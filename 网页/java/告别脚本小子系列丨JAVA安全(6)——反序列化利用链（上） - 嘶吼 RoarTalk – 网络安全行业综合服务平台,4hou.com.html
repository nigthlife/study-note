
<!-- saved from url=(0031)https://www.4hou.com/posts/gXpj -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">.small_tip{visibility: hidden;}</style><style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}
</style></head>
<body>
<title>告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com</title>

<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta property="wb:webmaster" content="4517e8fe39b18975">
<meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
<meta name="description" content="我们通常把反序列化漏洞和反序列化利用链分开来看，有反序列化漏洞不一定有反序列化利用链。">
<meta name="keywords" content="技术">
<link href="https://www.4hou.com/sihou/images/favicon.ico" rel="shortcut icon">
<link href="https://www.4hou.com/sihou/images/favicon_114.png" rel="apple-touch-icon">
<link href="https://www.4hou.com/sihou/images/favicon_76.png" sizes="76x76" rel="apple-touch-icon">
<link href="https://www.4hou.com/sihou/images/favicon_120.png" sizes="120x120" rel="apple-touch-icon">
<link href="https://www.4hou.com/sihou/images/favicon_152.png" sizes="152x152" rel="apple-touch-icon">
<!--[if lt IE 11]>
<script src="/sihou/js/html5shiv.min.js"></script>
<script src="/sihou/js/respond.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" media="screen and (min-width:1200px)" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lg.css">
<link rel="stylesheet" type="text/css" media="screen and (min-width:992px) and (max-width: 1199px)" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/md.css">
<link rel="stylesheet" type="text/css" media="screen and (min-width:768px) and (max-width: 991px)" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/sm.css">
<link rel="stylesheet" type="text/css" media="screen and (max-width: 768px)" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/sm.css">
<link rel="stylesheet" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/swiper.min.css">
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/push.js.下载"></script><script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/hm.js.下载"></script><script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/jquery.min.js.下载"></script>
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/swiper.jquery.min.js.下载"></script>
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/sweetalert.min.js.下载"></script>
<link rel="stylesheet" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/sweetalert.css">
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/swiper-bundle.min.js.下载"></script>
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/TweenMax.min.js.下载"></script>
<script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/main.js.下载"></script>
<style type="text/css">
    .navindex li span{
        color: #fff!important;
    }
    .swiper-pagination-bullet {
        width: 60px;
        height: 8px;
        border-radius: 2px;
        display: inline-block;
        background: #ffffff;
    }

    .swiper-pagination-bullet-active {
        background: #ffffff;
        opacity: 1;
    }

    .swiper-button-next, .swiper-container-rtl .swiper-button-prev {
        right: 10px;
        left: auto;
        color: #FF4612;
    }

    .swiper-button-prev, .swiper-container-rtl .swiper-button-next {
        left: 10px;
        right: auto;
        color: #FF4612;
    }

    .swiper-pagination {
        text-align: left;
        margin-left: 10px;
    }

    a {
        text-decoration: none
    }

    .t-font-cclor {
        color: #6C6C6C;
    }

    .span-color {
        color: #6C6C6C;
    }

    .white-color {
        color: #ffffff;
    }

    .intro-back-img {
        background-size: 100% !important;
    }

    .contribute-btn a {
        color: #FF4612;
    }

    .loginp a {
        color: #ffffff;
    }

    .logoa {
        position: relative;
    }

    .logoa img {
        height: 30px;
        width: 30px;
    }

    .member_name_new {
        padding-right: 1rem;
    }

    .nameheader_new {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: 7.5rem;
        display: inline-block;
        color: #fff;
        font-size: 1.4rem;
        text-align: right;
        overflow: hidden;
        padding-bottom: 3px;
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
    }

    .member_list_new li {
        display: block;
        float: none;
        margin: 0 auto;
        line-height: 3rem;
    }

    .member_list_new {
        position: absolute;
        margin-left: 3rem;
        margin-top: 0.4rem;
        border: 1px solid #e5e5ec;
        background-color: #fff;
        display: none;
        width: 8rem;
        text-align: center;
        border-radius: 3px;
        z-index: 99 !important;
    }

    .nameheader_new a {
        color: #ffffff;
    }

    .member_list_new li a {
        color: #6C6C6C !important;
        letter-spacing: 2px;
    }

    .nav-bar li a {
        color: #ffffff;
        opacity: 0.9;
    }

    .nav-bar li a:hover {
        opacity: 1;
        font-weight: 400;
        color: #FF4612;
    }

    #triangle-up:hover {
        border-top: 0.8rem solid #FF4612;
    }
</style>

<script>
        </script>
<script>
        </script>
<div class="navigation-bar">
    <div class="navigation-bar-center">
        <div class="left-logo-wrap">
            <a href="https://www.4hou.com/">
                <img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/newlogoss.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）">
            </a>
        </div>
        <div class="right-list-wrap">
            <ul class="navindex">
                <li class="">
                    <a href="https://www.4hou.com/"><span data-text="首" style="transition-delay: 0s;">首</span><span data-text="页" style="transition-delay: 0.0666667s;">页</span></a>
                </li>
                <li class="">
                    <a href="https://www.4hou.com/corp/newindex" target="_blank"><span data-text="企" style="transition-delay: 0s;">企</span><span data-text="业" style="transition-delay: 0.0666667s;">业</span><span data-text="中" style="transition-delay: 0.133333s;">中</span><span data-text="心" style="transition-delay: 0.2s;">心</span></a>
                </li>
                <li class="">
                    <a href="https://www.4hou.com/real-time" target="_blank"><span data-text="产" style="transition-delay: 0s;">产</span><span data-text="业" style="transition-delay: 0.0666667s;">业</span><span data-text="研" style="transition-delay: 0.133333s;">研</span><span data-text="究" style="transition-delay: 0.2s;">究</span><span data-text="院" style="transition-delay: 0.266667s;">院</span></a>
                </li>
            </ul>
            <div id="input-wrap">
                <form action="https://www.4hou.com/search-post">
                    <input name="keywords">
                </form>
            </div>
            <img class="search-icon" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/search-icon.png" onclick="$(&#39;#input-wrap&#39;).width() === 0 ? $(&#39;#input-wrap&#39;).width(&#39;20rem&#39;):$(&#39;#input-wrap&#39;).width(0)" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）">
            <button class="contribute-button">
                <a href="https://www.4hou.com/contribute" target="_blank">投稿</a>
            </button>
            <div style="font-size: 1.6rem;color:white;">
                                    <a href="https://www.4hou.com/login" style="color: white;">登录</a>
                    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
                    <a href="https://www.4hou.com/register" style="color: white;">注册</a>
                            </div>
        </div>
    </div>
</div>
<div class="nav-noth-bit">
    <div class="nav-noth-bit-info">
        <ul>
            <li class="newreadMenue">
                <a href="javascript:void(0);">导读&nbsp;▾</a>
            </li>
            <li>
                <a style="" href="https://www.4hou.com/newticket" target="_blank">活动</a>
            </li>
            <li>
                <a style="" href="https://www.4hou.com/category/special" target="_blank">专题</a>
            </li>
            <li class="">
                <a href="https://www.4hou.com/atlas/index" target="_blank">图谱</a>
            </li>
            <li class="">
                <a href="https://www.4hou.com/new-report-info" target="_blank">报告</a>
            </li>
            <li class="">
                <a href="https://www.4hou.com/tickets" target="_blank">嘶票</a>
            </li>
            <li class="">
                <a href="https://www.4hou.com/shop" target="_blank">嘶货</a>
            </li>
            <li class="">
                <a href="https://www.4hou.com/corp/new-search-company" target="_blank">企业查询</a>
            </li>
        </ul>
    </div>

</div>
<div class="nav-bar-bit">
    <div class="nav-bar-bit-info">
        <ul>
            <li><a href="https://www.4hou.com/category/news" target="_blank">新闻</a></li>
            <li><a href="https://www.4hou.com/category/industry" target="_blank">行业</a></li>
            <li><a href="https://www.4hou.com/category/observation" target="_blank">趋势</a></li>
            <li><a href="https://www.4hou.com/category/people" target="_blank">访谈</a></li>
            <li><a href="https://www.4hou.com/category/vulnerable" target="_blank">漏洞</a></li>
            <li><a href="https://www.4hou.com/category/web" target="_blank">WEB安全</a></li>
            <li><a href="https://www.4hou.com/category/business" target="_blank">业务安全</a></li>
            <li><a href="https://www.4hou.com/category/system" target="_blank">系统安全</a></li>
            <li><a href="https://www.4hou.com/category/penetration" target="_blank">内网渗透</a></li>
            <li><a href="https://www.4hou.com/category/typ" target="_blank">勒索软件</a></li>
            <li><a href="https://www.4hou.com/category/tools" target="_blank">安全工具</a></li>
        </ul>
    </div>
</div>
<div class="main-body">
        <meta name="csrf-token" content="YyFow8qKVBZLWivolvCTSFO95zIiTsR2JTa3kgdX">
    <link rel="stylesheet" href="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/style.css">
    <script type="text/javascript" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/jweixin-1.4.0.js.下载"></script>
    <script src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/public.js.下载"></script>
    <style type="text/css">
        body{
            margin: 0 auto;
            margin-top: 20rem;
        }
        .setReads {
            position: relative;
            height: 160px;
            width: 1200px;
            margin: 0 auto;
            background: #fff;
        }

        .informations {
            position: relative;
            display: inline-block;
            width: 350px;
            margin-top: 20px;
            margin-left: 176px;
            height: 130px;
            float: left;
        }

        .technology {
            position: relative;
            display: inline-block;
            width: 570px;
            height: 130px;
            float: left;
            margin-top: 20px;
            margin-left: 56px;
        }

        .informations h4,.technology h4 {
            font-size: 18px;
            color: #333333;
            display: inline-block;
            position: relative;
            padding-left: 0px;
            line-height: 22px;
        }

        .informations h4::before,.technology h4::before {
            content: " ";
            display: block;
            position: absolute;
            width: 4px;
            height: 22px;
            top: 0;
            left: -22px;
            background: #eb4f2a;
            border-radius: 1px;
        }

        .list_inav span {
            display: inline-block;
            float: left;
            width: 86px;
            height: 40px;
            box-sizing: border-box;
            padding-top: 10px;
            text-align: left;
        }

        .list_inav {
            margin-top: 12px;
        }

        .list_inav span a {
            display: inline-block;
            width: 70px;
            text-align: left;
            color: #666666!important;
            font-size: 14px;
        }

        .clearfix::after {
            content: "";
            overflow: hidden;
            clear: both;
            display: block;
            height: 0;
        }

        .swiper-container4 {
            height: 574px;
            overflow: hidden;
        }

        .banner_left div a {
            height: auto;
        }

        .information {
            border: none;
            padding-top: 15px;
            padding-left: 15px;
        }

        .information div a {
            display: block;
        }
        /* .swiper-container4{border:1px solid #ffc2ad;position: relative;} */
        .avatar_box {
            width: 100%
        }

        .information li p {
            padding: 5px 28px 5px 24px
        }

        .yyjr {
            height: 100%
        }

        .footerlogos {
            right: 0px !important
        }

        #mask {
            width: 100%;
            height: 100%;
            position: fixed;
            z-index: 25;
            left: 0px;
            top: 0px;
            background-color: rgba(0,0,0,.6);
            display: none;
        }

        .code-box {
            padding-top: 40px;
            display: none;
        }

        .code-box {
            width: 500px;
            height: 270px;
            background-color: #fff;
            position: fixed;
            left: 50%;
            margin-left: -200px;
            top: 28%;
            z-index: 999;
            border-radius: 5px;
            box-shadow: 1px 2px 2px rgba(0,0,0,.4);
        }

        .formTitle {
            margin-top: -40px;
            font-size: 24px;
            line-height: 65px;
            color: #fff;
            text-align: center;
            background: #ff3c08;
            border-radius: 5px 5px 0 0;
        }

        .succp {
            color: #999;
            font: 14px "微软雅黑";
            padding: 15px 80px;
        }

        .go_band {
            width: 340px;
            border: 1px solid #ff3d09;
            border-radius: 5px;
            line-height: 40px;
            color: #fff;
            text-align: center;
            background: #ff3d09;
            margin: 10px 20px;
            margin-bottom: 32px;
            margin-left: 80px;
        }
        .list-paddingleft-2 li{
            list-style-type: disc;
            margin-left: 20px;
        }

        @media  screen and (max-width:650px) {
            .code-box {
                padding-top: 40px;
                display: none;
            }

            .code-box {
                width: 97%;
                height: 240px;
                background-color: #fff;
                position: fixed;
                left: 50%;
                margin-left: -200px;
                top: 28%;
                z-index: 999;
                border-radius: 5px;
                box-shadow: 1px 2px 2px rgba(0,0,0,.4);
            }

            .formTitle {
                margin-top: -40px;
                font-size: 24px;
                line-height: 65px;
                color: #fff;
                text-align: center;
                background: #ff3c08;
                border-radius: 5px 5px 0 0;
            }

            .succp {
                color: #999;
                font: 14px "微软雅黑";
                padding: 10px 45px;
                line-height: 30px;
            }

            .go_band {
                width: 78%;
                border: 1px solid #ff3d09;
                color: #fff;
                background: #ff3d09;
                margin-left: 45px;
            }
        }

        .yyjr li i {
            display: block;
            width: 6px;
            height: 6px;
            background-color: #ff4612;
            border-radius: 50%;
            position: absolute;
            margin-top: 9px;
        }

        .new_right {
            width: 100%;
            float: right;
            margin-top: -52px;
        }

        .new_right_cen {
            width: 100%;
            background: #fff;
            margin-top: 82px;
        }

        ::selection {
            background: #fea283;
            color: #fff;
        }

        ::-moz-selection {
            background: #fea283;
            color: #fff;
        }

        ::-webkit-selection {
            background: #fea283;
            color: #fff;
        }

        .new_article {
            padding: 0 23px;
        }

        .new_article_in {
            border-top: 2px solid #efefef;
        }

        .new_article_in>h4 {
            line-height: 56px;
            text-align: center;
            font-size: 16px;
            color: #333;
            font-weight: 600;
        }

        .new_article_in li {
            margin-bottom: 15px;
        }

        .new_article_in li p {
            font-size: 14px;
            color: #333333;
            line-height: 22px;
            margin-bottom: 2px;
        }

        .new_article_in li span {
            font-size: 14px;
            color: #999999;
        }

        .see_more {
            display: block;
            width: 160px;
            height: 40px;
            text-align: center;
            font-size: 14px;
            color: #333!important;
            text-decoration: none!important;
            line-height: 40px;
            background: #eeeeee;
            margin: 0 auto;
            margin-bottom: 16px;
        }

        .sign_s {
            width: auto;
            height: 35px;
            line-height: 35px;
            text-align: center;
            border: 1px solid #e5e5e5;
            background: #f6f6f6;
            font-size: 14px;
            color: #333333!important;
            text-decoration: none!important;
            border-radius: 2px;
            margin-right: 8px;
            display: inline-block;
            padding: 0 5px;
        }

        .sigs {
            margin-left: 40px;
            float: left;
        }

        .art_time {
            margin-top: 20px;
        }

        .art_time span {
            display: inline-block;
            margin-right: 20px;
            color: #999999;
            font-size: 14px;
        }

        .art_time span.lei {
            color: #47baea
        }

        .article_cen img {
        }

        .article_cen strong span {
        }

        .intersting {
            padding: 28px 39px;
            background: #fff;
        }

        .intersting h4 {
            font-size: 16px;
            color: #333333;
            font-weight: 600;
            position: relative;
            margin-bottom: 30px;
            line-height: 18px;
            padding-left: 14px;
        }

        .intersting h4:before {
            position: absolute;
            content: " ";
            display: block;
            width: 4px;
            height: 100%;
            background: #ec4f2a;
            top: 0;
            left: 0;
        }

        .inters li {
            float: left;
            width: 244px;
            height: 224px;
            margin-right: 16px;
        }

        /*.inters li:nth-child(3n) {*/
        /*    margin-right: 0px;*/
        /*}*/

        .inters .img_bla {
            width: 100%;
        }

        .inters .img_bla img {
            width: 100%;
            display: block;
            max-height: 145px;
            height: auto;
        }

        .inters p {
            font-size: 14px;
            line-height: 24px;
            height: 48px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .inters .textbl {
            height: 68px;
            padding: 5px 0;
        }

        .review {
            margin-bottom: 0px!important;
        }

        .user-comment span {
            font-size: 12px;
        }

        .user-comment p {
            margin-top: 14px;
            font-size: 14px;
        }

        .reply .comment-reply-link {
            color: #ec4f2a;
            font-size: 14px;
        }

        .user-comment .reply {
            width: 84px;
            bottom: 23px;
        }

        .article_top {
            position: relative;
        }

        .strat {
            width: 60px;
            top: 1px;
            margin-right: 16px;
            padding-left: 24px;
            color: #999;
            font-size: 14px;
            cursor: pointer;
        }

        .article_cen p img {
            height: auto !important;
        }

        .commentlist .children {
            width: 90%;
            padding-right: 15px;
            border-color: transparent;
        }

        .commentname,.commenteml {
            width: 60%;
            margin-left: 5%;
            margin-bottom: 30px;
            border-bottom: 1px solid #dbdbdb;
        }

        .article_cen ol li {
            list-style-type: decimal;
        }

        .article_cen ol li p {
            overflow: inherit;
        }

        .commentname label {
            font-size: 16px;
            color: #666;
            margin-right: 10px;
            line-height: 32px;
        }

        .commentname input {
            width: 50%;
            border: none;
            outline: none;
        }

        .commenteml label {
            font-size: 16px;
            color: #666;
            margin-right: 10px;
            line-height: 32px;
        }

        .commenteml input {
            width: 50%;
            border: none;
            outline: none;
        }

        #zooming {
            display: none;
            width: 100%;
            height: 100%;
            position: fixed;
            z-index: 999;
            left: 0px;
            top: 0px;
            background-color: rgba(0,0,0,.6);
        }

        .zoomaniatae {
            display: block !important;
        }

        .imgcon {
        }

        #imgcon {
            position: absolute;
            left: 50%;
            top: 20%;
            max-width: 80%
        }

        .article_cen img {
            cursor: pointer;
        }

        #zooming {
            cursor: pointer;
        }

        .imgconadimate {
            animation: imgcon 0.5s 1 forwards;
            -webkit-animation: imgcon 0.5s 1 forwards;
        }

        .article_authorbox {
            width: 320px;
            min-height: 214px;
            padding-bottom: 20px;
            float: right;
            position: relative;
        }

        .article_author {
            width: 100%;
        }

        .interested {
            position: relative;
        }

        .interested>h1 {
            font-size: 18px;
            font-weight: 900;
            position: absolute;
            top: -36px;
            color: #5e5e5e
        }

        .user-comment span {
            font-size: 13px;
            position: relative;
            top: 2px;
        }

        .article_authoradd {
            position: fixed;
        }

        .stratend {
            width: 0px;
            margin-right: 60px;
            top: 1px;
            padding-left: 20px;
            background: url(https://www.4hou.com/sihou/images/starend.png); !important;
            background-size: contain !important;
        }

        .wpfp-span {
            opacity: 0;
            width: 100%;
            height: 100%;
            display: block;
            left: 0px;
            top: 0px;
        }

        .wpfp-link {
            width: 100%;
            height: 100%;
            display: block;
            left: 0px;
            top: 0px;
            word-break: keep-all;
        }

        .wpfp-span img {
            display: none;
        }

        .interested {
            width: 100%;
            padding-bottom: 20px;
            background-color: #fff;
            margin-top: 70px;
            padding-bottom: 10px;
            padding-top: 10px;
            border: 1px solid #f5c2b1
        }

        .interested li {
            width: 100%;
            position: relative;
            padding-top: 8px;
            padding-bottom: 8px;
            line-height: 24px;
            padding-left: 20px;
            padding-right: 14px
        }

        .interested li i {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #f63;
            position: absolute;
            left: 8px;
            top: 18px;
        }

        .interested li a {
            color: #666;
            font-size: 14px;
            line-height: 18px;
        }

        .interested li:hover {
            background-color: #f9e7e3;
            -moz-transition: all 0.4s ease-in-out;
            -o-transition: all 0.4s ease-in-out; -webkit-transition: all 0.4s ease-in-out; transition: all 0.4s ease-in-out;
        }

        .footer{position: relative;
            z-index: 99
        }

        .article_authorbox_top {
            position: relative;
        }

        @-webkit-keyframes imgcon {
            0% {
                opacity: 0;
                -webkit-transform: scale3d(.3, .3, .3);
                transform: scale3d(.3, .3, .3)
            }

            50% {
                opacity: 1
            }
        }

        @keyframes  imgcon {
            0% {
                opacity: 0;
                -webkit-transform: scale3d(.3, .3, .3);
                transform: scale3d(.3, .3, .3)
            }

            50% {
                opacity: 1
            }
        }

        .asideanimate {
            animation: asideanimate 1s 1 forwards;
            -webkit-animation: asideanimate 1s 1 forwards;
            position: fixed;
        }

        @-webkit-keyframes asideanimate {
            0% {
                opacity: 0;
                -webkit-transform: translate3d(0,-20%, 0);
                transform: translate3d(0, -20%, 0)
            }

            50% {
                opacity: 1
            }
        }

        @keyframes  asideanimate {
            0% {
                opacity: 0;
                -webkit-transform: translate3d(0,-20%, 0);
                transform: translate3d(0, -20%, 0)
            }

            50% {
                opacity: 1
            }
        }

        .asideanimateleave {
            animation: asideanimateleave 1s 1 forwards;
            -webkit-animation: asideanimateleave 1s 1 forwards;
        }

        @-webkit-keyframes asideanimateleave {
            0% {
                opacity: 1;
                -webkit-transform: translate3d(0,0, 0);
                transform: translate3d(0, 0, 0)
            }

            50% {
                opacity: 0;
                -webkit-transform: translate3d(0,-20%, 0);
                transform: translate3d(0, -20%, 0)
            }
        }

        @keyframes  asideanimateleave {
            0% {
                opacity: 1;
                -webkit-transform: translate3d(0,0, 0);
                transform: translate3d(0, 0, 0)
            }

            50% {
                opacity: 0;
                -webkit-transform: translate3d(0,-20%, 0);
                transform: translate3d(0, -20%, 0)
            }
        }

        @media  screen and (max-width:650px) {
            .member_list {
                right: -30px !important;
                top: 34px !important;
            }

            .article_authorbox {
                display: none;
            }

            .nameheader {
                display: none;
            }

            .shang_box {
                width: 90%;
                margin-left: -45%
            }

            #imgcon {
                width: 90% !important;
                margin-left: -45% !important;
                max-width: inherit !important
            }

            .dy {
                padding: 12px 15px!important;
                font-size: 14px !important;
                line-height: 22px !important;
            }
        }

        .article_author {
            float: none !important;
            padding-top: 1px;
        }

        .article_cen pre {
            color: #666 !important;
            line-height: 26px;
            background-color: #f1f1f1
        }

        .articlecontent blockquote>p {
            color: #666;
            font-size: 16px;
        }

        .information li {
            position: relative;
            margin-bottom: 15px;
            cursor: pointer;
            overflow: hidden;
        }

        .wpfp-link {
            width: 100%;
            height: 100%;
            display: block;
            position: absolute;
            left: -8px;
            padding-left: 31px;
            top: 0px;
            color: #999;
        }

        .wpfp-span {
            opacity: 1;
            width: 100%;
            height: 100%;
            display: block;
            left: 0px;
            top: 0px;
        }

        .strat {
            right: 3%;
        }

        @media  screen and (max-width: 650px) {
            .intersting {
                display: none;
            }
        }

        .activeq {
            height: 20px;
            background: url(https://www.4hou.com/sihou/images/starend.png)no-repeat;
            background-position: 0 0;
            position: absolute;
            top: 1px;
            right: 3%;
        }

        .show {
            display: block !important;
        }

        .hide {
            display: none !important;
        }
    </style>
    <div id="modelbg"></div>
    <script>
        $("#inNav").children("li").eq(1).children('a').css('color','#ff4612');
        $("#spans").css('border-color','#ff4612 transparent transparent');

        function isWeiXin(){
            //window.navigator.userAgent属性包含了浏览器类型、版本、操作系统类型、浏览器引擎类型等信息，这个属性可以用来判断浏览器类型
            var ua = window.navigator.userAgent.toLowerCase();
            //通过正则表达式匹配ua中是否含有MicroMessenger字符串

            $(function(){
                $.ajax({
                    headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                    url:"https://www.4hou.com/test-con",
                    type:'get',
                    dataType:"json",
                    data:{
                        url:"https://www.4hou.com/posts/gXpj",// 注册页面的url
                    }
                }).done(function(data){
                    // console.log(data);
                    wx.config({
                        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                        appId: data.appid, // 必填，公众号的唯一标识
                        timestamp:data.timestamp, // 必填，生成签名的时间戳
                        nonceStr: data.nonceStr, // 必填，生成签名的随机串
                        signature: data.signature,// 必填，签名，见附录1
                        jsApiList: ['updateAppMessageShareData','updateTimelineShareData'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2

                    });
                    wx.ready(function(){
                        wx.updateAppMessageShareData({ //分享给朋友
                            title: '告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）', // 分享标题,可在控制器端传递
                            desc: '我们通常把反序列化漏洞和反序列化利用链分开来看，有反序列化漏洞不一定有反序列化利用链。',//分享的描述，可在控制器端传递
                            link: 'https://www.4hou.com/posts/gXpj', // 分享链接，可在控制器端传递
                            imgUrl: "https://img.4hou.com/images/140633.jpg", // 分享图标 ，可在控制器端传递
                            success: function() {
                                // 用户确认分享后执行的回调函数
                                console.log('分享成功');
                            },
                            cancel: function() {
                                // 用户取消分享后执行的回调函数
                                console.log('分享失败');
                            }
                        });

                        wx.updateTimelineShareData({ //分享到朋友圈
                            title: '告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）', // 分享标题,可在控制器端传递
                            desc: '我们通常把反序列化漏洞和反序列化利用链分开来看，有反序列化漏洞不一定有反序列化利用链。',//分享的描述，可在控制器端传递
                            link: 'https://www.4hou.com/posts/gXpj', // 分享链接
                            imgUrl: "https://img.4hou.com/images/140633.jpg", // 分享图标 ，可在控制器端传递
                            success: function() {
                                // 用户确认分享后执行的回调函数
                                console.log('分享成功');
                            },
                            cancel: function() {
                                // 用户取消分享后执行的回调函数
                                console.log('分享失败');
                            }
                        });
                    });
                    // 加载失败
                    wx.error(function(res){
                        console.log(res);
                    });
                });
            });
            return true;

        }

        if(isWeiXin()){
            var nod = document.createElement("style"),
                str = ".small_tip{visibility: hidden;}";
            nod.type="text/css";
            if(nod.styleSheet){         //ie下
                nod.styleSheet.cssText = str;
            } else {
                nod.innerHTML = str;       //或者写成 nod.appendChild(document.createTextNode(str))
            }
            document.getElementsByTagName("head")[0].appendChild(nod);
        }

    </script>
    <section class="articlewrap">
        <article class="articlecontent">
            <div class="article_top">
                <h1 class="art_title">告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）</h1>
                <div class="art_time" style="position: relative;">
                    <span class="sir">盛邦安全</span>
                    <a href="https://www.4hou.com/category/technology">
                        <span class="lei">技术</span>
                    </a>
                                            <span>2022-07-05 11:37:47</span>
                                        <div id="collect-div" class="strat icons startq">
                        <span class="wpfp-link" title="收藏" rel="nofollow">收藏</span>
                    </div>
                </div>
            </div>
            <div class="dy" style="padding:0 30px;"><p style="font-size:14px;color:#999999;line-height: 24px;border-bottom: 1px dashed #dddddd;padding-bottom: 15px;">导语：我们通常把反序列化漏洞和反序列化利用链分开来看，有反序列化漏洞不一定有反序列化利用链。</p></div>
            <div class="article_cen">
                <!--文章摘要-->
                <section><section><section><section><p><span style="font-size: 20px;"><strong>0x01 前言</strong></span></p><p>我们通常把反序列化漏洞和反序列化利用链分开来看，有反序列化漏洞不一定有反序列化利用链（经常用shiro反序列化工具的人一定遇到过一种场景就是找到了key，但是找不到gadget，这也就是在这种场景下没有可利用的反序列化利用链）。如果我们向某个漏洞提交平台提交一个反序列化漏洞，但是不给反序列化利用链，那么平台大概率是不会接受这种漏洞的。</p></section></section></section></section><section><p>反序列化利用链是整个反序列化利用过程中最关键的一环，通常反序列化利用链需要借助常用的第三方jar包，其中最有名的就是CommonCollections利用链（简称CC链）。</p><section><section><section><section><section><section><section><p>往期推荐</p></section></section></section><section><section><section><section><section><section><p>1、<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&amp;mid=2247483768&amp;idx=1&amp;sn=36ff6d279fa7dbd7d5ae00b06a3c3ddc&amp;chksm=c2a1d5f1f5d65ce701e1f73ce0f584412bfc38a507622758f2acabce370cdcc4bb4af2270045&amp;token=1637952127&amp;lang=zh_CN&amp;scene=21#wechat_redirect">告别脚本小子系列丨JAVA安全(1)——JAVA本地调试和远程调试技巧</a></p></section></section></section></section></section><section><section><section><section><section><p>2、<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&amp;mid=2247483803&amp;idx=1&amp;sn=1af141cd5623b2682cfbdc2c12a53309&amp;chksm=c2a1d512f5d65c04bc046ee83de4ba98881d086837f05cef581b39323026195b504bb5635c4c&amp;token=1637952127&amp;lang=zh_CN&amp;scene=21#wechat_redirect">告别脚本小子系列丨JAVA安全(2)——JAVA反编译技巧</a></p></section></section></section></section></section><section><section><section><section><section><p>3、<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&amp;mid=2247483830&amp;idx=1&amp;sn=39c08c61cbab36ace4ac691e0756948b&amp;chksm=c2a1d53ff5d65c29f9b8310c324c67568fe27e61720baffff8af19ef9cb94f5096d73df0c69f&amp;token=1637952127&amp;lang=zh_CN&amp;scene=21#wechat_redirect">告别脚本小子系列丨JAVA安全(3)——JAVA反射机制</a></p></section></section></section></section></section><section><section><section><section><section><p>4、<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&amp;mid=2247483971&amp;idx=1&amp;sn=13bc478b9bad8c40279f4a2b22c7e29e&amp;chksm=c2a1d6caf5d65fdc4c76043ba0650ca947722c69bfd4bca69a4ef35d3fb318b5cf26fa557c6d&amp;token=1295938837&amp;lang=zh_CN&amp;scene=21#wechat_redirect">告别脚本小子系列丨JAVA安全(4)——ClassLoader机制与冰蝎Webshell分析</a></p></section></section></section></section></section><section><section><section><section><section><p>5、<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&amp;mid=2247484384&amp;idx=1&amp;sn=675a280b04097ab115a98b623ffc9957&amp;chksm=c2a1d769f5d65e7ff06adba1117ee14d1d772baedcd822302c5827b77fd6177a55f1c6add46b&amp;token=1295938837&amp;lang=zh_CN&amp;scene=21#wechat_redirect">告别脚本小子系列丨JAVA安全(5)——序列化与反序列化</a></p></section></section></section></section></section></section></section></section></section></section></section><section><section><section><section><section></section></section></section><section><section><section></section></section></section><section><section><p><span style="font-size: 20px;"><strong>0x02&nbsp;反序列化环境准备</strong></span></p><p>为了更方便初学者来学习反序列化利用链，我们首先要准备当前需要的实验环境。学习反序列化利用链最好的办法是参考ysoserial(https://github.com/frohoff/ysoserial)，ysoserial是一个开源的集成化反序列化利用链工具，可以快速生成反序列化利用链payload。</p></section></section></section></section><section><p>如果是不追求细节的小伙伴，可以直接按照参照ysoserial使用文档来生成payload，如下图所示。</p></section><section><section></section></section><section><p><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057161176913.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="630"></p><p>本文的主要目的是教会小伙伴们告别脚本小子，所以就不直接使用编译好的jar包，但是我们后面很多利用代码会参考ysoserial中的代码，ysoserial中关于反序列化利用链的代码都在ysoserial.payloads包中。</p><p>我们的目的是不通过ysoserial框架，自己实现相应的反序列化利用链。我们搭建反序列化测试的基础环境，新建maven项目，添加项目依赖的jar包。</p></section><section><p><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057162480578.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="258"></p><p>为了模拟序列化和反序列化的过程，编写两个公用的静态方法，这两个方法将在后面的反序列化利用链中被多次使用。其中searialize方法的作用是把对象obj序列化之后保存到文件filename中，unserialize方法的作用是把文件filename中的数据读出来反序列化为对象。<br></p></section><section><p><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057162180545.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="453"></p><p>通过读写文件来模拟序列化和反序列化的过程是最直观的实现方式，但是在实际环境中，我们遇到的都是基于POST输入的字符输入流来进行反序列化，如下图所示。本地读写文件的反序列化和基于POST输入字符的反序列化是完全没有区别的，所以我们后面在研究反序列化利用链的时候都是通过本地文件读写的方式来实现，而不会准备专门的WEB漏洞环境。<br></p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057164607611.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="537"></p></section><section><p style="text-align: center;">某系统反序列化漏洞实例</p></section><section><section><section><section><section></section></section></section><section><section><section></section></section></section><section><section><p><span style="font-size: 20px;"><strong>0x03 反序列化利用链</strong></span></p></section></section></section></section><section><section><section><section><section><p><strong>0x3.1 URLDNS利用链</strong></p></section></section></section></section></section><section><p>URLDNS链是JAVA众多利用链中最简单的一条利用链，非常适合初学者研究学习，具有下面的特点：</p></section><section><section><section><section><p>1）利用链只依赖jdk本身提供的类，不依赖其他第三方类，所以具有很高的通用性，可以用于判断目标是否存在反序列化漏洞。</p><p>2）利用链本身只能执行域名解析的操作，不能执行系统命令或者其他恶意操作。如果向漏洞提交平台提交反序列化漏洞，但是利用链是URLDNS的利用链，那么漏洞提交平台可能会拒绝这个漏洞。</p></section></section></section></section><section><p>Ysoserial中关于URLDNS链的主要代码如下图3.1.1，图3.1.2所示。这里面有一个很关键的点是使用了自定义的SilentURLStreamHandler类，为什么要使用这个自定义的类，我将在后面说明原因。<br></p></section><section><section></section></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057165404049.png" title="" width="900" height="381" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></p><p style="text-align: center;">图3.1.1 生成URLDNS利用链对象</p><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057165187815.png" title="" width="900" height="260" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></p><p style="text-align: center;">图3.1.2 自定义SilentURLStreamHandler类</p></section><section><p>我们先把ysoserial的代码搬运到本地，做一名合格的搬运工。直接搬运过来之后运行payload可以查看到DNSLOG的日志，证明搬运工没有问题了。搬运过来之后需要去掉ysoserial中的反射调用，我们这里没有Reflections类，所以自己写关于反射调用的代码，如图3.1.3所示，运行结果如图3.1.4所示</p><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057492128088.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="742"></p></section><section><section></section></section><section><p style="text-align: center;">图3.1.3 本地引用URLDNS利用链</p></section><section><section></section></section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057536210644.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="385"></p><p style="text-align: center;">图3.1.4 运行之后可以在DNSLOG查看DNS请求日志</p><section>为了理清楚利用链的整个流程，我们在java.net. URLStreamHandler类的getHostAddress方法中下断点调试一下，如图3.1.5所示。<br></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057566522110.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="594"></p></section><section><section></section></section><section><p style="text-align: center;">图3.1.5 下断点调试URLDNS利用链</p><p style="text-align: center;">运行整个payload，根据debug查看栈调用情况，如图3.1.6所示。其中最关键的红色的框中的部分，可以看出整个利用链非常简单。<br></p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057604681965.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="331"></p></section><section><section></section></section><section><p style="text-align: center;">图3.1.6 URLDNS利用链的栈调用情况</p><p style="text-align: center;">首先反序列化入口是在HashMap的readObject，在这个方法中会调用本类的hash方法，如图3.1.7所示。<br></p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057638166723.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="344"></p></section><section><p style="text-align: center;">图3.1.7 在HashMap的readObject方法中调用HashMap的hash方法</p><p>继续跟进hash方法，在这个方法中会调用key的hashCode方法。Key对应的值是java.net.URL类的对象，如图3.1.8所示。<br></p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057707177043.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="133"></p></section><section><p style="text-align: center;">图3.1.8 通过hash方法调用URL类的hashCode方法</p></section><section><p>继续跟进会调用java.net.URL类的hashCode方法,会调用handler字段的hashCode方法。而handler定义来自于URLStreamHandler类，所以会调用URLStreamHandler类的handler方法，如图3.1.9所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057735909554.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="252"></p></section><section><p style="text-align: center;">图3.1.9 URL类的hashCode方法调用URLStreamHandler类的hashCode方法</p></section><section><p>继续跟进java.net.URLStreamHandler类的hashCode方法，如图3.1.10所示。这里可以看出里面就直接调用了getHostAddress方法，该方法执行之后会进行域名到IP地址的解析请求。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057762536125.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></p></section><section><p style="text-align: center;">图3.1.10 最终调用了域名解析相关的方法getHostAddress方法</p></section><section><p>到这里已经看完了整个调用栈的流程，但是还是没有找到任何理由必须要用自定义的SilentURLStreamHandler类。为了理清楚原因，我们对原来的payload进行修改，去除自定义的SilentURLStreamHandler类，如图3.1.11所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057796826844.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="455"></p></section><section><p style="text-align: center;">图3.1.11 修改后的URLDNS利用链</p><p>还是在java.net. URLStreamHandler类的getHostAddress方法中下断点。可以看到整个栈调用情况如图3.1.12所示。可以看出触发getHostAddress方法的入口点是从generalURLDNS2这个方法，而不是unserialize方法，也就是在生成序列化对象的时候就已经触发了域名解析的请求。由于JAVA内部对DNS请求存在缓存机制，那么在反序列化的时候会优先从DNS缓存中查找域名解析记录，那么反序列化的时候就收不到正确的DNS请求数据。<br></p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057822137179.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="251"></p></section><section><p style="text-align: center;">图3.1.12 修改后的URLDNS利用链</p></section><section><p>我们跟一下在生成payload时候触发getHostAddress的流程，其中最关键的是执行HashMap中的put方法，如图3.1.13所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057850115774.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="399"></p></section><section><p style="text-align: center;">图3.1.13 URLDNS利用链生成对象时调用HashMap的put方法</p></section><section><p>跟踪put方法的定义，如图3.1.14所示。里面会调用hash方法</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057893998470.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="80"></p></section><section><p style="text-align: center;">图3.1.14 HashMap的put方法会调用本类的hash方法</p></section><p>剩下的流程和上面分析调用栈一样，最终会导致触发执行getHostAddress方法。</p><section><p>为了避免在生成payload的时候触发DNS请求，影响反序列化时DNS请求的执行。有两种解决办法。</p></section><section><section><section><section><p>1）第一种就是像ysoserial代码中的方式一样，定义一个类继承自URLStreamHandler，并且在类中重写getHostAddress等方法，使得在序列化的时候不会执行getHostAddress方法。</p><p>2）第二种办法是通过通过java.net.URL类中的hashCode方法中的逻辑来避免执行后续的getHostAddress方法。</p></section></section></section></section><section><p>第一种方法在ysoserial的代码中已经写很清楚了，这里主要再说一下第二种方式。在整个利用链中一个很重要的步骤是会调用java.net.URL类中的hashCode方法。如图3.1.15所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656057973681984.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="217"></p></section><p style="text-align: center;">图3.1.15 java.net.URL类中的hashCode方法代码逻辑</p><section><p>这里有一个很重要的判断语句是，如果hashCode不等于-1，则直接返回对应hashCode的值，否则调用hashCode方法计算对应的值。这里需要特别注意的一点是这里的hashCode既是java.net.URL类的方法，也是java.net.URL类的字段。所以我们需要</p></section><section><section><section><section><p>1）第一次put的时候把hashCode字段设置为不是-1的值，避免运行下面的handler.hashCode(this)。</p><p>2）生成序列化对象的时候又需要把hashCode字段设置为-1，因为反序列化的时候需要运行下面的handler.hashCode(this)。</p></section></section></section></section><p>所以我们也可以通过反射修改hashCode字段的方式来避免在序列化的时候触发DNS请求，再次修改后的代码如图3.1.16所示。这里最主要的是增加了通过反射修改hashCode字段的操作。<br></p><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058030110427.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="353"></p></section><section><p style="text-align: center;">图3.1.16 通过控制hashCode字段避免序列化时候触发DNS请求</p></section><section><p>这样之后也能达到和ysoserial代码一样的效果。也能正常触发URLDNS的请求，如图3.1.17所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058060623699.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="263"></p></section><section><p style="text-align: center;">图3.1.17 通过修改的payload触发URLDNS链的DNS请求</p></section><section><section><section><section><section><p><span style="font-size: 20px;"><strong>0x3.2&nbsp;CC链</strong></span></p></section></section></section></section></section><section><p>CC链是最早出现的影响较大的java反序列化利用链，原作者一共给出7条利用链，但是后来有很多大牛在此基础上给出了一些改进的利用链，对初学者而言，学习CC链是属于学习JAVA反序列化利用链的重要基础。</p></section><p>关于CC链的内容很多，限于篇幅有限，这次的文章先开头对部分CC链进行讲解，关于CC链的更多内容将在下一篇文章中详述。本次我们主要先讲关于CC链中的Transform链。</p><section><p>在学习Transform链之前，首先需要说明JAVA中命令执行的方式。JAVA中最典型的运行操作系统命令的办法是通过Runtime类来执行，如图3.2.1所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058111625903.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="113"></p></section><section><p style="text-align: center;">图3.2.1 JAVA中执行系统命令的方式</p></section><section><p>但是在反序列化的过程中不能直接通过Runtime来执行，因为Runtime类没有继承Serializable接口，如图3.2.2所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058136364167.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="95"></p></section><section><p style="text-align: center;">图3.2.2 Runtime类没有继承Serializable接口</p></section><section><p>但是我们可以通过反射的方式来调用Runtime类执行，并且里面涉及到的全部类都继承了Serializable接口，如图3.2.3所示。这里有一个坑是，通过反射来执行方法的返回值类型一定是Object类型，需要做强制类型转换，把Objectl类型转化为Runtime类型。后续的Transform利用链基本上都是通过执行这段代码来执行系统命令的。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058161160001.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="74"></p></section><section><p style="text-align: center;">图3.2.3 通过反射的方式来执行Runtime类的exec方法</p></section><section><p>严格来说Transform链属于整个CC链中的Sink点，CC链基本上都是通过Transform来最终执行系统命令的。学习Tranform链是掌握CC链的基础前提，最典型的Transform链如图3.2.4所示。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058185182669.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="507"></p></section><section><p style="text-align: center;">图3.2.4 典型Transform链运行情况</p></section><section><p>直接运行上面的代码是可以弹出计算器的，多数CC链最终也是通过调用类似的代码来执行系统命令。为了理解Transforml链的内容，需要分开来看里面涉及到的几个类：InvokerTransformer类、ConstantTransformer类和ChainedTransformer类。</p></section><section><p>在InvokerTransformer类中，最主要的是transform方法。该方法中通过反射的方式执行任意一个类的方式，如图3.2.5所示。Transform执行的方法必须是public修饰符的。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058278599022.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="377"></p></section><section><p style="text-align: center;">图3.2.5 通过InvokerTransformer类的transform方法执行任意public方法</p></section><section><p>InvokerTransformer类的transform方法提供了一种执行任意其他方法的路径，我们写一个简单的例子来帮助大家理解transform方法，如图3.2.6所示。定义一个类TEST，类中定义一个方法Hello，那么我们就可以通过tranform方法来执行TEST类的Hello方法。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058310116802.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="501"></p></section><section><p style="text-align: center;">图3.2.6 典型的transform方法调用</p></section><section><p>可能有的小伙伴会疑惑，我要执行Hello，为什么不直接调用，非要通过transform来调用呢？试想一下，如果我们要执行的是“Runtime.getRuntime()”这样的方法，但是整个系统中都没有任何地方直接调用了这个，那么我们是不是就可以通过transform来间接的执行这个方法呢。</p></section><section><p>但是现在通过transform来执行方法还有一个很明显的不足，就是只能执行单个对象的单个方法，不能链式调用。形象一点来说明这个问题，我们可以执行”Runtime.getRuntim()”，但是我们不能执行“Runtime.getRuntime().exec(xxxx)”。我们需要找到链式调用的方式，幸运的是CommonsCollections中提供了另一个类ChainedTransformer。</p></section><section><p>ChainedTransformer类中提供了链式调用transform方法的办法，如图3.2.7所示。ChainedTransformer类的构造方法是传入Transformer类型的数组，通过transform方法依次遍历数组中的每一个元素，上一步的方法调用的输出作为下一步的方法调用的输入，完美的链式调用解决办法。</p></section><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058346158012.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="359"></p></section><section><p style="text-align: center;">图3.2.7 通过ChainedTransformer类链式调用transform方法</p></section><section><p>现在已经可以链式调用来执行命令了，但是还有一个问题没有解决，从图3.2.3中可以看出要执行命令，第一步是获取Runtime.class对象，如何通过某个类的transform对象来获取Runtime.class对象呢？这个时候就要用到CommonCollections包里面另一个类ChainedTransformer。</p></section><p>ChainedTransformer类的transform方法很简单，就是直接返回构造函数中的iConstant字段，如图3.2.8所示。这完美地解决了我们想要Runtime.class对象的愿望。</p><section><p style="text-align: center;"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/1656058376169883.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" width="900" height="187"></p></section><section><p style="text-align: center;">图3.2.8 通过ChainedTransformer类获取Runtime.class对象</p></section><section><p>通过上面的分析可以知道通过Transform链已经可以达到执行操作系统命令的效果，如图3.2.4所示。目前的情况是如果反序列化的时候，可以调用ChainedTransformer类的transform方法，则可以导致命令执行，但是反序列化的时候会自动调用的是readObject方法，如何通过readObject方法来调用transform方法呢？这是下一次分享的内容，未完待续。</p></section><section><section><section><section><section></section></section></section><section><section><section></section></section></section><section><section><p><span style="font-size: 20px;"><strong>0x04 总结</strong></span></p></section></section></section></section><section><p>这次主要分享的是关于反序列化利用链的知识，主要介绍了URLDNS利用链和CC链中的Transform链。这些都是属于JAVA反序列化的基础知识，后续的知识都会在此基础上进行延展。从文中可以看出反序列化利用链通常包含比较复杂的逻辑知识，就算是最简单的URLDNS链也能让初学者难受，分析反序列化利用链不能太快，理解很重要。后续还有更多关于反序列化利用链的分享，欢迎交流沟通。</p></section><section><section><section><section><p><strong>参考链接</strong></p></section></section></section></section><section><section></section><p><a href="https://xz.aliyun.com/t/9873">https://xz.aliyun.com/t/9873</a></p><p><a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a></p></section>
                                <div class="foot_description" style="background-color: #fff;">
                    本文来源于：https://mp.weixin.qq.com/s/o_N4Hk4gstqnzfqfjutA3w如若转载，请注明原文地址
                </div>
                            </div>
            <div class="article_con">
            </div>
            <div class="post-like">

                <a id="like-before-btn" data-action="ding" class="favorite show">
                    <div class="zanbox">
                        <dd class="zanbefor"></dd>
                    </div>
                </a>

                <a id="like-after-btn" data-action="ding" class="favorite postlikeclick done hide">
                    <div class="zanbox">
                        <dd class="zanbefor" style="display: none;"></dd>
                        <dd class="zanafter zanafteranimate"></dd>
                    </div>
                </a>

            </div>
            <div class="active_bottom">
                <div class="clearfix">
                    <div class="sigs">
                                            </div>
                    <ul style="float: right;">
                        <li style="    font-size: 16px;color: #333333;width: 48px; background: #fff;border-radius: 0px; line-height: 25px;margin-right: 12px;">分享至</li>
                        <a class="Sina" href="http://service.weibo.com/share/share.php?url=https://www.4hou.com/posts/gXpj" title="分享到新浪微博" target="_blank"><li class="sinahover"></li></a>
                        <a onclick="dashangToggle(&#39;gXpj&#39;)" class="friend" title="分享到微信、朋友圈等" target="_blank"><li class="wx"></li></a>
                    </ul>
                    <div class="hide_box"></div>
                    <div class="shang_box">
                        <a class="shang_close" href="javascript:void(0)" onclick="$(&#39;.shang_box&#39;).fadeOut()" title="关闭">
                            <img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/close.jpg" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" title=""></a>
                        <img class="shang_logo" width="120px" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/logo.png" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" title="">
                        <div class="shang_tit">
                            <p>感谢您的支持，我会继续努力的!</p>
                        </div>
                        <div class="shang_payimg">
                            <img id="post-qrcode-img" src="https://www.4hou.com/posts/gXpj" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" title="">
                        </div>

                        <div class="shang_info">
                            <p>打开<span id="shang_pay_txt">微信</span>扫一扫后点击右上角即可分享哟</p>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                function dashangToggle(id){
                    $.ajax({
                        headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                        type:"post",
                        url:"https://www.4hou.com/post-qrcode",
                        data:{
                            id:id
                        },
                        dataType:'json',
                        success:function(data){
                            $('#post-qrcode-img').attr('src', data.message);
                        }
                    });
                    $(".shang_box").fadeIn();
                }
            </script>
            <script>
                var mySwiper = new Swiper('.swiper-container', {
                    direction : 'vertical',
                    pagination : '.swiper-pagination',
                    paginationClickable :true,
                    spaceBetween : 20
                })
            </script>
            <div class="review" style="margin-bottom:80px;display:block">
                <h3 id="reply-title" class="comment-reply-title">发表评论 <small></small></h3>
                    <p class="comment-form-comment">
                        <label for="comment">评论</label>
                        <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea>
                    </p>
                    <p class="form-submit">
                        <input type="submit" id="submit" class="submit" value="发表评论">

                        <input type="text" name="img-code" placeholder="验证码" style="border:1px solid #ff4612;border-radius: 4px;float: right;margin-top: 20px;width: 84px;height: 34px;margin-right: 1%;">
                        <img id="img-code" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/flat" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" style="cursor: pointer;float: right;margin-top: 20px;width: 84px !important;height: 34px !important;margin-right: 1%;border-radius: 4px;" onclick="this.src=&#39;https://www.4hou.com/captcha/flat?WgHxLL4c&#39;+Math.random()" title="">

                        <input type="hidden" name="post_id" value="gXpj" id="post_id">
                        <input type="hidden" name="parent_id" id="parent_id" value="0">
                        <input id="authenticated" type="hidden" value="">
                    </p>
                <div class="new-review">
                    <ol class="commentlist">
                                            </ol>
                    <div class="hr clearfix">&nbsp;</div>
                </div>
            </div>
            <div style="background: #f6f6f6;padding-top: 18px;">
                <div class="intersting">
                    <h4>你可能感兴趣的</h4>
                    <ul class="clearfix inters">
                                                <li>
                            <a href="https://www.4hou.com/posts/yAXg">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/1685803312140156.png" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">基于云的恶意软件传播：GuLoader的技术迭代过程</p>
                                </div>
                            </a>
                        </li>
                                                <li>
                            <a href="https://www.4hou.com/posts/vJNm">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/微信截图_20230619100511.png" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">【技术原创】渗透基础——Zimbra版本探测</p>
                                </div>
                            </a>
                        </li>
                                                <li>
                            <a href="https://www.4hou.com/posts/5wlA">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/2398bb29dee841c1a59c0276177b39b8.png" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">出于经济利益，Void Rabisu使用RomCom后门在地缘冲突中获利</p>
                                </div>
                            </a>
                        </li>
                                                <li>
                            <a href="https://www.4hou.com/posts/vxjM">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/1686467439190175.jpeg" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">2023年第一季度IT攻击概述</p>
                                </div>
                            </a>
                        </li>
                                                <li>
                            <a href="https://www.4hou.com/posts/xjP9">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/20181029191136931.jpg" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">【技术原创】vRealize Log Insight漏洞调试环境搭建</p>
                                </div>
                            </a>
                        </li>
                                                <li>
                            <a href="https://www.4hou.com/posts/8zE2">
                                <div class="img_bla">
                                    <img data-original="https://img.4hou.com/images/微信截图_20230609142559.png" class="wp-post-image" width="259" height="145" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/lazy.gif" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></div>
                                <div class="textbl">
                                    <p class="">BlackCat勒索软件启用了新的签名内核驱动程序</p>
                                </div>
                            </a>
                        </li>
                                            </ul>
                </div>
            </div>
        </article>
        <!--作者其他文章-->
        <aside class="article_authorbox">
            <div class="article_authorbox_top">
                <div class="article_author">
                    <div class="article_author_avatar">
                        <a class="upload-img">
                            <img alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/3c8d3af7c49c95c16dd14518142759d6.png" class="avatar avatar-72 photo" height="72" width="72" title="">
                        </a>
                    </div>
                    <h1 class="article_author_name">
                        <a href="https://www.4hou.com/member/9ZO4" class="upload-img" target="_blank">盛邦安全</a>
                                            </h1>
                    <span class="article_author_type" style="text-align: -webkit-center;">
                        <p>让网络空间更有序</p>
                    </span>
                    <div class="new_article">
                        <div class="new_article_in">
                            <h4>最新文章</h4>
                            <ul>
                                                                <li>
                                    <a href="https://www.4hou.com/posts/yAXg"><p>基于云的恶意软件传播：GuLoader的技术迭代过程</p></a>
                                    <span class="times">2023-06-21 12:00:00</span>
                                </li>
                                                                <li>
                                    <a href="https://www.4hou.com/posts/vJNm"><p>【技术原创】渗透基础——Zimbra版本探测</p></a>
                                    <span class="times">2023-06-19 12:00:00</span>
                                </li>
                                                                <li>
                                    <a href="https://www.4hou.com/posts/5wlA"><p>出于经济利益，Void Rabisu使用RomCom后门在地缘冲突中获利</p></a>
                                    <span class="times">2023-06-18 12:00:00</span>
                                </li>
                                                                <li>
                                    <a href="https://www.4hou.com/posts/vxjM"><p>2023年第一季度IT攻击概述</p></a>
                                    <span class="times">2023-06-15 12:00:00</span>
                                </li>
                                                            </ul>
                            <a href="https://www.4hou.com/member/9ZO4" class="see_more">查看更多</a>
                        </div>
                    </div>
                </div>
                <article class="new_right">
                    <!-- 热门推荐 -->
                    <div class="new_right_cen">
                        <div class="line"></div>
                        <h1 class="hot">相关热文</h1>
                        <ul class="information">
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/yAXg">基于云的恶意软件传播：GuLoader的技术迭代过程</a></p>
                                <span style="padding-left: 21px; color: #ccc;">xiaohui</span>
                            </li>
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/vJNm">【技术原创】渗透基础——Zimbra版本探测</a></p>
                                <span style="padding-left: 21px; color: #ccc;">3gstudent</span>
                            </li>
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/5wlA">出于经济利益，Void Rabisu使用RomCom后门在地缘冲突中获利</a></p>
                                <span style="padding-left: 21px; color: #ccc;">xiaohui</span>
                            </li>
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/vxjM">2023年第一季度IT攻击概述</a></p>
                                <span style="padding-left: 21px; color: #ccc;">lucywang</span>
                            </li>
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/xjP9">【技术原创】vRealize Log Insight漏洞调试环境搭建</a></p>
                                <span style="padding-left: 21px; color: #ccc;">3gstudent</span>
                            </li>
                                                        <li>
                                <i></i>
                                <p><a href="https://www.4hou.com/posts/8zE2">BlackCat勒索软件启用了新的签名内核驱动程序</a></p>
                                <span style="padding-left: 21px; color: #ccc;">lucywang</span>
                            </li>
                                                    </ul>
                    </div>
                </article>
            </div>
        </aside>
    </section>
    <div id="zooming">
        <img src="https://www.4hou.com/posts/gXpj" id="imgcon" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）">
    </div>
    <input type="hidden" id="post_id" value="21474">
    <input type="hidden" id="post_link" value="">
    <input type="hidden" id="postuid" value="0">
    <input type="hidden" id="status" value="">
    <input type="hidden" name="isCollection" value="1">
    <script>
        let authenticated = $('#authenticated').val();
        $(document).ready(function() {
            $('.post-like').click(function () {
                if(authenticated){
                    $.ajax({
                        headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                        type:"post",
                        url:"https://www.4hou.com/post-thumbs-up",
                        data:{
                            user_id: '0',
                            post_id: 'gXpj',
                            type: '1'
                        },
                        dataType:'json',
                        success:function(data){
                            if(data.status_code == 200){
                                window.location.reload()
                            }
                        }
                    });
                }else{
                    window.location.href= "https://www.4hou.com/login"
                }
            });
            $("img").attr("title","");
            var altcon=$(".art_title").text();
            $("img").attr("alt",altcon);
            // 图片放大
            $(".article_cen").find('img').on("click",function(){
                var imgsrc=$(this).attr("src");
                var winthimg=$(this).width();
                var zooming=winthimg*1.2;
                $("#imgcon").css({width:zooming});
                $("#imgcon").css({marginLeft:-zooming/2});
                $("#imgcon").attr("src",imgsrc);
                $("#zooming").addClass("zoomaniatae");
                $("#imgcon").addClass("imgconadimate");
            });
            $("#zooming").on("click",function(){
                $("#imgcon").removeClass("imgconadimate");
                $("#zooming").removeClass("zoomaniatae");
            });
        });
        $('#collect-div').on('click',function () {
            if('1'){
                sweetAlert('error','您还未登录，请登录后再收藏该文章!','error');
                setTimeout(function(){
                    window.location.href= 'https://www.4hou.com/login'
                },2000);
            }else{
                $.ajax({
                    headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                    type: "POST",
                    url: "https://www.4hou.com/post-collection",
                    data: {
                        user_id: '',
                        post_id: 'gXpj',
                        type: $("input[name='isCollection']").val()
                    },
                    dataType: "json",
                    success: function(data){
                        if(data.status_code == 200){
                            if($('#collect-div').hasClass('activeq')){
                                $('#collect-div').removeClass('activeq');
                                $('#collect-div').addClass('startq')
                                $('.wpfp-link').text('收藏');
                                $("input[name='isCollection']").val(1);
                            }else{
                                $('#collect-div').addClass('activeq');
                                $('#collect-div').removeClass('startq');
                                $('.wpfp-link').text('已收藏');
                                $("input[name='isCollection']").val(0);
                            }
                        }
                    }
                });
            }
        });

        // 发送文章评论
        function sendComment(parent_id = 0) {
            $('#comment').focus()
            $(" input[name='parent_id']").val(parent_id)
        }

        $('#submit').click(function () {
            var post_id = $("input[name='post_id']").val();
            var comment = $("textarea[name='comment']").val();
            var parent_id = $("input[name='parent_id']").val();
            var img_code = $("input[name='img-code']").val();
            if(!authenticated){
                sweetAlert('error','您还未登录，请登录后再评论!','error');
                setTimeout(function(){
                    window.location.href= 'https://www.4hou.com/login'
                },2000);
            }
            if(comment.length == 0){
                sweetAlert("error", "请填写评论内容！", "error");
                return false;
            }

            if(comment.length > 100){
                sweetAlert("error", "评论内容过长！", "error");
                return false;
            }

            if(!img_code){
                sweetAlert("error", "请填写验证码！", "error");
                return false;
            }

            $.ajax({
                headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                type:'POST',
                dataType:'json',
                data:{
                    'post_id': post_id,
                    'comment': comment,
                    'parent_id': parent_id,
                    'img_code': img_code
                },
                url:"https://www.4hou.com/send-comment",
                success:function (data) {
                    if(data.status_code == 200){
                        $("#submit").val('正在审核...').attr("disabled",true);
                        sweetAlert("success", data.message, "success");
                    }else {
                        $('#img-code').attr("src", 'https://www.4hou.com/captcha/flat?qvRPBzXQ'+Math.random());
                        sweetAlert("error", data.message, "error");
                    }
                }
            });
        });
    </script>
</div>


<div class="section-6 col">
    <div class="footlinks">
        <div class="row space-between links">
                            <span><a href="https://www.4hou.com/about?title=%E5%85%AC%E5%8F%B8%E7%AE%80%E4%BB%8B" target="_blank">公司简介</a></span>
                <span>|</span>
                            <span><a href="https://www.4hou.com/about?title=%E6%88%91%E8%A6%81%E6%8A%95%E7%A8%BF" target="_blank">我要投稿</a></span>
                <span>|</span>
                            <span><a href="https://www.4hou.com/about?title=%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97" target="_blank">更新日志</a></span>
                <span>|</span>
                            <span><a href="https://www.4hou.com/about?title=%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5" target="_blank">友情链接</a></span>
                <span>|</span>
                            <span><a href="https://www.4hou.com/about?title=%E9%9A%90%E7%A7%81%E6%94%BF%E7%AD%96" target="_blank">隐私政策</a></span>
                <span>|</span>
                    </div>
        <div class="row space-between top-share-icons">
            <a href="http://weibo.com/u/6069423878" target="_blank"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/weibo.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></a>
            <img class="wechartlogo" src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/wechat.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）">
            <a href="https://zhuanlan.zhihu.com/roartalk" target="_blank"><img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/zhihu.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"></a>
        </div>
    </div>
    <div class="disclaimer">本站4hou.com，所使用的字体和图片文字等素材部分来源于原作者或互联网共享平台。如使用任何字体和图片文字有侵犯其版权所有方的，嘶吼将配合联系原作者核实，并做出删除处理。</div>
    <div class="bottom-intro">
        <span><a href="https://beian.miit.gov.cn/" target="_blank">©2022 北京嘶吼文化传媒有限公司 京ICP备16063439号-1</a></span>
        <span class="row">本站由 <img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/txcloud.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"> <img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/bdcloud.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"> <img src="./告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上） - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com_files/ucloud.png" title="" alt="告别脚本小子系列丨JAVA安全(6)——反序列化利用链（上）"> 提供云计算服务 </span>
    </div>
</div>
<aside class="side">
    <div class="side_top icons "></div>
    <div class="iconbox">
        <div class="side_wechart icons iconhover">
            微信
            <dd></dd>
        </div>
        <a href="http://weibo.com/u/6069423878" target="_blank">
            <div class="side_webo icons iconhover">
                微博
            </div></a>
        <a href="https://www.4hou.com/feed" target="_blank">
            <div class="side_rss icons iconhover">
                RSS
            </div></a>
        <a href="https://zhuanlan.zhihu.com/roartalk" target="_blank">
            <div class="side_zh icons iconhover">
                知乎
            </div></a>
    </div>
    <div class="side_bottom icons"></div>
</aside>
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?ac201c14c3d2a4747423252be421e1bc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();

    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    $(".member_name_new").click(function () {
        $(".member_list_new").toggle();
    });
    // $('.closebtn').click(function () {
    //     $('.input-search').hide(400);
    //     $('.nav-bar-ul').show(400);
    //     $('.search-btns').show(400);
    // })
    // $('.search-btns').click(function () {
    //     $('.input-search').show(400);
    //     $('.nav-bar-ul').hide(400);
    //     $('.search-btns').hide(400);
    // })
    $(".newreadMenue").click(function () {
        $(".nav-bar-bit").slideToggle(200);
    })

    // 要操作的元素
    const links=document.querySelectorAll('.navindex li a');
    //要操作的元素
    //遍历a标签集合
    links.forEach(link=>{
        //将a标签的文本拆分为各个单字
        let letters=link.textContent.split('');
        //将a标签文本清空
        link.textContent='';
        //遍历单字集合
        letters.forEach((letter,i)=>{
            //创建span元素
            let span=document.createElement('span');
            //设置文本
            span.textContent=letter;
            //设置自定义属性(data-text)，css中可通过attr函数进行调用
            span.dataset.text=letter;
            //计算动画延迟时间并设置
            span.style.transitionDelay=i/15+'s';
            //追加span元素到a标签
            link.append(span);
        })
    })
</script>


</body></html>