/*! For license information please see c__LazyEmbedReader.101de22b.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[84,8,11,14,16,19,31,54,66,1136,1137,1142,1143,1150,1155,1158,1167,1187],{1490:function(e,t,n){"use strict";n.r(t),n.d(t,"LakexTextViewer",(function(){return J}));n(55);var r=n(22),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(429),u=n(110),s=n(303),d=n(101),f=n.n(d),h=n(731),p=n(635),m=n(125),y=n(207),v=n(644),g=n(35),b=n(1495),x=n(75),w=n(208),k=n(642),E=n.n(k),O=n(420),C=n(646);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===A(a)?a:String(a)),r)}var o,a}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R(e);if(t){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(a,e);var t,n,r,o=j(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return t=a,n=[{key:"previewImgs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;C.a.previewImages(e,t)}}],n&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s.ViewerEnvAdapter);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==M(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===M(a)?a:String(a)),r)}var o,a}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N(e);if(t){var o=N(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(a,e);var t,n,r,o=D(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"openLink",value:function(e){e.startsWith("#")?window.open(e,"_self"):(e.startsWith("./")&&(e=e.substring(1)),e.startsWith("/")&&(e="".concat(window.location.origin).concat(e)),m.a.pushWebWindow({url:e}))}},{key:"openLocalLink",value:function(e){m.a.pushWebWindow({url:e})}},{key:"openYuqueDocLink",value:function(e){m.a.pushWebWindow({url:e})}},{key:"openLocalYuqueDocLink",value:function(e){m.a.pushWebWindow({url:e})}},{key:"openMentionLink",value:function(e,t){m.a.pushWebWindow({url:e})}},{key:"openBookmarkLink",value:function(e){m.a.pushWebWindow({url:e})}},{key:"openThirdpartyLink",value:function(e){m.a.pushWebWindow({url:e})}},{key:"previewImgs",value:function(e,t){m.a.previewImage({images:e.map((function(e){return{url:e.src,thumbnailUrl:e.msrc,width:e.w,height:e.h}})),index:t})}},{key:"longPressCard",value:function(e){var t=e.type,n=e.src;window.NativeBridges.showActionSheet({actions:[__("保存到相册")],onAction:function(e){0===e&&window.NativeBridges.saveToGallery({type:t,fileUrl:n})}})}}])&&L(t.prototype,n),r&&L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s.ViewerEnvAdapter);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}var F=["dispatch"];function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}function z(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return(t=K(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(){V=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==I(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function U(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function W(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){U(a,r,o,i,c,"next",e)}function c(e){U(a,r,o,i,c,"throw",e)}i(void 0)}))}}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}function K(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$(e);if(t){var o=$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(d,e);var t,n,o,i,c,l=Q(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this,e)).containerRef=a.a.createRef(),t.viewerRef=a.a.createRef(),t}return t=d,n=[{key:"componentDidMount",value:function(){this.renderViewer()}},{key:"componentDidUpdate",value:function(e){e.content!==this.props.content&&this.renderViewer()}},{key:"renderViewer",value:(c=W(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.createDocViewer();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("renderLakexViewerError",e.t0),u.a.logViewerError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return c.apply(this,arguments)})},{key:"renderViewerHeader",value:function(){this.viewerRef.current&&this.viewerRef.current.renderHeader()}},{key:"createDocViewer",value:(i=W(V().mark((function e(){var t,n,o,a,i,c=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(null===(t=this.props.doc)||void 0===t?void 0:t.id)||+new Date,console.time("LakexTextViewer-".concat(a)),this.viewerRef.current&&this.viewerRef.current.destroy(),this.containerRef.current){e.next=5;break}return e.abrupt("return");case 5:this.viewerRef.current=Object(s.createDocViewer)(this.containerRef.current,this.buildOptions()),(i=this.viewerRef.current).on("ready",(function(){console.timeEnd("LakexTextViewer-".concat(a)),c.props.onReady&&c.props.onReady(i,i.getViewerContext())})),i.on("firstRender",(function(){c.props.onFirstRender&&c.props.onFirstRender(i)})),i.on("loaded",(function(){c.props.onLoaded&&c.props.onLoaded(i,i.getViewerContext())})),i.on("viewportLayoutChange",(function(e){c.props.onViewportLayoutChange&&c.props.onViewportLayoutChange(e)})),i.on("unSupportFileUpload",(function(e){var t;r.a.warning(Object(p.a)(null==e||null===(t=e.extName)||void 0===t?void 0:t.toLowerCase()))})),this.props.doc&&Object(O.d)(this.props.doc.id),i.setDocument({type:"html"===(null===(n=this.props.doc)||void 0===n?void 0:n.format)?"text/html":"lake",value:this.props.content},{dynamicData:this.props.dynamicData||(null===(o=this.props.doc)||void 0===o?void 0:o.doc_dynamic_data)}),i.on("beforeEnterMaxView",(function(e,t){var n=t.id;if(c.props.onCardMaximizeEnter&&c.props.onCardMaximizeEnter(),n&&window.history.pushState){window.history.pushState({},"","".concat(window.location.pathname,"?inner=").concat(n));var r=document.querySelector("#doc-content");r&&(r.style.zIndex=999,r.style.position="relative")}})),i.on("leaveMaxView",(function(){if(c.props.customMaximizeRestore)c.props.customMaximizeRestore();else if(window.history.pushState){window.history.pushState({},"",window.location.pathname);var e=document.querySelector("#doc-content");e&&(e.style.zIndex="",e.style.position="")}c.props.onCardMaximizeLeave&&c.props.onCardMaximizeLeave()})),i.on("login",(function(){var e,t;c.props.onLogin,null===(e=(t=c.props).onLogin)||void 0===e||e.call(t)})),i.on("userAction",(function(e){var t;g.a.logs.editorUserAction(Y({editor:"lakexTextViewer",uuid:null===(t=i.kernel)||void 0===t?void 0:t.id},e),{ignoreGlobalMessage:!0})})),i.on("monitorLog",(function(e){var t=e.code,n=e.data,r=e.error;u.a.editorMonitorLog(t,n,r)})),this.props.autoMaximizeCard&&i.enterMaxViewById(this.props.autoMaximizeCard),this.props.forwardedRef&&(this.props.forwardedRef.current={viewer:i});case 21:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"buildOptions",value:function(){var e,t,n,o,a,i,c,l,u,s,d,p,k,O,C,A,P,S,j,R=this.props,M=(null===(e=window.appData)||void 0===e?void 0:e.me)||{},L=R.doc||window.appData.doc,T=(null===(t=R.doc)||void 0===t?void 0:t.doc_id)||(null===(n=R.doc)||void 0===n?void 0:n.id)||(null===(o=window.appData.doc)||void 0===o?void 0:o.id),D=R.docType||(null===(a=R.doc)||void 0===a?void 0:a.type)||(null===(i=window.appData.doc)||void 0===i?void 0:i.type),N=!(null===(c=window.appData)||void 0===c||null===(l=c.me)||void 0===l||!l.id),I=null===(u=window.appData)||void 0===u?void 0:u.settings,F=null===(s=window.appData)||void 0===s||null===(d=s.matchCondition)||void 0===d?void 0:d.useTileRendering,q={},z=null===(p=window.appData)||void 0===p||null===(k=p.doc)||void 0===k||null===(O=k.abilities)||void 0===O?void 0:O.update,G=(null===(C=R.theme)||void 0===C?void 0:C.viewport)||(R.simpleUI?f.a.VIEWPORT.adapt:f.a.VIEWPORT.fixed);q.sidebar={sidePanelManager:R.sidePanelManager},q.isLogged=N,q.boundaryTopOffset=R.boundaryTopOffset||0,q.layout=G,q.mode=G,q.typography=(null===(A=R.theme)||void 0===A?void 0:A.typography)||f.a.TYPOGRAPHY.traditional,q.viewResizeObserver=R.viewResizeObserver,q.docId=T,q.tileRendering=R.tileRendering&&F,q.envAdapter=new _,q.image={supportImgOCR:E()(),onBeforeRenderImage:v.a,lazyLoad:R.imageLazyLoad},q.vote={queryDetailUrl:"/api/votes?doc_id=".concat(T),queryCheckUrl:"/api/votes/mine?doc_id=".concat(T),voteUrl:"/api/votes?doc_id=".concat(T),allowVote:N,isOwner:!(null==L||null===(P=L.abilities)||void 0===P||!P.update)},q.lockedtext={action:"/api/services/crypto"},q.video={queryAction:"/api/video",attachable_id:T,attachable_type:"Doc"},q.audio={queryURL:"/api/video",attachable_id:T,attachable_type:"Doc",allowAudioPlayer:y.a.isAllowAudio(R.doc,R.book,R.group)},q.toc={enable:!window.h5&&this.props.genOutline,getContainer:this.props.getTOCContainer},q.comments={enable:R.enableComments,enableCardComment:R.enableComments&&N,enableLineCommentCount:R.enableComments,enableParagraphComment:R.enableComments&&N},q.wording={enable:R.enableWording,enableShowWordingComments:R.enableWording,enableCreateWording:R.enableWording&&N},q.board={boardWebProxyParams:{webProxy:g.a,userId:null==M?void 0:M.id,spm:x,appData:window.appData},onClickSaveMaterial:function(e){if(e){var t=e.id;x.click("b4693.c107443.d223056",{material_id:t})}}},q.disabledPlugins=[],R.autoMaximizeCard&&(q.disableToolbar=!0),R.viewerMode&&(q.viewerMode=R.viewerMode);var H={};H.optimizeGlobalViewerCopy=R.optimizeGlobalViewerCopy,R.enableExportParser&&(q.viewerMode="simple",q.disableToolbar=!0,H.isExport=this.props.enableExportParser,H.exportType=this.props.exportParserType,H.docMaxWidth=this.props.exportDocMaxWidth,"word"===R.exportParserType&&(q.textDiagram={convertSvgImage:!0}),q.image.ocr=!1,q.image.resizeThreshold=1073741824);var U,X,K=!1;"word"!==R.exportParserType&&I&&!0===I.disableDocumentCopy&&(K=!0,null!==(U=R.doc)&&void 0!==U&&null!==(X=U.abilities)&&void 0!==X&&X.update&&(K=!1),q.board.preventSaveMaterial=!0),K&&(H.preventCopy=!0,R.preventCopySelfContainer?H.preventCopyContainer=this.containerRef.current:H.preventCopyContainer=document.getElementById("content"),H.preventCopyMessage=function(){r.a.warn(__("管理员已开启禁止复制功能，如有疑问，请联系管理员"))}),q.clipboard=H,!1===R.genAnchor&&(q.heading={anchor:!1}),q.heading=Y(Y({},q.heading),{},{folding:!!R.headingFolding});var Z=function(){return!new URL(window.location.href).searchParams.get("translate")};return q.selection={selectionMapping:function(){return Z()}},q.clipboard.optimizeGlobalViewerCopy=function(){return Z()},q.clipboard.optimizeViewerCopy=function(){return Z()},R.simpleUI&&(q.uiSwitch={default:"simple"}),q.checkIn={user:{id:M.id,work_id:M.work_id,name:M.name,login:M.login,avatar_url:M.avatar_url,description:M.description},enable:!this.props.disableDynamicCardFunction,allowExport:N&&z},q.list={enableDynamic:N&&z&&R.enableDynamicTaskList,allFromStart:"present"===R.viewerMode},q.dynamicData={docId:T,docType:D,webProxy:{datasheetRecord:g.a.datasheetRecord}},R.scrollNode&&(q.scrollNode=R.scrollNode),null!==(S=window.appData)&&void 0!==S&&S.isYuqueMobileApp&&(q.envAdapter=new B,q.file||(q.file={}),q.file.downloadFileHandler=function(){var e=W(V().mark((function e(t,n){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.downloadFile({url:t,fileName:n});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q.file.previewFileHandler=function(e){var t,n,r=(null===(t=window.nebulaMobileApp)||void 0===t||null===(n=t.envInfo)||void 0===n?void 0:n.origin)||window.location.origin;m.a.pushWebWindow({url:"".concat(r).concat(e)})}),q.dataTable={webProxy:g.a,webSdk:b.a,doc:Y(Y({},L),{},{id:T,type:D}),editable:!window.appData.sharePage&&"doc"===R.scene&&z,abilities:null===(j=R.doc)||void 0===j?void 0:j.abilities,image:{uploadConfig:y.a.imageUploadUrl,accept:Object(w.getImageAccept)()},file:{uploadConfig:y.a.fileUploadUrl,accept:Object(w.getFileAccept)()},maxRecordCount:h.CARD_MAX_RECORD_COUNT},q.codeblock={docId:T},q}},{key:"render",value:function(){return a.a.createElement("div",{className:"yuque-doc-content","data-df":"lake",style:{position:"relative"}},a.a.createElement("div",{ref:this.containerRef}))}}],n&&X(t.prototype,n),o&&X(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.PureComponent);J.defaultProps={scene:"other",disableYuqueCardEmbedView:!1,customMaximizeRestore:null,autoMaximizeCard:null,tileRendering:!1,optimizeGlobalViewerCopy:!1,imageLazyLoad:!1,enableDynamicTaskList:!1,viewResizeObserver:!1,boundaryTopOffset:0,disableDynamicCardFunction:!1,enableWording:!1,enableComments:!1},J.propTypes={id:c.a.oneOfType([c.a.string,c.a.number]),preventCopySelfContainer:c.a.bool,content:c.a.string,docUrl:c.a.string,genAnchor:c.a.bool,genOutline:c.a.bool,onReady:c.a.func,onFirstRender:c.a.func,onLoaded:c.a.func,enableExportParser:c.a.bool,enableWording:c.a.bool,enableComments:c.a.bool,exportParserType:c.a.string,exportDocMaxWidth:c.a.number,disableYuqueCardEmbedView:c.a.bool,doc:c.a.object,docType:c.a.string,book:c.a.object,group:c.a.object,meta:c.a.object,theme:c.a.object,scene:c.a.oneOf(["doc","template","other"]),customMaximizeRestore:c.a.func,onCardMaximizeEnter:c.a.func,onCardMaximizeLeave:c.a.func,autoMaximizeCard:c.a.string,tileRendering:c.a.bool,optimizeGlobalViewerCopy:c.a.bool,viewerMode:c.a.string,simpleUI:c.a.bool,imageLazyLoad:c.a.bool,enableDynamicTaskList:c.a.bool,dynamicData:c.a.array,viewResizeObserver:c.a.bool,boundaryTopOffset:c.a.number,onViewportLayoutChange:c.a.func,disableDynamicCardFunction:c.a.bool,getTOCContainer:c.a.func,headingFolding:c.a.bool,onLogin:c.a.func.isRequired,forwardedRef:c.a.object,sidePanelManager:c.a.object};t.default=Object(l.d)()((function(e){var t=e.dispatch,n=z(e,F);return a.a.createElement(J,q({onLogin:function(){var e,n;null!==(e=window.appData)&&void 0!==e&&null!==(n=e.me)&&void 0!==n&&n.id||null==t||t({type:"error/toggleLoginModal",payload:{visible:!0}})}},n))}))},2866:function(e,t,n){"use strict";n.r(t),n.d(t,"Editor",(function(){return ce})),n.d(t,"Reader",(function(){return he}));var r=n(3693);n.d(t,"Biz",(function(){return r.d}));var o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(1),u=n.n(l),s=(n(84),n(45)),d=n(11),f=n.n(d),h=(n(55),n(22)),p=n(21),m=n.n(p),y=n(30),v=n(47),g=n.n(v),b=n(4),x=n.n(b),w=n(5),k=n.n(w),E=n(6),O=n.n(E),C=n(7),A=n.n(C),P=n(2),S=n.n(P),j=n(26),R=n.n(j);function _(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}_("/* stylelint-disable */\n");var M=r.i.Board;function L(e){var t=e.viewModel,n=t.diagram,r=t.onProperties,o=t.showProperties,i=t.onSave,c=t.engine,l=t.mini,u=t.readOnly,s=t.onMaximize,d=t.focusMode,f=t.setFocusMode,h=t.material,p=t.boardWebProxy;if(!n||!c)return a.a.createElement("div",{className:"lake-board-toolbar"});var m={diagram:n,mini:l,onSave:i,onProperties:r,readOnly:u,showProperties:o,onMaximize:s,focusMode:d,setFocusMode:f,boardWebProxy:p};return null!=h&&h.onUse&&(m.onMaterialUse=h.onUse),null!=h&&h.onMore&&(m.onMaterialMore=h.onMore),null!=h&&h.onMaximize&&(m.onMaterialMaximize=h.onMaximize),a.a.createElement("div",{className:"lake-board-toolbar"},a.a.createElement(M.Toolbar,m))}L.propTypes={viewModel:c.a.shape({diagram:c.a.object,onProperties:c.a.func,onImageInputChange:c.a.func,showProperties:c.a.bool,mini:c.a.bool,readOnly:c.a.bool,onSave:c.a.func,onMaximize:c.a.func,engine:c.a.object,focusMode:c.a.bool,setFocusMode:c.a.func,material:c.a.object,boardWebProxy:c.a.object})};var T=r.i.Board;function D(e){var t=e.viewModel,n=t.diagram,r=t.onProperties,o=t.showProperties,i=t.engine,c=t.mini,l=t.boardWebProxy;return n&&i&&!o?a.a.createElement("div",{className:"lake-board-contextual-menu-wrap"},a.a.createElement(T.ContextualMenu,{diagram:n,mini:c,onProperties:r,boardWebProxy:l})):a.a.createElement("div",{className:"lake-board-contextual-menu-wrap"})}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){var t=e.getBoundingClientRect(),n=t.height;return{width:t.width,height:n}}function I(e){var t=e.diagram,n=e.setDiagram,a=e.model,i=e.container,c=e.mini,l=e.boardWebProxy;Object(o.useEffect)((function(){if(!t){var e=new r.m(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({container:i.current,plugins:[r.u.Board],mode:a.get("mode"),paper:{size:"auto"}},B(i.current)));e.spm=null==l?void 0:l.spm,n(e)}return function(){return t&&t.destroy()}}),[t]),Object(o.useEffect)((function(){var e=i.current,n=new ResizeObserver((function(n){var r=n.find((function(t){return t.target===e})),o=null===e.offsetParent;if(t&&r&&r.contentRect&&!o){var a=B(i.current),l=a.width,u=a.height,s=c?18:0;t.changeSize(l+s,u+s)}}));return n.observe(e),function(){return n.unobserve(e)}}),[t,c])}function F(e){var t=Object(o.useRef)(),n=e.viewModel,r=n.diagram,i=n.setDiagram,c=n.model,l=n.engine,u=n.mini,s=n.focusMode,d=n.setFocusMode;return I({diagram:r,setDiagram:i,model:c,container:t,engine:l,mini:u,boardWebProxy:n.boardWebProxy}),a.a.createElement("div",{ref:t,className:"lake-board-canvas"},a.a.createElement(L,{viewModel:n,focusMode:s,setFocusMode:d}),a.a.createElement(D,{viewModel:n}))}D.propTypes={viewModel:c.a.shape({diagram:c.a.object,onProperties:c.a.func,showProperties:c.a.bool,mini:c.a.bool,engine:c.a.object,boardWebProxy:c.a.object})},_(".lake-board-editor .lake-board-content .lake-board-canvas {\n  width: 100%;\n  height: 100%;\n}\n"),F.defaultProps={viewModel:{}},F.propTypes={viewModel:c.a.shape({model:c.a.object,engine:c.a.object,diagram:c.a.object,setDiagram:c.a.func,mini:c.a.bool,focusMode:c.a.bool,setFocusMode:c.a.func})};var q=r.i.Board;function z(e){var t=e.viewModel,n=t.diagram,r=t.propertiesWidth,o=t.onProperties,i=t.onViewportOptionChange,c=t.viewportOption;return a.a.createElement("div",{className:"lake-board-properties",style:{width:"".concat(r,"px"),flex:"none"}},n&&a.a.createElement(q.Properties,{diagram:n,viewportOptionProps:{onChange:function(e){i(e)},viewportOption:c},onClose:function(){o()}}))}z.defaultProps={viewModel:{}},z.propTypes={viewModel:c.a.shape({diagram:c.a.object,propertiesWidth:c.a.number,viewportOption:c.a.string,onProperties:c.a.func,onViewportOptionChange:c.a.func})},_("/* stylelint-disable */\n.lake-board-material-lib-maxi-modal-container {\n  text-align: center;\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-content {\n  box-shadow: none;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-close {\n  display: none;\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-footer {\n  display: none;\n}\n");var G=r.i.Board;function Y(e){var t=e.viewModel,n=t.diagram,r=t.material,o=t.boardWebProxy,i=t.showMaterialModal,c=t.materialScrollToName,l={diagram:n,boardWebProxy:o};return null!=r&&r.onUse&&(l.onUse=r.onUse),null!=r&&r.onClose&&(l.onClose=r.onClose),c&&(l.scrollToName=c),a.a.createElement(s.a,{className:"lake-board-material-lib-maxi-modal-container",visible:i,width:"auto",zIndex:1031,centered:!0},a.a.createElement(G.MaterialLibMaxi,l))}Y.defaultProps={viewModel:{}},Y.propTypes={viewModel:c.a.shape({diagram:c.a.object,material:c.a.object,boardWebProxy:c.a.object,showMaterialModal:c.a.bool,materialScrollToName:c.a.oneOfType([c.a.string,c.a.number])})};var H=r.i.Board;function V(e){var t=e.viewModel,n=t.diagram,r=t.material,o={diagram:n,boardWebProxy:t.boardWebProxy};return null!=r&&r.onAdd&&(o.onAddMaterial=r.onAdd),a.a.createElement(H.ContextMenu,o)}V.defaultProps={viewModel:{}},V.propTypes={viewModel:c.a.shape({diagram:c.a.object,material:c.a.object,boardWebProxy:c.a.object})},_("/* stylelint-disable */\n.lake-board-editor {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-editor .lake-board-content {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-editor .lake-board-content .lake-board-canvas-wrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n}\n.lake-board-editor .lake-board-content .lake-board-canvas-wrapper.lake-board-has-properties {\n  width: calc(100% - 284px);\n  margin-right: 284px;\n}\n.lake-board-editor .lake-board-content .lake-board-properties-wrapper {\n  width: 284px;\n  height: 100%;\n  position: absolute;\n  right: 0;\n}\n.lake-board-editor .lake-board-content .lake-board-properties-wrapper .lake-board-properties {\n  height: 100%;\n}\n");var U=r.i.LinkEditor,W=r.i.Note,X=r.i.IconChange,K=r.i.DslEditor;function Z(e){var t=e.viewModel,n=t.showProperties,r=t.diagram,o=t.focusMode,i=t.setFocusMode,c=t.showMaterialModal;return a.a.createElement("div",{className:"lake-board-editor"},a.a.createElement("div",{className:"lake-board-content"},a.a.createElement("div",{className:f()("lake-board-canvas-wrapper",{"lake-board-has-properties":n})},a.a.createElement(F,{viewModel:t,focusMode:o,setFocusMode:i}),r&&a.a.createElement(V,{viewModel:t})),r&&n&&a.a.createElement("div",{className:"lake-board-properties-wrapper"},a.a.createElement(z,{viewModel:t}))),r&&a.a.createElement(U,{diagram:r}),r&&a.a.createElement(W.Editor,{diagram:r}),r&&a.a.createElement(X,{diagram:r}),r&&a.a.createElement(K,{diagram:r}),r&&c&&a.a.createElement(Y,{viewModel:t}))}Z.defaultProps={viewModel:{}},Z.propTypes={viewModel:c.a.shape({diagramData:c.a.object,engine:c.a.object,diagram:c.a.object,showProperties:c.a.bool,focusMode:c.a.bool,setFocusMode:c.a.func,showMaterialModal:c.a.bool})};var Q=r.d.exportData,$=r.d.importData,J=r.d.onBeforeSave,ee=function(e){O()(n,R.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var o=S()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return A()(this,n)}}(n);function n(e){var o,a=e.diagram,i=e.model,c=e.uploader;x()(this,n),o=t.call(this);var l=new r.p.Event;return o.model=i,o.diagram=a,o.uploader=c,o.eventHelper=l,l.bind(a,"aftercommandexecute",(function(e){var t=e.isModelChange,n=e.commandName,r=e.useTime;t&&o.emit("change"),o.emit("commandEnd",n,r)})),o}return k()(n,[{key:"save",value:function(){this.emit("save")}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.diagram,n=this.model,r=this.uploader,o=e.diagramData,a=e.viewportOption,i=e.viewportSetting;o&&(n.set("diagramData",o),t.clear(),$({data:o,diagram:t,uploader:r})),a&&n.set("viewportOption",a),i&&"object"===g()(i)&&(n.set("viewportSetting",i),t.viewport.set(i))}},{key:"getValue",value:function(){var e=this.model;return e.set("diagramData",this.getDiagramData()),e.set("viewportSetting",this.getViewportSetting()),e.set("text",this.getText()),e.set("graphicsBBox",this.getGraphicsBBox()),e.export()}},{key:"getGraphicsBBox",value:function(){return this.diagram.rootGroup.getBBox()}},{key:"getViewportSetting",value:function(){return this.diagram.viewport.toObject()}},{key:"getDiagramData",value:function(){var e=this.diagram;return Q(e)}},{key:"getMeta",value:function(){return{cellCount:this.diagram.getCells().length}}},{key:"getHtml",value:function(){return this.diagram?this.diagram.exporter.html():"<div>LakeBoard</div>"}},{key:"getText",value:function(){return this.diagram?this.diagram.exporter.getText():"LakeBoard"}},{key:"download",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpeg",t=arguments.length>1?arguments[1]:void 0;return this.diagram.exporter.download(e,t)}},{key:"canvas",value:function(){var e;return(e=this.diagram.exporter).canvas.apply(e,arguments)}},{key:"onBeforeSave",value:function(){return J(this,this.uploader)}},{key:"destroy",value:function(){this.diagram=void 0,this.uploader=void 0,this.eventHelper.destroy(),this.destroyed=!0}}]),n}();function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=r.d.uploadImage,oe=r.d.generateBoardWebProxy;function ae(e){var t=e.file,n=e.uploader,r=e.diagram,o=e.from,a=e.x,i=e.y,c=e.width,l=e.height;return new Promise((function(e){re({file:t,uploader:n,enable:function(){return r.command.enable("MindmapAttachImage")||r.command.enable("InsertImage")},onTemporaryOnLoad:function(t){var n=r.selector.selections;"clipboard"===o&&(t.firstInsertRatio=1/window.devicePixelRatio),1===n.length&&n[0].isMindmap?r.command.execute("MindmapAttachImage",{image:t}):r.command.execute("InsertImage",{image:t,x:a,y:i,width:c,height:l}),e(t)},onCompleted:function(e){var t=e.hash,n=e.cdn;r.getCells().filter((function(e){var n,r,o,a=null===(n=e.model)||void 0===n||null===(r=n.image)||void 0===r||null===(o=r.uploadInfo)||void 0===o?void 0:o.hash;return a&&a===t})).forEach((function(e){e.updateModel({image:{src:n}})}))}})}))}var ie=r.d.Model;function ce(e){var t=function(e,t){var n,r=e.onLoad,i=e.uploader,c=e.mini,l=void 0!==c&&c,u=e.onMaximize,s=e.boardWebProxyParams,d=void 0===s?{}:s,f=Object(o.useState)(null),p=m()(f,2),v=p[0],g=p[1],b=Object(o.useState)(!1),x=m()(b,2),w=x[0],k=x[1],E=Object(o.useState)(null),O=m()(E,2),C=O[0],A=O[1],P=Object(o.useState)(!1),S=m()(P,2),j=S[0],R=S[1],_=Object(o.useState)(!1),M=m()(_,2),L=M[0],T=M[1],D=Object(o.useState)(null),N=m()(D,2),B=N[0],I=N[1],F=Object(o.useState)(t.get("viewportOption")),q=m()(F,2),z=q[0],G=q[1],Y=d.webProxy,H=d.userId,V=d.spm,U=d.appData,W=e.boardWebProxy||oe(Y,H,V,U);function X(){k(!w),setTimeout((function(){window.dispatchEvent(new Event("resize"))}))}return null!=W&&W.material&&(n={onAdd:function(e){h.a.success(a.a.createElement("span",null,a.a.createElement("span",null,"素材添加成功！"),a.a.createElement("a",{onClick:function(){e&&(I("personal"),T(!0))}},"查看"))),T(!1)},onUse:function(){T(!1)},onMore:function(e){I(e),T(!0)},onClose:function(){T(!1)},onMaximize:function(){I(null),T(!0)}}),t.set("mode","edit"),Object(o.useEffect)((function(){if(v){var e=new ee({diagram:v,model:t,uploader:i});return A(e),r(e),function(){return e.destroy()}}}),[v]),Object(o.useEffect)((function(){function e(e){ae(ne(ne({},e),{},{file:e.files[0],uploader:i,diagram:v}))}if(v)return v.on("importimage",e),function(){return v.off("importimage",e)}}),[v]),Object(o.useEffect)((function(){function e(e){(function(e){return y.ua.macos?e.metaKey:e.ctrlKey})(e)&&("s"===e.key?(e.preventDefault(),C.save()):"."===e.key&&(e.preventDefault(),R((function(e){return!e}))))}return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[C,X]),Object(o.useEffect)((function(){function e(e){if(!i.isCompleted())return e.preventDefault(),e.returnValue="仍有图片正在上传中，是否确认关闭？",""}return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}}),[C]),{model:t,engine:C,uploader:i,boardWebProxy:W,material:n,onImageInputChange:function(e){ae({file:e.nativeEvent.target.files[0],uploader:i,diagram:v}),e.nativeEvent.target.value=null},onMaximize:u,onSave:function(){C.save()},onProperties:X,onViewportOptionChange:function(e){t&&t.set("viewportOption",e),C&&C.emit("change"),G(e)},viewportOption:z,setViewportOption:G,materialScrollToName:B,setMaterialScrollToName:I,diagram:v,setDiagram:g,showMaterialModal:L,setShowMaterialModal:T,showProperties:!l&&w,setShowProperties:k,focusMode:j,setFocusMode:R,mini:l}}(e,Object(o.useMemo)((function(){return new ie}),[]));return a.a.createElement(Z,{viewModel:t})}function le(e){var t=e.viewModel,n=Object(o.useRef)();return I({diagram:t.diagram,setDiagram:t.setDiagram,model:t.model,container:n,engine:t.engine,mini:t.mini}),a.a.createElement("div",{ref:n,className:"lake-board-canvas"},a.a.createElement(L,{viewModel:t}))}ce.defaultProps={data:{},onLoad:function(){},boardWebProxy:null},ce.propTypes={data:c.a.shape({diagramData:c.a.object}),onLoad:c.a.func,uploader:c.a.object.isRequired,boardWebProxy:c.a.object},_(".lake-board-reader .lake-board-content .lake-board-canvas {\n  width: 100%;\n  height: 100%;\n  user-select: none;\n}\n"),le.defaultProps={viewModel:{},contentContainer:{}},le.propTypes={viewModel:c.a.shape({diagram:c.a.object,setDiagram:c.a.func,model:c.a.object,engine:c.a.object,mini:c.a.bool}),contentContainer:c.a.object.isRequired},_("/* stylelint-disable */\n.lake-board-reader {\n  width: 100%;\n  height: 100%;\n}\n.lake-board-reader .lake-board-content {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-reader .lake-board-content .lake-board-canvas-wrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n}\n");var ue=r.i.Note,se=r.i.Board;function de(e){var t=e.viewModel,n=t.diagram;return a.a.createElement("div",{className:"lake-board-reader"},a.a.createElement("div",{className:"lake-board-content"},a.a.createElement("div",{className:"lake-board-canvas-wrapper"},a.a.createElement(le,{viewModel:t}),n&&a.a.createElement(se.ContextMenu,{diagram:n}))),n&&a.a.createElement(ue.Reader,{diagram:n}))}de.defaultProps={viewModel:{}},de.propTypes={viewModel:c.a.shape({diagramData:c.a.object,diagram:c.a.object})};var fe=r.d.Model;function he(e){var t,n,r,i,c,l,u,s,d,f,h,p,y,v=(n=(t=e).onLoad,r=t.mini,i=t.onMaximize,c=Object(o.useMemo)((function(){return new fe})),l=Object(o.useState)(null),u=m()(l,2),s=u[0],d=u[1],f=Object(o.useState)(null),p=(h=m()(f,2))[0],y=h[1],c.set("mode","read"),Object(o.useEffect)((function(){if(s){var e=new ee({diagram:s,model:c});return y(e),n(e),function(){return e.destroy()}}}),[s]),{model:c,onMaximize:i,mini:r,engine:p,setEngine:y,diagram:s,setDiagram:d,readOnly:!0});return a.a.createElement(de,{viewModel:v})}he.defaultProps={data:{},onLoad:function(){}},he.propTypes={data:c.a.shape({diagramData:c.a.object}),onLoad:c.a.func}},2868:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(841),l=Object(c.a)({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(7),n.e(16),n.e(60)]).then(n.bind(null,3246)).then((function(e){return e.Reader}))}});function u(e){var t=e.content,n=e.width,a=e.height,i=e.print,c=Object(r.useMemo)((function(){return function(e){try{return JSON.parse(e)}catch(e){return{}}}(t)}),[t]),u=Object(r.useRef)();Object(r.useEffect)((function(){function e(e){e.origin===window.location.origin&&"show:play"===e.data&&u.current.execCommand("toggleMode")}return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]);var s={};return a&&(s.height=a),n&&(s.width=n),o.a.createElement("div",{className:e.className,style:s,"data-testid":"lake-show-viewer"},o.a.createElement(l,{data:c,ref:u,print:i}))}u.defaultProps={className:""},u.propTypes={className:i.a.string,content:i.a.string,print:i.a.string,height:i.a.oneOfType([i.a.string,i.a.number]),width:i.a.oneOfType([i.a.string,i.a.number])},t.default=u},3122:function(e,t,n){"use strict";n.r(t);n(537);var r=n(265),o=(n(145),n(42)),a=(n(61),n(23)),i=n(0),c=n.n(i),l=n(8),u=n.n(l),s=n(11),d=n.n(s),f=n(3163),h=n(31),p=n(41),m=n(27),y="index-module_belongs_A3uam",v="index-module_meta_Jn6WP",g="index-module_truncation_g-6vp";function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===b(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E={};E.Login=function(e){var t=e.goto,n=e.registerWithScene,r=t?"/login?goto=".concat(encodeURIComponent(t)):"/login",o=p.a.genCreateFromKey(m.CREATE_FROM.official_website_top_button);return n&&(r="/"===window.location.pathname||"/about"===window.location.pathname?"/login?register_with_scene=true&defaultType=org&register_from=".concat(o):"/login?register_with_scene=true&register_from=".concat(o)),Object(i.useEffect)((function(){Object(f.b)()}),[]),c.a.createElement(a.a,{href:r,size:e.size,type:"primary","data-aspm-click":"d65962"},__("登录 / 注册"))},E.Login.propTypes={size:u.a.oneOf(["small","large"]),goto:u.a.string},E.Job=function(e){var t=e.user,n=e.truncation;if(t)return c.a.createElement("span",{className:d()(v,k({},g,n))},c.a.createElement(h.b,{name:"user-job",width:16,height:16}),c.a.createElement("span",null,t.job_title||__("未填写")))},E.Job.propTypes={user:u.a.object.isRequired,truncation:u.a.bool},E.Location=function(e){var t=e.user,n=e.truncation,r=e.size,o=void 0===r?16:r;return t=t||{},c.a.createElement("span",{className:d()(v,k({},g,n))},c.a.createElement(h.b,{name:"user-location",width:o,height:o}),c.a.createElement("span",null,t.location||__("未填写")))},E.Location.propTypes={size:u.a.object.number,user:u.a.object.isRequired,truncation:u.a.bool},E.Department=function(e){var t,n=e.user,r=e.truncation;if(n)return c.a.createElement("div",null,null!==(t=n.departments)&&void 0!==t&&t.length?n.departments.map((function(e){return c.a.createElement("span",{className:d()(v,k({},g,r))},c.a.createElement(h.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,e))})):c.a.createElement("span",{className:d()(v,k({},g,r))},c.a.createElement(h.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,n.department||__("未填写"))))},E.Department.propTypes={user:u.a.object.isRequired,truncation:u.a.bool},E.Link=function(e){var t=e.user,n=e.className;return c.a.createElement("a",{href:"/".concat(t.login),title:t.name,className:n},t.name)},E.Link.propTypes={user:u.a.object.isRequired,className:u.a.string},E.Name=function(e){var t=e.user,n=e.className;return c.a.createElement("span",{title:t.name,className:n},t.name)},E.Name.propTypes={user:u.a.object.isRequired,className:u.a.string};var O=function(e){var t=e.belongs,n=e.onChange,a=x(Object(i.useState)(__("管理员")),2),l=a[0],u=a[1];return c.a.createElement(r.a,{trigger:["click"],overlay:c.a.createElement(o.a,{className:"dashboard-dropdown-menu",selectedKeys:[]},t.map((function(e,t){return c.a.createElement(o.a.Item,{key:e.type},c.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),function(e){n(e.type),u(e.text)}(e)}},e.text))})))},c.a.createElement("span",null,l,c.a.createElement("span",{className:d()("larkicon","larkicon-arrow-down",y)})))};O.propTypes={belongs:u.a.array.isRequired,onChange:u.a.func.isRequired},E.BelongMenu=O;t.default=E},3163:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(139),o="new_session",a="register",i="register/source";function c(){var e=new URLSearchParams(window.location.search).get("source");if(e)return e;var t=r.a.get(i);if(t)return t;var n,o=(window.Tracert||{})._refSpm,a=(n=o)&&n.split(".")[1];return a||null}function l(){var e=(window.Tracert||{}).spmBPos;e&&e!==o&&e!==a&&r.a.set(i,e)}function u(){"complete"===document.readyState?setTimeout(l,2e3):window.addEventListener("load",(function(){setTimeout(l,2e3)}))}},3170:function(e,t,n){var r=n(290),o=n(710),a=n(3239),i=n(279),c=n(237),l=n(3241),u=n(711),s=n(509),d=u((function(e,t){var n={};if(null==e)return n;var u=!1;t=r(t,(function(t){return t=i(t,e),u||(u=t.length>1),t})),c(e,s(e),n),u&&(n=o(n,7,l));for(var d=t.length;d--;)a(n,t[d]);return n}));e.exports=d},3174:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(185),o={doc:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_DOC_CREATION,board:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_BOARD_CREATION,table:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_TABLE_CREATION,sheet:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_SHEET_CREATION,repoHomePage:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_REPO_HOME_PAGE,teamHomePage:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_TEAM_HOME_PAGE,personalHomePage:r.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_PERSONAL_HOME_PAGE}},3190:function(e,t,n){"use strict";var r=n(13),o=n(0),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"},i=n(40),c=function(e,t){return o.createElement(i.a,Object(r.a)(Object(r.a)({},e),{},{ref:t,icon:a}))};c.displayName="UpOutlined";t.a=o.forwardRef(c)},3239:function(e,t,n){var r=n(279),o=n(1600),a=n(3240),i=n(261);e.exports=function(e,t){return t=r(t,e),null==(e=a(e,t))||delete e[i(o(t))]}},3240:function(e,t,n){var r=n(314),o=n(600);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},3241:function(e,t,n){var r=n(599);e.exports=function(e){return r(e)?void 0:e}},3554:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(90),i=n.n(a),c=n(232),l=n.n(c),u=n(101),s=n.n(u),d=n(839),f=n.n(d),h=n(1515),p=n(208),m=n(1413),y=n(75),v=n(1512),g=n.n(v),b=n(1513),x=n.n(b),w=n(642),k=n.n(w),E=n(1514),O=n(508),C=n(132),A=n(139),P=n(35);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===S(a)?a:String(a)),r)}var o,a}var R,_=i()("editor:cache"),M=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t}var t,n,r;return t=e,(n=[{key:"retrieve",value:function(){var e={format:null,value:null};_("[retrieve]key: ",this.key);var t=A.a.get(this.key);if(!t)return null;_("[retrieve]find text: ",t);var n=f.a.guessFormat(t);return e.format=n,e.value=t,_("[retrieve]doc: ",e),e}},{key:"put",value:function(e,t){_("[put]content cached: ","".concat(this.key," -> ").concat(e)),A.a.set(this.key,e)}},{key:"clear",value:function(){A.a.remove(this.key)}}])&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function T(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(){N=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==L(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function B(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){B(a,r,o,i,c,"next",e)}function c(e){B(a,r,o,i,c,"throw",e)}i(void 0)}))}}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function q(e,t,n){return(t=z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){var t=function(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===L(t)?t:String(t)}var G=i()("biz:lakex_mini_editor_base"),Y=(null===(R=window.appData)||void 0===R?void 0:R.me)||{},H=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),q(this,"getDefaultSuggestions",(function(){return t.options.getDefaultSuggestions?t.options.getDefaultSuggestions():[]})),q(this,"setEngine",(function(e){t._engine=e,m.a.onEditorEngineLoaded(e,t.getType())})),q(this,"getEngine",(function(){return t._engine})),q(this,"setValue",(function(e){var n=e;e?e.startsWith("<")?(n={type:"lake",value:e},t._engine.setDocument(n)):"string"==typeof e&&(n={type:"json",value:JSON.parse(e)},t._engine.setDocument(n)):t._engine.setDocument()})),q(this,"getValue",(function(){return t._engine?t._engine.getPureContent():t.getDefaultValue()})),q(this,"isEmpty",(function(){return!t._engine||t._engine.isEmpty()})),q(this,"getSafetyValue",I(N().mark((function e(){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.contentReady();case 2:return e.abrupt("return",t.getValue());case 3:case"end":return e.stop()}}),e)})))),q(this,"getHtml",(function(){return t._engine?t._engine.getPureHtml():null})),q(this,"focus",(function(e){if(!t._engine)return null;t._engine.focus(e)})),q(this,"contentReady",I(N().mark((function e(){var n,r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._engine){e.next=2;break}return e.abrupt("return",null);case 2:return n=0,r=function e(r,o){t._engine.canGetDocument()?r():n>10?o():(n++,setTimeout((function(){e(r,o)}),1e3))},e.abrupt("return",new Promise(r));case 5:case"end":return e.stop()}}),e)})))),q(this,"saveAll",(function(){if(!t.options.disableCache){var e={format:s.a.FORMAT.LAKE,value:t.getValue(),html:t.getHtml()};t.saveToCache(e)}})),this.options=n,this.from=n.from||"reply",this.targetType=n.targetType,this.belong=n.belong,this.belongType=n.belongType,this.group=n.group,this.target=n.target,this.attachType=n.attachType,this.isEditMode=!!n.target,this.type=this.getType(),this.ctoken=Object(O.a)(window);var r=this.getCacheKey();this.cacheKeys={title:"".concat(r,"/title"),content:"".concat(r,"/content")},this.editorCache=new M(this.cacheKeys.content),this.uuid=this.getUuid(),this._engine=null,this.initialDocument=null,this.init()}var t,n,r;return t=e,n=[{key:"init",value:function(){this.initialDocument=this.getInitialDocument(),G("init use: ",this.initialDocument)}},{key:"buildOptions",value:function(e){var t=this,n={translate:{supportTranslate:x()()},hideVipIcon:Object(E.a)(),board:{boardWebProxyParams:{webProxy:P.a,userId:null==Y?void 0:Y.id,spm:y,appData:window.appData}},image:{supportImgOCR:k()(),uploadFileURL:function(){return m.a.adaptOcrImageUploadUrl(t.getImageUploadUrl())},accept:Object(p.getImageAcceptArr)()},file:{hideEmbedButton:g()(),uploadFileURL:this.getFileUploadUrl(),accept:Object(p.getFileAcceptArr)(),localdocAccept:Object(p.getLocalDocAcceptArr)(),embedButtonStatus:Object(p.getIsDiabledPreviewAndEmbed)()},transfer:{transferFilesURL:this.getTransferUrl()},localdoc:{uploadFileURL:this.getFileUploadUrl(),accept:Object(p.getLocalDocAcceptArr)()},mention:{mentionURL:C.a.patchGroupIdToUrl(this.getMentionActionUrl()),defaultList:this.getDefaultSuggestions()},lockedtext:{action:this.getCryptoUrl()},placeholder:(null==e?void 0:e.placeholder)||this.getPlaceholder(),link:{autoCompleteLink:null==e?void 0:e.autoCompleteLink},video:{uploadAction:this.getMediaUploadUrl("video"),queryAction:"/api/video",accept:Object(p.getVideoAcceptArr)()},audio:{uploadFileURL:this.getMediaUploadUrl("audio"),queryURL:"/api/video",accept:Object(p.getAudioAcceptArr)()},vote:{allowVote:!0,queryDetailUrl:"api/votes",queryCheckUrl:"api/votes/mine",voteUrl:"api/votes"},yuque:{disableEmbedView:this.getDisableYuqueCardEmbedView()},materialLibrary:{component:o.a.createElement(h.a,{storage:A.a,webProxy:P.a})},fullscreen:{enable:this.getEnableFullEditor()}},r=[],a=this.getBlockedCards();return a&&a.length>1&&(r=Array.from(new Set([].concat(T(r),T(a))))),n.disabledPlugins=r,n}},{key:"getProps",value:function(){return{format:this.getFormat(),defaultValue:this.getDefaultValue(),autoFocus:this.getAutoFocus(),isMiniSize:this.isMiniSize()}}},{key:"getType",value:function(){return this.options.type||"unknown"}},{key:"getAutoFocus",value:function(){var e=this.options.autoFocus;return null!=e?e:!!this.options.useMiniGuide}},{key:"isMiniSize",value:function(){return!1}},{key:"getEnableFullEditor",value:function(){return!0}},{key:"getBlockedCards",value:function(){return["video","checkIn","vote","audio"]}},{key:"getUuid",value:function(){var e=this.cacheKeys.uuid,t=A.a.get(e);return t||(t=l()(32)+l()(32),A.a.set(e,t)),t}},{key:"getDefaultFormat",value:function(){return s.a.FORMAT.LAKE}},{key:"getFormat",value:function(){var e=this.options.format;return e||this.initialDocument.format}},{key:"getPlaceholder",value:function(){return this.options.placeholder}},{key:"getInitialDocument",value:function(){if(this.initialDocument)return this.initialDocument;var e=this.loadFromCache();if(G("cached document:",e),this.isEditMode){var t=this.getContentObject();return G("adapted content: ",t),e&&(G("merge with cached content",e),t.format=e.format||t.format,t.title=e.title||t.title,t.value=e.value||t.value),t}if(e)return e.format=e.format||this.getDefaultFormat(),e;var n=this.loadFromUrl();return n||{format:this.getDefaultFormat(),title:null,value:null}}},{key:"getContentObject",value:function(e){return{format:(e=e||this.target||{}).format||this.getDefaultFormat(),title:e.title||e.name||"",value:e.value||e.body_asl||e.content}}},{key:"getDefaultValue",value:function(){var e=this.options.defaultValue;return e||this.initialDocument.value}},{key:"getFullUrl",value:function(e){return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}},{key:"getTransferUrl",value:function(){return this.getFullUrl("/api/upload/copy?type=attachment")}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.getFullUrl(e)}},{key:"getMediaUploadUrl",value:function(e){var t="/api/video?ctoken=".concat(this.ctoken,"&format=").concat(e);return this.getFullUrl(t)}},{key:"getImageUploadUrl",value:function(){var e=this.getFileUploadUrl();return e?e.replace("&type=attachment","&type=image"):null}},{key:"getMentionActionUrl",value:function(){var e="";return this.isEditMode&&!this.options.useBelongAttach?e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.target.id):this.belong&&(e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.belong.id)),e}},{key:"getCryptoUrl",value:function(){return"/api/services/crypto"}},{key:"getDisableYuqueCardEmbedView",value:function(){return this.options.disableYuqueCardEmbedView}},{key:"saveToCache",value:function(e){G("save to cache:",e),e.format&&(e.title&&A.a.set(this.cacheKeys.title,e.title),this.needCacheContent(e)?this.editorCache.put(e.value,e.format):G("value is empty or the same as origin, ignore cache"))}},{key:"needCacheContent",value:function(e){if(!e.value)return!1;if(f.a.isBlank(e))return this.editorCache.clear(),!1;if(!this.target)return!0;var t=this.getContentObject();return!f.a.isContentSame(e.format,t.value,e.value)}},{key:"reset",value:function(){G("reset editor"),this.clearCache(),this._engine&&this._engine.setDocument()}},{key:"isContentChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e){var t=this.loadFromCache();t&&(e=t.value)}if(!this.target)return!0;var n="<cursor />";return this.target.body_asl.trim().replace(n,"")!==e.trim().replace(n,"")}},{key:"clearCache",value:function(){var e=this;G("clear cache"),Object.keys(this.cacheKeys).forEach((function(t){A.a.remove(e.cacheKeys[t])}))}},{key:"getCacheKey",value:function(){return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/new"):"autosave/".concat(this.type)}},{key:"loadFromUrl",value:function(){}},{key:"loadFromCache",value:function(){var e=!1,t={format:null,title:null,value:null},n=this.editorCache.retrieve();if(n&&(e=!0,t.format=n.format,t.value=n.value),this.cacheKeys.title){var r=A.a.get(this.cacheKeys.title);r&&(e=!0,t.title=r)}return e?t:null}}],r=[{key:"getEmptyDocument",value:function(){return{format:s.a.FORMAT.LAKE,value:null}}}],n&&F(t.prototype,n),r&&F(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=H},3560:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(429),i=n(8),c=n.n(i),l=n(3122),u=n(3552);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===s(a)?a:String(a)),r)}var o,a}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(i,e);var t,n,r,a=h(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a.apply(this,arguments)}return t=i,(n=[{key:"render",value:function(){var e=this.props,t=e.me,n=e.children,r=e.place,a=e.registerWithScene;return!window.appData.isYuque||t&&t.id?n:"comment"===r?o.a.createElement("div",{className:"comment-action"},__("{registerLogin} 语雀进行评论",{registerLogin:o.a.createElement("a",{onClick:function(){u.a.login()},"data-aspm-click":"d65962"},__("注册 / 登录"))})):o.a.createElement("div",{className:"login-action"},o.a.createElement(l.default.Login,{registerWithScene:a}))}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.Component);m.propTypes={me:c.a.object,place:c.a.string,children:c.a.node,registerWithScene:c.a.bool};t.a=Object(a.d)((function(e){return{me:e.me}}))(m)},3581:function(e,t,n){"use strict";var r=n(178),o=n.n(r),a=n(71);function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={adaptAbilities:function(e){var t=e.me,n=e.comment,r=e.target_type,o=e.target,a={edit:!1,delete:!1};return t&&t.id===n.user_id?(a.edit=!0,a.delete=!0):"Doc"===r&&(a.delete=o.abilities&&o.abilities.destroy_comment),a},getPostActions:function(e,t){var n=[];return n.push({cmd:"copy_link",title:__("复制链接")}),n.push({cmd:"reply",title:__("评论")}),e.edit&&n.push({cmd:"edit",title:__("编辑")}),e.delete&&n.push({cmd:"delete",title:__("删除"),confirm:!0}),t&&n.push({cmd:"content_report",title:__("举报")}),n},includesHashAnchoredComment:function(e,t){if(!t||!t.startsWith("#comment-"))return!1;var n=parseInt(t.substring(9),10);return!!e.find((function(e){return e.id===n}))},getParticipants:function(e,t,n){var r=n.groupMembers,c=n.targetType,l=[];return"Doc"!==c&&"Resource"!==c||(e.contributors=e.contributors||[],l=i(e.contributors)),t&&t.length>0&&t.forEach((function(e){var t=l.find((function(t){return t&&e.user&&t.id===e.user.id}));e.user&&!t&&l.push(e.user)})),r&&r.length>0&&r.forEach((function(e){l.push(e.user)})),l=o()(l,"login"),window.appData.isYuque&&(l=l&&l.filter((function(e){return e.status!==a.STATUS.terminated}))),l},getAnchorId:function(e,t){return"comment-".concat(e)},TARGET_TYPES:["Doc","DocVersion","Resource","Artboard","Note"]};t.a=l},3582:function(e,t,n){"use strict";var r=n(30);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,i=void 0,i=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===o(i)?i:String(i)),r)}var a,i}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},i.apply(this,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var a=u(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,o,s=l(d);function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),s.apply(this,arguments)}return t=d,(n=[{key:"buildOptions",value:function(e){var t=i(u(d.prototype),"buildOptions",this).call(this,e);return t.disabledPlugins.push("mobile"),r.ua.mobile&&t.disabledPlugins.push("placeholder","slash"),t}},{key:"getBlockedCards",value:function(){return["video","audio","checkIn"]}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(n(3554).a);t.a=s},3600:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return x})),n.d(t,"l",(function(){return S})),n.d(t,"j",(function(){return G})),n.d(t,"h",(function(){return K})),n.d(t,"i",(function(){return ne})),n.d(t,"k",(function(){return ue})),n.d(t,"f",(function(){return me})),n.d(t,"d",(function(){return we})),n.d(t,"e",(function(){return Pe})),n.d(t,"g",(function(){return Te})),n.d(t,"b",(function(){return ze}));var r=n(101),o=n.n(r),a=n(1510),i=n(3554);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===c(a)?a:String(a)),r)}var o,a}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(c,e);var t,n,r,i=s(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i.apply(this,arguments)}return t=c,r=[{key:"getEmptyDocument",value:function(){return{format:o.a.FORMAT.LAKE,value:null}}}],(n=[{key:"getType",value:function(){var e=this.options.targetType;return e?"".concat(e,"_comment").toLowerCase():"comment"}},{key:"getCacheKey",value:function(){var e=this.options.replyId;return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(e,"/new"):"autosave/".concat(this.type)}},{key:"isMiniSize",value:function(){return this.options.useMiniGuide||this.options.isMiniSize||window.h5}},{key:"getDefaultFormat",value:function(){return a.a.getDefaultDocumentFormat()}},{key:"getEnableFullEditor",value:function(){return"Artboard"!==this.targetType}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(i.a),h=f;function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===p(a)?a:String(a)),r)}var o,a}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var o=g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,e);var t,n,r,o=v(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.attachType="Resource",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=a,(n=[{key:"getType",value:function(){return"area_comment"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&m(t.prototype,n),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(h),x=b;function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===w(a)?a:String(a)),r)}var o,a}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(a,e);var t,n,r,o=C(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.attachType="Doc",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=a,(n=[{key:"buildOptions",value:function(e){var t,n=E(A(a.prototype),"buildOptions",this).call(this,e);return n.image.showMiniToolbarWhen="never",null===(t=n.disabledPlugins)||void 0===t||t.push("slash"),n}},{key:"getType",value:function(){return"word_comment"}},{key:"getAutoFocus",value:function(){return!1}},{key:"isMiniSize",value:function(){return!0}},{key:"getEnableFullEditor",value:function(){return!1}}])&&k(t.prototype,n),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(h),S=P,j=n(29),R=n.n(j),_=n(3582);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function N(e){var t=function(e,t){if("object"!==M(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===M(t)?t:String(t)}function B(e,t){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},B(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=F(e);if(t){var o=F(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var q={daily:{title:"#prefix# #day# 日报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>建议 TL 每天组织日会，将一天的重点事项安排于此</p><p>每位同学下班前，在此提交日报</p><p><br /></p><p>日报不要记流水账，尽量在 200 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的日报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},weekly:{title:"#prefix# #day# 周报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>将一周的工作总结回复于此</p><p><br /></p><p>不要记流水账，尽量在 800 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的周报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},vote:{title:"一起来投票吧",content:'<!doctype lake><meta name="doc-version" content="1" /><card type="block" name="vote" value="data:%7B%22margin%22%3Atrue%2C%22id%22%3A%22jTHWG%22%2C%22type%22%3A%22single%22%7D"></card><p><br /><cursor /></p>'},default:{title:"",content:"<!doctype lake><p></p>"}},z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(a,e);var t,n,r,o=I(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return t=a,r=[{key:"getTemplate",value:function(e,t){var n=q[e];if(!n)return{title:null,content:null};var r=R()(new Date).format("YYYY-MM-DD"),o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);return o.title=o.title.replace("#prefix#",t),o.title=o.title.replace("#day#",r),o}}],(n=[{key:"getType",value:function(){return"thread"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType||"Book","&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):this.group?"".concat(e,"&attachable_type=User&attachable_id=").concat(this.group.id,"&from=").concat(this.from):null}},{key:"getFileCopyUrl",value:function(){return this.isEditMode?"".concat("/api/upload/copy?type=attachment","&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):null}}])&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(_.a),G=z;function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==Y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Y(a)?a:String(a)),r)}var o,a}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=W(e);if(t){var o=W(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}var X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(a,e);var t,n,r,o=U(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"getType",value:function(){return"thread_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}}])&&H(t.prototype,n),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a),K=X;function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==Z(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Z(a)?a:String(a)),r)}var o,a}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ee(e);if(t){var o=ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function ee(e){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(e)}var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(a,e);var t,n,r,o=J(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"getType",value:function(){return"thread_comment"}}])&&Q(t.prototype,n),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(h),ne=te;function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===re(a)?a:String(a)),r)}var o,a}function ae(){return ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=le(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ae.apply(this,arguments)}function ie(e,t){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ie(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=le(e);if(t){var o=le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}var ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ie(e,t)}(a,e);var t,n,r,o=ce(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=a,(n=[{key:"buildOptions",value:function(e){var t=ae(le(a.prototype),"buildOptions",this).call(this,e);return t.typography={mustTypography:"classic",typography:"classic",paragraphSpacing:"default"},t}},{key:"getType",value:function(){return"user_readme"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&oe(t.prototype,n),r&&oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a);function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==se(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===se(a)?a:String(a)),r)}var o,a}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}function he(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe(e);if(t){var o=pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(a,e);var t,n,r,o=he(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.from="group_custom",e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=a,(n=[{key:"getType",value:function(){return"group_custom"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&de(t.prototype,n),r&&de(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==ye(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ye(a)?a:String(a)),r)}var o,a}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xe(e);if(t){var o=xe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}var we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(a,e);var t,n,r,o=be(a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=e.feedback;return e.attachType="User",e.useBelongAttach=!0,e.from="feedback",e.placeholder={tip:t&&t.abilities.manage?"你将要代表语雀回复用户，请使用官方口吻，慎重填写":"",emptyParagraphTip:""},o.call(this,e)}return t=a,(n=[{key:"getType",value:function(){return"feedback_comment"}},{key:"getCacheKey",value:function(){var e=this.getType();if(this.target)return"autosave/".concat(e,"/").concat(this.target.id,"/edit");var t=this.options.feedback;return t?"autosave/".concat(e,"/").concat(t.id,"/new"):"autosave/".concat(e)}},{key:"getContentObject",value:function(){var e=this.target.content||{source:"",format:"lake"};return{format:e.format,value:e.source||""}}},{key:"isMiniSize",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}}])&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(_.a);function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==ke(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ke(a)?a:String(a)),r)}var o,a}function Oe(e,t){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oe(e,t)}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ae(e);if(t){var o=Ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(a,e);var t,n,r,o=Ce(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.attachType="User",e.useBelongAttach=!0,e.placeholder={tip:"",emptyParagraphTip:""},e.from="feedback",o.call(this,e)}return t=a,(n=[{key:"getType",value:function(){return"feedback_remark"}},{key:"getContentObject",value:function(){return{format:"lake",value:this.target.remark||""}}},{key:"getCacheKey",value:function(){return this.target?"autosave/".concat(this.type,"/").concat(this.target.id):"autosave/".concat(this.type)}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&Ee(t.prototype,n),r&&Ee(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(_.a);function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==Se(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Se(a)?a:String(a)),r)}var o,a}function Re(){return Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Le(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Re.apply(this,arguments)}function _e(e,t){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_e(e,t)}function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Le(e);if(t){var o=Le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_e(e,t)}(a,e);var t,n,r,o=Me(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.target&&(e.attachType="Doclet"),o.call(this,e)}return t=a,(n=[{key:"getCards",value:function(){return this.options.target?Re(Le(a.prototype),"getCards",this).call(this):["label"]}},{key:"getFullCards",value:function(){return this.options.target?Re(Le(a.prototype),"getFullCards",this).call(this):["label"]}},{key:"getType",value:function(){return"org_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return!1}}])&&je(t.prototype,n),r&&je(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a);function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===De(a)?a:String(a)),r)}var o,a}function Be(){return Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Be.apply(this,arguments)}function Ie(e,t){return Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ie(e,t)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qe(e);if(t){var o=qe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}var ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ie(e,t)}(a,e);var t,n,r,o=Fe(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.attachType="Doclet",o.call(this,e)}return t=a,(n=[{key:"buildOptions",value:function(e){var t=Be(qe(a.prototype),"buildOptions",this).call(this,e);return t.disabledPlugins=["collaboration","vote","checkIn","toc","dataTable","materialLibrary","okr"],t.typography={typography:"classic",paragraphSpacing:"relax"},t}},{key:"getType",value:function(){return"book_overview"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&Ne(t.prototype,n),r&&Ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a)},3608:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(a=o.key,i=void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===r(i)?i:String(i)),o)}var a,i}var a="x-yuque-pt-signature",i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.query=new URLSearchParams(window.location.search),this.isServify=!!this.get(a),this.viewport=this.get("viewport"),this.sidebar="0"===this.get("toc_sidebar")?"none":"toc",this.cards=this.get("cards").split(",").map((function(e){return e.trim()})).filter((function(e){return!!e})),this.thirdpartyCards=this.get("thirdparty_cards")?this.get("thirdparty_cards").split(",").map((function(e){return e.trim()})).filter((function(e){return!!e})):[],this.showTitle="0"!==this.get("title"),this.showHeader="0"!==this.get("header"),this.isEmbedMode=this.get("mode").startsWith("embed"),this.autoHeight=this.getAutoHeight(),this.editorType=this.get("editor_type"),this.editorMode=this.get("editor_mode"),this.language=this.get("language")||"zh-cn",this.pageMinWidth=this.get("page_min_width"),this.onchange="1"===this.get("onchange"),this.allowMention="0"!==this.get("mention"),this.allowResource="1"===this.get("resource"),this.watermark=this.get("watermark"),this.backgroundColor=this.get("background_color"),this.bodyBackgroundColor=this.get("body_background_color"),this.toolbarBackgroundColor=this.get("toolbar_background_color"),this.autoSaveInterval=this.getAutoSaveInterval(),this.saveToServer="0"!==this.get("save_to_server"),this.customUploadUrl=this.get("upload_url"),this.customUploadTypes=this.get("upload_types"),this.customMentionUrl=this.getMentionUrl(),this.customMentionOrigin=this.get("search_user_origin"),this.imageUploadUrl=this.getImageUploadUrl(),this.fileUploadUrl=this.getFileUploadUrl(),this.videoUploadUrl=this.getVideoUploadUrl(),this.videoUploadStatusUrl=this.getVideoUploadStatusUrl(),this.fullHTML="1"===this.query.get("full_html"),this.allowResizeVideo=!0,this.extraConfig=JSON.parse(this.query.get("extra_config")||"{}")}var t,n,r;return t=e,(n=[{key:"get",value:function(e){return this.query.get(e)||""}},{key:"getAutoHeight",value:function(){return!window.h5&&"0"!==this.get("auto_height")}},{key:"getAutoSaveInterval",value:function(){var e=this.get("auto_save_interval");return e&&!Number.isNaN(Number(e))?((e=Number(e))<60&&(e=60),1e3*e):null}},{key:"getMentionUrl",value:function(){var e=this.get("search_user_url");return this._joinCsrf(e)}},{key:"getImageUploadUrl",value:function(){return this.customUploadTypes&&this.customUploadTypes.includes("image")?"".concat(this._joinCsrf(this.customUploadUrl),"&type=image"):null}},{key:"getFileUploadUrl",value:function(){return this.customUploadTypes&&this.customUploadTypes.includes("attachment")?"".concat(this._joinCsrf(this.customUploadUrl),"&type=attachment"):null}},{key:"getVideoUploadUrl",value:function(){var e=this.get("upload_video_url");return e?this._joinCsrf(e):null}},{key:"getVideoUploadStatusUrl",value:function(){var e=this.get("upload_video_status_url");return e?this._joinCsrf(e):null}},{key:"_joinCsrf",value:function(e){var t=e.includes("?")?"&":"?";return"".concat(e).concat(t).concat(this._getCustomCsrf())}},{key:"_getCustomCsrf",value:function(){var e=this.get("upload_csrf_token_field"),t=this.get("upload_csrf_token_value");return e?"".concat(e,"=").concat(encodeURIComponent(t)):""}},{key:"isExtremeMode",value:function(){return"extreme"===this.editorMode}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();i.isServify=function(){var e=new URLSearchParams(window.location.search).get("from");if(!e)return!1;try{if(new URL(e).searchParams.get(a))return!0}catch(e){}return!1},i.SERVIFY_TAG_SRT=a,t.a=i},3609:function(e,t,n){"use strict";n.r(t);n(55);var r=n(22),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(1502),u=n(635),s=n(1507),d=n(3681),f=n(565),h=n(431),p=n(75),m=n(917),y=(n(206),n(111)),v=n(90),g=n.n(v),b=n(1500),x=n.n(b),w=n(101),k=n.n(w),E=n(303),O=n(35);function C(e){return[k.a.FORMAT.MARKDOWN,k.a.FORMAT.ASL].includes(e)}var A="EditorBase-module_init_eZbjJ",P="EditorBase-module_editor_zrggr";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function j(){j=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==S(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function R(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=g()("editor:lakex_mini");function T(e){var t=e.editor,n=e.onChange,r=e.onSubmit,i=e.onLoad,c=t.getProps(),l=c.format,u=c.autoFocus,s=c.isMiniSize,d=c.defaultValue,f=_(Object(o.useState)(C(l)),2),h=f[0],p=f[1],m=_(Object(o.useState)(d),2),v=m[0],g=m[1],b=_(Object(o.useState)(!1),2),w=b[0],S=b[1],M=Object(o.useMemo)((function(){return a.a.createRef()}),[h]),T=a.a.createRef();Object(o.useEffect)((function(){if(C(l)){if(L("convert: ".concat(l," -> lake")),!d)return p(!1),void g("");O.a.docs.convertContent({from:l,to:k.a.FORMAT.LAKE,content:d}).then((function(e){L("convert done:",e),p(!1),g(e.content),S(!0)})).catch((function(e){L("convert fail:",e.message),p(!1)}))}}),[]),Object(o.useEffect)((function(){var e="⌘+enter, ctrl+enter";return x()(e,(function(e){T.current&&T.current.isFocus&&r&&r(e)})),function(){x.a.unbind(e)}}),[]);var D=function(){var r,o=(r=j().mark((function r(){var o,a,c;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(M.current){r.next=2;break}return r.abrupt("return");case 2:if(M.current){r.next=4;break}return r.abrupt("return");case 4:o=s?E.createMicroEditor:E.createMinorEditor,a=t.buildOptions(e),c=o(M.current,a),window.__miniEngine=c,T.current=c,t.setEngine(c),t.setValue(v),c.on("fullscreenStatusChange",(function(e){var t=new CustomEvent("neEditorFullscreenStatusChange",{detail:{isFullscreen:e,engine:c,editorNode:c.editorNode}});window.dispatchEvent(t)})),c.on("change",(function(){n&&n(),t.saveAll()})),i&&i(c),u&&c.focus(!1);case 15:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var a=r.apply(e,t);function i(e){R(a,n,o,i,c,"next",e)}function c(e){R(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}();Object(o.useEffect)((function(){D()}),[h,w]);return h?a.a.createElement("div",{id:"larkx-mini-editor",className:A},a.a.createElement(y.a,null)):l===k.a.FORMAT.LAKE||w?a.a.createElement("div",{id:"lark-mini-editor",className:P,ref:M}):a.a.createElement("div",{id:"lark-mini-editor",className:A},a.a.createElement("h4",null,__("内容格式异常，暂无法编辑")),a.a.createElement("pre",null,e.defaultValue))}T.propTypes={editor:c.a.object,onChange:c.a.func,onLoad:c.a.func,onSubmit:c.a.func};var D=T,N="index-module_lakeCreateGuide_VutDm";function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function I(){I=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==B(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function F(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){F(a,r,o,i,c,"next",e)}function c(e){F(a,r,o,i,c,"throw",e)}i(void 0)}))}}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Y=!1;function H(e){var t=Object(o.useRef)(),n=z(Object(o.useState)(!1),2),i=n[0],c=n[1],y=Object(o.useRef)(!1),v=function(){var e=t.current.isEmpty();y.current!==e&&(c(e),y.current=e)},g=Object(o.useCallback)(function(){var e=q(I().mark((function e(t){var n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.k)(t.id);case 2:if((n=e.sent).format!==h.FORMAT.LAKETABLE&&!/<card.*name=\"dataTable\"/.test(n.doclet.body_asl)){e.next=5;break}return e.abrupt("return",{content:""});case 5:return Object(p.spmClick)(m.a.TEMPLATE_USAGE,{id:n.id,type:n.type,format:n.format,name:n.name,platform:"pc"}),e.abrupt("return",{content:n.format===h.TYPE_FORMAT_MAP.Doc?n.doclet.body_asl:n.doclet.body});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),b=Object(o.useCallback)(function(){var n=q(I().mark((function n(r){var o;return I().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g(r);case 2:if(null!=(o=n.sent)&&o.content){n.next=5;break}return n.abrupt("return");case 5:t.current.setDocument("lake",o.content),c(!1),y.current=!1,e.onChange();case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[g,e.onChange]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(D,{autoFocus:!0,editor:e.editor,autoCompleteLinks:e.autoCompleteLinks,onChange:function(){e.onChange(),v(),Y||(Y=!0,l.a.epv({type:"Comment"}))},onLoad:function(n){t.current=n,e.onLoad(n),v(),n.on("unSupportFileUpload",(function(e){var t;r.a.warning(Object(u.a)(null==e||null===(t=e.extName)||void 0===t?void 0:t.toLowerCase()))})),n.on("clickEmbedButton",(function(){Object(s.a)(r.a.warning.bind(r.a))}))},onSubmit:e.onSubmit,isMiniSize:e.isMiniSize,placeholder:e.placeholder}),e.needCreateGuide&&i?a.a.createElement("div",{className:N},a.a.createElement(d.default,{doc:e.tplDoc,showRecent:!1,needMore:!1,isFullWidth:!0,visible:!0,includePersonal:!1,onUseTemplate:b})):null)}H.defaultProps={onLoad:function(){},onChange:function(){}},H.propTypes={editor:c.a.object.isRequired,tplDoc:c.a.object,onChange:c.a.func,onSubmit:c.a.func,onLoad:c.a.func,autoCompleteLinks:c.a.bool,isMiniSize:c.a.bool,placeholder:c.a.object,needCreateGuide:c.a.bool};t.default=H},3623:function(e,t,n){"use strict";function r(e){return Array.isArray(e.children)}function o(e){return"number"==typeof e.id}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},3628:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0);function o(e,t){0}var a=n(31),i=n(87),c=["type"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.forwardRef((function(e,t){var n=e.type,s=u(e,c),d=i.c[n.toLowerCase()];return d||(o(0,"There is no valid icon for type: ".concat(n)),d=i.c.doc),r.createElement(a.a,l({ref:t,name:d},s))}));s.displayName="DocIcon"},3630:function(e,t,n){"use strict";var r,o=[{id:1,title:__("加油")},{id:2,title:__("开心")},{id:3,title:__("很忙")},{id:4,title:__("想哭")},{id:5,title:__("生气")}],a=(r={},o.forEach((function(e){r[e.id]=e})),r),i=[{id:"thumbs_up",title:__("支持"),icon:"https://gw.alipayobjects.com/zos/basement_prod/40dd7f62-e6ad-48c6-b2c1-aeed729ff753.svg"},{id:"thumbs_down",title:__("反对"),icon:"https://gw.alipayobjects.com/zos/basement_prod/49753f89-a52b-47f8-8dff-ca2b7d5ab29e.svg"},{id:"applause",title:__("喝彩"),icon:"https://gw.alipayobjects.com/zos/basement_prod/39b96288-777c-4ad9-8065-fe27ee2366d5.svg"},{id:"momo",title:__("摸摸"),icon:"https://gw.alipayobjects.com/zos/basement_prod/486defba-93e3-4151-8b23-6fb09dfb7f97.svg"},{id:"+1",title:__("+1"),icon:"https://gw.alipayobjects.com/zos/bmw-prod/cd3682d7-3cc9-44a1-87d3-1feb83baee73.svg"},{id:"OK",title:"OK",icon:"https://gw.alipayobjects.com/zos/bmw-prod/70ec25dc-2ad6-42f3-b802-76ba015becde.svg"}],c=function(){var e={};return i.forEach((function(t){e[t.id]=t})),e}(),l={REACTIONS:i,getMoodTitleById:function(e){return(a[e]||{}).title||""},getPostUrl:function(e){var t=window.location.hash||"",n=window.location.href;return n=n.substring(0,n.length-t.length),"".concat(n,"#comment-").concat(e)},classifyReactions:function(e){var t=Object.keys(c),n={};return t.forEach((function(e){n[e]={count:0,user_ids:[]}})),e.forEach((function(e){e.action_option.split(",").forEach((function(t){n[t]&&(n[t].count++,n[t].user_ids.push(e.user_id))}))})),n},getReactionById:function(e){return c[e]}};t.a=l},3657:function(e,t,n){"use strict";n.r(t);n(227);var r=n(115),o=(n(84),n(45)),a=(n(95),n(38)),i=n(0),c=n.n(i),l=n(8),u=n.n(l),s=n(911),d=n.n(s),f=n(11),h=n.n(f),p=n(129),m=n(182),y=n(71),v=n(31),g={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e){var t=e.icon,n=e.content,r=e.style,o=e.showClose,a=b(Object(i.useState)(!0),2),l=a[0],u=a[1];return l?c.a.createElement("div",{className:g.wrap,style:r},t&&c.a.createElement("div",{className:g.icon},t),c.a.createElement("div",{className:g.content},n),o&&c.a.createElement("div",{className:g.close,onClick:function(){u(!1)}},c.a.createElement("span",{className:h()("lake-icon","lake-icon-close",g.closeIcon)}))):null};w.propTypes={icon:u.a.node,content:u.a.node.isRequired,style:u.a.object,showClose:u.a.bool};var k=w,E=n(229),O="ReaderAudit-module_closeBtn_hHU+3",C="ReaderAudit-module_detail_mWCgN",A="ReaderAudit-module_toggleDetail_pq7CA",P="ReaderAudit-module_moreLink_oxcCo",S="ReaderAudit-module_tagModeWrapper_xupeI",j="ReaderAudit-module_tagText_Womh9",R="ReaderAudit-module_pending_m3C28",_="ReaderAudit-module_illegal_B8aJ7",M="ReaderAudit-module_banned_sHuxy",L="ReaderAudit-module_isIntranet_WPBjb",T="ReaderAudit-module_tagClose_YIxR7";function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e){var t,n=F(Object(i.useState)(!1),2),l=n[0],u=n[1],s=F(Object(i.useState)(!0),2),f=s[0],g=s[1],b=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,x=e.doc,w=e.type,E=e.tagMode,D=x.audits,N=x.read_status,q=x.id,z=x.content_updated_at,G=x.abilities,Y=void 0===G?{}:G,H=window.appData,V=H.book,U=H.group,W=H.me,X=e.isYuque||window.appData.isYuque;var K="audit_ignored_".concat(w,"_").concat(q);function Z(e){null==e||e.preventDefault(),localStorage.setItem(K,Date.now()),g(!1)}function Q(e){var t=e.filter((function(e){return null!==e}));return d()(t)}if(Object(i.useEffect)((function(){if(N===p.READ_STATUS.insecure)if(W.isAdmin||Y.update){if(!b){var e=localStorage.getItem(K);if(e&&z){var t=new Date(z).getTime();g(t>e)}}}else g(!1)}),[]),N<=p.READ_STATUS.ok&&(null==V?void 0:V.status)!==m.STATUS.banned&&(null==U?void 0:U.status)!==y.STATUS.blocked)return null;if(N<=p.READ_STATUS.ok&&((null==V?void 0:V.status)===m.STATUS.banned||(null==U?void 0:U.status)===y.STATUS.blocked))return null!=W&&W.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==U?void 0:U.status)===y.STATUS.blocked,", bookBlocked: ").concat((null==V?void 0:V.status)===m.STATUS.banned)),null;if(null!=U&&U.isPermanentPunished)return null!=W&&W.isAdmin&&N>p.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===w&&N<=p.READ_STATUS.ok)return null;if(!f)return null;var $=[];D&&(D.forbidden||D.reason)&&($=D.forbidden||[D.reason]);var J,ee={};if(ee[p.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),ee[p.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),ee[p.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[p.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[p.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[p.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[p.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),X)J=ee[N]||ee[p.READ_STATUS.suspect];else{var te=!E&&$.length>0?c.a.createElement("a",{onClick:function(e){e.preventDefault(),u(!l)},className:A},l?"收起详情":"展开详情"):null,ne=c.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:P},__("了解更多"));J=b||N!==p.READ_STATUS.insecure?c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),ne,te," "):c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ne,te)}var re=X?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(E){if(X){var oe,ae,ie,ce,le=(I(oe={},p.READ_STATUS.pending,__("审核中")),I(oe,p.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),I(oe,p.READ_STATUS.banned,__("该内容已屏蔽#tag")),oe);switch(N){case p.READ_STATUS.pending:case p.READ_STATUS.suspect:ce=p.READ_STATUS.pending;break;case p.READ_STATUS.illegal:case p.READ_STATUS.illegal_polity:case p.READ_STATUS.illegal_ak:case p.READ_STATUS.illegal_privacy:ce=p.READ_STATUS.illegal;break;case p.READ_STATUS.banned:ce=p.READ_STATUS.banned;break;default:ce=null}return(ie=le[ce])?c.a.createElement(a.a,{title:c.a.createElement("span",{className:j},J),placement:"bottom"},c.a.createElement("div",{className:h()(S,(ae={},I(ae,R,ce===p.READ_STATUS.pending),I(ae,_,ce===p.READ_STATUS.illegal),I(ae,M,ce===p.READ_STATUS.banned),ae))},c.a.createElement("span",{className:j},ie))):null}return c.a.createElement("div",{className:h()(S,L),onClick:function(){o.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:c.a.createElement(c.a.Fragment,null,J,$.length>0&&c.a.createElement("ul",{className:C},Q($).map((function(e){return c.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){Z()}})}},c.a.createElement("span",{className:j},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),c.a.createElement("div",{className:T,onClick:function(e){e.stopPropagation(),Z()}},c.a.createElement(v.b,{name:"close",width:10,height:10})))}return c.a.createElement(k,{style:B({marginBottom:"Doc"===w?24:0,marginTop:4},re),icon:c.a.createElement(v.b,{name:"doc-has-content-risk",height:17,width:15}),content:c.a.createElement(c.a.Fragment,null,!X&&c.a.createElement(r.a,{title:__("确认忽略该提醒？"),onConfirm:Z,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},c.a.createElement("span",{className:O},c.a.createElement(v.b,{name:"close",width:14}))),c.a.createElement("span",{"data-testid":"audit-tip"},J),l&&c.a.createElement("ul",{className:C},Q($).map((function(e){return c.a.createElement("li",{key:e},e)}))))})}z.defaultProps={isYuque:window.appData.isYuque},z.propTypes={doc:u.a.object.isRequired,type:u.a.string,isYuque:u.a.bool,tagMode:u.a.bool};t.default=Object(E.b)(z)},3666:function(e,t,n){"use strict";var r=/["'&<>]/;e.exports=function(e){var t,n=""+e,o=r.exec(n);if(!o)return n;var a="",i=0,c=0;for(i=o.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}c!==i&&(a+=n.substring(c,i)),c=i+1,a+=t}return c!==i?a+n.substring(c,i):a}},3673:function(e,t,n){var r=n(1412)("toLowerCase");e.exports=r},3679:function(e,t,n){},3681:function(e,t,n){"use strict";n.r(t),n.d(t,"DocCreationGuide",(function(){return R})),n.d(t,"default",(function(){return _}));var r=n(3673),o=n.n(r),a=n(0),i=n(256),c=n(205),l=n(185),u=n(565),s=n(3682),d=n(3690),f=n(3174),h=n(377);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(){m=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function y(){}var v={};l(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(v=b);var x=y.prototype=f.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==p(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function y(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}var v=new(n.n(h).a)(5);function g(e,t){return b.apply(this,arguments)}function b(){var e;return e=m().mark((function e(t,n){var r,o,a,i=arguments;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:5e3,!(o=v.get(t))){e.next=4;break}return e.abrupt("return",Promise.resolve(o));case 4:return e.next=6,n();case 6:return a=e.sent,v.set(t,a,{maxAge:r}),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})),b=function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){y(a,r,o,i,c,"next",e)}function c(e){y(a,r,o,i,c,"throw",e)}i(void 0)}))},b.apply(this,arguments)}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}var w=["group","book","onUseTemplate","height","doc","isFullWidth","showRecent","needMore"],k=["visible","className","style"];function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}function O(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===x(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e){var t=e.group,n=e.book,r=e.onUseTemplate,h=e.height,p=(e.doc,e.isFullWidth),m=void 0===p||p,y=e.showRecent,v=void 0===y||y,b=e.needMore,x=void 0===b||b,k=O(e,w),C=function(e){var t=e.book,n=e.group,r=e.doc,i=e.showRecent,s=void 0===i||i,d=e.includePersonal,h=void 0===d||d,p=S(a.useState([]),2),m=p[0],y=p[1],v=S(a.useState({data:[],meta:{}}),2),b=v[0],x=v[1],w=(null==r?void 0:r.type)||"Doc";return a.useEffect((function(){var e;if(s){var n=function(){return c.a.editor.recentlyUpdatedDocs({book_id:t.id,type:w})};null!=t&&t.id&&null!=t&&null!==(e=t.abilities)&&void 0!==e&&e.create_doc?g("getRecentDocs-".concat(t.id,"-").concat(w),n,5e3).then((function(e){y(e)})):n().then((function(e){return y(e)}))}}),[t,s]),a.useEffect((function(){var e=f.a[o()(w)];g("getAllTemplates-".concat((null==t?void 0:t.id)||"","-").concat((null==n?void 0:n.id)||"","-").concat((null==t?void 0:t.organization_id)||"","-").concat(w||"","-").concat(e||""),(function(){return Object(u.i)(A(A({},Object(u.l)(t,n,h)),{},{official_channel:e,limit:5,format:l.TYPE_FORMAT_MAP[w]}))}),5e3).then((function(e){x(e)}))}),[t,w]),{recentDocs:m,templateConfig:b}}(e),P=C.recentDocs,j=C.templateConfig,R=S(a.useState(0),2),_=R[0],M=R[1],L=m?{}:{maxWidth:"890px",marginLeft:"auto",marginRight:"auto",paddingLeft:"70px",paddingRight:"70px"};return a.createElement("div",E({},k,{style:L}),a.createElement(i.a,{onResize:function(e){e.height&&M(e.height)}},a.createElement(s.c,{templateConfig:j,book:n,group:t,needMore:x,onUseTemplate:r})),v&&a.createElement(d.b,{height:h-_,recentDocs:P,book:n,group:t,onUseTemplate:r}))};function _(e){var t=e.visible,n=e.className,r=e.style,o=O(e,k);return t?a.createElement(R,E({},o,{className:n,style:r})):null}},3682:function(e,t,n){"use strict";n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return C}));var r=n(0),o=n(3709),a=n(3874),i=n(643),c=n(845),l=n(3623),u=n(3712),s=n(3708),d=n(536);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(){h=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof p?t:p,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function p(){}function m(){}function y(){}var v={};l(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(v=b);var x=y.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==f(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function p(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x={book:__("来自本知识库模板"),group:__("来自本团队模板"),personal:__("来自我的模板"),official:__("来自语雀推荐模板")};function w(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=[],r=e.data.reduce((function(e,t){return e[t.id]=t,e}),{}),o=e.meta,a=o.book,i=o.group,c=o.personal,l=o.official,u=[].concat(g(((null==a?void 0:a.template_ids)||[]).map((function(e){return["book",e]}))),g(((null==i?void 0:i.template_ids)||[]).map((function(e){return["group",e]}))),g(((null==c?void 0:c.template_ids)||[]).map((function(e){return["personal",e]}))),g(("zh-cn"===window.appData.locale&&Array.isArray(null==l?void 0:l.template_ids)&&(null==l?void 0:l.template_ids)||[]).map((function(e){return["official",e]}))));n.length<t&&u.length;){var s=u.shift();if(s){var d=r[s[1]];d&&n.push(y(y({},d),{},{from:x[s[0]]}))}}return n}var k=function(e){var t=e.book,n=e.group,o=e.onUseTemplate,a=e.templateConfig,u=Object(c.a)(),s=u.loadTemplateSelector,d=u.showTemplateSelector,f=u.contextHolder;r.useEffect((function(){s()}),[]);var m=r.useMemo((function(){return w(a)}),[a]),y=function(){var e,r=(e=h().mark((function e(){var r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({book:t,group:n,format:"lake"});case 2:(r=e.sent)&&Object(l.a)(r)&&o(r,!0);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,c,"next",e)}function c(e){p(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}();return{state:{templateList:m},handleTemplateItemClick:function(e){var t;o(e),Object(i.a)("c303187.d306374",{tid:e.id,name:e.name,format:e.format,inner:null!==(t=window.appData)&&void 0!==t&&t.isYuque?"0":"1",type:e.type,platform:"pc"})},handleMoreTemplateClick:y,contextHolder:f}},E=function(e){var t=e.template,n=t||{},o=n.from,a=n.meta,i=null;return null!=a&&a.description?i=r.createElement("div",{className:s.a.desc},a.description):o&&(i=r.createElement("div",{className:s.a.desc},o)),r.createElement(r.Fragment,null,r.createElement("div",{className:s.a.docIconWrapper},r.createElement(u.a,{className:s.a.docIcon,node:t,size:"large"})),r.createElement("div",{className:s.a.tip},r.createElement("div",{className:s.a.name,title:t.name},t.name),i))},O=function(e){var t=e.title,n=e.imgSrc;return r.createElement(r.Fragment,null,r.createElement("div",{className:s.a.moreImg},r.createElement("img",{src:n,alt:t})),r.createElement("div",{className:s.a.tip},r.createElement("div",{className:s.a.name},t)))},C=r.forwardRef((function(e,t){var n=k(e),i=Object(d.a)().isDarkMode,c=n.state.templateList,l=n.handleTemplateItemClick,u=n.handleMoreTemplateClick,f=n.contextHolder;return r.createElement("div",{ref:t},c.length>0?r.createElement("ul",{className:s.a.list},c.map((function(e,t){var n,i=1e3*(null!==(n=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9][t])&&void 0!==n?n:1)+.1;return r.createElement(o.Spring,{from:{marginTop:30,opacity:0},to:{marginTop:0,opacity:1},config:{duration:300,easing:a.b,delay:i},key:t},(function(t){return r.createElement("li",{key:e.id,className:s.a.item,onClick:function(){return l(e)},title:e.name,"data-aspm-click":"b4693.c100045.d207095",style:t},r.createElement(E,{template:e}))}))})),e.needMore?r.createElement(o.Spring,{from:{marginTop:30,opacity:0},to:{marginTop:0,opacity:1},config:{duration:300,easing:a.b,delay:.1*c.length+.1}},(function(e){return r.createElement("li",{className:s.a.item,onClick:u,style:e},r.createElement(O,{key:"official",title:__("更多模板"),imgSrc:i?"https://gw.alipayobjects.com/zos/bmw-prod/6518ac5a-760d-4289-ad7c-71a2dbfea622.svg":"https://gw.alipayobjects.com/mdn/prod_resource/afts/img/A*Tt8DRr2oSUwAAAAAAAAAAAAAARQnAQ"}))})):null):null,f)}))},3690:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(0),o=n(3628),a="RecentDocs-module_tip_n1Nmq",i="RecentDocs-module_docItem_GCIP4",c="RecentDocs-module_title_O3oxy",l="RecentDocs-module_icon_e5am+",u=function(e){var t=e.doc,n=e.onClick,a=e.hidden;return r.createElement("li",{className:i,style:{display:a?"none":"flex"},onClick:function(){return n(t)},title:t.title,"data-aspm-click":"b4693.c100045.d207096"},r.createElement(o.a,{className:l,type:t.type}),r.createElement("div",{className:c},t.title))},s=function(e){var t=e.height,n=e.onUseTemplate,o=e.recentDocs,i=r.useMemo((function(){var e=t>0?Math.floor((t-24)/58):0;return Math.min(e,o.length)}),[t,o.length]);return r.createElement("div",null,i>0?r.createElement("div",{className:a},__("从最近编辑的文档中复制内容过来：")):null,r.createElement("ul",null,o.map((function(e,t){return r.createElement(u,{key:e.id,doc:e,hidden:t+1>i,onClick:function(e){return n(e,!1)}})}))))}},3693:function(e,t,n){"use strict";n.d(t,"a",(function(){return Hi})),n.d(t,"b",(function(){return cr})),n.d(t,"c",(function(){return Zl})),n.d(t,"d",(function(){return SE})),n.d(t,"e",(function(){return Ou})),n.d(t,"f",(function(){return Mc})),n.d(t,"g",(function(){return dc})),n.d(t,"h",(function(){return xn})),n.d(t,"i",(function(){return sE})),n.d(t,"j",(function(){return Wr})),n.d(t,"k",(function(){return Ii})),n.d(t,"l",(function(){return Za})),n.d(t,"m",(function(){return Iu})),n.d(t,"n",(function(){return Eu})),n.d(t,"o",(function(){return da})),n.d(t,"p",(function(){return Qs})),n.d(t,"q",(function(){return Sa})),n.d(t,"r",(function(){return Ra})),n.d(t,"s",(function(){return kl})),n.d(t,"t",(function(){return or})),n.d(t,"u",(function(){return _g})),n.d(t,"v",(function(){return Fu}));var r=n(72),o=n(47),a=n.n(o),i=n(1),c=n.n(i),l=n(164),u=n.n(l),s=n(599),d=n.n(s),f=n(463),h=n.n(f),p=n(4),m=n.n(p),y=n(5),v=n.n(y),g=n(21),b=n.n(g),x=n(371),w=n.n(x),k=n(3610),E=n(133),O=n.n(E),C=n(3),A=n.n(C),P=n(6),S=n.n(P),j=n(7),R=n.n(j),_=n(2),M=n.n(_),L=n(20),T=n.n(L),D=n(15),N=n.n(D),B=n(26),I=n.n(B),F=n(1387);const q=Math.pow(2,-52),z=new Uint32Array(512);class G{static from(e,t=Z,n=Q){const r=e.length,o=new Float64Array(2*r);for(let a=0;a<r;a++){const r=e[a];o[2*a]=t(r),o[2*a+1]=n(r)}return new G(o)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:o}=this,a=e.length>>1;let i=1/0,c=1/0,l=-1/0,u=-1/0;for(let t=0;t<a;t++){const n=e[2*t],r=e[2*t+1];n<i&&(i=n),r<c&&(c=r),n>l&&(l=n),r>u&&(u=r),this._ids[t]=t}const s=(i+l)/2,d=(c+u)/2;let f,h,p,m=1/0;for(let t=0;t<a;t++){const n=Y(s,d,e[2*t],e[2*t+1]);n<m&&(f=t,m=n)}const y=e[2*f],v=e[2*f+1];m=1/0;for(let t=0;t<a;t++){if(t===f)continue;const n=Y(y,v,e[2*t],e[2*t+1]);n<m&&n>0&&(h=t,m=n)}let g=e[2*h],b=e[2*h+1],x=1/0;for(let t=0;t<a;t++){if(t===f||t===h)continue;const n=W(y,v,g,b,e[2*t],e[2*t+1]);n<x&&(p=t,x=n)}let w=e[2*p],k=e[2*p+1];if(x===1/0){for(let t=0;t<a;t++)this._dists[t]=e[2*t]-e[0]||e[2*t+1]-e[1];X(this._ids,this._dists,0,a-1);const t=new Uint32Array(a);let n=0;for(let e=0,r=-1/0;e<a;e++){const o=this._ids[e];this._dists[o]>r&&(t[n++]=o,r=this._dists[o])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(V(y,v,g,b,w,k)){const e=h,t=g,n=b;h=p,g=w,b=k,p=e,w=t,k=n}const E=function(e,t,n,r,o,a){const i=n-e,c=r-t,l=o-e,u=a-t,s=i*i+c*c,d=l*l+u*u,f=.5/(i*u-c*l),h=e+(u*s-c*d)*f,p=t+(i*d-l*s)*f;return{x:h,y:p}}(y,v,g,b,w,k);this._cx=E.x,this._cy=E.y;for(let t=0;t<a;t++)this._dists[t]=Y(e[2*t],e[2*t+1],E.x,E.y);X(this._ids,this._dists,0,a-1),this._hullStart=f;let O=3;n[f]=t[p]=h,n[h]=t[f]=p,n[p]=t[h]=f,r[f]=0,r[h]=1,r[p]=2,o.fill(-1),o[this._hashKey(y,v)]=f,o[this._hashKey(g,b)]=h,o[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(f,h,p,-1,-1,-1);for(let a,i,c=0;c<this._ids.length;c++){const l=this._ids[c],u=e[2*l],s=e[2*l+1];if(c>0&&Math.abs(u-a)<=q&&Math.abs(s-i)<=q)continue;if(a=u,i=s,l===f||l===h||l===p)continue;let d=0;for(let e=0,t=this._hashKey(u,s);e<this._hashSize&&(d=o[(t+e)%this._hashSize],-1===d||d===n[d]);e++);d=t[d];let m,y=d;for(;m=n[y],!V(u,s,e[2*y],e[2*y+1],e[2*m],e[2*m+1]);)if(y=m,y===d){y=-1;break}if(-1===y)continue;let v=this._addTriangle(y,l,n[y],-1,-1,r[y]);r[l]=this._legalize(v+2),r[y]=v,O++;let g=n[y];for(;m=n[g],V(u,s,e[2*g],e[2*g+1],e[2*m],e[2*m+1]);)v=this._addTriangle(g,l,m,r[l],-1,r[g]),r[l]=this._legalize(v+2),n[g]=g,O--,g=m;if(y===d)for(;m=t[y],V(u,s,e[2*m],e[2*m+1],e[2*y],e[2*y+1]);)v=this._addTriangle(m,l,y,-1,r[y],r[m]),this._legalize(v+2),r[m]=v,n[y]=y,O--,y=m;this._hullStart=t[l]=y,n[y]=t[g]=l,n[l]=g,o[this._hashKey(u,s)]=l,o[this._hashKey(e[2*y],e[2*y+1])]=y}this.hull=new Uint32Array(O);for(let e=0,t=this._hullStart;e<O;e++)this.hull[e]=t,t=n[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let o=0,a=0;for(;;){const i=n[e],c=e-e%3;if(a=c+(e+2)%3,-1===i){if(0===o)break;e=z[--o];continue}const l=i-i%3,u=c+(e+1)%3,s=l+(i+2)%3,d=t[a],f=t[e],h=t[u],p=t[s];if(U(r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[i]=d;const r=n[s];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===s){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(i,n[a]),this._link(a,s);const c=l+(i+1)%3;o<z.length&&(z[o++]=c)}else{if(0===o)break;e=z[--o]}}return a}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,o,a){const i=this.trianglesLen;return this._triangles[i]=e,this._triangles[i+1]=t,this._triangles[i+2]=n,this._link(i,r),this._link(i+1,o),this._link(i+2,a),this.trianglesLen+=3,i}}function Y(e,t,n,r){const o=e-n,a=t-r;return o*o+a*a}function H(e,t,n,r,o,a){const i=(r-t)*(o-e),c=(n-e)*(a-t);return Math.abs(i-c)>=33306690738754716e-32*Math.abs(i+c)?i-c:0}function V(e,t,n,r,o,a){return(H(o,a,e,t,n,r)||H(e,t,n,r,o,a)||H(n,r,o,a,e,t))<0}function U(e,t,n,r,o,a,i,c){const l=e-i,u=t-c,s=n-i,d=r-c,f=o-i,h=a-c,p=s*s+d*d,m=f*f+h*h;return l*(d*m-p*h)-u*(s*m-p*f)+(l*l+u*u)*(s*h-d*f)<0}function W(e,t,n,r,o,a){const i=n-e,c=r-t,l=o-e,u=a-t,s=i*i+c*c,d=l*l+u*u,f=.5/(i*u-c*l),h=(u*s-c*d)*f,p=(i*d-l*s)*f;return h*h+p*p}function X(e,t,n,r){if(r-n<=20)for(let o=n+1;o<=r;o++){const r=e[o],a=t[r];let i=o-1;for(;i>=n&&t[e[i]]>a;)e[i+1]=e[i--];e[i+1]=r}else{let o=n+1,a=r;K(e,n+r>>1,o),t[e[n]]>t[e[r]]&&K(e,n,r),t[e[o]]>t[e[r]]&&K(e,o,r),t[e[n]]>t[e[o]]&&K(e,n,o);const i=e[o],c=t[i];for(;;){do{o++}while(t[e[o]]<c);do{a--}while(t[e[a]]>c);if(a<o)break;K(e,o,a)}e[n+1]=e[a],e[a]=i,r-o+1>=a-n?(X(e,t,o,r),X(e,t,n,a-1)):(X(e,t,n,a-1),X(e,t,o,r))}}function K(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Z(e){return e[0]}function Q(e){return e[1]}const $=1e-6;class J{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const r=(e=+e)+(n=+n),o=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>$||Math.abs(this._y1-o)>$)&&(this._+="L"+r+","+o),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=o}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class ee{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class te{constructor(e,[t,n,r,o]=[0,0,960,500]){if(!((r=+r)>=(t=+t)&&(o=+o)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=r,this.xmin=t,this.ymax=o,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this,o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let t,r,a=0,i=0,c=n.length;a<c;a+=3,i+=2){const c=2*n[a],l=2*n[a+1],u=2*n[a+2],s=e[c],d=e[c+1],f=e[l],h=e[l+1],p=e[u],m=e[u+1],y=f-s,v=h-d,g=p-s,b=m-d,x=y*y+v*v,w=g*g+b*b,k=2*(y*b-v*g);if(k)if(Math.abs(k)<1e-8)t=(s+p)/2,r=(d+m)/2;else{const e=1/k;t=s+(b*x-v*w)*e,r=d+(y*w-g*x)*e}else t=(s+p)/2-1e8*b,r=(d+m)/2+1e8*g;o[i]=t,o[i+1]=r}let a,i,c,l=t[t.length-1],u=4*l,s=e[2*l],d=e[2*l+1];r.fill(0);for(let n=0;n<t.length;++n)l=t[n],a=u,i=s,c=d,u=4*l,s=e[2*l],d=e[2*l+1],r[a+2]=r[u]=c-d,r[a+3]=r[u+1]=s-i}render(e){const t=null==e?e=new J:void 0,{delaunay:{halfedges:n,inedges:r,hull:o},circumcenters:a,vectors:i}=this;if(o.length<=1)return null;for(let t=0,r=n.length;t<r;++t){const r=n[t];if(r<t)continue;const o=2*Math.floor(t/3),i=2*Math.floor(r/3),c=a[o],l=a[o+1],u=a[i],s=a[i+1];this._renderSegment(c,l,u,s,e)}let c,l=o[o.length-1];for(let t=0;t<o.length;++t){c=l,l=o[t];const n=2*Math.floor(r[l]/3),u=a[n],s=a[n+1],d=4*c,f=this._project(u,s,i[d+2],i[d+3]);f&&this._renderSegment(u,s,f[0],f[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new J:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new J:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let e=2;e<o;e+=2)r[e]===r[e-2]&&r[e+1]===r[e-1]||t.lineTo(r[e],r[e+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new ee;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,o){let a;const i=this._regioncode(e,t),c=this._regioncode(n,r);0===i&&0===c?(o.moveTo(e,t),o.lineTo(n,r)):(a=this._clipSegment(e,t,n,r,i,c))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,o=t.length;r<o;r+=2)for(let a=0,i=e.length;a<i;a+=2)if(t[r]==e[a]&&t[r+1]==e[a+1]&&t[(r+2)%o]==e[(a+i-2)%i]&&t[(r+3)%o]==e[(a+i-1)%i]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:o}}=this,a=n[e];if(-1===a)return null;const i=[];let c=a;do{const n=Math.floor(c/3);if(i.push(t[2*n],t[2*n+1]),c=c%3==2?c-2:c+1,o[c]!==e)break;c=r[c]}while(c!==a&&-1!==c);return i}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}_clipFinite(e,t){const n=t.length;let r,o,a,i,c,l=null,u=t[n-2],s=t[n-1],d=this._regioncode(u,s);for(let f=0;f<n;f+=2)if(r=u,o=s,u=t[f],s=t[f+1],a=d,d=this._regioncode(u,s),0===a&&0===d)i=c,c=0,l?l.push(u,s):l=[u,s];else{let t,n,f,h,p;if(0===a){if(null===(t=this._clipSegment(r,o,u,s,a,d)))continue;[n,f,h,p]=t}else{if(null===(t=this._clipSegment(u,s,r,o,d,a)))continue;[h,p,n,f]=t,i=c,c=this._edgecode(n,f),i&&c&&this._edge(e,i,c,l,l.length),l?l.push(n,f):l=[n,f]}i=c,c=this._edgecode(h,p),i&&c&&this._edge(e,i,c,l,l.length),l?l.push(h,p):l=[h,p]}if(l)i=c,c=this._edgecode(l[0],l[1]),i&&c&&this._edge(e,i,c,l,l.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return l}_clipSegment(e,t,n,r,o,a){for(;;){if(0===o&&0===a)return[e,t,n,r];if(o&a)return null;let i,c,l=o||a;8&l?(i=e+(n-e)*(this.ymax-t)/(r-t),c=this.ymax):4&l?(i=e+(n-e)*(this.ymin-t)/(r-t),c=this.ymin):2&l?(c=t+(r-t)*(this.xmax-e)/(n-e),i=this.xmax):(c=t+(r-t)*(this.xmin-e)/(n-e),i=this.xmin),o?(e=i,t=c,o=this._regioncode(e,t)):(n=i,r=c,a=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,o,a){let i,c=Array.from(t);if((i=this._project(c[0],c[1],n,r))&&c.unshift(i[0],i[1]),(i=this._project(c[c.length-2],c[c.length-1],o,a))&&c.push(i[0],i[1]),c=this._clipFinite(e,c))for(let t,n=0,r=c.length,o=this._edgecode(c[r-2],c[r-1]);n<r;n+=2)t=o,o=this._edgecode(c[n],c[n+1]),t&&o&&(n=this._edge(e,t,o,c,n),r=c.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(c=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return c}_edge(e,t,n,r,o){for(;t!==n;){let n,a;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,a=this.ymin}r[o]===n&&r[o+1]===a||!this.contains(e,n,a)||(r.splice(o,0,n,a),o+=2)}if(r.length>4)for(let e=0;e<r.length;e+=2){const t=(e+2)%r.length,n=(e+4)%r.length;(r[e]===r[t]&&r[t]===r[n]||r[e+1]===r[t+1]&&r[t+1]===r[n+1])&&(r.splice(t,2),e-=2)}return o}_project(e,t,n,r){let o,a,i,c=1/0;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<c&&(i=this.ymin,a=e+(c=o)*n)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<c&&(i=this.ymax,a=e+(c=o)*n)}if(n>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/n)<c&&(a=this.xmax,i=t+(c=o)*r)}else if(n<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/n)<c&&(a=this.xmin,i=t+(c=o)*r)}return[a,i]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const ne=2*Math.PI,re=Math.pow;function oe(e){return e[0]}function ae(e){return e[1]}function ie(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class ce{static from(e,t=oe,n=ae,r){return new ce("length"in e?function(e,t,n,r){const o=e.length,a=new Float64Array(2*o);for(let i=0;i<o;++i){const o=e[i];a[2*i]=t.call(r,o,i,e),a[2*i+1]=n.call(r,o,i,e)}return a}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let o=0;for(const a of e)yield t.call(r,a,o,e),yield n.call(r,a,o,e),++o}(e,t,n,r)))}constructor(e){this._delaunator=new G(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let e=0;e<t.length;e+=3){const r=2*t[e],o=2*t[e+1],a=2*t[e+2];if((n[a]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],o=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let e=0,n=t.length/2;e<n;++e){const n=ie(t[2*e],t[2*e+1],o);t[2*e]=n[0],t[2*e+1]=n[1]}this._delaunator=new G(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),i=this._hullIndex.fill(-1);for(let e=0,t=n.length;e<t;++e){const t=o[e%3==2?e-2:e+1];-1!==n[e]&&-1!==a[t]||(a[t]=e)}for(let e=0,t=r.length;e<t;++e)i[r[e]]=e;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,2===r.length&&(a[r[1]]=0))}voronoi(e){return new te(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:o,triangles:a,collinear:i}=this;if(i){const t=i.indexOf(e);return t>0&&(yield i[t-1]),void(t<i.length-1&&(yield i[t+1]))}const c=t[e];if(-1===c)return;let l=c,u=-1;do{if(yield u=a[l],l=l%3==2?l-2:l+1,a[l]!==e)return;if(l=o[l],-1===l){const t=n[(r[e]+1)%n.length];return void(t!==u&&(yield t))}}while(l!==c)}find(e,t,n=0){if((e=+e)!=e||(t=+t)!=t)return-1;const r=n;let o;for(;(o=this._step(n,e,t))>=0&&o!==n&&o!==r;)n=o;return o}_step(e,t,n){const{inedges:r,hull:o,_hullIndex:a,halfedges:i,triangles:c,points:l}=this;if(-1===r[e]||!l.length)return(e+1)%(l.length>>1);let u=e,s=re(t-l[2*e],2)+re(n-l[2*e+1],2);const d=r[e];let f=d;do{let r=c[f];const d=re(t-l[2*r],2)+re(n-l[2*r+1],2);if(d<s&&(s=d,u=r),f=f%3==2?f-2:f+1,c[f]!==e)break;if(f=i[f],-1===f){if(f=o[(a[e]+1)%o.length],f!==r&&re(t-l[2*f],2)+re(n-l[2*f+1],2)<s)return f;break}}while(f!==d);return u}render(e){const t=null==e?e=new J:void 0,{points:n,halfedges:r,triangles:o}=this;for(let t=0,a=r.length;t<a;++t){const a=r[t];if(a<t)continue;const i=2*o[t],c=2*o[a];e.moveTo(n[i],n[i+1]),e.lineTo(n[c],n[c+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const n=null==e?e=new J:void 0,{points:r}=this;for(let n=0,o=r.length;n<o;n+=2){const o=r[n],a=r[n+1];e.moveTo(o+t,a),e.arc(o,a,t,0,ne)}return n&&n.value()}renderHull(e){const t=null==e?e=new J:void 0,{hull:n,points:r}=this,o=2*n[0],a=n.length;e.moveTo(r[o],r[o+1]);for(let t=1;t<a;++t){const o=2*n[t];e.lineTo(r[o],r[o+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new ee;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new J:void 0,{points:r,triangles:o}=this,a=2*o[e*=3],i=2*o[e+1],c=2*o[e+2];return t.moveTo(r[a],r[a+1]),t.lineTo(r[i],r[i+1]),t.lineTo(r[c],r[c+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new ee;return this.renderTriangle(e,t),t.value()}}var le=n(209),ue=n.n(le),se=n(16),de=n.n(se),fe=n(12),he=n.n(fe),pe=n(30),me=n(3942),ye=n.n(me),ve=n(3943),ge=n.n(ve),be=n(36),xe=n.n(be),we=(n(55),n(22)),ke=n(356),Ee=n.n(ke),Oe=n(338),Ce=n.n(Oe),Ae=n(3944),Pe=n.n(Ae),Se=n(3947),je=n.n(Se),Re=n(911),_e=n.n(Re),Me=n(120),Le=n.n(Me),Te=n(43),De=n.n(Te),Ne=n(3953),Be=n.n(Ne),Ie=n(114),Fe=n.n(Ie),qe=n(1604),ze=n.n(qe),Ge=n(455),Ye=n.n(Ge),He=n(3917),Ve=n.n(He),Ue=n(81),We=n.n(Ue);function Xe(e,t,n,r=(e=>e)){return e*r(.5-t*(.5-n))}function Ke(e,t){return[e[0]+t[0],e[1]+t[1]]}function Ze(e,t){return[e[0]-t[0],e[1]-t[1]]}function Qe(e,t){return[e[0]*t,e[1]*t]}function $e(e){return[e[1],-e[0]]}function Je(e,t){return e[0]*t[0]+e[1]*t[1]}function et(e,t){return e[0]===t[0]&&e[1]===t[1]}function tt(e,t){return function(e){return e[0]*e[0]+e[1]*e[1]}(Ze(e,t))}function nt(e){return function(e,t){return[e[0]/t,e[1]/t]}(e,function(e){return Math.hypot(e[0],e[1])}(e))}function rt(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function ot(e,t,n){let r=Math.sin(n),o=Math.cos(n),a=e[0]-t[0],i=e[1]-t[1],c=a*r+i*o;return[a*o-i*r+t[0],c+t[1]]}function at(e,t,n){return Ke(e,Qe(Ze(t,e),n))}function it(e,t,n){return Ke(e,Qe(t,n))}var{min:ct,PI:lt}=Math,ut=.275,st=lt+1e-4;function dt(e,t={}){return function(e,t={}){let{size:n=16,smoothing:r=.5,thinning:o=.5,simulatePressure:a=!0,easing:i=(e=>e),start:c={},end:l={},last:u=!1}=t,{cap:s=!0,easing:d=(e=>e*(2-e))}=c,{cap:f=!0,easing:h=(e=>--e*e*e+1)}=l;if(0===e.length||n<=0)return[];let p,m=e[e.length-1].runningLength,y=!1===c.taper?0:!0===c.taper?Math.max(n,m):c.taper,v=!1===l.taper?0:!0===l.taper?Math.max(n,m):l.taper,g=Math.pow(n*r,2),b=[],x=[],w=e.slice(0,10).reduce(((e,t)=>{let r=t.pressure;if(a){let o=ct(1,t.distance/n),a=ct(1,1-o);r=ct(1,e+o*ut*(a-e))}return(e+r)/2}),e[0].pressure),k=Xe(n,o,e[e.length-1].pressure,i),E=e[0].vector,O=e[0].point,C=O,A=O,P=C,S=!1;for(let t=0;t<e.length;t++){let{pressure:r}=e[t],{point:c,vector:l,distance:u,runningLength:s}=e[t];if(t<e.length-1&&m-s<3)continue;if(o){if(a){let e=ct(1,u/n),t=ct(1,1-e);r=ct(1,w+e*ut*(t-w))}k=Xe(n,o,r,i)}else k=n/2;void 0===p&&(p=k);let f=s<y?d(s/y):1,j=m-s<v?h((m-s)/v):1;k=Math.max(.01,k*Math.min(f,j));let R=(t<e.length-1?e[t+1]:e[t]).vector,_=t<e.length-1?Je(l,R):1,M=null!==_&&_<0;if(Je(l,E)<0&&!S||M){let e=Qe($e(E),k);for(let t=1/13,n=0;n<=1;n+=t)A=ot(Ze(c,e),c,st*n),b.push(A),P=ot(Ke(c,e),c,st*-n),x.push(P);O=A,C=P,M&&(S=!0);continue}if(S=!1,t===e.length-1){let e=Qe($e(l),k);b.push(Ze(c,e)),x.push(Ke(c,e));continue}let L=Qe($e(at(R,l,_)),k);A=Ze(c,L),(t<=1||tt(O,A)>g)&&(b.push(A),O=A),P=Ke(c,L),(t<=1||tt(C,P)>g)&&(x.push(P),C=P),w=r,E=l}let j=e[0].point.slice(0,2),R=e.length>1?e[e.length-1].point.slice(0,2):Ke(e[0].point,[1,1]),_=[],M=[];if(1===e.length){if(!y&&!v||u){let e=it(j,nt($e(Ze(j,R))),-(p||k)),t=[];for(let n=1/13,r=n;r<=1;r+=n)t.push(ot(e,j,2*st*r));return t}}else{if(!(y||v&&1===e.length))if(s)for(let e=1/13,t=e;t<=1;t+=e){let e=ot(x[0],j,st*t);_.push(e)}else{let e=Ze(b[0],x[0]),t=Qe(e,.5),n=Qe(e,.51);_.push(Ze(j,t),Ze(j,n),Ke(j,n),Ke(j,t))}let t=$e(function(e){return[-e[0],-e[1]]}(e[e.length-1].vector));if(v||y&&1===e.length)M.push(R);else if(f){let e=it(R,t,k);for(let t=1/29,n=t;n<1;n+=t)M.push(ot(e,R,3*st*n))}else M.push(Ke(R,Qe(t,k)),Ke(R,Qe(t,.99*k)),Ze(R,Qe(t,.99*k)),Ze(R,Qe(t,k)))}return b.concat(M,x.reverse(),_)}(function(e,t={}){var n;let{streamline:r=.5,size:o=16,last:a=!1}=t;if(0===e.length)return[];let i=.15+.85*(1-r),c=Array.isArray(e[0])?e:e.map((({x:e,y:t,pressure:n=.5})=>[e,t,n]));if(2===c.length){let e=c[1];c=c.slice(0,-1);for(let t=1;t<5;t++)c.push(at(c[0],e,t/4))}1===c.length&&(c=[...c,[...Ke(c[0],[1,1]),...c[0].slice(2)]]);let l=[{point:[c[0][0],c[0][1]],pressure:c[0][2]>=0?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],u=!1,s=0,d=l[0],f=c.length-1;for(let e=1;e<c.length;e++){let t=a&&e===f?c[e].slice(0,2):at(d.point,c[e],i);if(et(d.point,t))continue;let n=rt(t,d.point);if(s+=n,e<f&&!u){if(s<o)continue;u=!0}d={point:t,pressure:c[e][2]>=0?c[e][2]:.5,vector:nt(Ze(d.point,t)),distance:n,runningLength:s},l.push(d)}return l[0].vector=(null==(n=l[1])?void 0:n.vector)||[0,0],l}(e,t),t)}function ft(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var o,a,i,c,l,u,s,d,f,h=e._root,p={data:r},m=e._x0,y=e._y0,v=e._x1,g=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((u=t>=(a=(m+v)/2))?m=a:v=a,(s=n>=(i=(y+g)/2))?y=i:g=i,o=h,!(h=h[d=s<<1|u]))return o[d]=p,e;if(c=+e._x.call(null,h.data),l=+e._y.call(null,h.data),t===c&&n===l)return p.next=h,o?o[d]=p:e._root=p,e;do{o=o?o[d]=new Array(4):e._root=new Array(4),(u=t>=(a=(m+v)/2))?m=a:v=a,(s=n>=(i=(y+g)/2))?y=i:g=i}while((d=s<<1|u)==(f=(l>=i)<<1|c>=a));return o[f]=h,o[d]=p,e}var ht=function(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o};function pt(e){return e[0]}function mt(e){return e[1]}function yt(e,t,n){var r=new vt(null==t?pt:t,null==n?mt:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function vt(e,t,n,r,o,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=o,this._y1=a,this._root=void 0}function gt(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var bt=yt.prototype=vt.prototype;bt.copy=function(){var e,t,n=new vt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=gt(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var o=0;o<4;++o)(t=r.source[o])&&(t.length?e.push({source:t,target:r.target[o]=new Array(4)}):r.target[o]=gt(t));return n},bt.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return ft(this.cover(t,n),t,n,e)},bt.addAll=function(e){var t,n,r,o,a=e.length,i=new Array(a),c=new Array(a),l=1/0,u=1/0,s=-1/0,d=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(i[n]=r,c[n]=o,r<l&&(l=r),r>s&&(s=r),o<u&&(u=o),o>d&&(d=o));if(l>s||u>d)return this;for(this.cover(l,u).cover(s,d),n=0;n<a;++n)ft(this,i[n],c[n],e[n]);return this},bt.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,o=this._x1,a=this._y1;if(isNaN(n))o=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var i,c,l=o-n,u=this._root;n>e||e>=o||r>t||t>=a;)switch(c=(t<r)<<1|e<n,(i=new Array(4))[c]=u,u=i,l*=2,c){case 0:o=n+l,a=r+l;break;case 1:n=o-l,a=r+l;break;case 2:o=n+l,r=a-l;break;case 3:n=o-l,r=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=o,this._y1=a,this},bt.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},bt.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},bt.find=function(e,t,n){var r,o,a,i,c,l,u,s=this._x0,d=this._y0,f=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new ht(m,s,d,f,h)),null==n?n=1/0:(s=e-n,d=t-n,f=e+n,h=t+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(o=l.x0)>f||(a=l.y0)>h||(i=l.x1)<s||(c=l.y1)<d))if(m.length){var y=(o+i)/2,v=(a+c)/2;p.push(new ht(m[3],y,v,i,c),new ht(m[2],o,v,y,c),new ht(m[1],y,a,i,v),new ht(m[0],o,a,y,v)),(u=(t>=v)<<1|e>=y)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var g=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),x=g*g+b*b;if(x<n){var w=Math.sqrt(n=x);s=e-w,d=t-w,f=e+w,h=t+w,r=m.data}}return r},bt.remove=function(e){if(isNaN(a=+this._x.call(null,e))||isNaN(i=+this._y.call(null,e)))return this;var t,n,r,o,a,i,c,l,u,s,d,f,h=this._root,p=this._x0,m=this._y0,y=this._x1,v=this._y1;if(!h)return this;if(h.length)for(;;){if((u=a>=(c=(p+y)/2))?p=c:y=c,(s=i>=(l=(m+v)/2))?m=l:v=l,t=h,!(h=h[d=s<<1|u]))return this;if(!h.length)break;(t[d+1&3]||t[d+2&3]||t[d+3&3])&&(n=t,f=d)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(o=h.next)&&delete h.next,r?(o?r.next=o:delete r.next,this):t?(o?t[d]=o:delete t[d],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[f]=h:this._root=h),this):(this._root=o,this)},bt.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},bt.root=function(){return this._root},bt.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},bt.visit=function(e){var t,n,r,o,a,i,c=[],l=this._root;for(l&&c.push(new ht(l,this._x0,this._y0,this._x1,this._y1));t=c.pop();)if(!e(l=t.node,r=t.x0,o=t.y0,a=t.x1,i=t.y1)&&l.length){var u=(r+a)/2,s=(o+i)/2;(n=l[3])&&c.push(new ht(n,u,s,a,i)),(n=l[2])&&c.push(new ht(n,r,s,u,i)),(n=l[1])&&c.push(new ht(n,u,o,a,s)),(n=l[0])&&c.push(new ht(n,r,o,u,s))}return this},bt.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new ht(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var o=t.node;if(o.length){var a,i=t.x0,c=t.y0,l=t.x1,u=t.y1,s=(i+l)/2,d=(c+u)/2;(a=o[0])&&n.push(new ht(a,i,c,s,d)),(a=o[1])&&n.push(new ht(a,s,c,l,d)),(a=o[2])&&n.push(new ht(a,i,d,s,u)),(a=o[3])&&n.push(new ht(a,s,d,l,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},bt.x=function(e){return arguments.length?(this._x=e,this):this._x},bt.y=function(e){return arguments.length?(this._y=e,this):this._y};var xt=n(62),wt=n.n(xt),kt=n(34),Et=n.n(kt),Ot=n(0),Ct=n.n(Ot),At=n(8),Pt=n.n(At),St=n(11),jt=n.n(St),Rt=(n(95),n(38)),_t=(n(61),n(23)),Mt=n(44),Lt=n.n(Mt),Tt=(n(537),n(265)),Dt=(n(145),n(42)),Nt=(n(98),n(37)),Bt=(n(454),n(161)),It=(n(3463),n(3696)),Ft=(n(183),n(104)),qt=(n(230),n(65)),zt=(n(1414),n(510)),Gt=(n(293),n(124)),Yt=(n(882),n(461)),Ht=(n(84),n(45)),Vt=(n(394),n(259));function Ut(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-viewport-container *::selection {\n  background-color: rgba(52, 155, 249, 0.15) !important;\n  color: inherit !important;\n}\n.lake-user-select-none {\n  user-select: none;\n}\n.lake-diagram-mindmap-root::selection {\n  background-color: var(--yq-blue-1) !important;\n}\n.selection-transparent::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n.selection-transparent *::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n");var Wt=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children};if(!1!==n(t,arguments.length>3?arguments[3]:void 0,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)){var o=r(t);if(o)for(var a=0;a<o.length;a++)e(o[a],n,r,t,a)}},Xt=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=r(t);if(a)for(var i=0;i<a.length;i++)!1!==n(a[i],t,o)&&e(a[i],n,r,i)};function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $t(e,t){var n,r=-1/0;if(void 0===t){var o,a=Zt(e);try{for(a.s();!(o=a.n()).done;)null!=(n=o.value)&&r<n&&(r=n)}catch(e){a.e(e)}finally{a.f()}}else{var i,c=-1,l=Zt(e);try{for(l.s();!(i=l.n()).done;)null!=(n=t(n=i.value,++c,e))&&r<n&&(r=n)}catch(e){l.e(e)}finally{l.f()}}return r}function Jt(e,t,n){return e<t?t:e>n?n:e}function en(e,t){for(var n,r=-1/0,o=0;o<e.length;o++){var a=e[o],i=t?a[t]:a;i>r&&(r=i,n=a)}return n}function tn(e,t){var n=t(e);return e.children&&(n.children=[],e.children.forEach((function(e){n.children&&n.children.push(tn(e,t))}))),n}function nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return e<t?t:e>n?n:e}function rn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return e>=t[0]-n&&e<=t[1]+n}function on(e,t){return Object.values(e.reduce((function(e,n){return(e[n[t]]=e[n[t]]||[]).push(n),e}),{}))}function an(e){return e.filter((function(e,t,n){return n.indexOf(e,0)===t}))}function cn(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function ln(e,t,n){if(n>=e.length)for(var r=n-e.length+1;r--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}function un(e){for(var t,n,r=arguments.length<=1?0:arguments.length-1;r>=1&&e.length;){var o;for(t=(o=1+--r)<1||arguments.length<=o?void 0:arguments[o];-1!==(n=e.indexOf(t));)e.splice(n,1)}return t}function sn(e,t){t.sort();for(var n=t.length-1;n>=0;n--)e.splice(t[n],1)}function dn(e,t){e.indexOf(t)<0&&e.push(t)}function fn(e,t){e.children?e.children.push(t):e.children=[t]}function hn(e,t,n,r){for(var o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return void 0===e};e&&e!==n&&a(o);)o=t(e),e=r(e);return o}function pn(e,t){Object.keys(t).forEach((function(n){var r,o=t[n];if("font-size"===n&&null!==(r=t["font-family"])&&void 0!==r&&r.includes("shouxie")){var a=parseInt(o);a<92&&(o=a+2+"px")}e.style[n]=o}))}function mn(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(t){var n=t.query,r=t.css;"self"!==n?e.querySelectorAll(n).forEach((function(e){pn(e,r)})):pn(e,r)}))}function yn(e,t){var n={};return Object.keys(t).forEach((function(r){var o=t[r];!0===o?n[r]=u()(e[r]):d()(t[r])&&d()(e[r])&&o&&(n[r]=yn(e[r],o))})),n}function vn(e,t,n){var r={};return e&&n?t?(n.forEach((function(n){e[n]!==t[n]&&(r[n]=e[n])})),r):function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e):r}function gn(e,t){return h()(e,t,(function(e,t){return void 0!==e||d()(t)?e:null}))}function bn(e,t){var n="object"===a()(e)?e:c()({},e,t),r={},o=function(e){e.split(".").reduce((function(t,r,o,a){return t[r]=o+1===a.length?n[e]:{}}),r)};for(var i in n)o(i);return r}var xn=Object.freeze({__proto__:null,max:$t,min:function(e,t){var n,r=1/0;if(void 0===t){var o,a=Zt(e);try{for(a.s();!(o=a.n()).done;)null!=(n=o.value)&&r>n&&(r=n)}catch(e){a.e(e)}finally{a.f()}}else{var i,c=-1,l=Zt(e);try{for(l.s();!(i=l.n()).done;)null!=(n=t(n=i.value,++c,e))&&r>n&&(r=n)}catch(e){l.e(e)}finally{l.f()}}return r},limitValue:Jt,findMaxObjBy:en,buildTree:tn,getValue:nn,between:rn,groupBy:on,arrayUnique:an,arrayEqual:cn,arrayMove:ln,removeArray:un,removeMultiple:sn,push:dn,append:fn,closest:hn,setStyleSheets:mn,pick:yn,diff:vn,mergeUndefinedToNull:gn,makeChangeModel:bn});function wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wn(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var En=function(e,t){var n=["x","y"].map((function(n){return e[n]+2*(t[n]-e[n])})),r=b()(n,2);return{x:r[0],y:r[1]}},On=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},Cn=function(e,t){var n=ri(t),r=Math.sin(n),o=Math.cos(n),a=e.x,i=e.y;return{x:a*o-i*r,y:a*r+i*o}},An=function(e,t,n){var r={x:e.x-t.x,y:e.y-t.y},o=Cn(r,n);return{x:o.x+t.x,y:o.y+t.y}},Pn=function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},Sn=function(e){var t=e.x,n=e.y;return{x:t+e.w/2,y:n+e.h/2}},jn=function(e){var t=e.x,n=e.y;return 180*Math.atan2(n,t)/Math.PI},Rn=function(e,t,n){var r={x:t.x-e.x,y:t.y-e.y},o={x:n.x-e.x,y:n.y-e.y},a=jn(r);return jn(o)-a},_n=function(e,t){var n=t.x,r=t.y,o=b()(e,2),a=o[0],i=o[1];if(oi(a.x,i.x))return{x:a.x,y:r};if(oi(a.y,i.y))return{x:n,y:a.y};var c=li(a.x,a.y,i.x,i.y),l=-1/c,u=(c*a.x+r-a.y-l*n)/(c-l);return{x:u,y:a.y-c*(a.x-u)}},Mn=function(){function e(t){m()(this,e),c()(this,"rect",void 0),c()(this,"_tl",void 0),c()(this,"_tr",void 0),c()(this,"_br",void 0),c()(this,"_bl",void 0),c()(this,"_tc",void 0),c()(this,"_bc",void 0),c()(this,"_rc",void 0),c()(this,"_lc",void 0),c()(this,"_center",void 0),this.rect=t,this._tl=null,this._tr=null,this._br=null,this._bl=null,this._tc=null,this._bc=null,this._rc=null,this._lc=null,this._center=null}return v()(e,[{key:"center",get:function(){return this._center||(this._center=Sn(this.rect)),this._center}},{key:"tl",get:function(){if(!this._tl){var e=this.rect,t=e.x,n=e.y,r=e.r;this._tl=An({x:t,y:n},this.center,r)}return this._tl}},{key:"tr",get:function(){if(!this._tr){var e=this.rect,t=e.x,n=e.y,r=e.w,o=e.r;this._tr=An({x:t+r,y:n},this.center,o)}return this._tr}},{key:"br",get:function(){return this._br||(this._br=En(this.tl,this.center)),this._br}},{key:"bl",get:function(){return this._bl||(this._bl=En(this.tr,this.center)),this._bl}},{key:"tc",get:function(){return this._tc||(this._tc=On(this.tl,this.tr)),this._tc}},{key:"bc",get:function(){return this._bc||(this._bc=On(this.br,this.bl)),this._bc}},{key:"rc",get:function(){return this._rc||(this._rc=On(this.tr,this.br)),this._rc}},{key:"lc",get:function(){return this._lc||(this._lc=On(this.tl,this.bl)),this._lc}}]),e}();function Ln(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return 0!==t?[1/t*e[0],1/t*e[1]]:t}function Tn(e,t){return(t-e)/3}function Dn(e,t){var n=0,r=0;return function(e,t){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)}(e,t)?n=Tn(e.x,t.x):r=Tn(e.y,t.y),{x:e.x+n,y:e.y+r}}function Nn(e,t){var n=Dn(e,t),r=Dn(t,e);return["C",n.x,n.y,r.x,r.y,t.x,t.y]}function Bn(e,t){var n={x:-1,y:-1},r=t.connection;return r&&("string"===a()(r)?n=e.anchors.filter((function(e){return e.name===r}))[0]:Array.isArray(r)&&(n={x:r[0],y:r[1]})),{width:e.width,height:e.height,theta:e.rotate,port:n}}function In(e,t,n,r){var o,a,i=e.width,c=e.height,l=e.port,u=e.theta,s=l.x,d=l.y;if(0===s&&0===d||1===s&&1===d||0===s&&1===d||1===s&&0===d)return o=[n.x-t.x,n.y-t.y],a=Math.sqrt(Math.pow(i,2)+Math.pow(c,2))/3,{direction:Ln(o),offset:Math.max(a,36)};var f=Ln([n.x-t.x,n.y-t.y]);return 0===s&&d>0&&d<1?(o=0===u?[-1,0]:f,a=Math.abs(Math.abs(n.x)-Math.abs(r.x))):1===s&&d>0&&d<1?(o=0===u?[1,0]:f,a=Math.abs(Math.abs(n.x)-Math.abs(r.x))):0===d&&s>0&&s<1?(o=0===u?[0,-1]:f,a=Math.abs(Math.abs(n.y)-Math.abs(r.y))):1===d&&s>0&&s<1?(o=0===u?[0,1]:f,a=Math.abs(Math.abs(n.y)-Math.abs(r.y))):(o=f,a=Math.abs(n.y-r.y)),a/=2,{direction:o,offset:Math.max(a,32)}}function Fn(e){var t=e.source,n=e.target,r=e.diagram,o=[],a=r.find(t.id),i=r.find(n.id),c=e.getPoints(),l=c[0],u=c[1];if(!a&&!i){var s=Nn(c[0],c[1]);return o.push(s),o}if(a&&i){var d=Bn(a,t),f=Bn(i,n),h=a.percentage2Canvas({x:.5,y:.5}),p=i.percentage2Canvas({x:.5,y:.5}),m=In(d,h,l,u),y=In(f,p,u,l),v=[l.x+m.direction[0]*m.offset,l.y+m.direction[1]*m.offset],g=[u.x+y.direction[0]*y.offset,u.y+y.direction[1]*y.offset];return[["C",v[0],v[1],g[0],g[1],u.x,u.y]]}if(!a&&i){var b=In(Bn(i,n),i.percentage2Canvas({x:.5,y:.5}),u,l),x=Nn(c[0],c[1]);return x[3]=u.x+b.direction[0]*b.offset,x[4]=u.y+b.direction[1]*b.offset,o.push(x),o}var w=In(Bn(a,t),a.percentage2Canvas({x:.5,y:.5}),l,u),k=Nn(c[0],c[1]);return k[1]=l.x+w.direction[0]*w.offset,k[2]=l.y+w.direction[1]*w.offset,o.push(k),o}function qn(e){for(var t=[],n=[0,.25,.5,.75],r=0;r<e.length-1;r++){var o=e[r-1],a=e[r],i=e[r+1],c=e[r+2];void 0===o&&(o={x:2*a.x-i.x,y:2*a.y-i.y}),void 0===c&&(c={x:2*i.x-a.x,y:2*i.y-a.y}),n[1]=Math.pow(ui(o.x,o.y,a.x,a.y),1)+n[0],n[2]=Math.pow(ui(a.x,a.y,i.x,i.y),1)+n[1],n[3]=Math.pow(ui(i.x,i.y,c.x,c.y),1)+n[2];var l=[(n[2]-n[1])/(n[2]-n[0]),(n[1]-n[0])/(n[2]-n[0]),(n[3]-n[2])/(n[3]-n[1]),(n[2]-n[1])/(n[3]-n[1])],u=[(n[2]-n[1])*(l[0]*(a.x-o.x)/(n[1]-n[0])+l[1]*(i.x-a.x)/(n[2]-n[1])),(n[2]-n[1])*(l[0]*(a.y-o.y)/(n[1]-n[0])+l[1]*(i.y-a.y)/(n[2]-n[1]))],s=[(n[2]-n[1])*(l[2]*(i.x-a.x)/(n[2]-n[1])+l[3]*(c.x-i.x)/(n[3]-n[2])),(n[2]-n[1])*(l[2]*(i.y-a.y)/(n[2]-n[1])+l[3]*(c.y-i.y)/(n[3]-n[2]))];t.push(["C",a.x+u[0]/3,a.y+u[1]/3,i.x-s[0]/3,i.y-s[1]/3,i.x,i.y])}return t}function zn(e){if(Array.isArray(e)){var t=w()(e);return[t[0],t.slice(1).join()].join("")}var n=e.name,r=e.x,o=e.y;switch(n.toLowerCase()){case"m":case"l":return n+[r,o].join();case"h":case"v":return n+r;case"z":return n;case"a":var a=e.xAxisRotation,i=e.largeArcFlag,c=e.sweepFlag;return n+[e.rx,e.ry,a,i,c,r,o].join();case"c":return n+[e.x1,e.y1,e.x2,e.y2,e.x,e.y].join();case"q":return n+[e.x1,e.y1,e.x,e.y].join();default:throw new Error("unknown path command: ".concat(n))}}function Gn(e){return e.map(zn).join("")}function Yn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return Gn([["M",e-n,t],["a",n,r,0,1,0,2*n,0],["a",n,r,0,1,0,-2*n,0],["Z"]])}function Hn(e,t,n){return Yn(e,t,n)}function Vn(e,t,n){var r=[],o=t[0],a=t[t.length-1],i=e[0],c=e[e.length-1];if(!i&&!i)return[];"V"===i[i.length-1]?r.push(["L",o.x,i[1]]):r.push(["L",i[0],o.y]);for(var l=1;l<e.length;l++){var u=e[l-1],s=e[l];"V"===s[s.length-1]?r.push(["L",u[0],s[1]]):r.push(["L",s[0],u[1]])}"V"===c[c.length-1]?r.push(["L",a.x,c[1]]):r.push(["L",c[0],a.y]);var d=r;n&&(d=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=e[n+1];r&&o&&ai(r.slice(1),o.slice(1),2)?n+=1:t.push(r)}return t}(r)),d.unshift(["M",o.x,o.y]);var f=d[d.length-1];if(oi(f[1],t[t.length-1].x,.65)&&oi(f[f.length-1],t[t.length-1].y,.65)?d[d.length-1]=["L",t[t.length-1].x,t[t.length-1].y]:oi(f[1],t[t.length-1].x)&&oi(f[f.length-1],t[t.length-1].y)||d.push(["L",t[t.length-1].x,t[t.length-1].y]),d.length>1){var h=d[0],p=d[1];oi(h[1],p[1],.65)&&oi(h[h.length-1],p[p.length-1],.65)&&d.splice(1,1)}return d}function Un(e,t,n,r,o,a,i,c){return Gn([["M",e,t],["L",n,t],["L",n,r],["L",e,r],["Z"],["M",o,a],["L",o,c],["L",i,c],["L",i,a],["Z"]])}function Wn(e,t,n,r){return Gn([["M",e,t],["L",n,r]])}var Xn="\t\n\v\f\r   ᠎             　\u2028\u2029",Kn=new RegExp("([a-z])["+Xn+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Xn+"]*,?["+Xn+"]*)+)","ig"),Zn=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Xn+"]*,?["+Xn+"]*","ig");function Qn(e){if(!e)return null;if(Array.isArray(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return(e=String(e)).replace(Kn,(function(e,r,o){var a=[],i=r.toLowerCase();if(o.replace(Zn,(function(e,t){t&&a.push(+t)})),"m"===i&&a.length>2&&(n.push([r].concat(a.splice(0,2))),i="l",r="m"===r?"l":"L"),"o"===i&&1===a.length&&n.push([r,a[0]]),"r"===i)n.push([r].concat(a));else for(;a.length>=t[i]&&(n.push([r].concat(a.splice(0,t[i]))),t[i]););return""})),n}function $n(e){return Gn(e.map((function(e,t){return[0===t?"M":"L",e.x,e.y]})))}function Jn(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o;return Gn(o?[["M",+e+ +o,t],["l",n-2*o,0],["a",o,a,0,0,1,o,a],["l",0,r-2*a],["a",o,a,0,0,1,-o,a],["l",2*o-n,0],["a",o,a,0,0,1,-o,-a],["l",0,2*a-r],["a",o,a,0,0,1,o,-a],["z"]]:[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]])}function er(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?er(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nr(e){for(var t,n=/([mlhvcsqtaz])/gi,r=e.replace(n," $1 ").trim().split(/[ ,]+/),o=[],a=0;a<r.length;a++){var i=r[a];n.test(i)?(t&&o.push(t),t=[i]):t.push(parseFloat(i))}return o}function rr(e,t,n){return"string"==typeof e&&(e=nr(e)),e.map((function(e){return function(e,t,n){switch(Array.isArray(e)&&(e=function(e){var t=w()(e),n=t[0],r=t.slice(1);switch(n.toLowerCase()){case"m":case"l":var o=b()(r,2);return{name:n,x:o[0],y:o[1]};case"a":var a=b()(r,7);return{name:n,rx:a[0],ry:a[1],xAxisRotation:a[2],largeArcFlag:a[3],sweepFlag:a[4],x:a[5],y:a[6]};case"c":var i=b()(r,6);return{name:n,x1:i[0],y1:i[1],x2:i[2],y2:i[3],x:i[4],y:i[5]};case"q":var c=b()(r,4);return{name:n,x1:c[0],y1:c[1],x:c[2],y:c[3]};default:return{name:n}}}(e)),e.name.toLowerCase()){case"m":case"l":var r=e,o=r.x,a=r.y;return tr(tr({},e),{},{x:o*t,y:a*n});case"a":var i=e,c=i.x,l=i.y,u=i.rx,s=i.ry;return tr(tr({},e),{},{x:c*t,y:l*n,rx:u*t,ry:s*n});case"c":var d=e,f=d.x1,h=d.y1,p=d.x2,m=d.y2,y=d.x,v=d.y;return tr(tr({},e),{},{x1:f*t,y1:h*n,x2:p*t,y2:m*n,x:y*t,y:v*n});case"q":var g=e,x=g.x1,k=g.y1,E=g.x,O=g.y;return tr(tr({},e),{},{x1:x*t,y1:k*n,x:E*t,y:O*n});default:return e}}(e,t,n)}))}var or=Object.freeze({__proto__:null,parsePathString:Qn,formatPath:Gn,rectPath:Jn,polylinePath:$n,ellipsePath:Yn,circlePath:Hn,catmullRomPath:qn,elbowPath:Vn,bezierPath:Fn,huiPath:Un,linePath:Wn,inflatePath:nr,scalePath:rr});function ar(){var e=[],t=arguments.length<=0?void 0:arguments[0];Array.isArray(t)?e.push(t):e.push([t]);for(var n=1;n<arguments.length;n++)if(t=n<0||arguments.length<=n?void 0:arguments[n],Array.isArray(t))e.push(t);else{for(var r=[],o=0;o<e[0].length;o++)r.push(t);e.push(r)}return e}var ir,cr=Object.freeze({__proto__:null,convertBatch:ar}),lr=function(e){return null==e?void 0:e.isText},ur=function(e){return null==e?void 0:e.isLine},sr=function(e){return null==e?void 0:e.isVertex},dr=function(e){return null==e?void 0:e.isDsl},fr=function(e){return null==e?void 0:e.isDslCell},hr=function(e){return null==e?void 0:e.isGroup},pr=function(e){return null==e?void 0:e.isBoardCell},mr=function(e){return null==e?void 0:e.isMindmap},yr=function(e){return null==e?void 0:e.isGeometry},vr=function(e){return null==e?void 0:e.isSwimlane},gr=function(e){return null==e?void 0:e.isSwimlaneCell},br=function(e){return null==e?void 0:e.isStack},xr=function(e){return null==e?void 0:e.isStackCell},wr=function(e){return null==e?void 0:e.isFreeHand},kr=function(e){return null==e?void 0:e.isPen},Er=function(e){return null==e?void 0:e.isPoints},Or=function(e){return{minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}},Cr=function(e){var t=new Mn(e),n=t.tl,r=t.tr,o=t.bl,a=t.br;return{minX:Math.min(n.x,r.x,o.x,a.x),minY:Math.min(n.y,r.y,o.y,a.y),maxX:Math.max(n.x,r.x,o.x,a.x),maxY:Math.max(n.y,r.y,o.y,a.y)}};function Ar(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e.getBBox()},n=e.reduce((function(e,n){var r=t(n),o=[r.x,r.y],a=[[o[0],o[1]],[o[0]+r.width,o[1]+r.height]];return e.push.apply(e,a),e}),[]),r=n.reduce((function(e,t){return t[0]>e?t[0]:e}),n[0][0]),o=n.reduce((function(e,t){return t[0]<e?t[0]:e}),n[0][0]),a=n.reduce((function(e,t){return t[1]>e?t[1]:e}),n[0][1]),i=n.reduce((function(e,t){return t[1]<e?t[1]:e}),n[0][1]);return{minX:o,minY:i,maxX:r,maxY:a}}var Pr=(c()(ir={"无法导出手绘字体，可能导致图片失真":"Hand-drawn fonts cannot be exported, which may cause image distortion","画布尺寸过大，导出图片失败":"The canvas size is too large, and the image export fails","未命名":"unnamed","与编辑一致":"Same as Edition","阅读页配置":"Setting","默认视口":"Default Viewport"," 粘贴":" paste",ER:"ER",UML:"UML","三角形":"Triangle","上下居中":"Align vertically","上传素材中":"Uploading Material","上传素材图片失败":"Failed to upload material image","上移":"Forward","上移一层":"Bring Forward","下移":"Backward","下移一层":"Bring Backward","不透明度":"Opacity"},"与编辑一致","WYSIWYG"),c()(ir,"云","cloud"),c()(ir,"五角星","star"),c()(ir,"五边形","Polygon"),c()(ir,"五边箭头","pentagon-arrow"),c()(ir,"位置","Position"),c()(ir,"使用","Use"),c()(ir,"使用说明","Instructions"),c()(ir,"保存","Save"),c()(ir,"保持宽高比","Constrain proportions"),c()(ir,"全局","Global"),c()(ir,"全部概化","Total generalization"),c()(ir,"关系","Relationship"),c()(ir,"内部存储","Internal Storage"),c()(ir,"决策","Decision"),c()(ir,"准备","Preparation"),c()(ir,"分支","Choice"),c()(ir,"分支类型","Branch type"),c()(ir,"分支粗细","Branch thickness"),c()(ir,"分支线条宽度逐渐变细","Tapered line"),c()(ir,"分支颜色","Line Color"),c()(ir,"删除","Delete"),c()(ir,"删除单个节点","Delete a single node"),c()(ir,"删除泳道","Delete Lane"),c()(ir,"前进","Forward"),c()(ir,"剪切","Cut"),c()(ir,"剪切失败","Cut failed"),c()(ir,"剪切成功","Cut successfully"),c()(ir,"副标题","Subtitle"),c()(ir,"加粗","Bold"),c()(ir,"包","Package"),c()(ir,"十字","Cross"),c()(ir,"卡片","Card"),c()(ir,"历史","Histroy Pseudostate"),c()(ir,"原始大小","Original size"),c()(ir,"双击画布快速添加","Double click to directly add"),c()(ir,"双向箭头","Arrow 3"),c()(ir,"发送信号","Send Signal"),c()(ir,"取消成组","Ungroup"),c()(ir,"另存为图片","Save as picture"),c()(ir,"可设置颜色、布局、文字等样式","Can set color, layout, text and other styles"),c()(ir,"右对齐","Right"),c()(ir,"右箭头","Arrow 2"),c()(ir,"合并","Merge"),c()(ir,"同步","Fork"),c()(ir,"同级","same level"),c()(ir,"后退","Backward"),c()(ir,"回到中心","Fit Page"),c()(ir,"图形","Shape"),c()(ir,"图片","Picture"),c()(ir,"图片上传中，请稍候","Picture uploading, please wait"),c()(ir,"圆形","Circle"),c()(ir,"圆角半径","Corner radius"),c()(ir,"圆角矩形","Rounded Rectangle"),c()(ir,"垂直均分","Distribute vertically"),c()(ir,"垂直居中","Align vertically"),c()(ir,"基础图形","Basic"),c()(ir,"基础格式","Basic Format"),c()(ir,"填充","Fill"),c()(ir,"填充颜色","Fill"),c()(ir,"备注","Note"),c()(ir,"复制","Copy"),c()(ir,"复制为其它格式","Copy to other formats"),c()(ir,"复制失败","Copy failed"),c()(ir,"复制成功","Copy successfully"),c()(ir,"多个值","multiValue"),c()(ir,"多值属性",""),c()(ir,"多文档","Multi Document"),c()(ir,"多类例","Multiplicity"),c()(ir,"大小","Size"),c()(ir,"大标题","Title"),c()(ir,"子级","Child"),c()(ir,"字号","Font size"),c()(ir,"字色","Font Color"),c()(ir,"存储数据","Stored Data"),c()(ir,"实体","Entity"),c()(ir,"实际尺寸","Actual size"),c()(ir,"宽","Widht"),c()(ir,"宽度","Width"),c()(ir,"对象","Object"),c()(ir,"对齐","Alignment"),c()(ir,"对齐方式","Alignment"),c()(ir,"导出素材图片失败","Failed to export stock image"),c()(ir,"小标题","Title small"),c()(ir,"层级","Level"),c()(ir,"展开","Expand"),c()(ir,"展开工具栏","Expand Toolbar"),c()(ir,"展开节点","Expand topic"),c()(ir,"属性","Attributes"),c()(ir,"左右居中","Align horizontally"),c()(ir,"左对齐","Left"),c()(ir,"左箭头","Arrow 1"),c()(ir,"已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ","The copied content of the current page has been pasted. If you need to paste the content outside the page, please use"),c()(ir,"布局","Layout"),c()(ir,"平行四边形","Parallelogram"),c()(ir,"并行模式","Parallel"),c()(ir,"幻灯片布局","Slide layout"),c()(ir,"底对齐","Bottom"),c()(ir,"底部对齐","Bottom"),c()(ir,"延迟","Delay"),c()(ir,"开始","Start"),c()(ir,"弱关系","Weak Relationship"),c()(ir,"弱实体","Weak Entity"),c()(ir,"形状","Shape"),c()(ir,"彩虹分支","Multi-colored lines"),c()(ir,"循环起止符","Loop Limit"),c()(ir,"思维导图","Mindmap"),c()(ir,"成组","Group"),c()(ir,"或者","Or"),c()(ir,"所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。","All icon materials come from the iconfont platform and are only for the communication and learning of the majority of users, and may not be used for any commercial purposes without the written authorization of iconfont or its affiliates."),c()(ir,"手动循环","Manual loop"),c()(ir,"手动设置节点宽度","Fixed size"),c()(ir,"手动设置节点尺寸","Custom size"),c()(ir,"手动输入","Manual Input"),c()(ir,"打开设置","Setting"),c()(ir,"批注","Annotation"),c()(ir,"折叠","Collapse"),c()(ir,"折叠节点","Collapse topic"),c()(ir,"拖拽","Drag"),c()(ir,"排列","Arrange"),c()(ir,"排序","Sort"),c()(ir,"接口","Interface"),c()(ir,"接收信号","Receive Signal"),c()(ir,"控制","Control"),c()(ir,"推荐素材","Recommended material"),c()(ir,"描边","Stroke"),c()(ir,"插入","Insert"),c()(ir,"插入 Iconfont","Insert Iconfont"),c()(ir,"插入主节点","Insert root topic"),c()(ir,"插入同级","Insert sibling"),c()(ir,"插入同级节点","Insert topic"),c()(ir,"插入图片","Insert image"),c()(ir,"插入子级","Insert child"),c()(ir,"插入子节点","Insert subtopic"),c()(ir,"插入父级","Insert parent"),c()(ir,"插入连线","Inset line"),c()(ir,"插入链接","Insert link"),c()(ir,"搜索结果为空","Search results are empty"),c()(ir,"撤销","Undo"),c()(ir,"数据","Data"),c()(ir,"数据库","Storage"),c()(ir,"整理","Collate"),c()(ir,"文字样式","Text Style"),c()(ir,"文本","Text"),c()(ir,"文本颜色","Font color"),c()(ir,"文档","Document"),c()(ir,"新建节点","New Node"),c()(ir,"旋转","Rotate"),c()(ir,"旋转角度","Rotate angle"),c()(ir,"无颜色","No color"),c()(ir,"时间信号","Frequency"),c()(ir,"星形","Star"),c()(ir,"显示","Display"),c()(ir,"暂时无法从 iconfont 获取资源","Temporarily unable to get resources from iconfont"),c()(ir,"更多 >","More >"),c()(ir,"最近使用","Recently Used"),c()(ir,"条带","Paper Tape"),c()(ir,"标注","Comment"),c()(ir,"标注 2","Annotation 2"),c()(ir,"样式","Styles"),c()(ir,"格式","Format"),c()(ir,"格式面板","Format panel"),c()(ir,"框选后，右键添加到素材库","After frame selection, right click and add to material library"),c()(ir,"梯形","Trapezoid"),c()(ir,"概化","Generalization"),c()(ir,"正文","Text"),c()(ir,"步骤一：框选需要添加的内容","Step 1: Box to select the content to be added"),c()(ir,"步骤二：右键打开面板，选择“添加到素材库”","Step 2: Right-click to open the panel and select 'Add to Material Library'"),c()(ir,"水平均分","Distribute horizontally"),c()(ir,"水平对齐","Horizontal Alignment"),c()(ir,"汇总连接","Summing Junction"),c()(ir,"注释","Annotation"),c()(ir,"泳道","Swimlane"),c()(ir,"泳道垂直","Vertical Swimlane"),c()(ir,"泳道水平","horizontal Swimlane"),c()(ir,"泳道数","Lane Number"),c()(ir,"活动","Activity"),c()(ir,"活动类","Activity Class"),c()(ir,"派生属性","Derived Attribute"),c()(ir,"流程图","Flowchart"),c()(ir,"流程图图形","Flowchart Graphics"),c()(ir,"流程箭头","process-arrow"),c()(ir,"流终止","Termination Pseudostate"),c()(ir,"添加到素材库","Add to material library"),c()(ir,"添加图形","Insert Geometry"),c()(ir,"添加思维导图","Insert Mindmap"),c()(ir,"添加文字","Insert Text"),c()(ir,"添加自定义素材","Add custom material"),c()(ir,"添加连线","Insert Line"),c()(ir,"添加链接","Insert Link"),c()(ir,"激活","Activation"),c()(ir,"点击选中元素","Click on the selected element"),c()(ir,"父级","Parent"),c()(ir,"版权说明","Copyright statement"),c()(ir,"状态","State"),c()(ir,"用例","Use Case"),c()(ir,"矩形","Rectangle"),c()(ir,"硬盘","Hard Disk"),c()(ir,"竖直对齐","Vertical Alignment"),c()(ir,"端点","End Point"),c()(ir,"简单类","Simple Class"),c()(ir,"类","Class"),c()(ir,"类型","Type"),c()(ir,"粗细","Line Width"),c()(ir,"粘贴","Paste"),c()(ir,"粘贴失败","Paste failed"),c()(ir,"素材库","Material Lib"),c()(ir,"素材版权说明","Material copyright statement"),c()(ir,"约束","Constraint"),c()(ir,"线条","Line"),c()(ir,"线条/边框","Line/Border"),c()(ir,"线条样式","Line style"),c()(ir,"线条端点","Line Endpoint"),c()(ir,"线条类型","Line Shape"),c()(ir,"线条粗细","Line Width"),c()(ir,"线条颜色","Line Color"),c()(ir,"直线","Straight"),c()(ir,"曲线","Curve"),c()(ir,"折线","Elbow"),c()(ir,"组件","Component"),c()(ir,"组合片段","Frame"),c()(ir,"终点","End"),c()(ir,"绑定","Boundary"),c()(ir,"结束","Finish"),c()(ir,"结构","Structure"),c()(ir,"编辑文本","Edit text"),c()(ir,"置底","Back"),c()(ir,"置顶","Front"),c()(ir,"背景","Background"),c()(ir,"背景颜色","Background color"),c()(ir,"自动适配","Adaption"),c()(ir,"自定义素材","Custom material"),c()(ir,"节点","Node"),c()(ir,"节点填充","Fill"),c()(ir,"节点形状","Topic shape"),c()(ir,"节点描边","Stroke"),c()(ir,"菱形","Diamond"),c()(ir,"角度","Angle"),c()(ir,"角色","Actor"),c()(ir,"设置","Setting"),c()(ir,"设置面板","Properties"),c()(ir,"语雀文档","Yuque document"),c()(ir,"语雀表格","Yuque table"),c()(ir,"请搜索","Please search"),c()(ir,"起止符","Terminator"),c()(ir,"起点","Start"),c()(ir,"转换","Swap"),c()(ir,"边框","Border"),c()(ir,"边框粗细","Border thickness"),c()(ir,"边框颜色","Border color"),c()(ir,"过程","Process"),c()(ir,"连接器","Connector"),c()(ir,"连接线","Line"),c()(ir,"连线","Insert Line"),c()(ir,"适应画布","Reset View"),c()(ir,"重做","Redo"),c()(ir,"链接","Link"),c()(ir,"隐藏工具栏","Hide Toolbar"),c()(ir,"页外连接符","Off-page Connector"),c()(ir,"顶对齐","Top"),c()(ir,"顶部对齐","Top"),c()(ir,"预定义流程","Predefined Process"),c()(ir,"颜色","Color"),c()(ir,"高","Height"),c()(ir,"高度","Height"),c()(ir,"概要","Abstract"),c()(ir,"添加概要","Insert Abstract"),c()(ir,"选择","Select"),c()(ir,"画笔","Pencil"),c()(ir,"铅笔","Pencil"),c()(ir,"马克笔","Mark Pencil"),c()(ir,"橡皮","Eraser"),c()(ir,"添加标记","Insert Icon"),c()(ir,"进度","Progress"),c()(ir,"优先级","Priority"),c()(ir,"旗帜","Flag"),c()(ir,"矢量绘图","Vector Drawing"),c()(ir,"确定","confirm"),ir),Sr={locale:r.LocaleUtil.getLocale(),translations:{"en-us":Pr}};function jr(e,t){if(!e)return e;var n=Sr.locale,r=Sr.translations[n]||{};return"zh-cn"!==n&&(e=r[e]||e),e.replace(/\{([^\}]+)\}/g,(function(e,n){return t[n]||n}))}var Rr=["#A287E1","#E48484","#69B1E4","#DE81C6","#77C386","#DFB85D","#8169BF"],_r={html:"".concat(jr("思维导图")),type:"mindmap"},Mr=["priority","progress","flag"],Lr=["优先级","进度","旗帜"],Tr=[7,7,7],Dr=[["https://gw.alipayobjects.com/zos/bmw-prod/bf9b8e4b-b1d4-45b1-bafc-f22c905b7b4e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bbb05404-6149-4cd6-b234-e330d412ceff.svg","https://gw.alipayobjects.com/zos/bmw-prod/1ef71652-d5a3-48b7-9e57-de90c7aa835b.svg","https://gw.alipayobjects.com/zos/bmw-prod/4119993f-c9b6-4c2d-8a65-907840a47202.svg","https://gw.alipayobjects.com/zos/bmw-prod/61ae2c45-7c6d-40fe-a772-873e34aecc6f.svg","https://gw.alipayobjects.com/zos/bmw-prod/f9e31950-3daa-457b-a429-6da0c6f8fee0.svg","https://gw.alipayobjects.com/zos/bmw-prod/cf26510b-6d9a-43dc-9bba-67839b11c05b.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/8b4c2bef-649d-40ac-b43b-f33fd456284d.svg","https://gw.alipayobjects.com/zos/bmw-prod/3a513a92-a334-4469-98ae-3c5825d8864e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bd0e81dc-34e8-4b6f-9221-9d33371f53b9.svg","https://gw.alipayobjects.com/zos/bmw-prod/aad5a7c4-8f72-47c0-805b-6b0d239a51d5.svg","https://gw.alipayobjects.com/zos/bmw-prod/5489b9dd-20bc-464a-a064-2593db39d1df.svg","https://gw.alipayobjects.com/zos/bmw-prod/8d2d4df2-f1f0-48c6-875d-c694d01fcfad.svg","https://gw.alipayobjects.com/zos/bmw-prod/d07956ae-58ad-479a-b59d-310646dd5f37.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/01e45248-e9d6-4ac1-9018-f64b82050155.svg","https://gw.alipayobjects.com/zos/bmw-prod/ddb1da7b-5481-4d40-a9f0-d6aea06c0011.svg","https://gw.alipayobjects.com/zos/bmw-prod/566d145a-bffa-4b19-b9fd-14315c9d2fd3.svg","https://gw.alipayobjects.com/zos/bmw-prod/ba0e8dee-7014-4213-84d0-6aee48c37248.svg","https://gw.alipayobjects.com/zos/bmw-prod/d3e16f31-34bd-4269-9ef7-d04005303024.svg","https://gw.alipayobjects.com/zos/bmw-prod/ca82f31a-a2d9-4751-a8d0-d4f87771b913.svg","https://gw.alipayobjects.com/zos/bmw-prod/1a24ad93-ccd5-4fe5-a42e-f8777b933e47.svg"]],Nr=function(e,t){var n=Mr.findIndex((function(t){return t===e}));if(-1===n||t>Tr[n])throw new Error("mindmap icon type ".concat(e," or index ").concat(t," is not valid."));return Dr[n][t]},Br="https://gw.alipayobjects.com/zos/bmw-prod/3f937c7f-4274-4765-8b4c-c0321ab89d83.svg",Ir="https://gw.alipayobjects.com/zos/bmw-prod/4c2a5221-e479-4805-b4e9-f170c9edfad2.svg",Fr="Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif",qr={"line-height":!0,"font-size":!0,"text-decoration-line":!0,"font-weight":!0,"font-style":!0,"text-align":!0,"text-decoration":!0,color:!0},zr=[{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2"},fontWeight:"normal"},{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2"},fontWeight:"bold"}],Gr=[{key:"top",icon:"top",title:"顶部对齐"},{key:"middle",icon:"middle",title:"垂直居中"},{key:"bottom",icon:"bottom",title:"底部对齐"}],Yr=Gr.map((function(e){return e.key})),Hr="rgba(88, 90, 90, 0.7)",Vr={background:"#ffffff",hover:"#e7e9e8",text:"#595959",roughIconHachurefill:"#585A5A",roughIconCrossHatchfill:"#585A5A",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#BEC0BF",roughIconSolidDisablefill:"#EFF0F0"},Ur={background:"#292929",hover:"rgba(255, 255, 255, 0.12)",text:"#d0d0d0",roughIconHachurefill:"#EFF0F0",roughIconCrossHatchfill:"#EFF0F0",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#8A8F8D",roughIconSolidDisablefill:"#585A5A"},Wr=Object.freeze({__proto__:null,BTM_HREF:Br,BTN_HOVER_HREF:Ir,DEFAULT_FONT_FAMILY:Fr,INLINE_STYLE:qr,EMPTY_TEXT:"&#8203;",LOCKED_STROKE_COLOR:"#979797",DEFAULT_FONT_COLOR:"rgb(38, 38, 38)",MULTI_SELECTED_FRAME_FILL:"rgba(9, 109, 217, .05)",LOCAL_STORAGE_CLIPBOARD_DATA_KEY:"lake_diagram_clipboard_data",LOCAL_STORAGE_CUSTOM_COLORS_KEY:"lake_diagram_custom_colors",LOCAL_STORAGE_GRAPHIC_LATEST_USED:"lake_diagram_graphic_latest_used",GLOBAL_VARIABLE_EXTERNAL_FONT_KEY:"lake_diagram_external_font",EXTERNAL_FONTS:zr,MINIMUM_STACK_CELL_HEIGHT:30,STACK_CELL_VERTICAL_PADDING:12,MAXIMUM_LINE_TEXT_DISTANCE:60,VERTICAL_TEXT_ALIGN_DEFAULT_VALUE:"middle",VERTICAL_TEXT_ALIGN_ALIGN_DATA:Gr,VERTICAL_TEXT_ALIGN_VAILD_VALUES:Yr,REF_LINE_STROKE:"#1672F3",RESIZE_STROKE:Hr,RESIZE_FILL:"#FFFFFF",RESIZE_LINE_STROKE:"#3384F5",RESIZE_BUTTON_RADIUS:4,ANCHOR_STORE:"rgba(255,255,255,0.15)",ANCHOR_FILL:"rgba(51, 132, 245, 0.3)",ANCHOR_HOVER_FILL:"rgba(95, 159, 246, 0.6)",CONTROL_STROKE:"rgba(255,255,255,0.8)",CONTROL_FILL:"#3384F5",ANTIANCHOR_STROKE:"#3384F5",ANTIANCHOR_FILL:"rgba(192,217,252,0.2)",CONNECT_FILL:"rgba(192,217,252,0.2)",SELECTED_STROKE_COLOR:"#3384F5",LINE_DOCK_TIME:1500,DRAG_DISTANCE_THRESHOLD:8,SWIMLANE_SINGLE_LANE_WIDTH:150,PEN_ACTIVE_BUTTON_FILL:"#C0D9FC",MAX_LANE_NUMBER:50,MIN_LANE_NUMBER:1,DEFAULT_FREE_HAND_COLOR:"#595959",EDIT_MODE:"edit",READ_MODE:"read",PEN_MODE:"pen",DRAG_MODE:"dragCanvas",FREE_HAND_MODE:"free-hand",ERASER_MODE:"eraser",BEGIN_INSERT_VERTEX_MODE:"beginInsertVertex",FREE_HAND_PENCIL:"pencil",FREE_HAND_MARK_PENCIL:"mark-pencil",PEN_SPMID:"a385.b4693.c124035",PENCIL_SPMID:"a385.b4693.c121188.d251467",MARK_PENCIL_SPMID:"a385.b4693.c121188.d251468",UI_THEME_COLORS_LIGHT:Vr,UI_THEME_COLORS_DARK:Ur,MINDMAP_ROOT_TEMPLATE:_r}),Xr="http://www.w3.org/2000/svg",Kr="http://www.w3.org/1999/xlink";function Zr(e){e=e||document.body;var t=document.createElementNS(Xr,"svg");return t.setAttribute("version","1.1"),t.setAttribute("xmlns",Xr),t.setAttribute("xmlns:xlink",Kr),t.style.opacity=0,t.style.width="0px",t.style.height="0px",t.style.position="absolute",t.style["z-index"]=-1,e.appendChild(t),t}function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Jr=Zr(),eo=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this),c()(A()(r),"options",void 0),c()(A()(r),"matrix",void 0),c()(A()(r),"rendererElement",void 0),c()(A()(r),"destroyed",void 0),c()(A()(r),"styles",void 0),c()(A()(r),"attrs",void 0),c()(A()(r),"parent",void 0);var o=$r({matrix:[1,0,0,0,1,0,0,0,1]},e);if(!o.name)throw new Error("Should set name for Graphics Element!");return r.options=o,r.matrix=o.matrix,r.attrs={},r.styles={},r.rendererElement=r.create(o.name),r.update(o),r}return v()(n,[{key:"hide",value:function(){this.update({visibility:"hidden"})}},{key:"show",value:function(){this.update({visibility:"visible"})}},{key:"on",value:function(e,t){return"string"==typeof e&&-1!==this.passthroughEventKeys().indexOf(e)&&this.rendererElement.addEventListener(e,t),N()(M()(n.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return"string"==typeof e&&-1!==this.passthroughEventKeys().indexOf(e)&&this.rendererElement.removeEventListener(e,t),N()(M()(n.prototype),"off",this).call(this,e,t)}},{key:"passthroughEventKeys",value:function(){return["mousedown","mouseenter","mouseleave","mousemove","mouseover","click"]}},{key:"passthroughAttributeKeys",value:function(){return["id","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin","stroke-miterlimit","clip-path","visibility","pointer-events","opacity","stroke-dasharray","class"]}},{key:"_getPassthroughData",value:function(e,t){var n={},r=Object.keys(t),o=this["passthrough".concat(e,"Keys")]();return r.filter((function(e){return o.includes(e)})).forEach((function(e){var r=t[e];void 0!==r&&(n[e]=r)})),n}},{key:"dataset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.rendererElement;t.dataset?Object.assign(t.dataset,e):Object.keys(e).forEach((function(n){t.setAttribute("data-".concat(n),e[n])}))}},{key:"update",value:function(e){var t=this._getPassthroughData("Attribute",e),n=e.matrix;n&&(t.transform="matrix(".concat(n[0],", ").concat(n[1],", ").concat(n[3],", ").concat(n[4],", ").concat(n[6],", ").concat(n[7],")"),this.matrix=n),this.attr(t)}},{key:"setAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rendererElement;Object.keys(e).forEach((function(n){var r=e[n];if(null==r)t.removeAttribute(n);else try{t.setAttribute(n,r)}catch(e){}}))}},{key:"_setStyles",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.rendererElement.style[n]=e[n]}))}},{key:"create",value:function(e){return document.createElementNS(Xr,e)}},{key:"css",value:function(e){if("object"===a()(e))this.styles=$r($r({},this.styles),e),this._setStyles(e);else if("string"==typeof e)return this.styles[e]}},{key:"attr",value:function(e){if("object"===a()(e))this.attrs=$r($r({},this.attrs),e),this.setAttrs(e);else if("string"==typeof e)return this.attrs[e]}},{key:"getBBox",value:function(){var e,t=this.rendererElement,n=this.canvas,r=n&&n.calculateCanvas||Jr;if(document.contains(t))e=t.getBBox();else{var o=t.cloneNode(!0);r.appendChild(o),e=o.getBBox(),r.removeChild(o)}return{x:e.x,y:e.y,width:e.width,height:e.height}}},{key:"capture",value:function(e){!0===e?this.css({"pointer-events":"auto"}):!1===e&&this.css({"pointer-events":"none"})}},{key:"getBoundingClientRect",value:function(){return this.rendererElement.getBoundingClientRect()}},{key:"getZIndex",value:function(){return this.parent?this.parent.children.indexOf(this):null}},{key:"getSiblingRendererElement",value:function(){return this.rendererElement.nextSibling?["before",this.rendererElement.nextSibling]:this.rendererElement.previousSibling?["after",this.rendererElement.previousSibling]:null}},{key:"remove",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"previousSibling",get:function(){if(!this.parent)return null;var e=this.parent.children,t=e.indexOf(this);return t>=1?e[t-1]:null}},{key:"nextSibling",get:function(){var e=this.parent.children,t=e.indexOf(this);return t>=0?e[t+1]:null}},{key:"before",value:function(e){if(!this.parent)return null;this.parent.insertBefore(e,this)}},{key:"after",value:function(e){var t;if(!this.parent)return null;null===(t=this.parent)||void 0===t||t.insertAfter(e,this)}},{key:"toBack",value:function(){if(!this.destroyed){var e=this.parent;e&&e.insertBefore(this,e.children[0])}}},{key:"toFront",value:function(){if(!this.destroyed){var e=this.parent;e&&e.insertBefore(this,null)}}},{key:"forward",value:function(){if(!this.destroyed){var e=this.parent,t=this.nextSibling;e&&t&&e.insertBefore(t,this)}}},{key:"backward",value:function(){if(!this.destroyed){var e=this.parent,t=this.previousSibling;e&&t&&e.insertBefore(this,t)}}},{key:"destroy",value:function(){this.destroyed=!0,this.options=null,this.remove()}}]),n}();function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var no=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"g"},e);return r=t.call(this,o),c()(A()(r),"children",void 0),r.children=[],r}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this)}},{key:"deepEach",value:function(e){Wt(this,e)}},{key:"add",value:function(e){this.children.includes(e)||(e.parent=this,this.children.push(e),this.rendererElement.appendChild(e.rendererElement))}},{key:"append",value:function(e){this.insertAfter(e,null)}},{key:"prepend",value:function(e){this.insertBefore(e,this.children[0])}},{key:"insertBefore",value:function(e,t){var n=this.children,r=this.rendererElement,o=n.indexOf(e);o>=0&&n.splice(o,1),e.parent=this;var a=n.indexOf(t);a>=0?(n.splice(a,0,e),r.insertBefore(e.rendererElement,t.rendererElement)):(n.push(e),r.insertBefore(e.rendererElement,null))}},{key:"insertAfter",value:function(e,t){t?this.insertBefore(e,t.nextSibling):this.insertBefore(e,null)}},{key:"removeChild",value:function(e){if(e.parent===this){var t=this.children,n=t.indexOf(e);n>-1&&t.splice(n,1),e.parent=void 0,this.rendererElement.removeChild(e.rendererElement)}}},{key:"clear",value:function(){T()(this.children).forEach((function(e){e.remove()}))}}]),n}();function ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var oo=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(m()(this,n),!(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ro(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({container:null,calculatedContainer:null,name:"svg"},r)).container)throw new Error("Please set container for canvas!");e=t.call(this,r),c()(A()(e),"calculateCanvas",void 0),e.options=r;var o=r.container,a=A()(e).rendererElement;return a.setAttribute("version","1.1"),a.setAttribute("xmlns",Xr),a.setAttribute("xmlns:xlink",Kr),o.appendChild(a),e.createCalculateCanvas(),e.container=o,e.canvas=A()(e),e}return v()(n,[{key:"createCalculateCanvas",value:function(){var e=this.options;this.calculateCanvas=Zr(e.calculatedContainer)}},{key:"remove",value:function(){this.container&&this.container.removeChild(this.rendererElement),this.calculateCanvas&&this.calculateCanvas.parentElement.removeChild(this.calculateCanvas)}}]),n}();function ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var io=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ao(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({x:0,y:0,scale:1,rotate:0},e))}return v()(n,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.options,e);var t=this.options,r=t.x,o=t.y,a=t.scale,i=t.rotate,c=a,l=Math.cos(i),u=Math.sin(i);e.matrix=[l*c,u*c,0,-u*c,l*c,0,r,o,1],N()(M()(n.prototype),"update",this).call(this,e)}}]),n}();var co=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=t.call(this,r),c()(A()(e),"isShape",!0),e}return v()(n)}();var lo=function(e){S()(n,co);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e={name:"avatar",matrix:e.element.matrix,element:e.element},t.call(this,e)}return v()(n,[{key:"create",value:function(){return this.options.element.rendererElement.cloneNode(!0)}}]),n}();function uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function so(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?so(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):so(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ho=function(e){S()(n,co);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=fo(fo({},r),{},{name:"path"}),e=t.call(this,r),c()(A()(e),"isPath",!0),e}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","marker-start","marker-end","fill-rule","clip-rule"])}},{key:"update",value:function(e){var t=e.d;Array.isArray(t)?N()(M()(n.prototype),"update",this).call(this,fo(fo({},e),{},{d:Gn(t)})):N()(M()(n.prototype),"update",this).call(this,e)}},{key:"getPath",value:function(e,t){var n;return rr(null===(n=this.options)||void 0===n?void 0:n.d,e,t)}},{key:"getClosestPoint",value:function(e,t){if("number"==typeof e&&"number"==typeof t){var n=e,r=t,o=Yi(this.rendererElement,(function(e,t){var o=e-n,a=t-r;return o*o+a*a})),a=o.point,i=o.percentage;return{point:[a.x,a.y],percentage:i}}if("number"!=typeof e&&t&&"number"!=typeof t){var c,l=e,u=t,s=Or(this.rendererElement.getBBox()),d=ce.from(u).voronoi([s.minX-10,s.minY-10,s.maxX+10,s.maxY+10]),f=0,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(d.cellPolygons());try{for(h.s();!(c=h.n()).done;){if(c.value,d.contains(f,l.x,l.y))return f;f++}}catch(e){h.e(e)}finally{h.f()}return 0}}},{key:"getIntersectionPoint",value:function(e,t,n,r){return Yi(this.rendererElement,(function(o,a){var i=o-e,c=a-t,l=o-n,u=a-r;return Math.sqrt(i*i+c*c)+Math.sqrt(l*l+u*u)})).point}}]),n}();function po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?po(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(ho.prototype,e,{value:function(){var t=this.rendererElement;return t[e].apply(t,arguments)}})}));var yo=function(e){S()(n,ho);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.cx,o=e.cy,a=e.rx,i=e.ry;return t.call(this,mo(mo({},e),{},{d:Yn(r,o,a,i)}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options;return Yn(n.cx*e,n.cy*t,n.rx*e,n.ry*t)}}]),n}();function vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var go=function(e){S()(n,co);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"html",html:"",x:0,y:0,width:0,height:0,styleSheets:[]},e),t.call(this,e)}return v()(n,[{key:"addClass",value:function(e){this.htmlContainer.classList.add(e)}},{key:"removeClass",value:function(e){this.htmlContainer.classList.remove(e)}},{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height"])}},{key:"create",value:function(){var e=document.createElement("div"),t=N()(M()(n.prototype),"create",this).call(this,"foreignObject");return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),t.appendChild(e),this.htmlContainer=e,mn(this.htmlContainer,this.options.styleSheets),t}},{key:"update",value:function(e){e.html&&this.htmlContainer.innerHTML!==e.html&&(this.html=e.html,this.htmlContainer.innerHTML=e.html,mn(this.htmlContainer,this.options.styleSheets)),N()(M()(n.prototype),"update",this).call(this,e)}}]),n}();function bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var xo=function(e){S()(n,co);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"image",crossorigin:"anonymous",preserveAspectRatio:"none"},e))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["href","x","y","width","height","crossorigin","preserveAspectRatio"])}}]),n}();function wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Eo=function(e){S()(n,ho);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.points;return t.call(this,ko(ko({},e),{},{d:$n(r).concat("z")}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return $n(this.options.points.map((function(n){return{x:n.x*e,y:n.y*t}}))).concat("z")}}]),n}();function Oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ao=function(e){S()(n,ho);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.x,o=e.y,a=e.width,i=e.height,c=e.rx,l=e.ry;return t.call(this,Co(Co({},e),{},{d:Jn(r,o,a,i,c,l)}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options,r=n.x,o=n.y,a=n.width,i=n.height,c=n.rx,l=n.ry;return Jn(r*e,o*t,a*e,i*t,Math.min(c*e,c),Math.min(l*e,l))}}]),n}();function Po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jo=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,So(So({},e),{},{name:"text"}))}return v()(n,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N()(M()(n.prototype),"update",this).call(this,e);var t=(e||{}).text;null!=t&&(this.rendererElement.innerHTML=t)}},{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dominant-baseline","x","y","textLength"])}}]),n}();function Ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ro(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ro(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mo=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,_o(_o({},e),{},{name:"title"}))}return v()(n,[{key:"update",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title;null!=e&&(this.rendererElement.innerHTML=e)}}]),n}();function Lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var To=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"use"},e),t.call(this,e)}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height","href"])}}]),n}();function Do(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var No=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Do(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Do(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"defs",matrix:null},r),(e=t.call(this,r)).isDefs=!0,e}return v()(n)}();function Bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fo=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,Io(Io({},e),{},{matrix:null,name:"clipPath"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","clipPathUnits"])}}]),n}();function qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Go=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,zo(zo({},e),{},{name:"feDropShadow"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dx","dy","stdDeviation","flood-color"])}}]),n}();function Yo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vo=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),(e=t.call(this,Ho(Ho({},r),{},{name:"filter"}))).children=[],e}return v()(n,[{key:"add",value:function(e){e.parent=this,this.children.push(e),this.rendererElement.appendChild(e.rendererElement)}},{key:"destroy",value:function(){this.children.forEach((function(e){return e.destroy()})),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();var Uo=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Wo=function(e){S()(n,eo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this,{name:"linearGradient",matrix:null})).id=Object(F.a)(),e.rendererElement.setAttribute("id",e.id),e}return v()(n,[{key:"update",value:function(e){if("string"==typeof e){var t,n,r,o,a=this.rendererElement,i=Uo.exec(e),c=(n=parseFloat(i[1]),(Math.PI/180*n%(t=2*Math.PI)+t)%t),l=i[2];c>=0&&c<.5*Math.PI?(r={x:0,y:0},o={x:1,y:1}):.5*Math.PI<=c&&c<Math.PI?(r={x:1,y:0},o={x:0,y:1}):Math.PI<=c&&c<1.5*Math.PI?(r={x:1,y:1},o={x:0,y:0}):(r={x:0,y:1},o={x:1,y:0});var u=Math.tan(c),s=u*u,d=(o.x-r.x+u*(o.y-r.y))/(s+1)+r.x,f=u*(o.x-r.x+u*(o.y-r.y))/(s+1)+r.y;a.setAttribute("x1",r.x),a.setAttribute("y1",r.y),a.setAttribute("x2",d),a.setAttribute("y2",f),a.innerHTML=function(e){var t=e.match(/[\d.]+:(#[^\s]+|[^\)]+\))/gi);if(!t)return"";var n="";return t.sort((function(e,t){return e=e.split(":"),t=t.split(":"),Number(e[0])-Number(t[0])})),t.forEach((function(e){e=e.split(":"),n+='<stop offset="'.concat(e[0],'" stop-color="').concat(e[1],'"></stop>')})),n}(l)}}}]),n}();function Xo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zo=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,Ko(Ko({},e),{},{name:"marker"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","markerWidth","markerHeight","viewBox","orient","refX","refY"])}}]),n}();function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ea=Zr(),ta=function(e){S()(n,co);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=Jo(Jo({},e),{},{name:"roughPath"}),t.call(this,e)}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return N()(M()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","roughFillStyle","disableMultiStroke"])}},{key:"create",value:function(e){var t=N()(M()(n.prototype),"create",this).call(this,"g"),r=N()(M()(n.prototype),"create",this).call(this,"path"),o=N()(M()(n.prototype),"create",this).call(this,"g"),a=N()(M()(n.prototype),"create",this).call(this,"svg");a.setAttribute("version","1.1"),a.setAttribute("xmlns",Xr),a.setAttribute("xmlns:xlink",Kr);var i=ge.a.svg(a);return t.appendChild(o),t.appendChild(r),r.setAttribute("fill","rgba(0,0,0,0)"),r.setAttribute("stroke","rgba(0,0,0,0)"),this.roughSVGContainer=a,this.roughSVG=i,this.roughGroup=o,this.calculatePath=r,t}},{key:"setAttrs",value:function(e){var t=this.roughSVG,n=this.calculatePath,r=this.roughGroup,o=this.rendererElement,a=["d","stroke-width"],i=["d","stroke","stroke-width","fill","stroke-dasharray","roughFillWeight","disableMultiStroke"],c={},l={},u={};if(Object.keys(e).forEach((function(t){var n=i.includes(t),r=a.includes(t);n&&(c[t]=e[t]),r&&(l[t]=e[t]),n||r||(u[t]=e[t])})),Object.keys(c).length>0){var s=this.attrs.d,d=t.path(s,function(e){var t=["stroke","fill"],n={seed:75,roughness:.4},r=e.roughFillStyle;return Object.keys(e).forEach((function(o){var a=e[o];t.includes(o)?n[o]=a:"stroke-dasharray"===o&&"string"==typeof a&&"none"!==a?n.strokeLineDash=a.split(" ").map((function(e){return Number(e)})):"stroke-width"===o&&"number"==typeof a?(n.strokeWidth=a,["hachure","default"].includes(r)&&(n.hachureGap=2.5*a,n.fillWeight=.8*a,n.bowing=1.2*(a-1)+4)):"roughFillStyle"===o&&"string"==typeof a?("solid"===a&&(n.roughness=1),n.fillStyle=a):"disableMultiStroke"===o&&"boolean"==typeof a&&(n.disableMultiStroke=a)})),n}(this.attrs));!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(r),r.appendChild(d)}Object.keys(u).forEach((function(e){var t=u[e];null==t?o.removeAttribute(e):o.setAttribute(e,t)})),Object.keys(l).forEach((function(e){var t=l[e];null==t?n.removeAttribute(e):n.setAttribute(e,t)}))}},{key:"update",value:function(e){var t=e.d;Array.isArray(t)?N()(M()(n.prototype),"update",this).call(this,Jo(Jo({},e),{},{d:Gn(t)})):N()(M()(n.prototype),"update",this).call(this,e)}},{key:"getPath",value:function(e,t){var n;return rr(null===(n=this.options)||void 0===n?void 0:n.d,e,t)}},{key:"getClosestPoint",value:function(e,t){if("number"==typeof e&&"number"==typeof t){var n=e,r=t,o=Yi(this.calculatePath,(function(e,t){var o=e-n,a=t-r;return o*o+a*a})),a=o.point,i=o.percentage;return{point:[a.x,a.y],percentage:i}}if("number"!=typeof e&&t&&"number"!=typeof t){var c,l=e,u=t,s=Or(this.calculatePath.getBBox()),d=ce.from(u).voronoi([s.minX-10,s.minY-10,s.maxX+10,s.maxY+10]),f=0,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(d.cellPolygons());try{for(h.s();!(c=h.n()).done;){if(c.value,d.contains(f,l.x,l.y))return f;f++}}catch(e){h.e(e)}finally{h.f()}return 0}}},{key:"getIntersectionPoint",value:function(e,t,n,r){return Yi(this.calculatePath,(function(o,a){var i=o-e,c=a-t,l=o-n,u=a-r;return Math.sqrt(i*i+c*c)+Math.sqrt(l*l+u*u)})).point}},{key:"getBBox",value:function(){var e,t=this.calculatePath,n=this.canvas,r=n&&n.calculateCanvas||ea;if(document.contains(t))e=t.getBBox();else{var o=t.cloneNode(!0);r.appendChild(o),e=o.getBBox(),r.removeChild(o)}return{x:e.x,y:e.y,width:e.width,height:e.height}}}]),n}();function na(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ra(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?na(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):na(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(ta.prototype,e,{value:function(){var t=this.calculatePath;return t[e].apply(t,arguments)}})}));var oa=function(e){S()(n,ta);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.cx,o=e.cy,a=e.rx,i=e.ry;return t.call(this,ra(ra({},e),{},{d:Yn(r,o,a,i)}))}return v()(n,[{key:"getPath",value:function(e,t){var n=this.options;return Yn(n.cx*e,n.cy*t,n.rx*e,n.ry*t)}}]),n}();function aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ia(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ca=function(e){S()(n,ta);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.points;return t.call(this,ia(ia({},e),{},{d:$n(r).concat("z")}))}return v()(n,[{key:"getPath",value:function(e,t){return $n(this.options.points.map((function(n){return{x:n.x*e,y:n.y*t}}))).concat("z")}}]),n}();function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sa=function(e){S()(n,ta);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n);var r=e.x,o=e.y,a=e.width,i=e.height,c=e.rx,l=e.ry;return t.call(this,ua(ua({},e),{},{d:Jn(r,o,a,i,c,l)}))}return v()(n,[{key:"getPath",value:function(e,t){var n=this.options,r=n.x,o=n.y,a=n.width,i=n.height,c=n.rx,l=n.ry;return Jn(r*e,o*t,a*e,i*t,Math.min(c*e,c),Math.min(l*e,l))}}]),n}(),da=Object.freeze({__proto__:null,Canvas:oo,Group:no,FixedGroup:io,Shape:co,Path:ho,Html:go,Avatar:lo,Image:xo,Defs:No,LinearGradient:Wo,Rect:Ao,Ellipse:yo,Marker:Zo,Use:To,Filter:Vo,FeDropShadow:Go,ClipPath:Fo,Title:Mo,Text:jo,Polygon:Eo,RoughPath:ta,RoughRect:sa,RoughPolygon:ca,RoughEllipse:oa});function fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new io,r=new ho({d:Hn(0,0,4),stroke:Hr,fill:"#FFFFFF","stroke-width":1});return n.add(r),r.dataset(ha(ha({},t),{},{type:"point",cursor:e})),{group:n,shape:r,name:e}}function ma(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new no,r=new ho({stroke:"rgba(255,255,255,0)"}),o=new ho({stroke:"#3384F5"});return r.dataset(ha(ha({},t),{},{type:"line",cursor:e})),n.add(o),n.add(r),{visShape:o,shape:r,name:e,group:n}}function ya(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new io,r=new xo({href:"https://gw.alipayobjects.com/zos/bmw-prod/d07101fb-046a-474e-a8f7-5bfa2d2d920d.svg",x:-8,y:-8,width:16,height:16});return n.add(r),r.dataset(ha({lake_prevent_click_unselect:"true",rotate_button:"true"},t)),n.css({cursor:"pointer"}),{group:n,shape:r,name:e}}var va=function(e){for(var t=e;null!==(n=t)&&void 0!==n&&n.parent&&hr(null===(r=t)||void 0===r?void 0:r.parent);){var n,r,o;t=null===(o=t)||void 0===o?void 0:o.parent}return t};function ga(e){var t=ue()(e).toRgb(),n=t.r,r=t.g,o=t.b;return t.a<.5||.299*n+.587*r+.114*o>=210?"#8C8C8C":"#fff"}try{JSON.parse(r.LocalStorageUtil.getItem("lake_diagram_custom_colors"))}catch(e){}function ba(e,t){var n=[],r={};return e.forEach((function(e){Wt(e,(function(e){var o=Object(F.a)();r[e.id]=o,t&&(t[o]=t[e.id]),e.id=o,"line"!==e.type&&"edge"!==e.type||n.push(e)}))})),n.forEach((function(e){e.source&&e.source.id&&r[e.source.id]&&(e.source.id=r[e.source.id]),e.target&&e.target.id&&r[e.target.id]&&(e.target.id=r[e.target.id])})),r}function xa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t.x+t.width/2,t.y+t.height/2],o=Math.cos(n),a=Math.sin(n),i=Ci(8,r,[r[0]+o,r[1]+a]);return i(e,0)||i(e,4)?"ew-resize":i(e,1)||i(e,5)?"nesw-resize":i(e,2)||i(e,6)?"ns-resize":"nwse-resize"}function wa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t.x+t.width/2,t.y+t.height/2],o=Math.cos(n),a=Math.sin(n),i=Ci(4,r,[r[0]+o,r[1]+a]);return i(e,0)||i(e,2)?"nesw-resize":"nwse-resize"}function ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oa(e){var t=new Image;return new Promise((function(n,r){t.onload=function(){n(t)},t.onerror=function(){r(new Error("unable to load url ".concat(e)))},t.crossOrigin="anonymous",t.src=e}))}function Ca(e,t,n,r,o,a,i,c,l,u,s){var d=document.createElement("canvas"),f=d.getContext("2d");d.width=u,d.height=s,f&&f.drawImage(t,r,o,a,i,c,l,u,s),e.push({canvas:d,fy:o*n,fHeight:s})}function Aa(e){return Pa.apply(this,arguments)}function Pa(){return(Pa=de()(he.a.mark((function e(t){var n,r,o,a,i,c,l,u,s,d,f,h,p,m,y,v,g,b,x,w=arguments;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w.length>1&&void 0!==w[1]?w[1]:{},e.next=3,Oa(t);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(o=document.createElement("canvas"),a=Ea({width:r.naturalWidth,height:r.naturalHeight,fLimit:1e4,ratio:1},n),i=a.width,c=a.height,l=a.fLimit,u=a.backgroundColor,s=a.ratio,d=i*s,f=c*s,o.width=d,o.height=f,h=o.getContext("2d")){e.next=15;break}return e.abrupt("return");case 15:if(u&&(h.fillStyle=u,h.fillRect(0,0,d,f)),f>l){for(p=parseInt(f/l),m=f%l,0,0,y=i,v=d,g=[],b=0,0,x=0;x<p;x++)Ca(g,r,s,0,b,y,l/s,0,0,v,l),b+=l/s;Ca(g,r,s,0,b,y,m/s,0,0,v,m),g.forEach((function(e){var t=e.canvas,n=e.fy,r=e.fHeight;h.drawImage(t,0,n,d,r)}))}else h.drawImage(r,0,0,d,f);return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Sa=Object.freeze({__proto__:null,loadImage:Oa,loadCanvas:Aa});function ja(e){return pe.ua.macos?e.metaKey:e.ctrlKey}var Ra=Object.freeze({__proto__:null,isMod:ja}),_a=[{key:"standard-h",directions:[[1,0],[-1,0]]},{key:"standard-r",directions:[[1,0]]},{key:"standard-l",directions:[[-1,0]]},{key:"standard-t",directions:[[0,-1]]},{key:"standard-b",directions:[[0,1]]},{key:"indent-br",directions:[[1,1]]},{key:"indent-bl",directions:[[-1,1]]},{key:"indent-tr",directions:[[1,-1]]},{key:"indent-tl",directions:[[-1,-1]]},{key:"timeline-r",directions:[[1,0]]},{key:"timeline-l",directions:[[-1,0]]}];function Ma(e,t){if(0!==e.length){var n=[];return e.forEach((function(e){var r=t.get([e],"downDirection");if(r){var o=t.get([e],"downLayoutType"),a=t.get([e],"layoutQuadrantConstraint"),i=r.map((function(e){return Math.sign(e)})).join(","),c=(1===a.length?{"0,-1":"t","0,1":"b","-1,0":"l","1,0":"r","1,1":"br","-1,1":"bl","1,-1":"tr","-1,-1":"tl"}:{"-1,0":"h","1,0":"h","0,1":"v","0,-1":"v"})[i];n.push("".concat(o,"-").concat(c))}})),n.every((function(e){return e===n[0]}))?n[0]:"multiValue"}}function La(e){var t,n,r=e.split("-"),o=b()(r,2),a=o[0],i=o[1];return"indent"===a?(t=[1,1],n={br:[1],bl:[2],tl:[3],tr:[4]}[i]):"standard"===a?"h"===i?(t=[1,0],n=null):"v"===i?(t=[0,1],n=null):"r"===i?(t=[1,0],n=[1]):"l"===i?(t=[1,0],n=[2]):"t"===i?(t=[0,1],n=[2]):"b"===i&&(t=[0,1],n=[1]):"timeline"===a&&("r"===i?(t=[1,0],n=[1]):"l"===i&&(t=[1,0],n=[2])),{type:a,direction:t,quadrantConstraint:n}}function Ta(e,t){var n=t.some((function(t,n){return Math.sign(t)===Math.sign(e[n])})),r=t.every((function(t,n){return Math.sign(t)!==-Math.sign(e[n])||0===Math.sign(t)}));return n&&r}function Da(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"standard"!==t:"timeline"===e&&"indent"!==t}var Na=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o=function(e,t){var n=new io,r=new yo({cx:0,cy:0,rx:4,ry:4,width:8,height:8,stroke:t?"rgba(255,255,255,0.40)":Hr,strokeWidth:"2px",fill:t?"rgba(9,109,217,0.40)":"#FFFFFF"});return r.dataset({isControlPoint:"".concat(!t),isUIPoints:"".concat(t),index:"".concat(e),test_id:"line-control-point_".concat(e)}),n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line-control-point_".concat(e),isControlPoint:"".concat(!t),isUIPoints:"".concat(t),index:"".concat(e)}),{group:n,shape:r,index:e,isUIPoints:t,isControlPoints:!t}}(e,t);return n&&r&&(o.shape.css({cursor:"V"===r[r.length-1]?"row-resize":"col-resize"}),o.group.dataset({test_id:"elbow_".concat(t?"ui_point":"control_point","_").concat(e)})),o},Ba=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=new io,r=new yo({cx:0,cy:0,rx:t,ry:t,stroke:Hr,fill:"#FFFFFF"});return n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line_endpoint_".concat(e)}),{group:n,shape:r,name:e}};function Ia(e,t){for(var n=e.getPoints(),r=Vn(e.controlPoints,n,t),o=[],a=0;a<r.length-1;a++){var i=r[a],c=r[a+1],l=[.5*(i[1]+c[1]),.5*(i[2]+c[2]),oi(i[1],c[1],2)?"H":"V"];o.push(l)}return o.length>2?o.slice(1,o.length-1):o}function Fa(e){var t=e.cell,n=e.uiPoints,r=e.uiPointIndex;return"elbow"===t.shape?function(e,t,n){return t.length<=1?t:0===n?t.splice(0,t.length-1):n===t.length-1?t.splice(1):t.slice(1,t.length-1)}(0,n,r):function(e,t,n){var r=t[n],o=u()(e.controlPoints);return o.splice(n,0,r),o}(t,n,r)}function qa(e,t){var n=[];return"straight"===e.shape?n=function(e){var t,n=[],r=e.getPoints(),o=r.length;for(t=0;t<o-1;t++){var a=[.5*(r[t].x+r[t+1].x),.5*(r[t].y+r[t+1].y)];n.push(a)}return n}(e):"curve"===e.shape?n=function(e){var t=[],n=e.getPoints().length,r=e.wireElement;if(2===n){var o=r.getPointAtLength(.5*r.getTotalLength());t.push([o.x,o.y])}else if(3===n){var a=Ri(r.attrs.d);t.push(a[0]),t.push(a[1])}else{var i,c=Qn(e.d);for(i=0;i<c.length-1;i++){var l=[];if("M"===c[i][0])l.push(c[i]),l.push(c[i+1]);else{var u=c[i];l.push(["M",u[u.length-2],u[u.length-1]]),l.push(c[i+1])}var s=Gn(l),d=new ho({d:s}),f=d.getPointAtLength(.5*d.getTotalLength());d.destroy(),t.push([f.x,f.y])}}return t}(e):"elbow"===e.shape&&(n=function(e,t){if(e.controlPoints.length>0||e.isLoop)return function(e,t){var n=e.getPoints(),r=e.controlPoints,o=n[0],a=r[0],i=n[n.length-1],c=r[r.length-1],l=u()(Ia(e,t)),s=Vn(r,n,t);return l.length<=2&&s.length<=3||(oi(a[0],o.x)||oi(a[1],o.y)||("V"===a[a.length-1]?l.unshift([o.x,.5*(a[1]+o.y),"H"]):l.unshift([.5*(a[0]+o.x),o.y,"V"])),oi(c[0],i.x)||oi(c[1],i.y)||("V"===c[c.length-1]?l.push([i.x,.5*(c[1]+i.y),"H"]):l.push([.5*(c[0]+i.x),i.y,"V"]))),l}(e,t);var n=e.source,r=e.target,o=e.diagram,a=o.find(n.id),i=o.find(r.id),c=e.getPoints(),l=[];if(!a&&!i&&2===c.length){var s=c[0],d=c[1],f=.5*(s.x+d.x),h=.5*(s.y+d.y);return oi(s.x,d.x)||oi(s.y,d.y)?l.push([f,h,0]):(l.push([.5*(s.x+f),s.y,"V"]),l.push([f,h,"H"]),l.push([.5*(f+d.x),d.y,"V"])),l}for(var p=Qn(e.d),m=1;m<p.length;m++){var y=p[m-1],v=p[m];oi(y[1],v[1])?l.push([y[1],.5*(y[2]+v[2]),"H"]):oi(y[2],v[2])&&l.push([.5*(y[1]+v[1]),y[2],"V"])}return l}(e,t)),n}var za=function(e){return Array.isArray(e)?{x:e[0],y:e[1]}:e},Ga=document.createElementNS(Xr,"svg"),Ya=function(e){var t,n;if(Array.isArray(e)){var r=b()(e,2);t=r[0],n=r[1]}else t=e.x,n=e.y;var o=Ga.createSVGPoint();return o.x=t,o.y=n,o},Ha=function(e){return!!(O()(e)&&e.hasOwnProperty("x")&&e.hasOwnProperty("y"))},Va=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var o=b()(t,2),a=o[0],i=o[1],c=b()(r[(n+1)%r.length],2),l=c[0],u=c[1];return e.push(a,i,(a+l)/2,(i+u)/2),e}),["M"].concat(T()(e[0]),["Q"]));return t.push("Z"),t.join(" ")};function Ua(e,t){var n=e;if("number"!=typeof e&&(n=fi(e.x,e.y,t.x,t.y)),n>=5*Math.PI/4&&n<7*Math.PI/4)return"N";if(n>=7*Math.PI/4||n<Math.PI/4)return"E";if(n>=Math.PI/4&&n<3*Math.PI/4)return"S";if(n>=3*Math.PI/4&&n<5*Math.PI/4)return"W";throw new Error("unexpected radian ".concat(n))}var Wa=["penetratedKeys","Subcells"],Xa=function(e,t){return h()(e,t,(function(e,t,n){if(Wa.indexOf(n)>-1)return[].concat(T()(e||[]),T()(t||[]))}))},Ka=function(e){return ye()(e,(function(e){if("object"===a()(e)&&!d()(e))return e}))},Za=Object.freeze({__proto__:null,mergeDefalutProps:Xa,cloneDeepDefaultProps:Ka});function Qa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(!e.rendererElement.closest("svg"))return null;var r=Ya(t),o=e.attr("stroke-width");e.attr({"stroke-width":2*n});var a=e.isPointInStroke(r);return e.attr({"stroke-width":o}),a?e.getClosestPoint(t[0],t[1]).point:null}var $a=function(e,t,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=o?o/180*Math.PI:0,c=Math.sin(i),l=Math.cos(i),u=n/2,s=r/2;return[l*a,c*a,0,-c*a,l*a,0,e+(-u*l+s*c+u),t+(-u*c-s*l+s),1]};function Ja(e,t){return{minX:-1.5*e,minY:t+10,maxX:2.5*e,maxY:t+30}}function ei(e,t,n){var r=e/2,o=t/2,a=r<n?r:n,i=o<n?o:n;return[["M",+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)+ +a,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0],["l",e-2*a,0],["a",a,i,0,0,1,a,i],["l",0,t-2*i],["a",a,i,0,0,1,-a,i],["l",2*a-e,0],["a",a,i,0,0,1,-a,-i],["l",0,2*i-t],["a",a,i,0,0,1,a,-i],["z"]]}function ti(e){return e>=180&&(e-=360),e<=-180&&(e+=360),e}function ni(e){return 180*e/Math.PI}function ri(e){return Math.PI/180*e}function oi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return Math.abs(e-t)<=n}function ai(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return e.length===t.length&&e.every((function(e,r){return oi(e,t[r],n)}))}function ii(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&e.maxX>=t.maxX&&e.maxY>=t.maxY}function ci(e,t){return!(t.maxX<e.minX||t.minX>e.maxX||t.maxY<e.minY||t.minY>e.maxY)}function li(e,t,n,r){var o;return o=(r-t)/(n-e),isNaN(o)?1/0:o=Number(o.toFixed(2))}function ui(e,t,n,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r){var o=e,a=t;return Math.sqrt(Math.pow(n-o,2)+Math.pow(r-a,2))}if("number"!=typeof e&&"number"!=typeof t){var i=za(e),c=za(t);return Math.sqrt(Math.pow(i.x-c.x,2)+Math.pow(i.y-c.y,2))}return 0}function si(e,t,n,r,o){var a=li(e,t,n,r),i=Math.atan(a),c=n<e,l=o*Math.cos(i),u=o*Math.sin(i);return c&&(l*=-1,u*=-1),{offsetX:l,offsetY:u}}function di(e,t,n,r,o){if(ui(e,t,n,r)<o)return{x:e,y:t};var a=si(e,t,n,r,o);return{x:n-a.offsetX,y:r-a.offsetY}}function fi(e,t,n,r){var o=li(e,t,n,r),a=Math.atan(o);return n<e?a+Math.PI:r<t?a+2*Math.PI:a}function hi(e,t,n,r){var o;return o=oi(e,n)?1/0:oi(t,r)?0:(o=(r-t)/(n-e)).toFixed(2),Number(o)}function pi(e,t,n,r,o,a,i,c){if(hi(e,t,n,r)===hi(o,a,i,c))return!1;var l=((e*r-n*t)*(o-i)-(e-n)*(o*c-a*i))/((e-n)*(a-c)-(t-r)*(o-i)),u=((e*r-n*t)*(a-c)-(t-r)*(o*c-a*i))/((e-n)*(a-c)-(t-r)*(o-i));return{x:-0===l?0:l,y:-0===u?0:u}}function mi(e,t,n,r){return Math.abs(e-n)+Math.abs(t-r)}function yi(e,t,n){return e>=t&&e<=n}function vi(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-4;return oi(e,n,o)&&oi(t,r,o)}function gi(e,t,n,r,o,a,i,c){var l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],u=o-e,s=a-t,d=n-e,f=r-t,h=i-o,p=c-a,m=d*p-f*h,y=null;if(m*m>1e-4*(d*d+f*f)*(h*h+p*p)){var v=(u*p-s*h)/m,g=(u*f-s*d)/m;yi(v,0,1)&&yi(g,0,1)&&(y={x:e+v*d,y:t+v*f})}return y&&!l&&(vi(e,t,y.x,y.y,.1)||vi(n,r,y.x,y.y,.1)||vi(o,a,y.x,y.y,.1)||vi(i,c,y.x,y.y,.1))?null:y}function bi(e,t,n,r){if(e===n)return{f:function(){return null},fy:function(){return e},string:"x=".concat(e.toFixed(3))};if(t===r)return{f:function(){return t},fy:function(){return null},string:"y=".concat(t.toFixed(3))};var o=(r-t)/(n-e),a=-e/(n-e)*(r-t)+t;return{f:function(e){return o*e+a},fy:function(e){return(e-a)/o},string:"y=".concat(o.toFixed(3),"x+").concat(a.toFixed(3))}}function xi(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!(gi(e.x1,e.y1,e.x2,e.y2,t.minX,t.minY,t.minX,t.maxY,n)||gi(e.x1,e.y1,e.x2,e.y2,t.minX,t.minY,t.maxX,t.minY,n)||gi(e.x1,e.y1,e.x2,e.y2,t.maxX,t.minY,t.maxX,t.maxY,n)||gi(e.x1,e.y1,e.x2,e.y2,t.minX,t.maxY,t.maxX,t.maxY,n))}function wi(e,t){return hi(e.x,e.y,t.x1,t.y1)===hi(e.x,e.y,t.x2,t.y2)}function ki(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function Ei(e,t){if(e.k===1/0){if(e.y1<e.y2&&t.y<e.y1)return!1;if(e.y1>e.y2&&t.y>e.y1)return!1}else{if(e.x1<e.x2&&t.x<e.x1)return!1;if(e.x1>e.x2&&t.x>e.x1)return!1}return!0}function Oi(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e[0]*t[0]+e[1]*t[1],o=e[0]*t[1]-e[1]*t[0],a=Math.atan2(o,r);return a<0&&(a=2*Math.PI-Math.abs(a)),n?2*Math.PI-a:a}function Ci(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0],r=[],o=2*Math.PI/e,a=0;a<e;a++)r.push([o*a,o*(a+1)]);var i=[n[0]-t[0],n[1]-t[1]];return function(e,n){var o=[e[0]-t[0],e[1]-t[1]],a=r[n];return rn(Oi(o,i,!1),a)}}var Ai=function(e,t,n){return(n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y)>0};function Pi(e,t){var n=new Mn(t),r=n.tl,o=n.tr,a=n.bl,i=n.br;return Ai(e,r,o)&&Ai(e,o,i)&&Ai(e,i,a)&&Ai(e,a,r)}var Si=function(e,t){var n="x"in e?Or(e):e,r="x"in t?Or(t):t;return Math.max(0,Math.min(n.maxX,r.maxX)-Math.max(n.minX,r.minX))*Math.max(0,Math.min(n.maxY,r.maxY)-Math.max(n.minY,r.minY))},ji=function(e,t,n){var r=za(e);return n.map((function(e){var n=ti(e.r+t),o=Sn(e),a=[0,0],i=[0,0];k.vec2.rotate(a,[e.x-r.x,e.y-r.y],[0,0],ri(t)),a[0]+=r.x,a[1]+=r.y,k.vec2.rotate(i,[o.x-r.x,o.y-r.y],[0,0],ri(t)),i[0]+=r.x,i[1]+=r.y;var c=[0,0];return k.vec2.rotate(c,[a[0]-i[0],a[1]-i[1]],[0,0],ri(360-t)),c[0]+=i[0],c[1]+=i[1],{x:c[0],y:c[1],r:n}}))},Ri=function(e){var t=e.split(/Q|M/).slice(1).map((function(e){return e.split(",").map((function(e){return parseFloat(e)}))})),n=t[0],r=n[0],o=n[1],a=t[1][0],i=t[1][1],c=t[1][2],l=t[1][3];return[_i(.25,r,o,a,i,c,l),_i(.75,r,o,a,i,c,l)]};function _i(e,t,n,r,o,a,i){return[Math.pow(1-e,2)*t+2*(1-e)*e*r+Math.pow(e,2)*a,Math.pow(1-e,2)*n+2*(1-e)*e*o+Math.pow(e,2)*i]}var Mi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m()(this,e),this.vertices={},this.edges={},this.isDirected=t}return v()(e,[{key:"snap",value:function(e){for(var t={vertex:void 0,distance:1/0},n=this.getAllVertices(),r=0;r<n.length;r++){var o=n[r];if(o.x===e.x&&o.y===e.y)return o;var a=Math.abs(o.x-e.x)+Math.abs(o.y-e.y);a<t.distance&&(t.vertex=o,t.distance=a)}return t.vertex}},{key:"addVertex",value:function(e){return this.vertices[e.getKey()]=e,this}},{key:"getVertexByKey",value:function(e){return this.vertices[e]}},{key:"getNeighbors",value:function(e){return e.getNeighbors()}},{key:"getAllVertices",value:function(){return Object.values(this.vertices)}},{key:"getAllEdges",value:function(){return Object.values(this.edges)}},{key:"addEdge",value:function(e){var t=this.getVertexByKey(e.startVertex.getKey()),n=this.getVertexByKey(e.endVertex.getKey());if(t||(this.addVertex(e.startVertex),t=this.getVertexByKey(e.startVertex.getKey())),n||(this.addVertex(e.endVertex),n=this.getVertexByKey(e.endVertex.getKey())),this.edges[e.getKey()])throw new Error("Edge has already been added before");return this.edges[e.getKey()]=e,this.isDirected?t.addEdge(e):(t.addEdge(e),n.addEdge(e)),this}},{key:"deleteEdge",value:function(e){if(!this.edges[e.getKey()])throw new Error("Edge not found in graph");delete this.edges[e.getKey()];var t=this.getVertexByKey(e.startVertex.getKey()),n=this.getVertexByKey(e.endVertex.getKey());t.deleteEdge(e),n.deleteEdge(e)}},{key:"findEdge",value:function(e,t){return this.getVertexByKey(e.getKey()).findEdge(t)}},{key:"findVertexByKey",value:function(e){return this.vertices[e]?this.vertices[e]:null}},{key:"getWeight",value:function(){return this.getAllEdges().reduce((function(e,t){return e+t.weight}),0)}},{key:"reverse",value:function(){var e=this;return this.getAllEdges().forEach((function(t){e.deleteEdge(t),t.reverse(),e.addEdge(t)})),this}},{key:"getVerticesIndices",value:function(){var e={};return this.getAllVertices().forEach((function(t,n){e[t.getKey()]=n})),e}},{key:"getAdjacencyMatrix",value:function(){var e=this,t=this.getAllVertices(),n=this.getVerticesIndices(),r=Array(t.length).fill(null).map((function(){return Array(t.length).fill(1/0)}));return t.forEach((function(t,o){t.getNeighbors().forEach((function(a){var i=n[a.getKey()];r[o][i]=e.findEdge(t,a).weight}))})),r}},{key:"toString",value:function(){return Object.keys(this.vertices).toString()}}]),e}(),Li=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m()(this,e),this.value=t,this.next=n}return v()(e,[{key:"toString",value:function(e){return e?e(this.value):"".concat(this.value)}}]),e}(),Ti=function(){function e(t){m()(this,e),this.compare=t||e.defaultCompareFunction}return v()(e,[{key:"equal",value:function(e,t){return 0===this.compare(e,t)}},{key:"lessThan",value:function(e,t){return this.compare(e,t)<0}},{key:"greaterThan",value:function(e,t){return this.compare(e,t)>0}},{key:"lessThanOrEqual",value:function(e,t){return this.lessThan(e,t)||this.equal(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return this.greaterThan(e,t)||this.equal(e,t)}},{key:"reverse",value:function(){var e=this.compare;this.compare=function(t,n){return e(n,t)}}}],[{key:"defaultCompareFunction",value:function(e,t){return e===t?0:e<t?-1:1}}]),e}(),Di=function(){function e(t){m()(this,e),this.head=null,this.tail=null,this.compare=new Ti(t)}return v()(e,[{key:"prepend",value:function(e){return this.head=new Li(e,this.head),this}},{key:"append",value:function(e){var t=new Li(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)}},{key:"delete",value:function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare.equal(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare.equal(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare.equal(this.tail.value,e)&&(this.tail=n),t}},{key:"find",value:function(e){var t=e.value,n=void 0===t?void 0:t,r=e.callback,o=void 0===r?void 0:r;if(!this.head)return null;for(var a=this.head;a;){if(o&&o(a.value))return a;if(void 0!==n&&this.compare.equal(a.value,n))return a;a=a.next}return null}},{key:"deleteTail",value:function(){if(this.head===this.tail){var e=this.tail;return this.head=null,this.tail=null,e}for(var t=this.tail,n=this.head;n.next;)n.next.next?n=n.next:n.next=null;return this.tail=n,t}},{key:"deleteHead",value:function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e}},{key:"toArray",value:function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e}},{key:"toString",value:function(e){return this.toArray().map((function(t){return t.toString(e)})).toString()}}]),e}(),Ni=function(){function e(t){if(m()(this,e),void 0===t)throw new Error("Graph vertex must have a value");this.value=t,this.edges=new Di((function(e,t){return e.getKey()===t.getKey()?0:e.getKey()<t.getKey()?-1:1}))}return v()(e,[{key:"addEdge",value:function(e){return this.edges.append(e),this}},{key:"deleteEdge",value:function(e){this.edges.delete(e)}},{key:"getNeighbors",value:function(){var e=this;return this.edges.toArray().map((function(t){return t.value.startVertex===e?t.value.endVertex:t.value.startVertex}))}},{key:"getEdges",value:function(){return this.edges.toArray().map((function(e){return e.value}))}},{key:"getDegree",value:function(){return this.edges.toArray().length}},{key:"hasEdge",value:function(e){return!!this.edges.find({callback:function(t){return t===e}})}},{key:"hasNeighbor",value:function(e){return!!this.edges.find({callback:function(t){return t.startVertex===e||t.endVertex===e}})}},{key:"findEdge",value:function(e){var t=this.edges.find({callback:function(t){return t.startVertex===e||t.endVertex===e}});return t?t.value:null}},{key:"getKey",value:function(){return this.value}},{key:"deleteAllEdges",value:function(){var e=this;return this.getEdges().forEach((function(t){return e.deleteEdge(t)})),this}},{key:"toString",value:function(e){return e?e(this.value):"".concat(this.value)}}]),e}(),Bi=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;m()(this,e),this.startVertex=t,this.endVertex=n,this.weight=r}return v()(e,[{key:"getKey",value:function(){var e=this.startVertex.getKey(),t=this.endVertex.getKey();return"".concat(e,"_").concat(t)}},{key:"reverse",value:function(){var e=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=e,this}},{key:"toString",value:function(){return this.getKey()}}]),e}(),Ii=Object.freeze({__proto__:null,Graph:Mi,Vertex:Ni,Edge:Bi,LinkedList:Di});function Fi(e){return e.getNeighbors().filter((function(e){return!0!==e.visited}))}function qi(e){var t,n={};for(t=0;t<e.length;t++){var r=e[t],o=bi(r.x1,r.y1,r.x2,r.y2).string;if(n[o])"ray"===r.type&&(n[o].type="straight"),e[t]=null;else{n[o]=r;var a,i=hi(r.x1,r.y1,r.x2,r.y2);a=r.x1===r.x2?r.x1:r.y1===r.y2?r.y1:r.y1-(r.y2-r.y1)/(r.x2-r.x1)*r.x1,r.k=i,r.b=a,r.intersections=[]}}return(e=e.filter((function(e){return e}))).sort((function(e,t){return e.b-t.b})),e}function zi(e){var t,n,r=on(e=qi(e),"k"),o=[];for(t=0;t<r.length;t++){var a=r[t],i=function(){var e=r[n];a.forEach((function(t){e.forEach((function(e){var n=pi(t.x1,t.y1,t.x2,t.y2,e.x1,e.y1,e.x2,e.y2);("ray"!==t.type||Ei(t,n))&&("ray"!==e.type||Ei(e,n))&&(t.intersections.push(n),e.intersections.push(n),n.index=o.length,o.push(n))}))}))};for(n=t+1;n<r.length;n++)i()}var c=new Mi,l=o.map((function(e,t){var n=new Ni(t);return Object.assign(n,e),n})),u=[];for(t=0;t<e.length;t++){var s=e[t];for(n=0;n<s.intersections.length;n++){var d=s.intersections[n],f=s.intersections[n+1];f&&u.push(new Bi(l[d.index],l[f.index]))}}return l.forEach((function(e){c.addVertex(e)})),u.forEach((function(e){c.addEdge(e)})),c}function Gi(e,t,n,r){t=e.snap(t),n=e.snap(n);var o,a,i=t,c=Fi(i),l=[i];for(i.visited=!0,i.distance=0;c.length>0;){o=-1/0,a=void 0;for(var u=0;u<c.length;u++){var s=c[u];if(s.from=i,!s.visited){s.distance=ki(i.x,i.y,s.x,s.y)+i.distance;var d=r(s,t,n);d>o&&(a=s,o=d)}}if(a&&(c=Fi(i=a),l.push(i),i.visited=!0,i===n))break}return l}function Yi(e,t){var n,r,o=e.getTotalLength();if(0===o)return{point:{x:0,y:0},percentage:0};var a,i,c,l,u=8,s=0,d=1/0;for(c=0;c<=o;c+=u)(l=t((i=e.getPointAtLength(c)).x,i.y))<d&&(d=l,s=c,a=i);for(u/=2;u>.5;){var f=s-u,h=e.getPointAtLength(f),p=t(h.x,h.y);if(f>=0&&p<d)a=h,s=f,d=p;else{var m=s+u,y=e.getPointAtLength(m),v=t(y.x,y.y);v>=0&&v<d?(a=y,s=m,d=v):u/=2}}return{point:{x:(null===(n=a)||void 0===n?void 0:n.x)||0,y:(null===(r=a)||void 0===r?void 0:r.y)||0},percentage:s/o}}var Hi=Object.freeze({__proto__:null,deepTreeTraversal:Wt,deepTreeTraversalWithoutSelf:Xt,breadthTreeTraversal:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children},r=[];for(r.unshift(e);0!==r.length;){var o=r.shift();if(o){t(o);var a=n(o);if(a)for(var i=0;i<a.length;i++)r.push(a[i])}}},normolizeR:ti,toDegree:ni,centerPoint:function(e,t){return e=za(e),t=za(t),{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},toRadian:ri,pointRotateByPoint:function(e,t,n){e=za(e),t=za(t);var r=[e.x-t.x,e.y-t.y],o=[0,0];return k.vec2.rotate(o,r,[0,0],ri(n)),{x:o[0]+t.x,y:o[1]+t.y}},computeWidthByHW:function(e,t){var n=ri(ti(e.r));return(t-e.h*Math.abs(Math.cos(Math.PI/2-n)))/Math.abs(Math.cos(n))},roughlyEqual:oi,roughlyArrayEqual:ai,roughlyDeepEqual:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;if(Array.isArray(t)&&Array.isArray(n))return t.length===n.length&&t.every((function(t,o){return e(t,n[o],r)}));if(O()(t)&&O()(n)){for(var o=0,a=Object.keys(t);o<a.length;o++){var i=a[o];if(!e(t[i],n[i],r))return!1}return!0}return oi(t,n,r)},rectContainRect:ii,rectIntersectRect:ci,lineSlope:li,lineDistance:ui,computeXYOffset:si,findThridPoint:di,lineRadian:fi,lineIntercept:hi,lineIntersection:pi,manhattanDistance:mi,isBetween:yi,isEqlPoint:vi,lineSegmentIntersect:gi,getLineEquation:bi,lineSegmentIntersectRect:xi,pointInLine:wi,pointToPointDistance:ki,isInRay:Ei,clockwiseAngle:Oi,radialQuadrantSegmentationGenerator:Ci,normalize2D:function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return[1/t*e[0],1/t*e[1]]},getOffset:function(e,t){return Math.max(Math.max(Math.abs(Math.abs(e[0])-Math.abs(t[0])),Math.abs(Math.abs(e[1])-Math.abs(t[1])))/3,4)},isPointLiesLineRight:Ai,isPointInRect:Pi,intersectingAreaOfTwoRects:Si,rotateByPoint:ji,getMidPointsFromQuadraticBezierPath:Ri,calculateLine:qi,linesToGraph:zi,snapPoint:function(e,t){for(var n={vertex:void 0,distance:1/0},r=e.getAllVertices(),o=0;o<r.length;o++){var a=r[o];if(a.x===t.x&&a.y===t.y)return a;var i=mi(a.x,a.y,t.x,t.y);i<n.distance&&(n.vertex=a,n.distance=i)}return n.vertex},pathFinding:Gi,binaryFindPoint:Yi});function Vi(e,t,n,r){var o=t.split(".");if(!o.reduce((function(e,t){return e&&e[t]}),e)||r)for(var a=o.length,i=0;i<a;i++){var c=o[i];i===a-1?e[c]=n:(d()(e[c])||(e[c]={}),e=e[c])}}var Ui=function(e){return!!e.type&&"line"===e.type},Wi=function(e){return!!e.type&&("freehand"===e.type||"pen"===e.type)},Xi=function(e){return!!e.type&&"dsl"===e.type},Ki=function(e){return!!e.type&&"geometry"===e.type},Zi=function(e){return!!e.type&&"stack"===e.type},Qi=function(e){return!!e.type&&"swimlane"===e.type},$i=function(e){return!!e.type&&"text"===e.type};var Ji=[{name:"rect",category:"basic",width:100,height:100,outline:{name:"polygon",points:[{x:0,y:0},{x:100,y:0},{x:100,y:100},{x:0,y:100}]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,23.6],["C",24,23.8209139,23.8209139,24,23.6,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"rounded-rect",category:"basic",width:100,height:100,round:10,outline:{path:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e/2,a=t/2,i=Math.min(e,t);r>=i/2&&(r=i/2);var c=o<r?o:r,l=a<r?a:r;return[["M",+c+0,0],["l",e-2*c,0],["a",c,l,0,0,1,c,l],["l",0,t-2*l],["a",c,l,0,0,1,-c,l],["l",2*c-e,0],["a",c,l,0,0,1,-c,-l],["l",0,2*l-t],["a",c,l,0,0,1,c,-l],["z"]]}},scene:[],thumb:[{d:[["M",11,8],["L",21,8],["C",22.6568542,8,24,9.3431458,24,11],["L",24,21],["C",24,22.6568542,22.6568542,24,21,24],["L",11,24],["C",9.3431458,24,8,22.6568542,8,21],["L",8,11],["C",8,9.3431458,9.3431458,8,11,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"triangle",category:"basic",width:100,height:87,outline:{name:"polygon",points:[{x:50,y:0},{x:100,y:87},{x:-141931921e-23,y:87}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:8},{x:25,y:24},{x:7,y:24}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:1},{x:1,y:1}]},{name:"cross",category:"basic",width:80,height:80,outline:{d:[["M",56,0],["C",57.1045695,-0,58,.8954305,58,2],["L",58,22],["L",78,22],["C",79.1045695,22,80,22.8954305,80,24],["L",80,56],["C",80,57.1045695,79.1045695,58,78,58],["L",58,58],["L",58,78],["C",58,79.1045695,57.1045695,80,56,80],["L",24,80],["C",22.8954305,80,22,79.1045695,22,78],["L",22,57.999],["L",2,58],["C",.8954305,58,0,57.1045695,0,56],["L",0,24],["C",0,22.8954305,.8954305,22,2,22],["L",22,21.999],["L",22,2],["C",22,.8954305,22.8954305,0,24,0],["L",56,0],["Z"]]},scene:[],thumb:[{d:[["M",18.8909091,7],["C",19.5536508,7,20.0909091,7.5372583,20.0909091,8.2],["L",20.09,11.909],["L",23.8,11.9090909],["C",24.4627417,11.9090909,25,12.4463492,25,13.1090909],["L",25,18.8909091],["C",25,19.5536508,24.4627417,20.0909091,23.8,20.0909091],["L",20.09,20.09],["L",20.0909091,23.8],["C",20.0909091,24.4627417,19.5536508,25,18.8909091,25],["L",13.1090909,25],["C",12.4463492,25,11.9090909,24.4627417,11.9090909,23.8],["L",11.909,20.09],["L",8.2,20.0909091],["C",7.5372583,20.0909091,7,19.5536508,7,18.8909091],["L",7,13.1090909],["C",7,12.4463492,7.5372583,11.9090909,8.2,11.9090909],["L",11.909,11.909],["L",11.9090909,8.2],["C",11.9090909,7.5372583,12.4463492,7,13.1090909,7],["L",18.8909091,7],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"cloud",category:"basic",width:112,height:80,outline:{d:[["M",20.6665465,28.3657378],["C",9.0184823,12.0418488,29.8104362,1.5251218,41.8853768,16.5362653],["C",41.1592489,-4.3380418,87.3193529,-8.1490155,88.6486324,20.930009],["C",103.875914,12.7155897,116.726702,29.8609474,101.339386,39.434501],["C",122.97831,47.5058532,108.447103,73.4138921,86.4692273,64.7475232],["C",86.3334719,64.958338,86.1921896,65.1661294,86.0455508,65.3708699],["C",81.9792975,83.9250756,49.2991196,84.5216854,42.2982472,68.9125048],["C",27.3426857,79.041314,7.4780067,68.88778,15.843504,56.1252668],["C",-8.1440256,55.1167183,-3.5710215,23.0030303,20.6665465,28.3657378],["Z"]]},scene:[],thumb:[{d:[["M",9.0595002,13.6731476],["C",6.7714876,10.4083698,10.8556214,8.3050244,13.2274847,11.3072531],["C",13.0848525,7.1323916,22.1520157,6.3701969,22.4131242,12.1860018],["C",25.4041974,10.5431179,27.9284594,13.9721895,24.9059508,15.8869002],["C",29.1564537,17.5011706,26.3021096,22.6827784,21.9850268,20.9495046],["C",21.9583605,20.9916676,21.9306087,21.0332259,21.9018046,21.074174],["C",21.1030763,24.7850151,14.6837556,24.9043371,13.3085843,21.782501],["C",10.3708847,23.8082628,6.4688942,21.777556,8.1121169,19.2250534],["C",3.4002807,19.0233437,4.2985494,12.6006061,9.0595002,13.6731476],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"pentagon-arrow",category:"basic",width:120,height:50,textarea:{region:function(e,t){var n=t/50*25;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:4,minY:4,maxX:e-n/2-4,maxY:t-4}}},outline:{path:function(e,t){var n=t/50*25;return n>=e?[["M",0,0],["L",e,t/2],["L",0,t],["Z"]]:[["M",0,0],["L",e-n,0],["L",e,t/2],["L",e-n,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",7.4,10],["L",18.8343146,10],["C",18.9404012,10,19.0421427,10.0421427,19.1171573,10.1171573],["L",25,16],["L",25,16],["L",19.1171573,21.8828427],["C",19.0421427,21.9578573,18.9404012,22,18.8343146,22],["L",7.4,22],["C",7.1790861,22,7,21.8209139,7,21.6],["L",7,10.4],["C",7,10.1790861,7.1790861,10,7.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"process-arrow",category:"basic",width:120,height:50,textarea:{region:function(e,t){var n=t/50*25;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n+4,minY:4,maxX:e-n/2-4,maxY:t-4}}},outline:{path:function(e,t){var n=t/50;return 25*n>=e?[["M",0,0],["L",e,t/2],["L",0,t]]:[["M",0,0],["L",e-25*n,0],["L",e,t/2],["L",e-25*n,t],["L",0,t],["L",25*n,t/2],["L",0,0],["Z"]]}},scene:[],thumb:[{d:[["M",19.9439083,10],["C",20.0481092,10,20.1480423,10.0421427,20.2217235,10.1171573],["L",26,16],["L",20.2217235,21.8828427],["C",20.1480423,21.9578573,20.0481092,22,19.9439083,22],["L",6.3928901,22],["C",6.1759029,22,6,21.8209139,6,21.6],["C",6,21.4939134,6.0413937,21.3921718,6.1150748,21.3171573],["L",11.3377208,16],["L",6.1150748,10.6828427],["C",5.9616417,10.526633,5.9616417,10.273367,6.1150748,10.1171573],["C",6.188756,10.0421427,6.2886892,10,6.3928901,10],["L",19.9439083,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-1",category:"basic",width:100,height:80,textarea:{region:function(e,t){var n=t/80*50;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n/2,minY:.25*t+4,maxX:e-4,maxY:.75*t-4}}},outline:{path:function(e,t){var n=t/80*50;return n>=e?[["M",e,0],["L",0,t/2],["L",e,t],["Z"]]:[["M",n,t/4],["L",n,0],["L",0,t/2],["L",n,t],["L",n,3*t/4],["L",e,3*t/4],["L",e,t/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.2620321,y:7.99867328},{x:7,y:15.9997347},{x:16.2620321,y:23.9986733},{x:16.2620321,y:19.9277347},{x:25.7357163,y:19.9277347},{x:25.7357163,y:12.1917347},{x:16.2620321,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-2",category:"basic",width:100,height:80,textarea:{region:function(e,t){var n=t/80*50;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:4,minY:.25*t+4,maxX:e-n/2,maxY:.75*t-4}}},outline:{path:function(e,t){var n=t/80;return 50*n>=e?[["M",0,0],["L",e,t/2],["L",0,t],["Z"]]:[["M",e-50*n,t/4],["L",e-50*n,0],["L",e,t/2],["L",e-50*n,t],["L",e-50*n,3*t/4],["L",0,3*t/4],["L",0,t/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.4736842,y:7.99867328},{x:25.7357163,y:15.9997347},{x:16.4736842,y:23.9986733},{x:16.4736842,y:19.9277347},{x:7,y:19.9277347},{x:7,y:12.1917347},{x:16.4736842,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-3",category:"basic",width:138,height:80,textarea:{region:function(e,t){var n=t/80*46;return 2*n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n/2,minY:.3125*t+4,maxX:e-4-n/2,maxY:.6875*t-4}}},outline:{path:function(e,t){var n=.3125,r=.6875,o=t/80*46;return 2*o>=e?[["M",e/2,0],["L",0,t/2],["L",e/2,t],["L",e,t/2],["Z"],["M",e/2,0],["L",e/2,t*n],["M",e/2,t],["L",e/2,t*r]]:[["M",e-o,n*t],["L",e-o,0],["L",e,t/2],["L",e-o,t],["L",e-o,t*r],["L",o,t*r],["L",o,t],["L",0,t/2],["L",o,0],["L",o,t*n],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:19.8639344,y:8},{x:27.109397,y:16},{x:19.8639344,y:24},{x:19.8639344,y:19.1800649},{x:12.5968509,y:19.1800649},{x:12.5968509,y:24},{x:5.10939702,y:16.0010614},{x:12.5968509,y:8},{x:12.5968509,y:12.9324943},{x:19.8639344,y:12.9324943}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"circle",category:"basic",width:100,height:100,outline:{name:"ellipse",cx:50,cy:50,rx:50,ry:50},scene:[],thumb:[{name:"ellipse",cx:16,cy:16.5333333,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment-2",category:"basic",width:120,height:100,controlPoints:[[.25,.75],[.25,1],[.5,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],textarea:{region:function(e,t,n){return{minX:4,minY:4,maxX:e-4,maxY:Jt(n[0][1],0,1)*t-4}}},outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.25,.75],[.25,1],[.5,.75]]).map((function(n){return[Jt(n[0],0,1)*e,Jt(n[1],0,1)*t]})),r=Math.min(e/2,t/2,8,n[0][1]/2,n[0][0]/2,(e-n[2][0])/2);return[["M",r,0],["l",e-2*r,0],["a",r,r,0,0,1,r,r],["l",0,n[0][1]-2*r],["a",r,r,0,0,1,-r,r],["L",n[2][0],n[2][1]],["L",n[1][0],n[1][1]],["L",n[0][0],n[0][1]],["l",r-n[0][0],0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-n[0][1]],["a",r,r,0,0,1,r,-r],["Z"]]}},scene:[],thumb:[{d:[["M",10,9],["L",22,9],["C",23.6568542,9,25,10.3431458,25,12],["L",25,18.700459],["C",25,20.3573132,23.6568542,21.700459,22,21.700459],["L",15.4989962,21.700459],["L",15.4989962,21.700459],["L",10.5156524,25.2421473],["L",10.5156524,21.7],["L",10,21.7],["C",8.3431458,21.7,7,20.3568542,7,18.7],["L",7,12],["C",7,10.3431458,8.3431458,9,10,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment",category:"basic",width:120,height:100,controlPoints:[[.4,.75],[.5,1],[.6,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.4,.75],[.5,1],[.6,.75]]).map((function(n){return[Jt(n[0],0,1)*e,Jt(n[1],0,1)*t]}));return[["M",0,0],["L",0,n[0][1]],["L",n[0][0],n[0][1]],["L",n[1][0],n[1][1]],["L",n[2][0],n[2][1]],["L",e,n[2][1]],["L",e,0],["Z"]]}},scene:[],thumb:[{d:[["M",7,22],["C",6.4477153,22,6,21.5522847,6,21],["L",6,10],["C",6,9.4477153,6.4477153,9,7,9],["L",25,9],["C",25.5522847,9,26,9.4477153,26,10],["L",26,21],["C",26,21.5522847,25.5522847,22,25,22],["L",18,22],["L",16,25],["L",14,22],["L",7,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],textarea:{region:function(e,t,n){return{minX:4,minY:4,maxX:e-4,maxY:Jt(n[0][1],0,1)*t-4}}}},{name:"diamond",category:"basic",width:100,height:100,outline:{d:[["M",50.5029462,.2083271],["L",99.7916729,49.4970538],["C",100.069442,49.7748233,100.069442,50.2251767,99.7916729,50.5029462],["L",50.5029462,99.7916729],["C",50.2251767,100.069442,49.7748233,100.069442,49.4970538,99.7916729],["L",.2083271,50.5029462],["C",-.0694424,50.2251767,-.0694424,49.7748233,.2083271,49.4970538],["L",49.4970538,.2083271],["C",49.7748233,-.0694424,50.2251767,-.0694424,50.5029462,.2083271],["Z"]]},scene:[],thumb:[{d:[["M",16.2852309,7.0928427],["L",24.9119336,15.7195454],["C",25.0681433,15.8757552,25.0681433,16.1290212,24.9119336,16.2852309],["L",16.2852309,24.9119336],["C",16.1290212,25.0681433,15.8757552,25.0681433,15.7195454,24.9119336],["L",7.0928427,16.2852309],["C",6.936633,16.1290212,6.936633,15.8757552,7.0928427,15.7195454],["L",15.7195454,7.0928427],["C",15.8757552,6.936633,16.1290212,6.936633,16.2852309,7.0928427],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"parallelogram",category:"basic",width:160,height:80,controlPoints:[[.1875,.25]],controlPointsConfig:[{x:{limit:[0,.75]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.1875,.25]]).map((function(n){return[Jt(n[0],0,1)*e,Jt(n[1],0,1)*t]}));return[["M",4*n[0][0]/3,0],["L",0,t],["L",e-4*n[0][0]/3,t],["L",e,0],["Z"]]}},scene:[],thumb:[{d:[["M",11.2637585,9],["L",26.3933844,9],["C",26.6142983,9,26.7933844,9.1790861,26.7933844,9.4],["C",26.7933844,9.4541707,26.7823813,9.507777,26.7610424,9.5575677],["L",21.1038995,22.7575677],["C",21.040868,22.9046413,20.8962528,23,20.7362415,23],["L",5.6066156,23],["C",5.3857017,23,5.2066156,22.8209139,5.2066156,22.6],["C",5.2066156,22.5458293,5.2176187,22.492223,5.2389576,22.4424323],["L",10.8961005,9.2424323],["C",10.959132,9.0953587,11.1037472,9,11.2637585,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"star",category:"basic",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:75},{x:18.6107374,y:91},{x:24.2235871,y:57.7254249},{x:0,y:34.5491503},{x:33.3053687,y:29.7745751},{x:48,y:0},{x:62.6946313,y:29.7745751},{x:96,y:34.5491503},{x:71.7764129,y:57.7254249},{x:77.3892626,y:91}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:21},{x:10.1221475,y:24.0901699},{x:11.2447174,y:17.545085},{x:6.48943484,y:12.9098301},{x:13.0610737,y:11.954915},{x:16,y:6},{x:18.9389263,y:11.954915},{x:25.5105652,y:12.9098301},{x:20.7552826,y:17.545085},{x:21.8778525,y:24.0901699}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:0,y:.38},{x:1,y:.38},{x:18.6107374/96,y:1},{x:77.3892626/96,y:1}]},{name:"trapezoid",category:"basic",width:140,height:80,controlPoints:[[.75,0]],controlPointsConfig:[{x:{limit:[.5,1]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.75,0]]).map((function(n){return[Jt(n[0],0,1)*e,Jt(n[1],0,1)*t]}));return[["M",e-n[0][0],0],["L",n[0][0],0],["L",e,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",6.4000995,22],["L",25.3553854,22],["C",25.5762993,22,25.7553854,21.8209139,25.7553854,21.6],["C",25.7553854,21.5646094,25.7506887,21.5293754,25.7414182,21.4952206],["L",22.7014434,10.2952206],["C",22.6541459,10.120965,22.4959711,10,22.3154107,10],["L",9.4095965,10],["C",9.228659,10,9.0702525,10.1214609,9.0232992,10.2962],["L",6.0138022,21.4962],["C",5.956475,21.709546,6.0829534,21.9289701,6.2962994,21.9862972],["C",6.3301496,21.995393,6.3650485,22,6.4000995,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],ec=[{name:"collate",category:"flowchart",width:42,height:36,textarea:{region:Ja},outline:{d:[["M",40.3837262,0],["C",40.6808145,0,40.9625216,.132096,41.1525116,.3604931],["C",41.478533,.7524209,41.4542938,1.3198118,41.1146853,1.6825771],["L",41.0232331,1.7687854],["L",20.9996243,18.0064637],["L",41.0232331,34.2312146],["C",41.2190021,34.3940632,41.3440192,34.6242958,41.3757431,34.8738407],["L",41.3837518,35],["C",41.3837518,35.5128358,40.997686,35.9355072,40.5003473,35.9932723],["L",40.3837262,36],["L",1.9253140000000002,36],["C",1.6282257999999992,36,1.3465187000000007,35.867904,1.1565287000000009,35.6395069],["C",.8305071999999996,35.2475791,.8547464999999992,34.6801882,1.1943549999999998,34.317423],["L",1.2858070999999995,34.2312146],["L",20.9996243,18.0064637],["L",1.2858070999999995,1.7687854],["C",1.0900382000000004,1.6059368,.9650210999999995,1.3757042,.9332972000000002,1.1261593],["L",.9252885000000006,1],["C",.9252885000000006,.4871642,1.3113542000000002,.0644928,1.8086929000000005,.0067277],["L",1.9253140000000002,0],["L",40.3837262,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6671476,9],["C",23.787916,9,23.9022194,9.0545637,23.9781629,9.1484658],["C",24.1170814,9.3202349,24.0904508,9.5720969,23.9186817,9.7110154],["L",23.9186817,9.7110154],["L",16.142839,16],["L",23.9186817,22.2889846],["C",23.9938034,22.3497394,24.0437485,22.4350446,24.0607217,22.5285699],["L",24.0671476,22.6],["C",24.0671476,22.8209139,23.8880615,23,23.6671476,23],["L",23.6671476,23],["L",8.3328524,23],["C",8.212084,23,8.0977806,22.9454363,8.0218371,22.8515342],["C",7.8829186,22.6797651,7.9095492,22.4279031,8.0813183,22.2889846],["L",8.0813183,22.2889846],["L",15.856839,16],["L",8.0813183,9.7110154],["C",8.0061966,9.6502606,7.9562515,9.5649554,7.9392783,9.4714301],["L",7.9328524,9.4],["C",7.9328524,9.1790861,8.1119385,9,8.3328524,9],["L",8.3328524,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.02,name:"NW"},{x:0,y:.98,name:"SW"},{x:1,y:.02,name:"NE"},{x:1,y:.98,name:"SE"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"connector",category:"flowchart",width:44,height:44,textarea:{region:Ja},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"data",category:"flowchart",width:124,height:60,textarea:{region:function(e,t){return{minX:.15*e,minY:4,maxX:e-.15*e-4,maxY:t-4}}},outline:{d:[["M",17.1403103,0],["L",122.687657,0],["C",123.239942,-0,123.687657,.4477153,123.687657,1],["C",123.687657,1.0896438,123.675604,1.1788806,123.65182,1.2653118],["L",107.823852,58.7853118],["C",107.704434,59.2192873,107.309796,59.52,106.85969,59.52],["L",1.3123427,59.52],["C",.7600579,59.52,.3123427,59.0722847,.3123427,58.52],["C",.3123427,58.4303562,.3243965,58.3411194,.34818,58.2546882],["L",16.1761477,.7346882],["C",16.2955661,.3007127,16.6902043,-0,17.1403103,0],["Z"]]},scene:[],thumb:[{d:[["M",7.6068779,10],["L",27.4750629,10],["C",27.6959768,10,27.8750629,10.1790861,27.8750629,10.4],["C",27.8750629,10.4358575,27.8702414,10.4715522,27.860728,10.5061247],["L",24.7787871,21.7061247],["C",24.7310198,21.8797149,24.5731645,22,24.3931221,22],["L",4.5249371,22],["C",4.3040232,22,4.1249371,21.8209139,4.1249371,21.6],["C",4.1249371,21.5641425,4.1297586,21.5284478,4.139272,21.4938753],["L",7.2212129,10.2938753],["C",7.2689802,10.1202851,7.4268355,10,7.6068779,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.095,y:.5,name:"W"},{x:.905,y:.5,name:"E"},{x:.23,y:.02,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.77,y:.98,name:"SE"}]},{name:"database",category:"flowchart",width:70,height:80,textarea:{region:function(e,t){return{minX:4,minY:4+.2*t,maxX:e-4,maxY:t-4}}},outline:{d:[["M",35,0],["C",53.9753466,0,69.4238162,5.273994,69.9842524,11.8539517],["L",69.995311,11.8537712],["L",69.995311,12.022052],["L",70,12.2242015],["C",70,12.2917139,69.998433,12.3590985,69.995311,12.426351],["L",69.995311,67.977948],["C",69.6862333,74.6359505,54.1366666,80,35,80],["C",16.0547001,80,.6251167,74.7426951,.0185218,68.1772958],["L",.004689,67.977948],["L",0,11.8537712],["L",.0157476,11.8539517],["C",.5761838,5.273994,16.0246534,0,35,0],["Z"]]},scene:[{d:[["M",70,13],["C",70,19.0751322,54.3299662,24,35,24],["C",15.8633334,24,.3137667,19.1731371,.004689,13.1819051],["L",0,13]],attr:{fill:"transparent"}}],thumb:[{d:[["M",16,7],["C",20.337222099999998,7,23.8683009,8.1866487,23.9964006,9.6671391],["L",23.9989282,9.6670985],["L",23.9989282,9.7049617],["L",24,9.750445299999999],["C",24,9.7656356,23.9996418,9.7807972,23.9989282,9.795929000000001],["L",23.9989282,22.2950383],["C",23.9282819,23.7930889,20.3740952,25,16,25],["C",11.6696457,25,8.1428838,23.8171064,8.0042336,22.3398916],["L",8.0010718,22.2950383],["L",8,9.6670985],["L",8.0035994,9.6671391],["C",8.1316991,8.1866487,11.6627779,7,16,7],["Z"]]},{d:[["M",24,10],["C",24,11.1045695,20.418278,12,16,12],["C",11.6259048,12,8.0717181,11.1223886,8.0010718,10.0330737],["L",8,10]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.15,name:"NW"},{x:0,y:.85,name:"SW"},{x:1,y:.15,name:"NE"},{x:1,y:.85,name:"SE"}]},{name:"decision",category:"flowchart",width:140,height:70,textarea:{region:function(e,t){return{minX:24,minY:1/8*t,maxX:e-24,maxY:7/8*t}}},outline:{name:"polygon",points:[{x:70,y:0},{x:140,y:35},{x:70,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",5.5303015,15.6625354],["L",15.7852498,9.1366592],["C",15.9162764,9.0532787,16.0837236,9.0532787,16.2147502,9.1366592],["L",26.4696985,15.6625354],["C",26.656075,15.7811387,26.7110162,16.0283736,26.5924129,16.2147502],["C",26.5609814,16.2641425,26.5190908,16.3060331,26.4696985,16.3374646],["L",16.2147502,22.8633408],["C",16.0837236,22.9467213,15.9162764,22.9467213,15.7852498,22.8633408],["L",5.5303015,16.3374646],["C",5.343925,16.2188613,5.2889839,15.9716264,5.4075871,15.7852498],["C",5.4390186,15.7358575,5.4809092,15.6939669,5.5303015,15.6625354],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"delay",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:4,minY:4,maxX:.81*e,maxY:t-4}}},outline:{d:[["M",1,0],["L",90,0],["C",106.568542,-0,120,13.4314575,120,30],["C",120,46.5685425,106.568542,60,90,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,11.0666667],["L",20,11.0666667],["C",23.3137085,11.0666667,26,13.7529582,26,17.0666667],["C",26,20.3803752,23.3137085,23.0666667,20,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,11.4666667],["C",6,11.2457528,6.1790861,11.0666667,6.4,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.81,y:0,name:"NE"},{x:.81,y:1,name:"SE"}]},{name:"display",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:.15*e+4,minY:4,maxX:.9*e,maxY:t-4}}},outline:{d:[["M",18.559242,0],["L",108.388294,0],["C",108.593661,-124e-7,108.794047,.0632157,108.962224,.18108],["C",116.320741,5.3381999,120,15.2778399,120,30],["C",120,43.9124351,116.326183,53.8383306,108.978548,59.7776865],["C",108.800609,59.9215337,108.578719,60,108.349908,60],["L",18.559242,60],["C",18.2079174,60,17.8823628,59.8156369,17.70166,59.5143473],["L",.3084873,30.5143473],["C",.1185966,30.1977386,.1185966,29.8022614,.3084873,29.4856527],["L",17.70166,.4856527],["C",17.8823628,.1843631,18.2079174,0,18.559242,0],["Z"]]},scene:[],thumb:[{d:[["M",8.7974767,10],["L",24.1863956,10],["L",24.1863956,10],["C",25.6811795,11.0207233,26.4285714,13.0207233,26.4285714,16],["C",26.4285714,18.8174994,25.6811795,20.8174994,24.1863956,22],["L",8.7974767,22],["C",8.6564465,22,8.525838,21.9257329,8.4537242,21.8045343],["L",5.1216988,16.2045343],["C",5.0467021,16.0784903,5.0467021,15.9215097,5.1216988,15.7954657],["L",8.4537242,10.1954657],["C",8.525838,10.0742671,8.6564465,10,8.7974767,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.2,y:.14,name:"NW"},{x:.2,y:.86,name:"SW"},{x:.92,y:.14,name:"NE"},{x:.92,y:.86,name:"SE"}]},{name:"document",category:"flowchart",width:120,height:72,outline:{d:[["M",1,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,63.2943312],["C",119.999975,63.8466024,119.552271,64.2943066,119,64.2943066],["C",118.874051,64.2943066,118.749236,64.2705132,118.63212,64.2241781],["C",108.562735,60.240377,99.0186463,58.2432881,89.9998549,58.2329113],["C",75.8605271,58.216643,73.9215376,58.9595768,59.9999032,65.0379103],["C",46.0782688,71.1162438,44.1653018,71.9832913,29.9999516,72],["C",20.7325008,72.010162,10.9291929,69.6914094,.590028,65.0437423],["C",.2309588,64.882365,-0,64.5253236,0,64.1316572],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6,10],["L",26,10],["L",26,23.0414063],["C",24.237687,22.2996937,22.5710122,21.9279131,20.9999758,21.9260644],["C",18.6434212,21.9232914,18.3202563,22.0499279,15.9999839,23.0860074],["C",13.6797115,24.122087,13.3608836,24.2698792,11,24.2726331],["C",9.4260668,24.274461,7.7594002,23.864052,6,23.0414063],["L",6,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.9,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:0,y:.9,name:"SW"},{x:.98,y:.015,name:"NE"},{x:1,y:.9,name:"SE"}]},{name:"internal-storage",category:"flowchart",width:80,height:80,textarea:{region:function(e,t){return{minX:.1*e+4,minY:1/8*t+4,maxX:e-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:80,height:80,rx:0,ry:0},scene:[{d:[{name:"M",x:0,y:8},{name:"L",x:80,y:8}]},{d:[{name:"M",x:8,y:0},{name:"L",x:8,y:80}]}],thumb:[{name:"rect",x:8,y:8,width:17,height:17,rx:.4,ry:.4},{d:[{name:"M",x:8.5,y:12.5},{name:"L",x:24.5,y:12.5}]},{d:[{name:"M",x:12.5,y:8.5},{name:"L",x:12.5,y:24.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"loop-limit",category:"flowchart",width:120,height:60,outline:{d:[["M",17.5871195,0],["L",102.429999,0],["C",102.7204,-0,102.996458,.1262398,103.186409,.3459021],["L",119.75641,19.5077312],["C",119.913532,19.6894304,120,19.9216166,120,20.1618291],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1621158],["C",0,19.92173,.0865921,19.6893882,.2439196,19.5076371],["L",16.831039,.3455213],["C",17.0209853,.1260876,17.2968941,0,17.5871195,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,11.0666667],["L",22.4862374,11.0666667],["C",22.6043417,11.0666667,22.7164089,11.1188597,22.7924108,11.2092607],["L",25.9061734,14.9129485],["C",25.9667743,14.9850307,26,15.0761829,26,15.1703545],["L",26,22.6666667],["C",26,22.8875806,25.8209139,23.0666667,25.6,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,15.1704681],["C",6,15.0762275,6.0332743,14.9850132,6.0939556,14.9129087],["L",9.210984,11.2091073],["C",9.286986,11.118798,9.3989942,11.0666667,9.5170283,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.15,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.9,y:.15,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-input",category:"flowchart",width:118,height:60,textarea:{region:function(e,t){return{minX:4,minY:t*(2/7)+4,maxX:e-4,maxY:t-4}}},outline:{d:[["M",.8676336,15.6420323],["L",116.867634,.1512179],["C",117.415059,.0781139,117.918097,.4626272,117.991201,1.0100523],["C",117.99706,1.0539311,118,1.0981505,118,1.1424188],["L",118,59],["C",118,59.5522847,117.552285,60,117,60],["L",1,60],["C",.4477152,60,0,59.5522847,0,59],["L",0,16.6332332],["C",0,16.1321084,.3709182,15.7083644,.8676336,15.6420323],["Z"]]},scene:[],thumb:[{d:[["M",6.3471791,12.618128],["L",25.5471791,10.0603243],["C",25.7661584,10.0311521,25.9673249,10.1850212,25.9964971,10.4040005],["C",25.9988298,10.4215108,26,10.4391564,26,10.4568214],["L",26,21.2666667],["C",26,21.4875806,25.8209139,21.6666667,25.6,21.6666667],["L",6.4,21.6666667],["C",6.1790861,21.6666667,6,21.4875806,6,21.2666667],["L",6,13.0146251],["C",6,12.8141269,6.1484367,12.6446042,6.3471791,12.618128],["Z"]]}],anchors:[{x:.5,y:.195,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-loop",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){var n=.14*e;return{minX:n,minY:4,maxX:e-n,maxY:t-4}}},outline:{d:[["M",1.3143594,0],["L",118.682087,0],["C",119.234371,-0,119.682087,.4477153,119.682087,1],["C",119.682087,1.0910107,119.669662,1.1815953,119.645158,1.2692451],["L",103.43015,59.2692451],["C",103.309369,59.7012703,102.915669,60,102.467078,60],["L",17.3668015,60],["C",16.917245,60,16.5229467,59.7000072,16.4030326,59.2667387],["L",.3505905,1.2667387],["C",.2032748,.7344638,.5153458,.1835468,1.0476207,.0362311],["C",1.1344943,.0121874,1.2242199,-0,1.3143594,0],["Z"]]},scene:[],thumb:[{d:[["M",6.5216709,11.0666667],["L",25.4769568,11.0666667],["C",25.6978707,11.0666667,25.8769568,11.2457528,25.8769568,11.4666667],["C",25.8769568,11.5020572,25.8722601,11.5372913,25.8629896,11.5714461],["L",22.8230148,22.7714461],["C",22.7757173,22.9457017,22.6175425,23.0666667,22.4369821,23.0666667],["L",9.5311679,23.0666667],["C",9.3502305,23.0666667,9.1918239,22.9452058,9.1448706,22.7704667],["L",6.1353736,11.5704667],["C",6.0780465,11.3571206,6.2045248,11.1376966,6.4178708,11.0803694],["C",6.451721,11.0712737,6.4866199,11.0666667,6.5216709,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.1,y:.5,name:"W"},{x:.9,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.22,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.78,y:.985,name:"SE"}]},{name:"merge",category:"flowchart",width:50,height:36,textarea:{region:Ja},outline:{d:[["M",48.9094474,1.5703958],["L",25.82137,34.8172272],["C",25.5063491,35.2708574,24.883234299999998,35.3832223,24.4296042,35.0682014],["C",24.3316502,35.0001778,24.246653600000002,34.9151812,24.17863,34.8172272],["L",1.0905526000000005,1.5703958],["C",.7755317000000002,1.1167657,.8878967000000006,.4936509,1.3415268000000005,.17863],["C",1.5090014000000007,.0623282,1.7080259000000009,0,1.9119226000000005,0],["L",48.0880774,0],["C",48.6403621,0,49.0880774,.4477153,49.0880774,1],["C",49.0880774,1.2038967,49.0257492,1.4029212,48.9094474,1.5703958],["Z"]]},scene:[],thumb:[{d:[["M",25.5482177,9.6324953],["L",16.3254934,22.5443093],["C",16.1970898,22.7240743,15.9472698,22.765711,15.7675047,22.6373074],["C",15.7315865,22.6116515,15.7001625,22.5802275,15.6745066,22.5443093],["L",6.4517823,9.6324953],["C",6.3233787,9.4527302,6.3650154,9.2029102,6.5447805,9.0745066],["C",6.6126207,9.0260493,6.6939065,9,6.7772757,9],["L",25.2227243,9],["C",25.4436382,9,25.6227243,9.1790861,25.6227243,9.4],["C",25.6227243,9.4833692,25.596675,9.564655,25.5482177,9.6324953],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:0,y:1,name:"SW"},{x:1,y:0,name:"NE"},{x:1,y:1,name:"SE"}]},{name:"multi-document",category:"flowchart",isClip:!1,width:120,height:80,textarea:{region:function(e,t){return{minX:4,minY:.2*t,maxX:11/12*e-4,maxY:.8*t}}},outline:{d:[["M",119,-0],["C",119.552285,-0,120,.4477153,120,1],["L",120,57.6634711],["C",120.00004,58.2157781,119.552307,58.6635113,119,58.6635113],["C",118.846121,58.6635113,118.694318,58.6280008,118.556406,58.5597438],["C",117.079303,57.8286782,115.893834,57.3066398,115,56.9936286],["L",114.744,56.868],["L",114.744526,63.1694166],["C",114.744553,63.7217167,114.296826,64.1694445,113.744526,64.1694445],["C",113.610972,64.1694445,113.478771,64.1426929,113.355724,64.0907684],["C",111.834645,63.4488877,110.620494,62.9604303,109.71327,62.6253962],["L",109.714286,71.1461039],["C",109.714249,71.6983687,109.26655,72.1460677,108.714286,72.1460677],["C",108.59377,72.1460677,108.474247,72.1242823,108.361482,72.0817624],["C",98.4971172,68.3622546,89.1471649,66.4976545,80.3116246,66.4879622],["C",66.4538962,66.4727606,64.5535237,67.1669765,50.9091531,72.8467226],["C",37.2647825,78.5264687,35.3899142,79.3366596,21.5066816,79.351889],["C",12.4628087,79.3615937,5.4112062,77.2136321,.351874,72.9080041],["C",.1286374,72.7179927,0,72.4396044,0,72.1464509],["L",0,11.7804604],["C",0,11.2281757,.4477153,10.7804604,1,10.7804604],["L",5.255,10.78],["L",5.2554745,6.3902302],["C",5.2554745,5.8379455,5.7031897,5.3902302,6.2554745,5.3902302],["L",10.51,5.39],["L",10.5109489,1],["C",10.5109489,.4477153,10.9586642,-0,11.5109489,-0],["L",119,-0],["Z"]]},scene:[{d:[["M",10,5.3902302],["L",113.744526,5.3902302],["C",114.29681,5.3902302,114.744526,5.8379455,114.744526,6.3902302],["L",114.744526,61.6827625],["L",114.744526,61.6827625]],attr:{fill:"transparent"}},{d:[["M",3,10.7804604],["L",108.714286,10.7804604],["C",109.26657,10.7804604,109.714286,11.2281757,109.714286,11.7804604],["L",109.714286,69.602221],["L",109.714286,69.602221]],attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4444444,10.4296499],["L",8.4444444,8],["L",28.4444444,8],["L",28.4444444,19.5606936],["C",28.0673004,19.4077004,26.2625497,18.3360173,25.8924529,18.2092979]]},{d:[["M",6.2222222,13.090719],["L",6.2222222,10.7555556],["L",25.4444444,10.7555556],["L",25.4444444,21.8666667],["C",25.0819671,21.7196232,23.3557041,21.1217914,23,21]]},{d:[["M",4.3333333,13.5111111],["L",22.3333333,13.5111111],["L",22.3333333,23.8011738],["C",20.6331063,23.1515551,19.0251483,22.8259361,17.5094592,22.824317],["C",15.2359257,22.8218883,14.9241458,22.9328011,12.6856163,23.8402371],["C",10.4470867,24.7476731,10.1394911,24.8771148,7.8617733,24.8795322],["C",6.3432947,24.8811295,5.1671481,24.5216767,4.3333333,23.8011738],["L",4.3333333,13.5111111],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.88,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.08,y:.1,name:"NW"},{x:0,y:.91,name:"SW"},{x:.98,y:.02,name:"NE"},{x:.885,y:.91,name:"SE"}]},{name:"off-page",category:"flowchart",width:38,height:38,textarea:{region:Ja},outline:{d:[["M",.3999999999999986,0],["L",37.6,0],["C",37.8209139,0,38,.1790861,38,.4],["L",38,19.0323398],["C",38,19.1391572,37.9572763,19.2415374,37.8813478,19.3166695],["L",19.2813478,37.7216028],["C",19.125486199999997,37.8758298,18.874513800000003,37.8758298,18.7186522,37.7216028],["L",.11865219999999965,19.3166695],["C",.04272369999999981,19.2415374,0,19.1391572,0,19.0323398],["L",0,.4],["C",0,.1790861,.17908609999999925,0,.3999999999999986,0],["Z"]]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,15.9169777],["C",24,16.0237952,23.9572763,16.1261753,23.8813478,16.2013075],["L",16.2813478,23.7216028],["C",16.1254862,23.8758298,15.8745138,23.8758298,15.7186522,23.7216028],["L",8.1186522,16.2013075],["C",8.0427237,16.1261753,8,16.0237952,8,15.9169777],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:1,y:0,name:"NE"}]},{name:"or",category:"flowchart",width:44,height:44,textarea:{region:Ja},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[{name:"M",x:0,y:21.5},{name:"L",x:44,y:21.5}]},{d:[{name:"M",x:21.5,y:0},{name:"L",x:21.5,y:44}]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",7,17],["L",25,17],["M",16,8],["L",16,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"parallel",category:"flowchart",width:120,height:40,outline:{name:"rect",x:0,y:0,width:120,height:40,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[{name:"M",x:120,y:40},{name:"L",x:0,y:40}]},{d:[{name:"M",x:0,y:0},{name:"L",x:120,y:0}]}],thumb:[{d:[["M",26,21],["L",6,21],["M",6,11],["L",26,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"polygon",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:0},{x:95.5528258,y:34.5491503},{x:77.3892626,y:90.4508497},{x:18.6107374,y:90.4508497},{x:.44717419000000014,y:34.5491503}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:7},{x:24.5595086,y:13.2188471},{x:21.2900673,y:23.2811529},{x:10.7099327,y:23.2811529},{x:7.44049135,y:13.2188471}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"preparation",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:1/6*e,minY:4,maxX:5/6*e,maxY:t-4}}},outline:{d:[["M",19.9840694,0],["L",99.6873184,0],["C",100.023525,-0,100.33723,.1689467,100.522259,.4496594],["L",119.639798,29.4535248],["C",119.858585,29.7854538,119.859975,30.2154564,119.64334,30.5487937],["L",100.798808,59.5449283],["C",100.614349,59.8287556,100.298826,60,99.960325,60],["L",20.1720063,60],["C",19.83462,60,19.5199796,59.8298739,19.3352402,59.5475604],["L",.3565669,30.5448953],["C",.1398092,30.2136523,.1388534,29.7857253,.3541294,29.4535175],["L",19.1448658,.4561827],["C",19.3292042,.1717169,19.6450984,0,19.9840694,0],["Z"]]},scene:[],thumb:[{d:[["M",9.1753609,10],["L",22.7586938,10],["C",22.8919773,10,23.016505,10.0663866,23.0907953,10.1770457],["L",26.8513724,15.7786117],["C",26.9413749,15.912675,26.9419451,16.0877051,26.8528179,16.2223519],["L",23.1470284,21.8207859],["C",23.072951,21.9326965,22.9476882,22,22.8134814,22],["L",9.2130739,22],["C",9.0793157,22,8.9544098,21.9331428,8.8802274,21.8218405],["L",5.1471359,16.2207607],["C",5.057961,16.0869638,5.0575691,15.9127763,5.1461411,15.7785795],["L",8.8415196,10.1796593],["C",8.9155518,10.067492,9.0409649,10,9.1753609,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.26,y:.02,name:"NW"},{x:.26,y:.98,name:"SW"},{x:.74,y:.02,name:"NE"},{x:.74,y:.98,name:"SE"}]},{name:"process",category:"flowchart",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10.5],["L",25.6,10.5],["C",25.8209139,10.5,26,10.6790861,26,10.9],["L",26,22.1],["C",26,22.3209139,25.8209139,22.5,25.6,22.5],["L",6.4,22.5],["C",6.1790861,22.5,6,22.3209139,6,22.1],["L",6,10.9],["C",6,10.6790861,6.1790861,10.5,6.4,10.5],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"sort",category:"flowchart",width:44,height:44,textarea:{region:Ja},outline:{d:[["M",22.707552999999997,.7084468],["L",43.2664758,21.2933397],["C",43.6564052,21.6837616,43.6564052,22.3162384,43.2664758,22.7066603],["L",22.707552999999997,43.2915532],["C",22.3172753,43.682324,21.6841104,43.6827236,21.293339699999997,43.2924459],["C",21.2930419,43.2921485,21.292744399999997,43.291851,21.292447000000003,43.2915532],["L",.7335241999999997,22.7066603],["C",.3435948,22.3162384,.3435948,21.6837616,.7335241999999997,21.2933397],["L",21.292447000000003,.7084468],["C",21.6827247,.317676,22.3158896,.3172764,22.706660300000003,.7075541],["C",22.7069581,.7078515,22.707255600000003,.708149,22.707552999999997,.7084468],["Z"]]},scene:[{d:[{name:"M",x:.1242938,y:22},{name:"L",x:43.8757062,y:22}]}],thumb:[{d:[["M",16.2830212,7.2833787],["L",24.706338,15.7173359],["C",24.8623098,15.8735046,24.8623098,16.1264954,24.706338,16.2826641],["L",16.2830212,24.7166213],["C",16.1269101,24.8729296,15.8736442,24.8730894,15.7173359,24.7169784],["C",15.7172168,24.7168594,15.7170978,24.7167404,15.7169788,24.7166213],["L",7.293662,16.2826641],["C",7.1376902,16.1264954,7.1376902,15.8735046,7.293662,15.7173359],["L",15.7169788,7.2833787],["C",15.8730899,7.1270704,16.1263558,7.1269106,16.2826641,7.2830216],["C",16.2827832,7.2831406,16.2829022,7.2832596,16.2830212,7.2833787],["Z"],["M",7.3175141,15.7333333],["L",25.2158192,15.7333333]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start-end",category:"flowchart",width:120,height:60,outline:{path:function(e,t){return ei(e,t,Math.min(e,t)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]},{name:"stored-data",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:1/12*e,minY:4,maxX:e-1*e/8,maxY:t-4}}},outline:{d:[["M",13.7777709,0],["L",120,0],["C",111.115006,4.7754794,106.672509,14.7754794,106.672509,30],["C",106.672509,44.2961128,111.115006,54.2961128,120,60],["L",13.7777709,60],["C",4.2600422,53.6223342,-.3265282,43.6223342,.0180598,30],["C",.4106176,14.4813071,4.997188,4.4813072,13.7777709,0],["Z"]]},scene:[],thumb:[{d:[["M",7.7592332,10],["L",26.7592332,10],["C",24.3123052,10.9550959,23.0888412,12.9550959,23.0888412,16],["C",23.0888412,18.8592226,24.3123052,20.8592226,26.7592332,22],["L",7.7592332,22],["C",5.853146,20.7244668,4.9346072,18.7244668,5.0036168,16],["C",5.0822332,12.8962614,6.000772,10.8962614,7.7592332,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:.93,y:.5,name:"E"},{x:.1,y:0,name:"NW"},{x:.1,y:1,name:"SW"},{x:.995,y:.01,name:"NE"},{x:.995,y:.99,name:"SE"}]},{name:"subroutine",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:.08*e+4,minY:4,maxX:.92*e-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[{d:[{name:"M",x:8,y:-0},{name:"L",x:8,y:60}]},{d:[{name:"M",x:112,y:-0},{name:"L",x:112,y:60}]}],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"],["M",10,10],["L",10,22],["M",22,10],["L",22,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"summing-junction",category:"flowchart",width:44,height:44,textarea:{region:Ja},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[["M",6.44365,6.44365],["l",31.1127,31.1127],["m",-31.1127,0],["l",31.1127,-31.1127]]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",9.636,10.636],["l",12.727922,12.727922],["m",0,-12.727922],["l",-12.727922,12.727922]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"hard-disk",category:"flowchart",width:120,height:60,outline:{d:[["M",15,60],["L",14.7519476,59.9959809],["C",9.2781402,59.818482,4.5170854,53.7768783,1.9708869,44.875377],["L",1.7488298,44.0706625],["L",1.7488298,44.0706625],["L",1.538854,43.2511373],["C",.5535534,39.2550784,0,34.7568286,0,30],["C",0,27.0176624,.2175896,24.1369663,.6227504,21.4179485],["L",.76471,20.5176797],["C",.9879463,19.1765057,1.2572417,17.8774189,1.5688436,16.627924],["L",1.7828048,15.8023567],["C",1.892878,15.3933289,2.0075593,14.9899966,2.1267097,14.5926377],["L",2.3709282,13.805967],["C",4.9969253,5.6312819,9.5529446,.172607,14.7519476,.0040191],["L",15.0621025,0],["L",15.0621025,0],["L",105,0],["L",105.248052,.0040191],["C",110.72186,.181518,115.482915,6.2231217,118.029113,15.124623],["L",118.25117,15.9293375],["L",118.25117,15.9293375],["L",118.461146,16.7488627],["C",119.446447,20.7449216,120,25.2431714,120,30],["C",120,32.9823376,119.78241,35.8630337,119.37725,38.5820515],["L",119.23529,39.4823203],["C",119.012054,40.8234943,118.742758,42.1225811,118.431156,43.372076],["L",118.217195,44.1976433],["C",118.107122,44.6066711,117.992441,45.0100034,117.87329,45.4073623],["L",117.629072,46.194033],["C",115.003075,54.3687181,110.447055,59.827393,105.248052,59.9959809],["L",105,60],["L",15,60],["Z"]]},scene:[{d:[["M",105,0],["C",96.7157288,0,90,13.4314575,90,30],["C",90,46.5685425,96.7157288,60,105,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",26,16],["C",26,19.7950693,24.6815015,22.8847632,23.0365121,22.9968505],["L",23.0365572,22.9990622],["L",9.005513,22.9990622],["C",7.3410124,22.9372467,6,19.8273333,6,16],["C",6,12.21094,7.3143262,9.1250233,8.955676,9.0037044],["L",9.005513,9.0009378],["L",23.0365572,9],["L",23.0365121,9.0031495],["C",24.6815015,9.1152368,26,12.2049307,26,16],["Z"]]},{d:[["M",22.6666667,23],["C",21.4393672,23,20.4444444,19.8659932,20.4444444,16],["C",20.4444444,12.1726667,21.4195683,9.0627533,22.6299182,9.0009378],["L",22.6666667,9]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"annotation",category:"flowchart",width:160,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[["M",12,0],["L",2,0],["C",.8954305,0,0,.8954305,0,2],["L",0,98],["C",0,99.1045695,1.8954305,100,2,100],["L",12,100],["L",12,100]],attr:{fill:"transparent"}}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]],attr:{fill:"transparent"}},{d:[["M",15,12.4],["L",23,12.4],["M",15,19.6],["L",20,19.6],["M",15,16],["L",25,16]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"paper-tape",category:"flowchart",width:120,height:60,outline:{d:[["M",1.5222953,.9815615],["C",9.1503953,5.6605205,18.6431804,8,30.0006506,8],["C",48.1891811,8,72,0,90,0],["C",101.772949,0,111.620866,2.5667099,119.54375,7.7001296],["C",119.827781,7.8834886,119.999272,8.1983049,120,8.536377],["L",120,58.1813965],["C",119.99868,58.7336797,119.549899,59.1803262,118.997616,59.1790094],["C",118.81486,59.1785736,118.635719,59.1280638,118.479584,59.0330812],["C",110.744659,54.3443604,101.251465,52,90,52],["C",72,52,47.9802124,60,30.0006506,60],["C",18.2410691,60,8.3931965,57.4332901,.4570327,52.2998704],["C",.1725566,52.1168331,7995e-7,51.8018948,0,51.463623],["L",0,1.8312988],["C",.0011011,1.2790152,.4497064,.8321918,1.0019901,.8332909],["C",1.1858393,.8336568,1.3660294,.8846988,1.5222953,.9815615],["Z"]]},scene:[],thumb:[{d:[["M",6.6474214,9.5811114],["C",7.8470102,10.5270371,9.2979179,11,11.0001446,11],["C",14.0315882,11,18.0555691,9,21.0153944,9],["C",22.9279117,9,24.5476734,9.6262819,25.8746796,10.8788457],["C",25.9544319,10.953493,25.9996109,11.0577585,26.0001446,11.1669922],["L",26.0001446,22.1123047],["C",25.9985502,22.3332128,25.8181845,22.5110102,25.5972763,22.5094261],["C",25.5080849,22.5087865,25.421666,22.4783549,25.3523768,22.4221807],["C",24.1466821,21.4740602,22.7041694,21,21.0248386,21],["C",18.037633,21,13.9967599,23,11.0001446,23],["C",9.0638551,23,7.4385415,22.3737181,6.1242038,21.1211543],["C",6.0451563,21.0461214,6.0003506,20.9419953,6,20.8330078],["L",6,9.8935547],["C",6.000786,9.6726422,6.1805061,9.4941923,6.4014186,9.4949758],["C",6.4907774,9.4952927,6.5774568,9.5255221,6.6474214,9.5811114],["Z"]]}],anchors:[{x:.5,y:.09,name:"N"},{x:.5,y:.91,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.09,name:"NW"},{x:0,y:.91,name:"SW"},{x:1,y:.09,name:"NE"},{x:1,y:.91,name:"SE"}]},{name:"card",category:"flowchart",width:120,height:60,outline:{d:[["M",17.119717,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1542151],["C",0,19.9186136,.0831857,19.6905777,.2348891,19.5103165],["L",16.3546062,.3561015],["C",16.5446112,.1303284,16.8246316,-0,17.119717,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,14.1038014],["C",6,14.0095609,6.0332743,13.9183465,6.0939556,13.846242],["L",9.210984,10.1424406],["C",9.286986,10.0521313,9.3989942,10,9.5170283,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.16,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.985,y:.98,name:"SE"}]}],tc=1/6*Math.PI,nc=20*Math.tan(tc);function rc(e,t){return{d:nc>e?0:nc,titleHeight:20>t?t:20}}var oc=[{name:"frame",width:500,height:400,html:'<div style="text-align:left;">&nbsp;</div>',textarea:{region:function(e,t){return{minX:4,minY:4,maxX:.4*e-(10<e?10:0),maxY:(30<t?30:t)-4}}},outline:{path:function(e,t){return ei(e,t,4)}},scene:[{path:function(e,t){var n,r,o=.4*e,a=10<e?10:0;return 30<t?(n=30,r=16):(n=t,r=0),[["M",0,n],["l",o-a,0],["l",a,-r],["L",o,0]]},attr:{fill:"none"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",6,12],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["L",16.5337171,9],["C",16.697486400000003,9,16.8447125,9.0998297,16.9053186,9.251971900000001],["L",18,12],["L",18,12],["L",6,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"package",category:"UML",isClip:!1,width:120,height:80,textarea:{region:function(e,t){return{minX:4,minY:rc(e,t).titleHeight+4,maxX:e-4,maxY:t-4}}},outline:{path:function(e,t){var n=.6*e,r=rc(e,t),o=r.d,a=r.titleHeight,i=e/2,c=t>a?t/2:0,l=i<4?i:4,u=c<4?c:4;return[["M",l,0],["l",n,0],["l",o-l,a],["L",e-l,a],["a",l,u,0,0,1,l,u],["L",e,t-u],["a",l,u,0,0,1,-l,u],["L",l,t],["a",l,u,0,0,1,-l,-u],["L",0,u],["a",l,u,0,0,1,l,-u],["Z"]]}},scene:[{path:function(e,t){var n=.6*e,r=rc(e,t),o=r.d;return[["M",0,r.titleHeight],["l",n+o,0]]}}],thumb:[{d:[["M",6,11],["L",25.6,11],["C",25.8209139,11,26,11.1790861,26,11.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,11],["L",6,11],["Z"]]},{d:[["M",6,11],["L",6,8.9],["C",6,8.6790861,6.1790861,8.5,6.4,8.5],["L",14.7328929,8.5],["C",14.8966622,8.5,15.0438883,8.5998297,15.1044944,8.751971900000001],["L",16,11],["L",16,11],["L",6,11],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activation",category:"UML",width:20,height:80,textarea:{region:Ja},outline:{name:"rect",x:0,y:0,width:20,height:80,rx:4,ry:4},scene:[],thumb:[{d:[["M",19,6.4],["L",19,25.6],["C",19,25.8209139,18.8209139,26,18.6,26],["L",13.4,26],["C",13.1790861,26,13,25.8209139,13,25.6],["L",13,6.4],["C",13,6.1790861,13.1790861,6,13.4,6],["L",18.6,6],["C",18.8209139,6,19,6.1790861,19,6.4],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"actor",category:"UML",width:40,height:80,isClip:!1,closed:!1,textarea:{region:Ja},outline:{d:[["M",20,20],["C",25.5228475,20,30,15.5228475,30,10],["C",30,4.4771525,25.5228475,0,20,0],["C",14.4771525,0,10,4.4771525,10,10],["C",10,15.5228475,14.4771525,20,20,20],["Z"],["M",0,35],["L",40,35],["M",20,20],["L",20,52],["M",20,52],["L",0,80],["M",20,52],["L",40,80]]},scene:[{name:"rect",x:0,y:0,width:40,height:80,attr:{fill:"transparent",stroke:"transparent"}}],thumb:[{d:[["M",16,13],["C",17.9329966,13,19.5,11.4329966,19.5,9.5],["C",19.5,7.5670034,17.9329966,6,16,6],["C",14.0670034,6,12.5,7.5670034,12.5,9.5],["C",12.5,11.4329966,14.0670034,13,16,13],["Z"],["M",11,16],["L",21,16],["M",16,19],["L",11,26],["M",16,19],["L",21,26],["M",16,13],["L",16,19]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.4375,name:"W"},{x:1,y:.4375,name:"E"}]},{name:"annotation",category:"UML",width:159,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0},scene:[{d:[["M",2,0],["L",10,0],["C",11.1045695,-0,12,.8954305,12,2],["L",12,98],["C",12,99.1045695,11.1045695,100,10,100],["L",0,100],["L",0,100]]}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]]},{d:[["M",20.6,18.8],["C",20.8209139,18.8,21,18.9790861,21,19.2],["L",21,20],["C",21,20.2209139,20.8209139,20.4,20.6,20.4],["L",15.4,20.4],["C",15.1790861,20.4,15,20.2209139,15,20],["L",15,19.2],["C",15,18.9790861,15.1790861,18.8,15.4,18.8],["L",20.6,18.8],["Z"],["M",25.6,15.2],["C",25.8209139,15.2,26,15.3790861,26,15.6],["L",26,16.4],["C",26,16.6209139,25.8209139,16.8,25.6,16.8],["L",15.4,16.8],["C",15.1790861,16.8,15,16.6209139,15,16.4],["L",15,15.6],["C",15,15.3790861,15.1790861,15.2,15.4,15.2],["L",25.6,15.2],["Z"],["M",23.6,11.6],["C",23.8209139,11.6,24,11.7790861,24,12],["L",24,12.8],["C",24,13.0209139,23.8209139,13.2,23.6,13.2],["L",15.4,13.2],["C",15.1790861,13.2,15,13.0209139,15,12.8],["L",15,12],["C",15,11.7790861,15.1790861,11.6,15.4,11.6],["L",23.6,11.6],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"boundary",category:"UML",width:70,height:50,isClip:!1,textarea:{region:Ja},outline:{d:[["M",45,50],["C",58.8071187,50,70,38.8071187,70,25],["C",70,11.1928813,58.8071187,0,45,0],["C",31.1928813,0,20,11.1928813,20,25],["C",20,38.8071187,31.1928813,50,45,50],["Z"],["M",-0,0],["L",0,50],["M",0,25],["L",20,25]]},scene:[],thumb:[{d:[["M",19,22],["C",22.3137085,22,25,19.3137085,25,16],["C",25,12.6862915,22.3137085,10,19,10],["C",15.6862915,10,13,12.6862915,13,16],["C",13,19.3137085,15.6862915,22,19,22],["Z"],["M",8,16],["L",13,16],["M",7.5,10],["L",7.5,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"choice",width:40,height:40,textarea:{region:Ja},outline:{d:[["M",22.1213203,.9081169],["L",39.0918831,17.8786797],["C",40.263456,19.0502525,40.263456,20.9497475,39.0918831,22.1213203],["L",22.1213203,39.0918831],["C",20.9497475,40.263456,19.0502525,40.263456,17.8786797,39.0918831],["L",.9081169,22.1213203],["C",-.263456,20.9497475,-.263456,19.0502525,.9081169,17.8786797],["L",17.8786797,.9081169],["C",19.0502525,-.263456,20.9497475,-.263456,22.1213203,.9081169],["Z"]]},scene:[],thumb:[{d:[["M",16.219338,9.0908528],["L",22.9091472,15.780662],["C",23.0302843,15.901799,23.0302843,16.098201,22.9091472,16.219338],["L",16.219338,22.9091472],["C",16.098201,23.0302843,15.901799,23.0302843,15.780662,22.9091472],["L",9.0908528,16.219338],["C",8.9697157,16.098201,8.9697157,15.901799,9.0908528,15.780662],["L",15.780662,9.0908528],["C",15.901799,8.9697157,16.098201,8.9697157,16.219338,9.0908528],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"control",category:"UML",width:50,height:55,isClip:!1,textarea:{region:Ja},outline:{d:[["M",25,55],["C",38.8071187,55,50,43.8071187,50,30],["C",50,16.1928813,38.8071187,5,25,5],["C",11.1928813,5,0,16.1928813,0,30],["C",0,43.8071187,11.1928813,55,25,55],["Z"],["M",24,4.9497475],["L",28.9497475,0]]},scene:[{d:[{name:"M",x:28.9497475,y:9.8994949},{name:"L",x:24,y:4.9497475}]}],thumb:[{d:[["M",16,22],["C",19.3137085,22,22,19.3137085,22,16],["C",22,12.6862915,19.3137085,10,16,10],["C",12.6862915,10,10,12.6862915,10,16],["C",10,19.3137085,12.6862915,22,16,22],["Z"],["M",15,10.1213203],["L",17.1213203,8],["M",17.1213203,12.2426407],["L",15,10.1213203]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"deletion",category:"UML",width:40,height:40,isClip:!1,closed:!1,textarea:{region:Ja},outline:{d:[["M",0,0],["L",40,40],["M",40,0],["L",0,40]],attr:{stroke:{width:4}}},scene:[],thumb:[{d:[["M",9.3534503,9.3534503],["L",22.6465497,22.6465497],["M",22.6465497,9.3534503],["L",9.3534503,22.6465497]],attr:{"stroke-width":2}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"finish",category:"UML",width:42,height:42,textarea:{region:Ja},outline:{name:"ellipse",cx:21,cy:21,rx:21,ry:21,attr:{stroke:{color:"#595959",width:4.2}}},scene:[{name:"ellipse",cx:21,cy:21,rx:12,ry:12,attr:{fill:"#595959"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{stroke:"#595959","stroke-width":1.2}},{name:"ellipse",cx:16,cy:16,rx:5,ry:5,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"fork",category:"UML",width:120,height:20,outline:{name:"rect",x:0,y:0,width:120,height:20,rx:4,ry:4,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"rect",x:6,y:14,width:20,height:4,rx:1,ry:1,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"frequency",category:"UML",textarea:{region:Ja},width:44,height:36,outline:{d:[["M",42.7122245,0],["C",42.8304828,0,42.9426798,.0523287,43.0186811,.1429312],["C",43.1606563,.3121825,43.1385446,.5644814,42.9692933,.7064566],["L",42.9692933,.7064566],["L",22.353,18],["L",42.9692933,35.2935434],["C",43.0417753,35.3543444,43.0897621,35.4383107,43.1060575,35.5300135],["L",43.1122245,35.6],["C",43.1122245,35.8209139,42.9331384,36,42.7122245,36],["L",42.7122245,36],["L",1.2877755,36],["C",1.1695172,36,1.0573202,35.9476713,.9813189,35.8570688],["C",.8393436999999999,35.6878175,.8614554000000001,35.4355186,1.0307067,35.2935434],["L",1.0307067,35.2935434],["L",21.646,17.999],["L",1.0307067,.7064566],["C",.9582246999999999,.6456556,.9102379,.5616893,.8939425000000001,.4699865],["L",.8877755,.4],["C",.8877755,.1790861,1.0668616,0,1.2877755,0],["L",1.2877755,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6012174,9],["C",23.7214126,9,23.8352365,9.0540492,23.9112011,9.1471955],["C",24.0508212,9.3183948,24.0252212,9.5703637,23.8540219,9.7099837],["L",23.8540219,9.7099837],["L",16.142,16],["L",23.8540219,22.2900163],["C",23.928539,22.350788,23.9780339,22.4357897,23.9948511,22.5288994],["L",24.0012174,22.6],["C",24.0012174,22.8209139,23.8221313,23,23.6012174,23],["L",23.6012174,23],["L",8.3987826,23],["C",8.2785874,23,8.1647635,22.9459508,8.0887989,22.8528045],["C",7.9491788,22.6816052,7.9747788,22.4296364,8.1459781,22.2900163],["L",8.1459781,22.2900163],["L",15.858,16],["L",8.1459781,9.7099837],["C",8.071461,9.649212,8.0219661,9.5642103,8.0051489,9.4711006],["L",7.9987826,9.4],["C",7.9987826,9.1790861,8.1778687,9,8.3987826,9],["L",8.3987826,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"node",category:"UML",width:240,height:240,textarea:{region:function(e,t){return{minX:4,minY:1/11*t+4,maxX:10/11*e-4,maxY:t-4}}},outline:{d:[["M",0,239],["L",0,20.4142136],["C",0,20.1489971,.1053568,19.8946432,.2928932,19.7071068],["L",19.7071068,.2928932],["C",19.8946432,.1053568,20.1489971,0,20.4142136,0],["L",239,0],["C",239.552285,-0,240,.4477153,240,1],["L",240,219.585786],["C",240,219.851003,239.894643,220.105357,239.707107,220.292893],["L",220.292893,239.707107],["C",220.105357,239.894643,219.851003,240,219.585786,240],["L",1,240],["C",.4477153,240,0,239.552285,0,239],["Z"]]},scene:[{name:"polygon",points:[{x:20,y:0},{x:240,y:0},{x:220,y:20},{x:0,y:20}],attr:{fill:"rgba(0,0,0,0.1)"}},{name:"polygon",points:[{x:220,y:20},{x:220,y:240},{x:240,y:220},{x:240,y:6123234e-22}],attr:{fill:"rgba(0,0,0,0.1)"}}],thumb:[{d:[["M",8,10],["L",22,10],["L",22,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,10],["L",8,10],["Z"]]},{d:[["M",8,10],["L",9.9481766,8.1127039],["C",10.0227934,8.0404189,10.122606300000001,8,10.2264947,8],["L",24,8],["L",24,8],["L",22.4516129,10]]},{d:[["M",22,24],["L",23.8872961,22.0518234],["C",23.9595811,21.977206600000002,24,21.8773937,24,21.7735053],["L",24,8],["L",24,8]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"object",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"receive-signal",category:"UML",width:139,height:60,textarea:{region:function(e,t){return{minX:.18*e+4,minY:4,maxX:e-4,maxY:t-4}}},outline:{d:[["M",138,0],["L",1.1350416,0],["C",.5827568999999999,0,.1350416000000001,.4477153,.1350416000000001,1],["C",.1350416000000001,1.2339365,.21705780000000008,1.4604694,.3668203000000001,1.6401844],["L",23.466513,29.3598156],["C",23.7755513,29.7306616,23.7755513,30.2693384,23.466513,30.6401844],["L",.3668203000000001,58.3598156],["C",.01325630000000011,58.7840925,.07058030000000004,59.4146572,.4948572,59.7682213],["C",.6745722000000001,59.9179838,.9011051000000001,60,1.1350416,60],["L",138,60],["C",138.552285,60,139,59.5522847,139,59],["L",139,1],["C",139,.4477153,138.552285,0,138,0],["Z"]]},scene:[],thumb:[{d:[["M",25.6,20],["L",6.9656854,20],["C",6.7447715,20,6.5656854,19.8209139,6.5656854,19.6],["C",6.5656854,19.4939134,6.6078282,19.3921718,6.6828427,19.3171573],["L",9.7171573,16.2828427],["C",9.873367,16.126633,9.873367,15.873367,9.7171573,15.7171573],["L",6.6828427,12.6828427],["C",6.526633,12.526633,6.526633,12.273367,6.6828427,12.1171573],["C",6.7578573,12.0421427,6.8595988,12,6.9656854,12],["L",25.6,12],["C",25.8209139,12,26,12.1790861,26,12.4],["L",26,19.6],["C",26,19.8209139,25.8209139,20,25.6,20],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"send-signal",category:"UML",width:140,height:60,textarea:{region:function(e,t){return{minX:4,minY:4,maxX:e-.18*e-4,maxY:t-4}}},outline:{d:[["M",1,0],["L",114.531625,0],["C",114.828405,0,115.109853,.131823,115.299846,.3598156],["L",139.466513,29.3598156],["C",139.775551,29.7306616,139.775551,30.2693384,139.466513,30.6401844],["L",115.299846,59.6401844],["C",115.109853,59.868177,114.828405,60,114.531625,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,12],["L",21.8343146,12],["C",21.9404012,12,22.0421427,12.0421427,22.1171573,12.1171573],["L",26,16],["L",26,16],["L",22.1171573,19.8828427],["C",22.0421427,19.9578573,21.9404012,20,21.8343146,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"simple-class",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start",width:40,height:40,textarea:{region:Ja},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"state",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:12,ry:12},scene:[],thumb:[{d:[["M",8,10],["L",24,10],["C",25.1045695,10,26,10.8954305,26,12],["L",26,20],["C",26,21.1045695,25.1045695,22,24,22],["L",8,22],["C",6.8954305,22,6,21.1045695,6,20],["L",6,12],["C",6,10.8954305,6.8954305,10,8,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"termination-pseudostate",category:"UML",width:40,height:40,textarea:{region:Ja},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",5.7142857,5.7142857],["C",5.7142857,5.7142857,15.2380952,15.2380952,34.2857143,34.2857143],["M",34.2857143,5.7142857],["L",5.7142857,34.2857143]]}],thumb:[{d:[["M",16,23],["C",19.8659932,23,23,19.8659932,23,16],["C",23,12.1340068,19.8659932,9,16,9],["C",12.1340068,9,9,12.1340068,9,16],["C",9,19.8659932,12.1340068,23,16,23],["Z"],["M",11,11],["C",11,11,14.3333333,14.3333333,21,21],["M",21,11],["L",11,21]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"use-case",category:"UML",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"class",category:"UML",type:"stack",width:280,height:200,row:3,heights:[40,80,80],outline:{path:function(e,t){return ei(e,t,8)}},scene:[{d:[["M",0,40],["L",280,40]],height:40},{d:[["M",0,120],["L",280,120]],height:120}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:12},{name:"L",x:26,y:12}]},{d:[{name:"M",x:6,y:17.5},{name:"L",x:26,y:17.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Class</span></div>','<div style="text-align:left;">+ attribute1:type = defaultValue</div>\n      <div style="text-align:left;">+ attribute2:type</div>\n      <div style="text-align:left;">- attribute3:type</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>']},{name:"interface",type:"stack",width:280,height:200,row:2,heights:[64,90],outline:{path:function(e,t){return ei(e,t,8)}},scene:[{d:[["M",0,64],["L",280,64]],height:64}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:16},{name:"L",x:26,y:16}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">&lt;&lt;interface&gt;&gt;</span></div>\n      <div style="text-align:center;">Interface</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>'],category:"UML"},{name:"constraint",width:120,height:50,textarea:{region:function(e,t){var n=.1*e,r=16/380*t;return{minX:n+4,minY:r,maxX:e-n-4,maxY:t-r}}},outline:{name:"rect",x:0,y:0,width:120,height:50,rx:0,ry:0,style:{visibility:"hidden"}},scene:[{d:[["M",11,2],["L",10,2],["C",7.790861,2,6,3.790861,6,6],["L",6,19.9098301],["C",6,21.8036903,4.9299881,23.5350059,3.236068,24.381966],["L",1,25],["L",3.236068,25.618034],["C",4.9299881,26.4649941,6,28.1963097,6,30.0901699],["L",6,44],["C",6,46.209139,7.790861,48,10,48],["L",11,48]],attr:{fill:"transparent"}},{d:[["M",109,2],["L",110,2],["C",112.209139,2,114,3.790861,114,6],["L",114,19.9098301],["C",114,21.8036903,115.070012,23.5350059,116.763932,24.381966],["L",119,25],["L",116.763932,25.618034],["C",115.070012,26.4649941,114,28.1963097,114,30.0901699],["L",114,44],["C",114,46.209139,112.209139,48,110,48],["L",109,48]],attr:{fill:"transparent"}}],thumb:[{d:[["M",11,8],["L",11,9.0792291],["L",10.0378007,9.0792291],["L",9.9004779,9.0841809],["C",9.2360127,9.1336991,8.9037801,9.5546039,8.9037801,10.3468951],["L",8.9037801,10.3468951],["L",8.9037801,13.9100642],["L",8.8982764,14.0989026],["C",8.8432399,15.0236884,8.3754296,15.6573876,7.4948454,16],["C",8.4341352,16.3768737,8.9037801,17.0735189,8.9037801,18.0899358],["L",8.9037801,18.0899358],["L",8.9037801,21.6702355],["L",8.9082098,21.8216676],["C",8.9525075,22.5544031,9.3290378,22.9207709,10.0378007,22.9207709],["L",10.0378007,22.9207709],["L",11,22.9207709],["L",11,24],["L",9.814433,24],["L",9.6063574,23.9933191],["C",8.997079,23.9532334,8.5223368,23.7327623,8.1821306,23.3319058],["C",7.8155785,22.9321913,7.6323024,22.3668808,7.6323024,21.6359743],["L",7.6323024,21.6359743],["L",7.6323024,18.1413276],["L",7.6272015,17.9587794],["C",7.6033971,17.5465739,7.4962772,17.2305496,7.3058419,17.0107066],["C",7.0652921,16.7366167,6.6300114,16.5881513,6,16.5653105],["L",6,16.5653105],["L",6,15.4346895],["L",6.2061856,15.4190393],["C",6.7356497,15.366026,7.1022019,15.2227774,7.3058419,14.9892934],["C",7.5234823,14.7380443,7.6323024,14.3611706,7.6323024,13.8586724],["L",7.6323024,13.8586724],["L",7.6323024,10.3811563],["L",7.6378007,10.1635974],["C",7.6707904,9.5263383,7.8522337,9.0278373,8.1821306,8.6680942],["C",8.5601375,8.2226981,9.1042383,8,9.814433,8],["L",9.814433,8],["L",11,8],["Z"],["M",22.185567,8],["C",22.8957617,8,23.4398625,8.2226981,23.8178694,8.6680942],["C",24.1477663,9.0278373,24.3292096,9.5263383,24.3621993,10.1635974],["L",24.3676976,10.3811563],["L",24.3676976,13.8586724],["C",24.3676976,14.3611706,24.4765178,14.7380443,24.6941581,14.9892934],["C",24.8977981,15.2227774,25.2643503,15.366026,25.7938144,15.4190393],["L",26,15.4346895],["L",26,16.5653105],["C",25.3699885,16.5881513,24.9347079,16.7366167,24.6941581,17.0107066],["C",24.5037228,17.2305496,24.3966029,17.5465739,24.3727985,17.9587794],["L",24.3676976,18.1413276],["L",24.3676976,21.6359743],["C",24.3676976,22.3668808,24.1844215,22.9321913,23.8178694,23.3319058],["C",23.4776632,23.7327623,23.002921,23.9532334,22.3936426,23.9933191],["L",22.185567,24],["L",21,24],["L",21,22.9207709],["L",21.9621993,22.9207709],["C",22.6709622,22.9207709,23.0474925,22.5544031,23.0917902,21.8216676],["L",23.0962199,21.6702355],["L",23.0962199,18.0899358],["C",23.0962199,17.0735189,23.5658648,16.3768737,24.5051546,16],["C",23.6245704,15.6573876,23.1567601,15.0236884,23.1017236,14.0989026],["L",23.0962199,13.9100642],["L",23.0962199,10.3468951],["C",23.0962199,9.5546039,22.7639873,9.1336991,22.0995221,9.0841809],["L",21.9621993,9.0792291],["L",21,9.0792291],["L",21,8],["L",22.185567,8],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"activity-class",width:120,height:60,textarea:{region:function(e,t){var n=.128*e;return{minX:n+4,minY:4,maxX:e-n-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[{d:[["M",105,0],["L",105,60],["M",15,60],["L",15,0]]}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9,y:9},{name:"L",x:9,y:23}]},{d:[{name:"M",x:23,y:9},{name:"L",x:23,y:23}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"component",width:120,height:80,isClip:!1,textarea:{region:function(e,t){return{minX:28,minY:4,maxX:e-4,maxY:t-4}}},outline:{path:function(e,t){var n=e-12,r=(n-12)/2,o=t/2,a=r<4?r:4,i=o<4?o:4,c=2,l=14;if(t<80){var u=t/80;return[["M",+a+12,0],["l",n-2*a,0],["a",a,i,0,0,1,a,i],["l",0,t-2*i],["a",a,i,0,0,1,-a,i],["l",2*a-n,0],["a",a,i,0,0,1,-a,-i],["l",0,i-(l*=u)],["l",(c*=u)-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,-24*u],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,i-l],["a",a,i,0,0,1,a,-i],["z"]]}return[["M",+a+12,0],["l",n-2*a,0],["a",a,i,0,0,1,a,i],["l",0,t-2*i],["a",a,i,0,0,1,-a,i],["l",2*a-n,0],["a",a,i,0,0,1,-a,-i],["l",0,-(t-i-(80-l))],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,-(80-4*l)],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,i-l],["a",a,i,0,0,1,a,-i],["z"]]}},scene:[{path:function(e,t){var n=2,r=14;if(t<80){var o=t/80;return[["M",12,r*=o],["l",12-(n*=o),0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0],["M",12,t-2*r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0]]}return[["M",12,r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0],["M",12,80-2*r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0]]},attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",8.4,23],["C",8.1790861,23,8,22.8209139,8,22.6],["L",8,9.4],["C",8,9.1790861,8.1790861,9,8.4,9],["Z"]]},{d:[["M",6.4,12],["L",11.6,12],["C",11.8209139,12,12,12.1790861,12,12.4],["L",12,13.6],["C",12,13.8209139,11.8209139,14,11.6,14],["L",6.4,14],["C",6.1790861,14,6,13.8209139,6,13.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]},{d:[["M",6.4,18],["L",11.6,18],["C",11.8209139,18,12,18.1790861,12,18.4],["L",12,19.6],["C",12,19.8209139,11.8209139,20,11.6,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,18.4],["C",6,18.1790861,6.1790861,18,6.4,18],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"multiplicity",width:110,height:70,isClip:!1,textarea:{region:function(e,t){return{minX:4,minY:.15*t+4,maxX:e-.1*e-4,maxY:t-4}}},outline:{d:[["M",106,0],["C",108.209139,-0,110,1.790861,110,4],["L",110,56],["C",110,58.209139,108.209139,60,106,60],["L",100,60],["L",100,66],["C",100,68.209139,98.209139,70,96,70],["L",4,70],["C",1.790861,70,0,68.209139,0,66],["L",0,14],["C",-0,11.790861,1.790861,10,4,10],["L",10,10],["L",10,4],["C",10,1.790861,11.790861,0,14,0],["L",106,0],["Z"]]},scene:[{d:[["M",10,10],["L",96,10],["C",98.209139,10,100,11.790861,100,14],["L",100,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",9.4,9],["L",26.6,9],["C",26.8209139,9,27,9.1790861,27,9.4],["L",27,19.6],["C",27,19.8209139,26.8209139,20,26.6,20],["L",9.4,20],["C",9.1790861,20,9,19.8209139,9,19.6],["L",9,9.4],["C",9,9.1790861,9.1790861,9,9.4,9],["Z"]]},{d:[["M",6.4,12],["L",23.6,12],["C",23.8209139,12,24,12.1790861,24,12.4],["L",24,22.6],["C",24,22.8209139,23.8209139,23,23.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"note",width:120,height:80,outline:{d:[["M",120,79],["C",120,79.5522847,119.552285,80,119,80],["L",1,80],["C",.4477153,80,0,79.5522847,0,79],["L",0,1],["C",0,.4477153,.4477153,0,1,0],["L",100,0],["L",120,20],["L",120,79],["Z"]]},scene:[{d:[["M",120,20],["L",100.5,20],["C",100.223858,20,100,19.7761424,100,19.5],["L",100,0],["L",100,0]],attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",21,9],["L",21,9],["L",25.8828427,13.8828427],["C",25.9578573,13.9578573,26,14.0595988,26,14.1656854],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",21,9],["L",21,13.6],["C",21,13.8209139,21.1790861,14,21.4,14],["L",26,14],["L",26,14]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"history-pseudostate",width:40,height:40,textarea:{region:Ja},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",12,20],["L",28,20],["M",12,11],["L",12,29],["M",28,11],["L",28,29]]}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7},{d:[["M",18.319148900000002,19.9993969],["C",18.567375900000002,19.991959100000003,18.742907799999998,19.930596899999998,18.845744699999997,19.8153104],["C",18.9485816,19.700023899999998,19,19.568002200000002,19,19.4192454],["L",19,19.4192454],["L",19,12.5801515],["C",19,12.4313947,18.9450355,12.2975136,18.8351064,12.1785082],["C",18.7251773,12.0595027,18.5460993,12,18.2978723,12],["C",18.035460999999998,12,17.856383,12.0632216,17.7606383,12.1896649],["C",17.6648936,12.3161082,17.617021299999998,12.4462704,17.617021299999998,12.5801515],["L",17.617021299999998,12.5801515],["L",17.617021299999998,15.2689307],["L",14.382978699999999,15.2689307],["L",14.382978699999999,12.5801515],["C",14.382978699999999,12.4313947,14.3315603,12.2975136,14.2287234,12.1785082],["C",14.1258865,12.0595027,13.9503546,12,13.7021277,12],["C",13.4539007,12,13.2748227,12.0632216,13.1648936,12.1896649],["C",13.0549645,12.3161082,13,12.4462704,13,12.5801515],["L",13,12.5801515],["L",13,19.4192454],["C",13,19.553126499999998,13.0549645,19.6851482,13.1648936,19.8153104],["C",13.2748227,19.945472600000002,13.4539007,20.0068348,13.7021277,19.9993969],["C",13.9503546,19.991959100000003,14.1258865,19.930596899999998,14.2287234,19.8153104],["C",14.3315603,19.700023899999998,14.382978699999999,19.568002200000002,14.382978699999999,19.4192454],["L",14.382978699999999,19.4192454],["L",14.382978699999999,16.5184878],["L",17.617021299999998,16.5184878],["L",17.617021299999998,19.4192454],["C",17.617021299999998,19.553126499999998,17.6719858,19.6851482,17.7819149,19.8153104],["C",17.891844,19.945472600000002,18.070922,20.0068348,18.319148900000002,19.9993969],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"entity",category:"UML",width:50,height:50,isClip:!1,textarea:{region:Ja},outline:{name:"ellipse",cx:25,cy:25,rx:25,ry:25},scene:[{d:[{name:"M",x:0,y:50},{name:"L",x:50,y:50}]}],thumb:[{d:[{name:"M",x:8,y:22},{name:"L",x:24,y:22}]},{name:"ellipse",cx:16,cy:16,rx:6,ry:6}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activity",category:"UML",width:120,height:60,outline:{path:function(e,t){return ei(e,t,Math.min(e,t)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]}],ac=[{name:"swimlane-vertical",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:450,widths:[1/3,2/3],height:600,heights:[.1],outline:{path:function(e,t){return ei(e,t,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:12.5,y:9},{name:"L",x:12.5,y:23}]},{d:[{name:"M",x:19.5,y:9},{name:"L",x:19.5,y:23}]},{d:[{name:"M",x:6,y:12.5},{name:"L",x:26,y:12.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"swimlane-horizontal",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:600,widths:[.1],height:400,heights:[1/3,2/3],outline:{path:function(e,t){return ei(e,t,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9.5,y:9},{name:"L",x:9.5,y:23}]},{d:[{name:"M",x:6,y:13.5},{name:"L",x:26,y:13.5}]},{d:[{name:"M",x:6,y:18.5},{name:"L",x:26,y:18.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],ic=function(e,t){var n=(new DOMParser).parseFromString(t.join(""),"text/html"),r=0,o=[];!function e(t,n){Array.from(t).forEach((function(t){"#text"===t.nodeName?n(t):e(t.childNodes,n)}))}(n.body.childNodes,(function(t){r>=e.length||(t.nodeValue=e[r++],o.push(function(e){for(;"BODY"!==(null===(t=e.parentNode)||void 0===t?void 0:t.nodeName);){var t;e=e.parentNode}return e}(t).outerHTML))}));for(var a=r;a<e.length;a++)o.push("<div>".concat(e[a],"</div>"));return o},cc=function(e){return Array.from(e).map((function(e){return e.innerText}))},lc=[{name:"pyramid",category:"DSL",type:"dsl",htmls:["<div>第一层</div>","<div>第二层</div>","<div>第三层</div>"],width:450,height:450,outline:{path:function(e,t){return[["M",0,t],["L",e/2,0],["L",e,t],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:12.3,y:12.5},{name:"L",x:19.5,y:12.5}]},{d:[{name:"M",x:9.5,y:18},{name:"L",x:22.6,y:18}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)})),{models:t,info:e}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return cc(t.body.childNodes).join("\n")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return ic((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),e)}},{name:"stage",category:"DSL",type:"dsl",htmls:["<div>阶段一</div>","<div>阶段二</div>","<div>阶段三</div>"],width:450,height:50,outline:{path:function(e,t){return[["M",0,0],["L",e-25,0],["L",e,t/2],["L",e-25,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",6.7,10.5],["L",22.9466615,10.5],["C",23.0746361,10.5,23.1948849,10.5612336,23.270156,10.6647313],["L",27.1503514,16],["L",27.1503514,16],["L",23.270156,21.3352687],["C",23.1948849,21.4387664,23.0746361,21.5,22.9466615,21.5],["L",6.7,21.5],["C",6.4790861,21.5,6.3,21.3209139,6.3,21.1],["L",6.3,10.9],["C",6.3,10.6790861,6.4790861,10.5,6.7,10.5],["Z"]]},{d:[["M",13.6,10.5],["L",17.6,16],["L",13.6,21.5]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)})),{models:t,info:e}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return cc(t.body.childNodes).join(",")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return ic((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(","),e)}},{name:"segmented pyramid",category:"DSL",type:"dsl",htmls:["<div>观点一</div>","<div>观点二</div>","<div>观点三</div>","<div>观点四</div>"],width:450,height:450,outline:{path:function(e,t){return[["M",0,t],["L",e/2,0],["L",e,t],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:20.5511187,y:14.4004187},{name:"L",x:11.0329065,y:14.5869445}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:11.2505579,y:14.370259}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:20.5511187,y:14.370259}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)}));var n=Math.ceil(Math.sqrt(t.length));return{models:t,info:e,otherInfo:{rows:n}}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return cc(t.body.childNodes).join("\n")},toHtmls:function(){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=ic((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),e),n=Math.ceil(Math.sqrt(t.length)),r=n*n,o=t.length;o<r;o++)t.push("");return t}},{name:"architecture",category:"DSL",type:"dsl",htmls:[["<div>模块1.1</div>","<div>模块1.2</div>"],["<div>模块2</div>"],["<div>模块3.1</div>","<div>模块3.2</div>"]],width:450,height:450,outline:{path:function(e,t){return ei(e,t,4)}},scene:[],thumb:[{d:[["M",7,8.5],["L",25,8.5],["C",25.5522847,8.5,26,8.9477153,26,9.5],["L",26,22],["C",26,22.5522847,25.5522847,23,25,23],["L",7,23],["C",6.4477153,23,6,22.5522847,6,22],["L",6,9.5],["C",6,8.9477153,6.4477153,8.5,7,8.5],["Z"]]},{d:[["M",9.1,17],["L",14.15,17],["C",14.4813708,17,14.75,17.2686292,14.75,17.6],["L",14.75,19.9],["C",14.75,20.2313708,14.4813708,20.5,14.15,20.5],["L",9.1,20.5],["C",8.7686292,20.5,8.5,20.2313708,8.5,19.9],["L",8.5,17.6],["C",8.5,17.2686292,8.7686292,17,9.1,17],["Z"]]},{d:[["M",9.1,11],["L",22.9,11],["C",23.2313708,11,23.5,11.2686292,23.5,11.6],["L",23.5,13.9],["C",23.5,14.2313708,23.2313708,14.5,22.9,14.5],["L",9.1,14.5],["C",8.7686292,14.5,8.5,14.2313708,8.5,13.9],["L",8.5,11.6],["C",8.5,11.2686292,8.7686292,11,9.1,11],["Z"]]},{d:[["M",17.85,17],["L",22.9,17],["C",23.2313708,17,23.5,17.2686292,23.5,17.6],["L",23.5,19.9],["C",23.5,20.2313708,23.2313708,20.5,22.9,20.5],["L",17.85,20.5],["C",17.5186292,20.5,17.25,20.2313708,17.25,19.9],["L",17.25,17.6],["C",17.25,17.2686292,17.5186292,17,17.85,17],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(e){var t=[],n=[];return e.forEach((function(e){e.forEach((function(e){n.push({html:e})})),t.push(e.length)})),{models:n,info:t}},toText:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){var t=(new DOMParser).parseFromString(e.join(""),"text/html");return cc(t.body.childNodes).join(",")})).join("\n")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n").map((function(t,n){return ic(t.split(","),e[n]||[])}))}}],uc=[].concat(T()(Ji),T()(ec),T()(oc),T()([{name:"er-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[{name:"rect",x:5,y:5,width:110,height:60,rx:1,ry:1,attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",8.4,11],["L",23.6,11],["C",23.8209139,11,24,11.1790861,24,11.4],["L",24,20.6],["C",24,20.8209139,23.8209139,21,23.6,21],["L",8.4,21],["C",8.1790861,21,8,20.8209139,8,20.6],["L",8,11.4],["C",8,11.1790861,8.1790861,11,8.4,11],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"derived-attribute",width:120,height:70,outline:{d:[["M",60,70],["C",93.137085,70,120,54.3299662,120,35],["C",120,15.6700338,93.137085,0,60,0],["C",26.862915,0,0,15.6700338,0,35],["C",0,54.3299662,26.862915,70,60,70],["Z"]],attr:{stroke:{style:"dash"}}},scene:[],thumb:[{d:[["M",16,24],["C",22.0751322,24,27,20.418278,27,16],["C",27,11.581722,22.0751322,8,16,8],["C",9.9248678,8,5,11.581722,5,16],["C",5,20.418278,9.9248678,24,16,24],["Z"]],attr:{"stroke-dasharray":"2"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"multivalued-attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[{name:"ellipse",cx:60,cy:35,rx:55,ry:30,attr:{fill:"transparent"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8},{name:"ellipse",cx:16,cy:16,rx:9,ry:6,attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[{name:"polygon",points:[{x:60.4285714,y:5},{x:111.857143,y:35},{x:60.4285714,y:65},{x:9,y:35}],attr:{fill:"transparent"}}],thumb:[{d:[["M",16.2309401,10.1632993],["L",24.0234012,15.6734014],["C",24.2037766,15.8009461,24.2466044,16.0505647,24.1190597,16.2309401],["C",24.0928359,16.2680261,24.0604872,16.3003748,24.0234012,16.3265986],["L",16.2309401,21.8367007],["C",16.0925332,21.9345692,15.9074668,21.9345692,15.7690599,21.8367007],["L",7.9765988,16.3265986],["C",7.7962234,16.1990539,7.7533956,15.9494353,7.8809403,15.7690599],["C",7.9071641,15.7319739,7.9395128,15.6996252,7.9765988,15.6734014],["L",15.7690599,10.1632993],["C",15.9074668,10.0654308,16.0925332,10.0654308,16.2309401,10.1632993],["Z"]]},{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",33,0],["L",33,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",16.5,22],["L",16.5,26],["M",16.5,7],["L",16.5,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"total-generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",23,0],["L",23,14],["M",43,0],["L",43,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",11.5,7],["L",11.5,11],["M",20.5,7],["L",20.5,11],["M",16.5,22],["L",16.5,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"}]),T()(ac),T()(lc));function sc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var dc=function(){function e(t){m()(this,e),c()(this,"autoSelect",!0),c()(this,"diagram",void 0),this.diagram=null==t?void 0:t.diagram,Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t))}return v()(e,[{key:"commandName",get:function(){return this.constructor.className}},{key:"execute",value:function(e){}},{key:"forward",value:function(){}},{key:"backward",value:function(){}},{key:"select",value:function(e){var t=this.diagram;this.autoSelect&&(e&&e.length>0?t.selector.select(e):(t.selector.clear(),t.tryFocus()))}}],[{key:"enable",value:function(e){return!0}}]),e}();c()(dc,"className","Command"),c()(dc,"isModelChange",!0),c()(dc,"Update",void 0),c()(dc,"Add",void 0);var fc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"map",new Map),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.model,n=void 0===t?{}:t,r=this.cellOptions,o=ar(n,void 0===r?{}:r);o[0].forEach((function(e){e.id||(e.id=Object(F.a)())}));var a=e.add.apply(e,T()(o));a.forEach((function(t,n){Object.assign(o[1][n],e.getCellOptions(t))})),this.changeArguments=o,this.select(a)}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=e.add.apply(e,T()(t));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id).parent;e.remove(t[0].map((function(e){return e.id}))),this.select(n&&n.model.id)}}]),n}();c()(fc,"className","Add");var hc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getCells",value:function(){var e=this.changeArguments,t=this.diagram,n=e[0].map((function(e){return t.find(e)}));if(n.some((function(e){return!e})))throw new Error("can not find the cell");return n}},{key:"execute",value:function(){var e=this.diagram,t=this.model,n=this.cellOptions,r=void 0===n?{}:n,o=this.originModels,i=this.notSelect,c=this.id;Array.isArray(c)||(c=[c]),"object"===a()(c[0])&&(c=c.map((function(e){return e.model.id})));var l=ar(c,t,r);this.changeArguments=l;var u=this.getCells(),s=l[1];this.originModels=o||u.map((function(e,t){var n=s[t];return Object.keys(n).reduce((function(e,r){if("children"===r)return e;var o=n[r],a=u[t].model[r];return d()(o)?e[r]=Object.keys(o).reduce((function(e,t){var n=a&&a[t];return e[t]=null==n?null:n,e}),{}):e[r]=null==a?null:a,e}),{})})),this.originCellOptions=u.map((function(t){return e.getCellOptions(t)}));for(var f=0;f<s.length;f++)gn(this.originModels[f],s[f]);e.update(u,s,l[2]),i||this.select(u)}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.getCells(),r=t[1];e.update(n,r,t[2]),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.originModels,n=this.originCellOptions,r=this.getCells();e.update(r,t,n),this.select(r)}}]),n}();c()(hc,"className","Update");var pc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"commands",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.commands,t=e.length;e.forEach((function(e,n){e.autoSelect=n===t-1,e.execute()}))}},{key:"forward",value:function(){var e=this.commands,t=e.length;e.forEach((function(e,n){e.autoSelect=n===t-1,e.forward()}))}},{key:"backward",value:function(){for(var e=this.commands,t=e.length-1;t>=0;t--){var n=e[t];n.autoSelect=0===t,n.backward()}}}]),n}();c()(pc,"className","Compound");var mc=function(e){S()(n,pc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){}}]),n}();c()(mc,"className","NoneExecuteCompound");var yc=function(e){return e.reduce((function(e,t){return t.isStem?e.concat(t.getChildren()):e.concat(t)}),[])};var vc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.onlyCell,n=t?[t]:e.selector.selections,r=yc(e.deduplicate(n)).filter((function(e){return e.canCollapse()}));e.update(r,{collapsed:!0}),e.selector.select(r),this.cells=r.map((function(e){return e.model.id}))}},{key:"backward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:null}),e.selector.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:!0}),e.selector.select(t)}}]),n}();c()(vc,"className","Collapse"),c()(vc,"enable",(function(e){var t=e.selector.selections;return yc(e.deduplicate(t)).some((function(e){return e.canCollapse()}))}));var gc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.onlyCell,n=t?[t]:e.selector.selections,r=yc(e.deduplicate(n)).filter((function(e){return!e.canCollapse()&&e.canExpand()}));e.update(r,{collapsed:null}),e.selector.select(r),this.cells=r.map((function(e){return e.model.id}))}},{key:"backward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:!0}),e.selector.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:null}),e.selector.select(t)}}]),n}();c()(gc,"className","Expand"),c()(gc,"enable",(function(e){var t=e.selector.selections;return yc(e.deduplicate(t)).some((function(e){return!e.canCollapse()&&e.canExpand()}))}));var bc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.command.undo()}}]),n}();c()(bc,"className","Undo"),c()(bc,"enable",(function(e){return e.command.index>=0}));var xc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.command.redo()}}]),n}();c()(xc,"className","Redo"),c()(xc,"enable",(function(e){var t=e.command;return t.index<t.commands.length-1}));var wc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram.viewport;e.setViewport(e.zoom+.2)}}]),n}();c()(wc,"className","ZoomIn"),c()(wc,"isModelChange",!1),c()(wc,"enable",(function(e){var t=e.viewport;return t.zoom+.2<=t.maxZoom}));var kc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram.viewport;e.setViewport(e.zoom-.2)}}]),n}();c()(kc,"className","ZoomOut"),c()(kc,"isModelChange",!1),c()(kc,"enable",(function(e){var t=e.viewport;return t.zoom-.2>=t.minZoom}));var Ec=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e);var o=A()(r).diagram.viewport;return r.queue=!1,r.zoom=e.zoom<o.minZoom&&o.minZoom||e.zoom>o.maxZoom&&o.maxZoom||e.zoom,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.zoom;e.viewport.setViewport(t)}}]),n}();c()(Ec,"className","ZoomTo"),c()(Ec,"isModelChange",!1);var Oc=function(){function e(){m()(this,e),this.clipboardData={setData:function(e,t){this[e]=t},getData:function(e){return this[e]},files:[]}}return v()(e,[{key:"preventDefault",value:function(){}}]),e}();function Cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ac(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pc(e,t){return an(e.reduce((function(e,n){return vr(n)?e.push.apply(e,[n].concat(T()(n.children),T()(n.contain.map(t.find.bind(t)).filter((function(e){return e}))))):br(n)||dr(n)?e.push.apply(e,[n].concat(T()(n.children))):hr(n)?n.deepEachWithoutSelf((function(t){e.push(t)})):e.push(n),e}),[]))}function Sc(){return(Sc=de()(he.a.mark((function e(t,n){var r,o,a,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.exporter.blob("png",{cells:Pc(t.selector.selections,t)});case 2:r=e.sent,o=new Blob([n.text],{type:"text/plain"}),a=new Blob([n.html],{type:"text/html"}),i=new window.ClipboardItem({"text/html":a,"text/plain":o,"image/png":r}),window.navigator.clipboard.write([i]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jc(e,t){t.importer.caches={};var n=t.selector.selections;if(0!==n.length){e.preventDefault();var o=t.exporter.clipboard(n);try{var a,i,c;document.hasFocus()&&null!==(a=window)&&void 0!==a&&null!==(i=a.navigator)&&void 0!==i&&null!==(c=i.clipboard)&&void 0!==c&&c.write&&pe.ua.chrome&&function(e,t){Sc.apply(this,arguments)}(t,o)}catch(e){console.warn("Asynchronous clipboard is not supported")}e.clipboardData.setData("text/html",o.html),e.clipboardData.setData("text/plain",o.text);try{r.LocalStorageUtil.setItem("lake_diagram_clipboard_data",JSON.stringify(Ac(Ac({},o),{},{recordTime:Date.now()})))}catch(e){console.warn("Failed to execute 'setItem' on 'Storage': Setting the value of 'lake_diagram_clipboard_data' exceeded the quota.")}}}var Rc=new Oc;function _c(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!document.execCommand(e))if("paste"!==e)t.command.execute(e.charAt(0).toUpperCase()+e.slice(1),{e:Rc});else{var a=r.LocalStorageUtil.getItem("lake_diagram_clipboard_data");if(a){a=JSON.parse(a);var i=pe.ua.macos?"⌘+V":"Ctrl+V";o&&we.a.info(jr("已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ")+i+jr(" 粘贴")),Rc.clipboardData.setData("text/html",a.html),Rc.clipboardData.setData("text/plain",a.text),t.command.execute("Paste",{e:Rc,focusPoint:n})}}}window.__lake_diagram_board_custom_clipboard_event=Rc;var Mc=Object.freeze({__proto__:null,getCopyImageCells:Pc,handleCopy:jc,customClipboardEvent:Rc,executeClipboardCommand:_c});function Lc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Tc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({queue:!1},e))}return v()(n,[{key:"execute",value:function(){jc(this.e,this.diagram)}}]),n}();c()(Tc,"className","Copy"),c()(Tc,"isModelChange",!1);var Dc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.e,n=this.focusPoint,r=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),a=Array.from(t.clipboardData.files),i={text:o,html:r};a.length>0&&(""===r&&/^.+\.\w+$/.test(o)||""===o&&/^(<meta.+?>)?<img.+?>$/.test(r)||!o||!r)&&(i.files=a);var c=e.importer.clipboard(i,n);c?(this.handler=c,d()(c)&&(this.selectedCellId=e.selector.selections.map((function(e){return e.model.id})),e.destroyed||(e.signal.beforePasteSelect=!0,e.selector.select(this.handler.body.map((function(e){return e.id}))),e.signal.beforePasteSelect=!1))):this.queue=!1}},{key:"forward",value:function(){var e=this.handler,t=this.diagram;e&&(e.execute(),t.selector.select(this.handler.body.map((function(e){return e.id}))))}},{key:"backward",value:function(){var e=this.handler,t=this.diagram,n=this.selectedCellId;e&&(e.body.forEach((function(e){t.remove(e.id)})),n&&t.selector.select(n))}}]),n}();function Nc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Dc,"className","Paste");var Bc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({queue:!1},e))}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.command.execute("ZoomTo",{zoom:1}),e.viewport.focus([t.x,t.y])}}]),n}();c()(Bc,"className","FocusSelection"),c()(Bc,"enable",(function(e){return 1===e.selector.selections.length}));var Ic=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.id,n=this.endHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r)}},{key:"forward",value:function(){var e=this.diagram,t=this.endHTML,n=this.id,r={html:t};Array.isArray(t)&&(r=t.map((function(e){return{html:e}}))),e.update(n,r),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r),this.select(t)}}]),n}();c()(Ic,"className","UpdateCellContent");var Fc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=jr("链接"),n=window.getSelection(),r=null==n?void 0:n.getRangeAt(0),o=null==r?void 0:r.commonAncestorContainer;if(e.contentEditor.dom&&o===e.contentEditor.dom){var a=null==o?void 0:o.querySelectorAll("a");if(1===a.length){var i=a[0].getAttribute("href");i&&(t=i)}}e.contentEditor.execCommand("createLink",t)}}]),n}();c()(Fc,"className","CreateLink"),c()(Fc,"enable",(function(e){var t=e.getCell(e.contentEditor.dom);return!!e.contentEditor.getRange()&&!!t}));var qc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r.onBeginInsertLine=function(e){if(r.sourceCell){var t=A()(r),n=t.diagram,o=t.beginInsertEvent,a=n.viewport.invertClient([e.clientX,e.clientY]);n.emit("begininsertline",{source:{id:r.sourceCell.model.id,connection:null},target:{id:null,connection:[a[0],a[1]]}}),n.off(o,r.onBeginInsertLine)}},r}return v()(n,[{key:"bindBegineInsertEvent",value:function(){var e=this.diagram,t=this.sourceCell,n=this.beginInsertEvent;e.off(n,this.onBeginInsertLine),t&&e.on(n,this.onBeginInsertLine)}},{key:"execute",value:function(){var e=this.diagram,t=this.shape,n=this.beginInsertEvent,r=e.selector.selections;1!==r.length||r[0].isLine||r[0].isGroup||(this.sourceCell=r[0],n="mousemove"),e.selector.clear(),e.tryFocus(),e.interaction.changeMode("beginInsertLine"),e.settings.line.shape=t,this.beginInsertEvent=n,this.beginInsertEvent&&this.bindBegineInsertEvent()}}],[{key:"enable",value:function(){return!0}}]),n}();c()(qc,"className","BeginInsertLine"),c()(qc,"isModelChange",!1),dc.Add=fc,dc.Update=hc;var zc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,n=this.value,r=e.selector,o=e.contentEditor,a=r.selections,i=[];a.forEach((function(e){var t,n=e.getCanTextCell();Array.isArray(n)?(t=i).push.apply(t,T()(n)):i.push(e)}));var c=(i=an(i)).map((function(e){return e.textareaElement.htmlContainer})),l=c.map((function(e){return e.innerHTML}));e.contentEditor.batchEdit(c,t,n);var u=c.map((function(e){return e.innerHTML})),s={html:u};Array.isArray(u)&&(s=u.map((function(e){return{html:e}}))),this.endHTML=u,this.startHTML=l,this.id=i,e.update(i,s),1!==i.length||o.isBegin||o.prepareEdit()}},{key:"forward",value:function(){var e=this.diagram,t=this.endHTML,n=this.id,r={html:t};Array.isArray(t)&&(r=t.map((function(e){return{html:e}}))),e.update(n,r),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r),this.select(t)}}],[{key:"enable",value:function(e){return e.selector.selections.filter((function(e){return e.canUpdateText()})).length>0}}]),n}();c()(zc,"className","ContentCommand");var Gc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(e){var t=this.diagram,n=this.cells,r=n.map((function(e){return e.model.id})),o=n.map((function(e){return t.getCellOptions(e)}));n.forEach((function(t){t[e]()}));var a=n.map((function(e){return t.getCellOptions(e)}));this.beforeCellOptions=o,this.afterCellOptions=a,this.id=r,this.select(r)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.beforeCellOptions;e.update(t,{},n),this.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.id,n=this.afterCellOptions;e.update(t,{},n),this.select(t)}}]),n}();c()(Gc,"className","ZIndex");var Yc=function(e){S()(n,Gc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"toBack")}}]),n}();c()(Yc,"className","ToBack");var Hc=function(e){S()(n,Gc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"toFront")}}]),n}();c()(Hc,"className","ToFront");var Vc=function(e){S()(n,Gc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"forward")}}]),n}();c()(Vc,"className","Forward");var Uc=function(e){S()(n,Gc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"backward")}}]),n}();c()(Uc,"className","Backward");var Wc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){this.diagram.viewport.autoFit()}}]),n}();c()(Wc,"className","FitViewport"),c()(Wc,"isModelChange",!1);var Xc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;e.selector.select(e.getCells().filter((function(e){return e.state.visible})))}}]),n}();c()(Xc,"className","SelectAll"),c()(Xc,"isModelChange",!1);var Kc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.viewport.setViewport(1)}}]),n}();c()(Kc,"className","ActualSize"),c()(Kc,"isModelChange",!1);var Zc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.contentEditor.prepareEdit(),e.contentEditor.beginEdit(),e.update(t,{})}}],[{key:"enable",value:function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.textareaElement}))}}]),n}();c()(Zc,"className","BeginEditContent"),c()(Zc,"isModelChange",!1);var Qc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;if("dragCanvas"===e.interaction.currentMode)e.interaction.changeMode("edit"),e.signal.buttonDragCanvas=!1;else e.highlight.clear(),e.interaction.changeMode("dragCanvas"),e.signal.buttonDragCanvas=!0}}]),n}();function $c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Qc,"className","ButtonDragCanvas"),c()(Qc,"isModelChange",!1);var Jc=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"index",-1),c()(this,"commands",[]),c()(this,"commandConstructors",void 0),this.commandConstructors={ToBack:Yc,ToFront:Hc,Forward:Vc,Backward:Uc,Add:fc,Update:hc,Compound:pc,NoneExecuteCompound:mc,Collapse:vc,Expand:gc,Undo:bc,Redo:xc,ZoomIn:wc,ZoomOut:kc,ZoomTo:Ec,ActualSize:Kc,FitViewport:Wc,UpdateCellContent:Ic,ContentCommand:zc,FocusSelection:Bc,Copy:Tc,Paste:Dc,CreateLink:Fc,BeginInsertLine:qc,SelectAll:Xc,ButtonDragCanvas:Qc,BeginEditContent:Zc}}return v()(e,[{key:"find",value:function(e){var t=this.diagram;return!e||t&&t.destroyed?null:"string"==typeof e?this.commandConstructors[e]:e.constructor}},{key:"enable",value:function(e){var t=this.find(e);return t&&(!t.enable||t.enable(this.diagram))||!1}},{key:"register",value:function(e){this.commandConstructors[e.className]=e}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this.commandConstructors[e](function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$c(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({diagram:this.diagram},t))}},{key:"execute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram;if(!n||!n.destroyed){"string"==typeof e&&(e=this.create(e,t));var r=e.constructor,o={commandName:r.className,command:e,prevent:!1,useTime:0,isModelChange:!0};if(n&&n.emit("beforecommandexecute",o),this.enable(e)&&!0!==o.prevent&&this.commands){var a=+new Date;e.execute(),!1!==e.queue&&(this.index>-1?this.commands=this.commands.slice(0,this.index+1):this.commands=[],this.commands.push(e),this.index=this.commands.indexOf(e)),o.useTime=+new Date-a,o.isModelChange=r.isModelChange,n&&n.emit("aftercommandexecute",o)}return e}}},{key:"redo",value:function(){var e=this.index,t=this.commands,n=this.diagram;if(t&&!(e>=t.length-1)){var r=t[++e];n&&n.emit("beforecommandforward",{command:r}),r.forward(),n&&n.emit("aftercommandforward",{command:r}),this.index=e}}},{key:"undo",value:function(){var e=this.index,t=this.commands,n=this.diagram;if(t&&!(e<0)){var r=t[e];n&&n.emit("beforecommandbackward",{command:r}),r.backward(),n&&n.emit("aftercommandbackward",{command:r}),this.index=--e}}},{key:"destroy",value:function(){this.commands=[]}}]),e}();function el(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?el(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):el(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nl(e,t){return e.nodeType===Node.ELEMENT_NODE&&(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector).call(e,t)}function rl(e,t,n){for(;e&&n.contains(e);){if("string"==typeof t&&nl(e,t)||"function"==typeof t&&t(e))return e;e=e.parentNode}return null}function ol(e,t){var n=e.getAttribute("style");return n&&n.includes(t)}function al(e){for(var t=e.firstChild;t;){var n=t.nextSibling;e.parentNode.insertBefore(t,e),t=n}e.parentNode.removeChild(e)}function il(e,t){return t.tagName!==e||t.childNodes&&t.childNodes[0]&&3!==t.childNodes[0].nodeType&&(t.childNodes[0].tagName===e||1!==t.childNodes.length)?t.childNodes[0]&&il(e,t.childNodes[0]):t}function cl(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return{};if(t){var a=t.startContainer;if(a===e)n=il("SPAN",e),r=il("DIV",e);else{var i=rl(a,(function(e){return 1===e.nodeType}),e);n=i,r=i}}else n=il("SPAN",e),r=il("DIV",e);return function(e,t,n,r){var o=function(e,t){if(!e)return{};var n=window.getComputedStyle(e),r=n["text-align"],o=parseInt(n["font-size"]),a=n.color;return{textAlign:r,fontSize:t.fontSize?t.fontSize.value:o,color:t.foreColor?t.foreColor.value:a}}(e,n),a=function(e,t,n){if(!e)return{};var r=window.getComputedStyle(e),o=parseInt(r["font-size"]),a=r.color;return{bold:t.bold?!t.bold.cancel:!!rl(e,(function(e){return ol(e,"bold")}),n),italic:t.italic?!t.italic.cancel:!!rl(e,(function(e){return ol(e,"italic")}),n),strikethrough:t.strikethrough?!t.strikethrough.cancel:!!rl(e,(function(e){return ol(e,"line-through")}),n),underline:t.underline?!t.underline.cancel:!!rl(e,(function(e){return ol(e,"underline")}),n),fontSize:t.fontSize?t.fontSize.value:o,color:t.foreColor?t.foreColor.value:a}}(t,n,r);return tl(tl({bold:!1,italic:!1,strikethrough:!1,underline:!1},o),a)}(r,n,o,e)}function ll(e){if(e.preventDefault(),this.isBegin){e.stopPropagation();var t=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("text/html");if(n){var r=(new DOMParser).parseFromString(n,"text/html");if(r&&1===r.body.childNodes.length&&"A"===r.body.childNodes[0].tagName)return this.execCommand("insertHTML",r.body.childNodes[0].outerHTML);if(n.includes("lake_diagram_content_editor_data"))return this.execCommand("insertHTML",r.querySelector("[data-lake_diagram_content_editor_data]").innerHTML)}return t&&/^https?:\/\/\S+$/.test(t)?this.execCommand("insertHTML",'<a href="'.concat(t,'" target="_blank">').concat(t,"</a>")):this.execCommand("insertText",t)}}function ul(e){return!e||e&&!e.match(/^[\x00-\x7F]/)||e.startsWith("javascript:")}function sl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"copy";if(this.isBegin){e.stopPropagation(),"copy"===t&&e.preventDefault();var n=this.getRange(),r=document.createElement("div"),o=n.cloneContents();r.dataset.lake_diagram_content_editor_data=!0,r.appendChild(o),e.clipboardData.setData("text/html",r.outerHTML),e.clipboardData.setData("text",r.innerText)}}function dl(e,t,n){Wt(t,(function(t){if(1===t.nodeType){var n=t.getAttribute("style");n&&n.includes("font-size: x-small;")&&(t.style["font-size"]="".concat(e,"px"))}}),(function(e){return e.childNodes}));var r=[];Wt(t,(function(e){1===e.nodeType&&"FONT"===e.tagName&&r.push(e)}),(function(e){return e.childNodes})),r.length>0&&(n&&!n.collapsed&&Wt(n.commonAncestorContainer,(function(e){1===e.nodeType&&n.isPointInRange(e,0)&&(e.style["font-size"]="")}),(function(e){return e.childNodes})),r.forEach((function(t){var n=t.parentNode,r=document.createElement("span");r.style["font-size"]="".concat(e,"px"),n.insertBefore(r,t),r.appendChild(t),al(t);var o=r.childNodes[0];o&&"SPAN"===o.tagName&&1===r.childNodes.length&&(Object.keys(qr).forEach((function(e){o.style[e]&&"font-size"!==e&&(r.style[e]=o.style[e])})),al(o)),"SPAN"===n.tagName&&1===n.childNodes.length&&(Object.keys(qr).forEach((function(e){r.style[e]&&"font-size"!==e&&(n.style[e]=r.style[e])})),al(r))})))}c()(Jc,"className","Command");var fl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),c()(this,"onKey",void 0),c()(this,"offKey",void 0),c()(this,"events",void 0),c()(this,"destroyed",void 0),this.onKey="on",this.offKey="off",this.events=[],Object.assign(this,t)}return v()(e,[{key:"bind",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e[(e===window||e instanceof HTMLElement||e instanceof SVGElement?"addEventListener":r.onKey)||this.onKey](t,n);var o={object:e,eventName:t,callback:n,options:r};return this.events.push(o),o}},{key:"_unbind",value:function(e){var t=e.object,n=e.eventName,r=e.callback,o=e.options;if(t[(t===window||t instanceof HTMLElement||t instanceof SVGElement?"removeEventListener":o.offKey)||this.offKey](n,r),this.events){var a=this.events.indexOf(e);-1!==a&&this.events.splice(a,1)}}},{key:"unbind",value:function(e){var t=this;e?this._unbind(e):this.events.concat([]).forEach((function(e){t._unbind(e)}))}},{key:"destroy",value:function(){this.events&&this.unbind(),this.events=[],this.destroyed=!0}}]),e}();function hl(e){return"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+e)))}var pl=["http:","https:","data:","dingtalk:","ftp:","mailto:","blob:"];function ml(e){return function(e){return"string"==typeof e&&!(e=e.toLowerCase()).startsWith("data:text/html")&&(!!pl.some((function(t){return e.startsWith(t)}))||!(!e.startsWith("./")&&!e.startsWith("/"))||e.indexOf(":")<0)}(e)?e:""}var yl=new Ee.a.FilterXSS({onIgnoreTag:function(){return""},css:{whiteList:qr},whiteList:{p:["style","id"],a:["href","title","target","style"],b:["style"],i:["style"],span:["style"],br:[],div:["style"]},onTag:function(e,t,n){var r=n.isClosing;if("a"===e&&!r&&"string"==typeof t){var o=t.match(/<a\s+(?:[^>]*?\s+)?href=(["'])(.*?)\1/);if(!o||!ml(o[2]))return""}},onTagAttr:function(e,t,n){if("a"===e&&"href"===t){var r=ml(n);return r?"".concat(t,'="').concat(r,'"'):""}}});function vl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bl(e){if(!e)return!1;var t=(new DOMParser).parseFromString(e,"text/html").querySelector("[data-lake_diagram_body]");return!!t&&{body:JSON.parse(t.dataset.lake_diagram_body),extraInformations:JSON.parse(t.dataset.lake_extra_informations||t.dataset.lake_computed_props_map)||{},optionsMap:{}}}function xl(e){return e&&(e=yl.process(e)),e||""}function wl(e){try{var t;t=e.includes("\r\n")?e.trim().split("\r\n"):e.trim().split("\n");var n,r,o,a,i,c=[],l=0,u=1/0,s=vl(t.map((function(e){if(0!==e.trim().length){var t=(e=e.replace(decodeURI("%0D"),"")).match(/^(\s*)(\S[\s\S]*)$/),n=b()(t,3),r=n[1],o=n[2],a=r.replace(/\t/g,"");return a.length>0&&a.length<u&&(u=a.length),{indent:r,html:o,spaceLength:a.length}}})).filter((function(e){return e})));try{for(s.s();!(i=s.n()).done;){var d,f=i.value,h=f.indent,p=f.html,m=u===1/0?h:h.replace(/\t/g," ".repeat(u)),y="",v=!0,g=vl(p);try{for(g.s();!(d=g.n()).done;){var x=d.value;if("\n"!==x)y+=x;else{if(v){y+="<div>",v=!1;continue}y+="</div><div>"}}}catch(e){g.e(e)}finally{g.f()}v||(y+="</div>"),!a&&m&&n&&(a=m.length);var w=m.length/a;if(w)if(w>l)r=o,o={html:y},r.children=[o],l+=1;else if(w===l)o={html:y},r.children.push(o);else{var k=0;for(r=n;k<w-1;)r=r.children[r.children.length-1],k++;o={html:y},l=w,r.children.push(o)}else n=r=o={html:y},c.push(n),l=0}}catch(e){s.e(e)}finally{s.f()}return c}catch(e){return null}}var kl=Object.freeze({__proto__:null,getLakeDataByHtml:bl,parseHTML:xl,structuredPlainText:wl});function El(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ol=pe.HotKeyUtils.isHotkey,Cl=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,c()(A()(r),"eventHelper",new fl),c()(A()(r),"isBegin",!1),c()(A()(r),"dom",void 0),c()(A()(r),"eventObj",{}),c()(A()(r),"originCursor",void 0),c()(A()(r),"compositing",!1),c()(A()(r),"readyCommands",{}),r}return v()(n,[{key:"_getFormattingFlags",value:function(e,t){var n=[],r=0;switch(t){case"bold":case"italic":case"underline":case"strikethrough":e.forEach((function(e){var o=e.querySelector("span");("bold"===t?"bold"===(null==o?void 0:o.style.fontWeight):"italic"===t?"italic"===(null==o?void 0:o.style.fontStyle):"underline"===t?null==o?void 0:o.style.textDecorationLine.includes("underline"):null==o?void 0:o.style.textDecorationLine.includes("line-through"))?(r++,n.push(!1)):n.push(!0)})),r===e.length&&(n=n.map((function(){return!0})));break;default:n=e.map((function(){return!0}))}return n}},{key:"batchEdit",value:function(e,t,n){var r,o=this,a=window.getSelection();try{r=null==a?void 0:a.getRangeAt(0)}catch(e){}var i=this._getFormattingFlags(e,t);e.forEach((function(e,r){var c=document.createRange();c.selectNodeContents(e),null==a||a.removeAllRanges(),null==a||a.addRange(c);var l=e.getAttribute("contenteditable");e.setAttribute("contenteditable","true"),"fontSize"===t?(o._execCommand(t,"1"),dl(n,e,c)):i[r]&&o._execCommand(t,n),l||e.removeAttribute("contenteditable")})),null==a||a.removeAllRanges(),r&&(null==a||a.addRange(r))}},{key:"prepareEdit",value:function(){var e=this.dom;if(e){this.updateStartContent();var t=window.getSelection(),n=document.createRange();e.focus(),n.selectNodeContents(e),null==t||t.removeAllRanges(),null==t||t.addRange(n),this.emit("prepareedit")}}},{key:"closest",value:function(e,t){return rl(e,t,this.dom)}},{key:"getRange",value:function(){if(!this.dom)return null;var e=window.getSelection();try{var t=null==e?void 0:e.getRangeAt(0);return t&&!this.dom.contains(t.commonAncestorContainer)?null:t}catch(e){return null}}},{key:"_execCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];document.execCommand("styleWithCss",!1,"true");var r=document.execCommand(e,n,t);return{result:r,eventObj:{name:e,showUI:n,value:t,result:r,target:void 0}}}},{key:"convertFontSize",value:function(e){var t=this.getRange();dl(e,this.dom,t)}},{key:"execReadyCommand",value:function(){this.readyCommands.fontSize&&this.convertFontSize(this.readyCommands.fontSize.value),this.readyCommands={}}},{key:"execCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getRange();if(r&&e){if("fontSize"===e){var o=this._execCommand(e,"1",n),a=o.result,i=o.eventObj;return this.convertFontSize(t),this.afterExecCommand({name:e,value:t,result:a,eventObj:i}),a}if("createLink"===e){var c=this._execCommand(e,t,n),l=c.result,u=c.eventObj;if(l){var s,d,f=null===(s=this.dom)||void 0===s?void 0:s.querySelectorAll("a"),h=null===(d=r=this.getRange())||void 0===d?void 0:d.commonAncestorContainer;if(u.target=rl(h,"a",this.dom)||1===h.nodeType&&(null==h?void 0:h.querySelector("a")),f)for(var p=0;p<f.length;p++){var m=f[p];m.setAttribute("target","_blank"),m.style.cursor="default",ul(m.getAttribute("href"))&&m.setAttribute("href","")}}return this.afterExecCommand({name:e,value:t,result:l,eventObj:u}),l}var y=this._execCommand(e,t,n),v=y.result,g=y.eventObj;return this.afterExecCommand({name:e,value:t,result:v,eventObj:g}),v}}},{key:"getFirstTag",value:function(e){return il(e,this.dom)}},{key:"afterExecCommand",value:function(e){var t=e.name,n=e.value,r=e.result,o=e.eventObj,a=this.getRange();if(null!=a&&a.collapsed)if(this.readyCommands[t])Object.assign(this.readyCommands[t],{value:n,result:r,cancel:!this.readyCommands[t].cancel});else{var i=this.getRange(),c=null==i?void 0:i.startContainer,l=c===this.dom?this.getFirstTag("SPAN"):this.closest(c,(function(e){return 1===e.nodeType}));this.readyCommands[t]={value:n,result:r,cancel:!!this.closest(l,(function(e){return ol(e,"strikethrough"===t?"line-through":t)}))}}this.emit("execcommand",o),this.emitChangeEvent()}},{key:"emitChangeEvent",value:function(){this.emit("change",{dom:this.dom})}},{key:"emitTextareaKeydownEvent",value:function(e){this.emit("textareaKeydown",e)}},{key:"beginEdit",value:function(){if(this.dom){this.isBegin=!0,this.emit("beginedit",this.eventObj),document.execCommand("styleWithCss",!1,"true"),this.dom.classList.remove("selection-transparent");var e=escape(this.dom.innerText);if(this.dom.style.cursor="text","%u200B"===e||"%u200D"===e){var t=this.getRange();null==t||t.collapse()}this.emit("selectionchange")}}},{key:"forceEndEdit",value:function(){this.isBegin&&(this.endEdit(),this.prepareEdit())}},{key:"updateStartContent",value:function(){var e;this.eventObj&&(this.eventObj.startHTML=xl(null===(e=this.dom)||void 0===e?void 0:e.innerHTML))}},{key:"bind",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.eventHelper,o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?El(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):El(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({insertParagraphKey:function(e){},cancelKey:function(e){}},n),a=o.insertParagraphKey,i=o.cancelKey;this.originCursor=e.style.cursor,this.dom=e,e.setAttribute("contenteditable","true"),e.setAttribute("spellcheck","false"),e.focus({preventScroll:!0}),this.eventObj={dom:e},this.updateStartContent(),r.bind(e,"contextmenu",(function(e){t.isBegin&&e.stopPropagation()})),r.bind(document,"selectionchange",(function(){t.compositing||(t.execReadyCommand(),t.emit("selectionchange"))}),{onKey:"addEventListener",offKey:"removeEventListener"}),r.bind(e,"keydown",(function(e){var n=t.dom,r=t.diagram,o=t.getRange(),c=r.viewport.zoom;if(t.emitTextareaKeydownEvent(e),t.isBegin){if(Ol("mod+k",e))return e.preventDefault(),e.stopPropagation(),void t.execCommand("createLink",jr("链接"));if(Ol("mod+shift+x",e))return e.preventDefault(),e.stopPropagation(),void t.execCommand("strikethrough","");if(a(e))return t.compositing||t.execCommand("insertParagraph",""),e.stopPropagation(),void e.preventDefault();if(i(e))return e.preventDefault(),e.stopPropagation(),void(t.compositing||t.forceEndEdit());if(Ol("mod+s",e))return;if(function(e,t){var n=e.startContainer,r=e.startOffset;return!!e.collapsed&&function e(t,n,r){if(n>0)return!1;if(t===r)return!0;var o=t.parentNode;return!!o&&e(o,Array.from(o.childNodes).indexOf(t),r)}(n,r,t)}(o,n)&&"ArrowLeft"===e.key)return e.preventDefault(),void e.stopPropagation();if(function(e,t){var n=e.endContainer,r=e.endOffset;return!!e.collapsed&&function e(t,n,r){if(t.nodeType===Node.TEXT_NODE){if(n!==t.data.length)return!1}else if(n!==t.childNodes.length)return!1;if(t===r)return!0;var o=t.parentNode;return!!o&&e(o,Array.from(o.childNodes).indexOf(t)+1,r)}(n,r,t)}(o,n)&&"ArrowRight"===e.key)return e.preventDefault(),void e.stopPropagation();if(function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=e.getBoundingClientRect(),a=t.getBoundingClientRect();return n=e.collapsed&&["x","y","width","height"].every((function(e){return 0===o[e]}))&&1===e.commonAncestorContainer.nodeType?e.commonAncestorContainer.getBoundingClientRect().y-a.y:o.y-a.y,(n=Math.abs(n/r))<6}(o,n,c)&&"ArrowUp"===e.key)return e.preventDefault(),void e.stopPropagation();if(function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=e.getBoundingClientRect(),a=t.getBoundingClientRect();return n=e.collapsed&&["x","y","width","height"].every((function(e){return 0===o[e]}))&&1===e.commonAncestorContainer.nodeType?e.commonAncestorContainer.getBoundingClientRect().bottom-a.bottom:o.bottom-a.bottom,(n=Math.abs(n/r))<6}(o,n,c)&&"ArrowDown"===e.key)return e.preventDefault(),void e.stopPropagation();e.stopPropagation()}else{if(Ol("mod+c",e)||Ol("mod+v",e)||Ol("mod+x",e)||Ol("shift+enter",e)||Ol("space",e))return;if(Ol("mod+enter",e))return e.preventDefault(),e.stopPropagation(),void t.beginEdit();if(function(e){return!(e.altKey||e.ctrlKey||e.metaKey||["Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Capslock","Esc","Home","Pause","Shift","Option","Alt","Help","Esc","Backspace","Delete","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(e.key))}(e))return e.stopPropagation(),void t.beginEdit();e.preventDefault()}})),r.bind(e,"compositionstart",(function(){t.compositing=!0})),r.bind(e,"compositionend",(function(){t.compositing=!1})),r.bind(e,"input",(function(e){e.stopPropagation(),t.isBegin?t.emitChangeEvent():e.preventDefault()})),r.bind(e,"paste",ll.bind(this)),r.bind(e,"copy",sl.bind(this)),r.bind(e,"cut",(function(e){sl.call(t,e,"cut")}))}},{key:"endEdit",value:function(){this.isBegin=!1,this.dom&&(this.eventObj.endHTML=xl(this.dom.innerHTML),this.dom.style.cursor=this.originCursor,this.dom.classList.add("selection-transparent")),this.emit("endedit",this.eventObj)}},{key:"unbind",value:function(){var e=this.dom,t=this.eventHelper;e&&(e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck"),t.unbind(),this.endEdit(),this.dom=void 0)}},{key:"query",value:function(){return cl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dom,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getRange(),arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.readyCommands)}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(Cl,"className","ContentEditor");var Al=function(){function e(t){m()(this,e),c()(this,"graphicGroup",void 0),c()(this,"dx",0),c()(this,"dy",0),this.graphicGroup=t}return v()(e,[{key:"translate",value:function(e,t){this.graphicGroup.update({matrix:[1,0,0,0,1,0,e,t,1]}),this.dx=e,this.dy=t}},{key:"getBBox",value:function(){return this.graphicGroup.getBBox()}},{key:"destroy",value:function(){this.graphicGroup.destroy()}}]),e}(),Pl=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"delegations",[])}return v()(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.diagram,n=new no;"function"==typeof e?e(n):((e=e.map((function(e){return t.find(e)})).filter((function(e){return e}))).sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e.forEach((function(e){var t=new lo({element:e.graphicGroup});n.add(t)}))),t.frontRootGroup.prepend(n);var r=new Al(n);return this.delegations.push(r),r}},{key:"clear",value:function(){var e=this;this.delegations.forEach((function(t){e.remove(t)}))}},{key:"remove",value:function(e){var t=this.delegations;t.splice(t.indexOf(e),1),e.destroy()}},{key:"destroy",value:function(){this.delegations=[]}}]),e}();c()(Pl,"className","Delegator");var Sl=function(e,t){var n={};return t.forEach((function(t){var r=e.find(t);if(r){var o=r.mindmapParent;if(o&&o.isMindmap){var a=o.model.id,i=o.getChildren().indexOf(r),c=o.isTwoQuadrantLayout,l=i;if(c){var u,s,d=null!==(u=null===(s=r.model.layout)||void 0===s?void 0:s.quadrant)&&void 0!==u?u:1;a+=":"+d;var f=o.quadrantTreeLists[d-1];if(!f)throw new Error("no correct quad index list"+JSON.stringify(o.quadrantTreeLists));l=f.indexOf(i)}if(r.model.abstract){var h,p,m={id:r.model.id,index:i,q:c?null!==(h=null===(p=r.model.layout)||void 0===p?void 0:p.quadrant)&&void 0!==h?h:1:void 0,start:r.model.start,end:r.model.end};n[a]?n[a].abstracts.push(m):n[a]={indexes:[],childrenIds:[],childrenLength:o.model.children.filter((function(e){return!e.abstract})).length,abstracts:[m]}}else l>=0&&(n[a]?(n[a].indexes.push(l),n[a].childrenIds.push(r.model.id)):n[a]={indexes:[l],childrenIds:[r.model.id],childrenLength:o.model.children.filter((function(e){return!e.abstract})).length,abstracts:[]})}}})),n};function jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jl(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _l=function(e,t,n){var r,o,a="mindmap"===e.type;if(t&&t.isMindmap){if(delete e.type,delete e.x,delete e.y,delete e.zIndex,e.children){var i=e.layout,c=void 0===i?{}:i,l=c.type,u=void 0===l?"standard":l,s=c.quadrantConstraint,d=void 0===s?[1,2]:s;if(!a||"standard"!==u||null!==d&&2!==d.length)e.children.forEach((function(e){var t;2===(null===(t=e.layout)||void 0===t?void 0:t.quadrant)&&(e.layout.quadrant=1)}));else{e.children.sort((function(e,t){var n=e.layout,r=(void 0===n?{}:n).quadrant,o=void 0===r?1:r,a=e.abstract,i=t.layout,c=(void 0===i?{}:i).quadrant,l=void 0===c?1:c,u=t.abstract;return a&&u||!a&&!u?o-l:a?1:u?-1:0}));var f=e.children.filter((function(e){var t=e.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n,o=e.abstract;return 1===r&&!o}));e.children.forEach((function(e){var t=e.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n,o=e.abstract,a=e.start,i=void 0===a?0:a,c=e.end,l=void 0===c?0:c;return 2===r&&o&&(e.start=i+f.length,e.end=l+f.length),0}))}}}else e.layout&&delete e.layout.quadrant,delete e.collapsed,delete e.abstract,delete e.start,delete e.end,e.type="mindmap",e.layout=null!==(r=e.layout)&&void 0!==r?r:{type:"standard"},e.layout.type=null!==(o=e.layout.type)&&void 0!==o?o:"standard",a||e.children.forEach((function(e){e.layout&&(e.layout.quadrant=1)}));return e},Ml=function(e,t){t=t.concat([]);var n=Sl(e,t),r=[{},{}],o=t.filter((function(e){return!e.isMindmap})),a=o.map((function(e){return u()(e.model)})),i=t.filter((function(e){return e.isMindmap&&e.isStem})),c=i.length;o.push.apply(o,T()(i)),i.forEach((function(e){var t,n=u()(e.model);null!==(t=n.layout)&&void 0!==t&&t.quadrant&&delete n.layout.quadrant,a.push(n)})),Object.keys(n).forEach((function(t){var o=t.split(":"),a=b()(o,2),i=a[0],c=a[1],l=void 0===c?void 0:parseInt(c),u=null!=l?l:1,s=n[t],d=s.indexes,f=s.abstracts,h=s.childrenIds,p=s.childrenLength,m=e.find(i),y={normal:[],abstract:[]};h.forEach((function(t,n){var r=e.find(t);if(r){var o={cell:r,quadIndex:d[n]};y.normal.push(o)}})),m.getChildren().filter((function(e){return e.model.abstract&&e.realQuadrant===u})).forEach((function(e,t){var n=e.model,r=n.id,o=n.start,a=n.end;if(Pe()(o,a+1).every((function(e){return d.includes(e)}))){var i={cell:e,quadIndex:t};y.abstract.push(i)}else if(f.find((function(e){return r===e.id}))){var c={cell:e,quadIndex:t+p};y.normal.push(c)}})),r[u-1][t]=y})),r.forEach((function(e,t){Object.keys(e).forEach((function(n){var r,i,c=(null!==(r=null===(i=e[n])||void 0===i?void 0:i.normal)&&void 0!==r?r:[]).sort((function(e,t){return e.quadIndex-t.quadIndex}));o.push.apply(o,T()(c.map((function(e){return e.cell})))),a.push.apply(a,T()(c.map((function(e){var n=u()(e.cell.model),r=e.cell,o=r.x,a=r.y;return delete n.abstract,delete n.start,delete n.end,n.x=o,n.y=a,n.layout=Rl(Rl({},n.layout),{},{quadrant:t+1}),n}))))}))})),r.forEach((function(e,t){Object.keys(e).reduce((function(r,i){var c,l,s,d,f=n[i].indexes.sort(),h=null!==(c=null===(l=e[i])||void 0===l?void 0:l.normal)&&void 0!==c?c:[],p=(null!==(s=null===(d=e[i])||void 0===d?void 0:d.abstract)&&void 0!==s?s:[]).sort((function(e,t){return e.quadIndex-t.quadIndex}));return o.push.apply(o,T()(p.map((function(e){return e.cell})))),a.push.apply(a,T()(p.map((function(e){var n=u()(e.cell.model),o=e.cell,a=o.x,i=o.y;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.start,o=e.end;if(e.start=t.indexOf(r)+n,e.end=t.indexOf(o)+n,e.start===n-1||e.end===n-1)throw new Error("wrong s and e for trans: ".concat(e.start,", ").concat(e.end))}(n,f,r),n.x=a,n.y=i,n.layout&&(n.layout.quadrant=t+1),n})))),r+h.length}),c)}));var l=e.deduplicate(o),s=a.filter((function(e){return l.find((function(t){return t.model.id===e.id}))}));return[l,s]},Ll=function(e,t,n,r,o){var a=[],i=[],c=[];if(t&&mr(t)){var l,u=t.isTwoQuadrantLayout;a.push.apply(a,T()(e.filter((function(e){return!!o&&!o(e)})))),a.forEach((function(){i.push({})}));var s=e.filter((function(e){return!o||o(e)}));u||(n=1);var d=[[],[]],f=[[],[]],h=1,p=null!==(l=t.model.children)&&void 0!==l?l:[],m=p.filter((function(e){return e.abstract})),y=p.length-m.length,v=t.quadrantTreeLists,g=[-1,-1];s.forEach((function(e){var t,n=(null===(t=e.layout)||void 0===t?void 0:t.quadrant)||1;e.abstract||(n>h?h=n:h>n&&(n=h,void 0===e.layout&&(e.layout={}),e.layout.quadrant=n),d[n-1].push(e))})),s.forEach((function(e){if(e.abstract){var t=e.start,n=e.end,r=e.layout,o=(void 0===r?{}:r).quadrant,a=void 0===o?1:o,i=d[a-1].length;t>g[a-1]&&t<=n&&n<i?(g[a-1]=n,f[a-1].push(e)):Wt(e,(function(e){c.push(e.id)}))}})),n&&(d.forEach((function(e){e.forEach((function(e){void 0===e.layout&&(e.layout={}),e.layout.quadrant=n}))})),f.reduce((function(e,t,r){return t.forEach((function(t){t.start+=e,t.end+=e,void 0===t.layout&&(t.layout={}),t.layout.quadrant=n})),e+d[r].length}),0),d=[Ce()(d)],f=[Ce()(f)]),d.reduce((function(e,o,c){var l=n?n-1:c,u=void 0===r||r>=v[l].length,s=0===l?0===v[l].length?0:v[l][v[l].length-1]+1:y,d=u?s:v[l][r];return o.forEach((function(n,r){_l(n,t),a.push(n);var o={nth:d+r+e,parent:t.model.id};i.push(o)})),e+o.length}),0),d=[Ce()(d)],f.reduce((function(e,o,l){var s=n?n-1:l,f=v[s],h=null!=r?r:f.length;if(!m.some((function(e){var t=e.start,n=e.end,r=e.layout,o=(void 0===r?{}:r).quadrant;return s+1===(u?void 0===o?1:o:1)&&t<h&&h<=n}))){var p=m.findIndex((function(e,t){var n=e.start,r=e.layout,o=(void 0===r?{}:r).quadrant,a=u?void 0===o?1:o:1;return a>s+1||s+1===a&&n>=h})),g=y+d[0].length+(-1===p?m.length:p);return o.forEach((function(n,r){n.start+=h,n.end+=h,_l(n,t),a.push(n);var o={nth:g+r+e};t&&(o.parent=t.model.id),i.push(o)})),e+o.length}return o.forEach((function(e){Wt(e,(function(e){c.push(e.id)}))})),e}),0)}else e.forEach((function(e){(!o||o(e))&&_l(e),a.push(e);var n={};t&&(n.parent=t.model.id),i.push(n)}));return[a,i,c]};function Tl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tl(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nl(e,t){var n=t.left,r=t.top,o=t.width,a=t.height,i=t.padding;e.setAttribute("viewBox",[n-i,r-i,o+2*i,a+2*i].join(",")),e.setAttribute("width","".concat(o)),e.setAttribute("height","".concat(a)),e.style.width="".concat(o,"px"),e.style.height="".concat(a,"px")}function Bl(e){return"jpg"===e||"jpeg"===e}function Il(e){var t=(new XMLSerializer).serializeToString(e);return t=t.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[\x00-\x1F\x7F-\x9F]/g,""),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+t)))}function Fl(e){return ql.apply(this,arguments)}function ql(){return(ql=de()(he.a.mark((function e(t){var n,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r=Object.keys(t).map(function(){var e=de()(he.a.mark((function e(r){var o,a,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t[r],e.next=3,fetch(o).then((function(e){return e.blob()}));case 3:return a=e.sent,e.next=6,new Promise((function(e){var t=new FileReader;t.onload=function(){e(t.result)},t.readAsDataURL(a)}));case 6:i=e.sent,n[r]=i;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(r);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zl(e){return Gl.apply(this,arguments)}function Gl(){return(Gl=de()(he.a.mark((function e(t){var n,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r=t.map(function(){var e=de()(he.a.mark((function e(t){var r,o,a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,o=t.fontURL,a=t.fontWeight,e.abrupt("return",Fl(o).then((function(e){n.push({name:r,fontDataURL:e,fontWeight:a})})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(r);case 4:return e.abrupt("return",n.map((function(e){var t=e.fontDataURL,n="@font-face{font-family:".concat(e.name,";src:");return Object.entries(t).forEach((function(e,r){var o=b()(e,2),a=o[0],i=o[1];r===Object.keys(t).length-1?n+="url(".concat(i,")format(").concat(a,");"):n+="url(".concat(i,")format(").concat(a,"),")})),n+="font-weight:".concat(e.fontWeight,";font-style:normal;}")})).join(""));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yl(e,t){var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;var r=e.querySelector("defs");r?r.appendChild(n):e.insertBefore(n,e.firstChild)}function Hl(e,t){if(t.image&&t.image.src){var n=document.createElement("img");n.setAttribute("src",t.image.src),e.appendChild(n)}}function Vl(e,t){if(t.noteContent){var n=document.createElement("p");n.textContent=t.noteContent,e.appendChild(n)}}function Ul(e){var t=document.createElement("td");return e.textContent&&(t.textContent=e.textContent),Hl(t,e),Vl(t,e),t}var Wl=function(){function e(t){m()(this,e),this.diagram=t}var t,n,r;return v()(e,[{key:"canvas",value:(r=de()(he.a.mark((function e(){var t,n,r,o,a,i,c,l,u,s,d,f,h,p,m,y=arguments;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=y.length>0&&void 0!==y[0]?y[0]:{}).backgroundColor,r=t.paperClip,o=t.base64EncodedFonts,a=t.cells,i=this.svg(a),r&&(c=this.diagram.paper,l=c.size,Nl(i,{left:0,top:0,width:l[0],height:l[1],padding:2})),o&&Yl(i,o),e.next=7,Promise.all(Array.from(i.querySelectorAll("image"),function(){var e=de()(he.a.mark((function e(t){var n,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.getAttribute("href"))){e.next=6;break}return e.next=4,Aa(n);case 4:(r=e.sent)&&t.setAttribute("href",r.toDataURL("image/png"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).concat(Array.from(i.querySelectorAll("img"),function(){var e=de()(he.a.mark((function e(t){var n,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.getAttribute("src"))){e.next=6;break}return e.next=4,Aa(n);case 4:(r=e.sent)&&t.setAttribute("src",r.toDataURL("image/png"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 7:return u=parseFloat((null==i?void 0:i.getAttribute("width"))||"0"),s=parseFloat((null==i?void 0:i.getAttribute("height"))||"0"),d=u/s,f=window.devicePixelRatio>2?window.devicePixelRatio:2,t.width&&null==t.height?(h=t.width,p=t.width/d):t.height&&null==t.width?(p=t.height,h=t.height*d):t.width&&t.height?(h=t.width,p=t.height):(h=u,p=s),m=Il(i),e.next=15,Aa(m,{backgroundColor:n,width:h,height:p,ratio:f});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"json",value:function(e){var t=this.diagram,n={head:Dl({},t.head),body:[]};return e?e.forEach((function(e){var t=e.model;if(null!=t&&t.type){var r=u()(e.model);n.body.push(r)}})):t.rootGroup.rendererElement.childNodes.forEach((function(e,r){var o=t.getCell(e);if(o&&(o.model.zIndex=r,o.isRoot&&!o.model.isPlaceholder)){var a=u()(o.model);a.children&&0===a.children.length&&delete a.children,Wt(a,(function(){void 0!==a.html&&(a.html=xl(a.html))})),n.body.push(a)}})),n}},{key:"svg",value:function(e,t){t=Dl({type:"default"},t);var n=function(e,t){var n,r,o=e.getCells(),a=o.filter((function(e){return e.state.beginEdit||e.state.selected||e.state.highlight}));a.forEach((function(e){e.setDefault()})),t&&o.forEach((function(e){e.graphicGroup.rendererElement.setAttribute("data-id",e.model.id)}));var i=e.canvas.rendererElement.cloneNode(!0),c=i.querySelectorAll("foreignObject");if(i.querySelectorAll("image").forEach((function(e){var t=e.getAttribute("href");t&&t.startsWith("blob:")&&e.setAttribute("href","")})),null===(n=i.querySelector('[data-element="front_group"]'))||void 0===n||n.remove(),null===(r=i.querySelector('[data-element="back_group"]'))||void 0===r||r.remove(),i.style["background-color"]=null,t)for(var l=i.querySelectorAll("[data-id]"),u=0;u<l.length;u++){var s=l[u],d=s.getAttribute("data-id");d&&t.includes(d)||s.remove()}return c&&c.forEach((function(e){var t=e.getAttribute("width");t&&(t=Number(t))>0&&(t+=4,e.setAttribute("width",String(t)))})),a.forEach((function(e){e.updateState()})),t&&o.forEach((function(e){e.graphicGroup.rendererElement.removeAttribute("data-id")})),function(e){e.style.position="fixed",e.style.visibility="hidden",document.body.appendChild(e),Nl(e,Object.assign(function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;return Array.from(e.childNodes).filter((function(e){return"root_group"===e.dataset.element})).forEach((function(e){if("defs"!==e.tagName.toLowerCase()){var a=e.getBBox(),i=a.x,c=a.y,l=a.width,u=a.height;i<t&&(t=i),i+l>r&&(r=i+l),c<n&&(n=c),c+u>o&&(o=c+u)}})),{left:t,top:n,width:r-t,height:o-n}}(e),{padding:2})),e.style.position="relative",e.style.visibility="visible",document.body.removeChild(e)}(i),i}(this.diagram,e&&e.map((function(e){return e.model.id}))),r=t.type;return"string"===r||"dom-string"===r?'<?xml version="1.0" encoding="utf-8"?>'+(new XMLSerializer).serializeToString(n):n}},{key:"image",value:function(){var e=this.svg(),t=new Image;return t.src=Il(e),t}},{key:"blob",value:(n=de()(he.a.mark((function e(){var t,n,r,o,a,i,c,l=arguments;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:"jpeg",n=l.length>1&&void 0!==l[1]?l[1]:{},r=this.diagram,Bl(t)&&(n.backgroundColor=null==r||null===(o=r.theme)||void 0===o||null===(a=o.values)||void 0===a?void 0:a.canvasBackgroundColor),window.lake_diagram_external_font){e.next=8;break}return e.next=7,zl(zr);case 7:window.lake_diagram_external_font=e.sent;case 8:return i=window.lake_diagram_external_font,e.next=11,this.canvas(Dl(Dl({},n),{},{base64EncodedFonts:i}));case 11:return c=e.sent,e.abrupt("return",new Promise((function(e){null==c||c.toBlob(e,"image/".concat(t),"jpeg"===t?.8:1)})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"download",value:(t=de()(he.a.mark((function e(){var t,n,r,o,a,i,c,l,u,s,d=arguments;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:"jpeg",n=d.length>1&&void 0!==d[1]?d[1]:{},r=this.diagram,Bl(t)&&(n.backgroundColor=null==r||null===(o=r.theme)||void 0===o||null===(a=o.values)||void 0===a?void 0:a.canvasBackgroundColor),window.lake_diagram_external_font){e.next=8;break}return e.next=7,zl(zr);case 7:window.lake_diagram_external_font=e.sent;case 8:return i=window.lake_diagram_external_font,e.next=11,this.canvas(Dl(Dl({},n),{},{base64EncodedFonts:i}));case 11:c=e.sent,l=document.createElement("a"),u=n.filename||"yuque_diagram",l.download="".concat(u,".").concat(t),c&&((s=c.toDataURL("image/".concat(t))).length<20?we.a.warn(jr("画布尺寸过大，导出图片失败")):"default"!==r.rough.name&&pe.ua.windows?we.a.warn(jr("无法导出手绘字体，可能导致图片失真")):(l.href=s,l.click()));case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_textContent",value:function(e){return e?function(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}(e):""}},{key:"doc",value:function(e){var t=this,n=document.createElement("div");return e.forEach((function(e){Wt(e,(function(e){if(rn(e.depth,[0,3])){if(e.textContent){var r=document.createElement("h".concat(e.depth+1));r.textContent=e.textContent,n.appendChild(r)}return Hl(n,e),void Vl(n,e)}return t.list([e]).childNodes.forEach((function(e){n.appendChild(e)})),!1}))})),n}},{key:"table",value:function(e){var t=document.createElement("table");e.forEach((function(e){Wt(e,(function(e,n){if(e.parent=n,!e.children||0===e.children.length){var r=document.createElement("tr"),o=Ul(e);for(r.prepend(o);n;){var a=Ul(n);r.prepend(a),n=n.parent}t.appendChild(r)}}))}));var n=0;return t.childNodes.forEach((function(e){var t=e.childNodes.length;t>n&&(n=t)})),t.childNodes.forEach((function(e){for(var t=e.childNodes.length,r=0;r<n-t;r++){var o=document.createElement("td");e.appendChild(o)}})),t}},{key:"list",value:function(e){var t=document.createElement("div");return e.forEach((function(e){var n=document.createElement("ul");Wt(e,(function(e,t){e.level=t?t.level+1:1;var r=document.createElement("li");t?t.childContainer.appendChild(r):n.appendChild(r),e.textContent&&(r.textContent=e.textContent),Hl(r,e),Vl(r,e),e.children&&e.children.length>0&&(e.childContainer=document.createElement("ul"),t?t.childContainer.appendChild(e.childContainer):n.appendChild(e.childContainer))})),t.appendChild(n)})),t}},{key:"dom",value:function(e){var t=this,n=this.diagram,r=n.settings.copyType;e||(e=n.getCells().filter((function(e){return e.isStem}))),e=n.deduplicate(e);var o=Ml(n,e),a=b()(o,2),i=a[0],c=a[1],l=document.createElement("div"),s=document.createElement("div"),d=[];i.forEach((function(e){d=d.concat(e.getAllCells())}));var f=d.reduce((function(e,t){var n=u()(t.computedProps)||{};if("line"===t.type)n.points=t.getPoints();else if(Er(t)){var r=t.getPointBox();n.topLeft=[r.minX,r.minY],n.points=u()(t.model.points)}return n.swimlane=t.swimlane,n.x=t.x,n.y=t.y,fr(t)&&(n.x=null,n.y=null),n.rootType=t.stem.type,n.nth=t.getNth(),n.hasParent=!!t.parent,e[t.model.id]=n,e}),{})||{};s.dataset.lake_diagram_body=JSON.stringify(c);var h,p=JSON.stringify(f);return s.dataset.lake_extra_informations=p,l.appendChild(s),c.forEach((function(e,n){e.depth=null==i?void 0:i[n].depth,Xt(e,(function(e,t){e.depth=t.depth+1})),Wt(e,(function(e){e.textContent=t._textContent(e.html),e.note&&e.note.content&&(e.noteContent=t._textContent(e.note.content))}))})),h="doc"===r?this.doc(c):"table"===r?this.table(c):this.list(c),l.appendChild(h),l}},{key:"html",value:function(){return this.dom().outerHTML}},{key:"getText",value:function(){return this.dom().innerText}},{key:"clipboard",value:function(e){var t=this.dom(e);return{html:t.innerHTML,text:t.textContent}}},{key:"destroy",value:function(){}}]),e}();c()(Wl,"className","Exporter");var Xl=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new no),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),this.group.css({"pointer-events":"none"})}return v()(e,[{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t=this.diagram.viewport.zoom;e=e.filter((function(e){return e.multiSelectHighlight&&e.state.visible})),this.render(e,(function(e){return e.isLine?{type:"outline",shapeStyle:{fill:"none",stroke:"#3384F5","stroke-width":2/t}}:{type:"rect",shapeStyle:{fill:"none",stroke:"#fff","stroke-width":1/t},shadowStyle:{fill:"none",stroke:"#3384F5","stroke-width":1/t}}}))}},{key:"render",value:function(e,t){var n=this.group,r=this.diagram;cn(e,this.arr.map((function(e){return e.cell})))||(this.clear(),e&&!e.some((function(e){return!e||!e.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=e.map((function(e){var r=t(e),o=r.type,a=r.shapeStyle,i=r.shadowStyle,c={cell:e,type:"function"==typeof o?o(e):o,shape:a&&new ho(a),shadow:i&&new ho(i)};return c.shadow&&n.add(c.shadow),c.shape&&n.add(c.shape),c})),this.draw()))}},{key:"_updateShape",value:function(e){var t=e.cell,n=e.type,r=e.shape,o=e.shadow,a=t.getKeyShape();if(a){var i,c=a.attr("stroke-width"),l=c/2,u=t.graphicGroup.matrix.concat([]),s=a.getBBox();if(i="outline"===n?a.attr("d"):Jn(-l,-l,s.width+c,s.height+c),r.update({matrix:u,d:i}),o){var d=parseFloat(o.attr("stroke-width"))+parseFloat(r.attr("stroke-width")),f=s.width+c,h=s.height+c,p=i;t.isLine||(p=je()(i).scale(1+d/f,1+d/h).translate(-d/2,-d/2).toString()),o.update({matrix:u,d:p})}}}},{key:"_draw",value:function(){var e=this;this.arr.forEach((function(t){e._updateShape(t)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||0===this.arr.length||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.arr=[],this.destroyed=!0}}]),e}();c()(Xl,"className","Highlight");var Kl=function(){function e(t){m()(this,e),this.diagram=t}return v()(e,[{key:"json",value:function(e){this.diagram.add(e.body)}},{key:"clipboard",value:function(e,t){return"clipboard"}},{key:"destroy",value:function(){}}]),e}();c()(Kl,"className","Importer");var Zl=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e}},{key:"reset",value:function(){}}]),n}();var Ql=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ja(t)&&!t.shiftKey&&"z"===t.key?(e.command.execute("Undo"),e.tryFocus()):(ja(t)&&"y"===t.key||ja(t)&&t.shiftKey&&"z"===t.key)&&(e.command.execute("Redo"),e.tryFocus())}))}}]),n}();var $l=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(ja(t)&&"/"===t.key){if(e.command.enable("Collapse"))return e.command.execute("Collapse");if(e.command.enable("Expand"))return e.command.execute("Expand")}}))}}]),n}();var Jl=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.selector;this.bind(window,"mousedown",(function(n){var r=e.selector.selections,o=e.getCell(n.target);if(!(o&&o.state.selected&&e.contentEditor.isBegin)){if(o)if(n.shiftKey||(pe.ua.macos?n.metaKey:n.ctrlKey))if(r.includes(o))t.select(r.filter((function(e){return e!==o})));else{var a=o.parent,i=!1;if(n.shiftKey&&o.isMindmap&&null!=a&&a.isMindmap&&!o.isAbstract)for(var c=function(){var e=r[l];if(e.isMindmap&&!e.isAbstract){var n=e.parent,c=e.realQuadrant;if(n===a&&o.realQuadrant===c){var u=n.quadrantTreeLists[c-1],s=[u.findIndex((function(t){return t===e.getNth()})),u.findIndex((function(e){return e===o.getNth()}))].sort(),d=b()(s,2),f=d[0],h=d[1],p=n.getChildren(),m=[];return Pe()(f,h+1).forEach((function(e){var t=u[e];m.push(p[t])})),t.select(_e()(r.concat(m))),i=!0,"break"}}},l=r.length-1;l>=0&&"break"!==c();l--);i||t.select(r.concat([o]))}else r.includes(o)||t.select([o]);else hn(n.target,(function(e){var t,n;return(null==e||null===(t=e.dataset)||void 0===t?void 0:t.lake_prevent_click_unselect)||(null==e||null===(n=e.classList)||void 0===n?void 0:n.contains("lake-diagram-prevent-mouse-select"))}),window.document,(function(e){return e.parentNode}),(function(e){return!e}))||r.length>0&&t.clear();o&&o.state.selected&&!e.contentEditor.isBegin&&n.preventDefault()}}))}}]),n}();var eu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"collapsedbutton:click",(function(t){var n=t.nativeEvent,r=t.cell;if(n.stopPropagation(),n.target.closest("[data-diagram-collapsed-button=true]")){if(e.command.enable("Collapse"))return e.command.execute("Collapse",{onlyCell:r});if(e.command.enable("Expand"))return e.command.execute("Expand",{onlyCell:r})}}))}}]),n}();var tu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"scroll",(function(e){(e.ctrlKey||pe.ua.macos&&e.metaKey)&&(e.preventDefault(),e.stopPropagation())})),this.bind(e,"wheel",(function(t){if(t.ctrlKey||pe.ua.macos&&t.metaKey){t.preventDefault(),t.stopPropagation();var n=t.wheelDelta||-t.deltaY;if(e.emit("wheelzoom"),Math.abs(n)>0){var r=e.viewport.zoom;n>0?e.viewport.setViewport(1.05*r):e.viewport.setViewport(r*(1/1.05))}}}))}}]),n}();var nu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"copy",(function(t){e.command.execute("Copy",{e:t})}))}}]),n}();var ru=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"cut",(function(t){e.command.execute("Cut",{e:t})}))}}]),n}();var ou=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"paste",(function(t){t.preventDefault(),e.command.execute("Paste",{e:t})}))}}]),n}();var au=pe.HotKeyUtils.isHotkey,iu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){au("mod+=",t)?(t.preventDefault(),e.command.execute("ZoomIn")):au("mod+shift+=",t)?(t.preventDefault(),e.command.execute("FitViewport")):au("mod+-",t)?(t.preventDefault(),e.command.execute("ZoomOut")):au("mod+0",t)?e.command.execute("ActualSize"):au("mod+8",t)&&e.command.execute("FocusSelection")}))}}]),n}();var cu=document.createElement("div"),lu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.contentEditor;this.bind(t,"change",(function(t){var n=t.dom,r=e.getCell(n);!e.signal.preventUpdateCellContent&&r&&e.update(r,{html:n.innerHTML})})),this.bind(t,"beginedit",(function(t){var n=t.dom;e.signal.contentEditing=!0;var r=e.getCell(n);r&&r.beginEditContent()})),this.bind(t,"endedit",(function(t){var n=t.dom,r=t.startHTML,o=t.endHTML;e.signal.contentEditing=!1;var a=e.getCell(n);a&&(a.endEditContent(),cu.innerHTML=o,""===cu.textContent&&(o=-1!==o.indexOf("<br>")?o.replace("<br>","".concat("&#8203;","<br>")):"&#8203;"),r!==o&&"&#8203;"!==o?e.command.execute("UpdateCellContent",{id:a.model.id,startHTML:r,endHTML:o}):a.shouldRefreshEndEditContent()&&e.update(a))}))}}]),n}();var uu=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;this.bind(e,"mousedown",(function(n){clearTimeout(t),t=setTimeout((function(){e.getCell(n.target)?e.tryFocus():e.focus()}))}))}}]),n}(),su=function(e){return e.reduce((function(e,t){return vr(t)?e.push.apply(e,T()(t.children)):dr(t)?e.push.apply(e,[t].concat(T()(t.children))):e.push(t),e}),[])};var du=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(A()(e),"selections",void 0),c()(A()(e),"lines",void 0),e.selections=[],e.lines=void 0,e}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"afterselect",(function(e){var n=e.selections,r=t.lines;if(1===n.length){if(function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].model.id!==t[n].model.id)return!1;return!0}(t.selections,n))return void(r&&r.forEach((function(e){return e.resizer.update()})));r&&r.forEach((function(e){return e.resizer.end()})),t.lines=n.filter((function(e){return ur(e)})),t.lines.forEach((function(e){return e.resizer.begin()}))}else r&&r.forEach((function(e){return e.resizer.end()})),t.lines=void 0;t.selections=n}))}}]),n}(),fu=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"_currentMode",null),c()(this,"defaultCursor","default"),c()(this,"defaultCursors",{read:"grab"}),c()(this,"modes",void 0),this.modes={edit:[new Ql,new $l,new Jl,new eu,new tu,new nu,new ru,new ou,new iu,new lu,new uu,new du],read:[new $l,new Jl,new eu,new iu,new tu,new uu,new nu],none:[]}}return v()(e,[{key:"currentMode",get:function(){return this._currentMode||"read"},set:function(e){this._currentMode=e}},{key:"_removeCurrentMode",value:function(){var e;this.currentMode&&(null===(e=this.modes[this.currentMode])||void 0===e||e.forEach((function(e){e.reset(),e.unbind()})))}},{key:"init",value:function(e){this.changeMode(e)}},{key:"addDefaultCursor",value:function(e){Object.assign(this.defaultCursors,e)}},{key:"registerMode",value:function(e,t){var n,r=this.modes;r[e]?r[e]=null===(n=r[e])||void 0===n?void 0:n.concat(t):this.modes[e]=t}},{key:"getModeCursor",value:function(){return this.defaultCursors[this.currentMode]||this.defaultCursor}},{key:"changeMode",value:function(e){var t=this,n=this.modes[e],r=this.diagram;r.selector.clear(),r.emit("beforemodechange",e),this._removeCurrentMode(),null==n||n.forEach((function(e){e.diagram=t.diagram,e.init(t.diagram)}));var o=r.viewportContainer;this.currentMode!==e&&(o.dataset.lakeBoardMode=e),this.currentMode=e,r.emit("aftermodechange");var a=this.defaultCursors[e]||this.defaultCursor;this.diagram.setCursor(a)}},{key:"destroy",value:function(){this._removeCurrentMode()}}]),e}();c()(fu,"className","Interaction");var hu=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"fill",{color:"#ffffff"}),c()(this,"eventHelper",new fl),c()(this,"visible",void 0),c()(this,"size",void 0),c()(this,"element",void 0),this.diagram=t}return v()(e,[{key:"init",value:function(e){Object.assign(this,{size:[200,200]},e),this.visible&&this.render(),this.bind()}},{key:"calculateBBox",value:function(){var e=this.diagram,t=this.size,n=e.rootGroup.getBBox(),r=e.viewport.zoom;if("auto"===t){var o={},a=e.width/r,i=e.height/r;if(n.width<a){var c=n.x+n.width/2,l=a/2;o.left=c-l,o.right=c+l}else o.left=n.x,o.right=n.x+n.width;if(n.height<i){var u=n.y+n.height/2,s=i/2;o.top=u-s,o.bottom=u+s}else o.top=n.y,o.bottom=n.y+n.height;return o}return 0===n.width&&0===n.height?Array.isArray(t)?{top:0,bottom:t[1],left:0,right:t[0]}:{top:0,bottom:e.height,left:0,right:e.width}:{top:Math.floor(n.y/t[1])*t[1],bottom:Math.ceil((n.y+n.height)/t[1])*t[1],left:Math.floor(n.x/t[0])*t[0],right:Math.ceil((n.x+n.width)/t[0])*t[0]}}},{key:"getBBox",value:function(){return this.calculateBBox()}},{key:"render",value:function(){var e=this.diagram,t=this.size,n=this.fill,r=e.defs,o=e.backRootGroup,a=Object(F.a)(),i=new Vo,c=new Go({dx:0,dy:2,stdDeviation:8,"flood-color":"rgba(115, 115, 115, 0.08)"});i.attr({id:a}),i.add(c),r.add(i);var l=b()(t,2),u=l[0],s=l[1],d=new Ao({x:0,y:0,width:u,height:s,fill:n.color});d.css({filter:"url(#".concat(a,")"),"pointer-events":"none"}),o.add(d),this.element=d}},{key:"bind",value:function(){var e=this;if(this.visible){var t=Le()((function(){e.update()}),16);this.eventHelper.bind(this.diagram,"afterviewportchange",t)}}},{key:"update",value:function(e){e&&Object.assign(this,e);var t=this.diagram,n=this.fill,r=this.size;if(this.visible){this.element||this.render();var o=b()(r,2),a=o[0],i=o[1],c=t.viewport.paperBox,l=c.left,u=c.top;this.element.update({x:l,y:u,width:a,height:i,fill:n&&n.color||"#fff"})}}},{key:"destroy",value:function(){this.element&&this.element.destroy(),this.eventHelper.destroy()}}]),e}();c()(hu,"className","Paper");var pu=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"behaviours",void 0),this.behaviours=[]}return v()(e,[{key:"init",value:function(e){var t=this;e.forEach((function(e){t.registerPlugin(e)}))}},{key:"registerCell",value:function(e){var t=this.diagram;t&&(t.Cells[e.className]=e)}},{key:"registerPlugin",value:function(e){var t=this,n=this.diagram;if(n){var r=e.Cells,o=e.Commands,a=e.Extends,i=e.modes,c=e.defaultCursors,l=e.dataProcessor,u=e.settings;r&&r.forEach((function(e){t.registerCell(e)})),i&&i.forEach((function(e){var r=e.mode,o=e.Behaviours.map((function(e){return e instanceof Zl?e:new e}));n.interaction.registerMode(r,o),t.behaviours=t.behaviours.concat(o)})),o&&o.forEach((function(e){n.command.register(e)})),a&&n.addExtend(a),l&&n.addDataProcessor(l),c&&n.interaction.addDefaultCursor(c),u&&Object.assign(n.settings,u)}}},{key:"destroy",value:function(){this.diagram=void 0,this.behaviours.forEach((function(e){return e.destroy()}))}}]),e}();c()(pu,"className","Register");var mu=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"_selections",void 0),this._selections=[]}return v()(e,[{key:"selections",get:function(){return this._selections}},{key:"_select",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.diagram.cellMap;e.map((function(e){return"string"==typeof e?r[e]:e})).forEach((function(e){if(e.state.selected!==n){var r=t.selections.indexOf(e);n?(e.select(),-1===r&&t.selections.push(e)):(e.unSelect(),-1!==r&&t.selections.splice(r,1))}}))}},{key:"select",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(e)||(e=[e]);var n=this.diagram,r=this.selections,o={selections:T()(r)},a={selections:T()(e).map((function(e){return n.find(e)})).filter((function(e){return e}))},i={before:o,after:a,selections:a.selections},c=cn(o.selections,a.selections);!c&&n.emit("beforeselectionchange",i),n.emit("beforeselect",i),this._select(o.selections,!1),this._select(e,t),n.emit("afterselect",i),!c&&n.emit("afterselectionchange",i)}},{key:"clear",value:function(){this.select([])}},{key:"destroy",value:function(){}}]),e}();c()(mu,"className","Selector");var yu=function(){function e(t){m()(this,e),c()(this,"listeners",[]),c()(this,"params",void 0),this.params=t}return v()(e,[{key:"tap",value:function(e,t){this.listeners.push({name:e,listener:t})}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.listeners.forEach((function(e){return e.listener.apply(void 0,t)}))}},{key:"apply",value:function(e){this.listeners.forEach((function(t){return t.listener.apply(void 0,T()(e))}))}},{key:"destroy",value:function(){this.listeners=[]}}]),e}();c()(yu,"className","SyncHook");var vu=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"zoom",1),c()(this,"eventHelper",new fl),c()(this,"focusPoint",[0,0]),c()(this,"minZoom",.02),c()(this,"maxZoom",4),c()(this,"m",void 0),c()(this,"n",void 0),c()(this,"autoFitPadding",8),c()(this,"scrollBarSize",20),c()(this,"scrollLeft",void 0),c()(this,"scrollTop",void 0),c()(this,"isPreventDefault",void 0),c()(this,"destroyed",void 0),c()(this,"viewportCanvasBox",void 0),c()(this,"containerBox",void 0),c()(this,"canvasWidth",void 0),c()(this,"canvasHeight",void 0),c()(this,"paperBox",void 0),c()(this,"opRecord",void 0),c()(this,"viewBox",void 0)}return v()(e,[{key:"init",value:function(){this._initContainerSize(),this.setViewport(1),this._bindEvent()}},{key:"getViewportClientBox",value:function(){var e=this.diagram,t=this.scrollBarSize,n=e.viewportContainer.getBoundingClientRect(),r=n.x||n.left,o=n.y||n.top,a=n.width-t,i=n.height-t;return{minX:r,minY:o,maxX:r+a,maxY:o+i,x:r,y:o,width:a,height:i}}},{key:"getViewportCanvasBox",value:function(){var e=this.getViewportClientBox(),t=e.minX,n=e.minY,r=e.maxX,o=e.maxY,a=this.invertClient([t,n]),i=this.invertClient([r,o]);return{minX:a[0],minY:a[1],maxX:i[0],maxY:i[1],x:a[0],y:a[1],width:i[0]-a[0],height:i[1]-a[1]}}},{key:"width",get:function(){return this.diagram.width}},{key:"height",get:function(){return this.diagram.height}},{key:"_resetFocusPoint",value:function(){var e=this.focusPoint,t=this.getViewportClientBox();e[0]=t.x+t.width/2,e[1]=t.y+t.height/2}},{key:"_bindEvent",value:function(){var e=this,t=this.diagram,n=this.eventHelper,r=t.viewportContainer;n.bind(r,"scroll",Le()((function(){oi(e.scrollLeft,r.scrollLeft,1)&&oi(e.scrollTop,r.scrollTop,1)||e.setScroll(r.scrollLeft,r.scrollTop)}),16)),n.bind(t,"aftercommandexecute",(function(t){if(t.isModelChange){if(e.isPreventDefault||e.destroyed)return;e.refresh()}})),this._trackVisualFocus()}},{key:"translate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scrollLeft,r=this.scrollTop;this.setScroll(n+e,r+t)}},{key:"preventDefault",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPreventDefault=e}},{key:"scrollIntoView",value:function(e){var t=this.diagram,n=this.scrollBarSize,r=t.width,o=t.height,a=t.canvas.getBoundingClientRect();if(!(a.width<=r&&a.height<=o)){var i=this.convertViewport([e.x,e.y]),c=this.convertViewport([e.x+e.width,e.y+e.height]),l=this.scrollLeft,u=this.scrollTop;i[0]<0?l-=Math.abs(i[0])+20:c[0]>r-n&&(l+=c[0]-r+n+20),i[1]<0?u-=Math.abs(i[1])+20:c[1]>o-n&&(u+=c[1]-o+n+20),l===this.scrollLeft&&u===this.scrollTop||this.setScroll(l,u)}}},{key:"_trackVisualFocus",value:function(){var e=this,t=this.diagram,n=this.focusPoint,r=this.eventHelper;r.bind(t,"mousemove",(function(e){var t=e.clientX,r=e.clientY;n[0]=t,n[1]=r})),r.bind(t,"mouseleave",(function(t){t.relatedTarget&&1===t.relatedTarget.nodeType&&t.relatedTarget.closest(".lake-diagram-prevent-mouseleave-reset-focus-point")||e._resetFocusPoint()}))}},{key:"_resizeViewport",value:function(){var e=this.diagram,t=e.viewportContainer,n=e.width,r=e.height;t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),t.style.maxWidth="".concat(n,"px"),t.style.maxHeight="".concat(r,"px")}},{key:"_initContainerSize",value:function(){this.diagram.viewportContainer.style.overflow="auto",this._resizeViewport()}},{key:"_change",value:function(){var e=this.scrollLeft,t=this.scrollTop,n=this.canvasWidth,r=this.canvasHeight,o=this.viewBox,a=this.diagram;a.emit("beforeviewportchange"),this._resizeViewport(),a.canvas.rendererElement.style.display="block",a.canvas.rendererElement.style.width="".concat(n,"px"),a.canvas.rendererElement.style.height="".concat(r,"px"),a.canvas.rendererElement.setAttribute("viewBox",o.join(",")),a.viewportContainer.scrollLeft=e,a.viewportContainer.scrollTop=t,this._setMatrix(),a.emit("afterviewportchange"),this.viewportCanvasBox=this.getViewportCanvasBox()}},{key:"_setMatrix",value:function(){var e=this.zoom,t=this.scrollLeft,n=this.scrollTop,r=this.viewBox;this.n=[e,0,0,0,e,0,-e*r[0],-e*r[1],1],this.m=[e,0,0,0,e,0,-t-e*r[0],-n-e*r[1],1]}},{key:"isInnerCanvasPoint",value:function(e){var t=this.viewportCanvasBox,n=t.minX,r=t.maxX,o=t.minY,a=t.maxY;return!(e[0]<n||e[0]>r||e[1]<o||e[1]>a)}},{key:"focusFirstRoot",value:function(){var e=this.diagram,t=e.getCells().filter((function(e){return e.isStem}))[0];t&&(this.autoFit(),e.viewport.focus([t.x+t.width/2,t.y+t.height/2]),e.viewport.setViewport(1))}},{key:"focusGraphicCenter",value:function(){var e=this.diagram;if(e.getCells().length>0){var t=e.rootGroup.getBBox();e.viewport.focus([t.x+t.width/2,t.y+t.height/2]),e.viewport.setViewport(1)}}},{key:"setScroll",value:function(e,t){this.destroyed||(this._setScrollLeft(e),this._setScrollTop(t),this._change())}},{key:"getPadding",value:function(e,t){var n=this.diagram;return n.options.padding||[n.height/2,n.width/2]}},{key:"moveTo",value:function(e,t){var n=this.zoom,r=this.invertViewport([0,0]);this.setScroll(this.scrollLeft+(e-r[0])*n,this.scrollTop+(t-r[1])*n)}},{key:"_restoreCanvasTlPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom;this.setViewport(t),this.moveTo.apply(this,T()(e))}},{key:"refresh",value:function(){var e=this.getViewportClientBox();this.setViewport(this.zoom,[e.x,e.y])}},{key:"_setScrollLeft",value:function(e){var t=this.diagram,n=this.canvasWidth,r=this.scrollBarSize,o=n-t.width+r;this.scrollLeft=Jt(e,0,o)}},{key:"_setScrollTop",value:function(e){var t=this.diagram,n=this.canvasHeight,r=this.scrollBarSize,o=n-t.height+r;this.scrollTop=Jt(e,0,o)}},{key:"setViewport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoom,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focusPoint;(e=Jt(e,this.minZoom,this.maxZoom))!==this.zoom&&(this.opRecord=void 0),this.zoom=e;var n,r,o=this.diagram,a=this.m,i=o.width,c=o.paper.getBBox(),l=this.getPadding(c,e),u=this.getViewportClientBox(),s=c.right-c.left,d=c.bottom-c.top,f=s*e+2*l[1],h=d*e+2*l[0],p=[c.left-l[1]/e,c.top-l[0]/e,f/e,h/e];if(a){var m=[t[0]-u.x,t[1]-u.y,1],y=k.mat3.invert([],a),v=k.vec3.transformMat3([],[m[0],m[1],1],y),g=[e,0,0,0,e,0,-e*p[0],-e*p[1],1],b=k.vec3.transformMat3([],v,g);n=b[0]-m[0],r=b[1]-m[1]}else n=(f-i)/2,r=l[0]-c.top;this.paperBox=c,this.canvasWidth=f,this.canvasHeight=h,this.zoom=e,this.viewBox=p,this.containerBox=u,this._setScrollLeft(n),this._setScrollTop(r),this._change()}},{key:"convertViewport",value:function(e){e=za(e);var t=this.m;return k.vec3.transformMat3([],[e.x,e.y,1],t)}},{key:"invertViewport",value:function(e){e=za(e),this.m;var t=k.mat3.invert([],this.m);return k.vec3.transformMat3([],[e.x,e.y,1],t)}},{key:"convertViewportAbs",value:function(e){return k.vec3.transformMat3([],[e[0],e[1],1],this.n)}},{key:"invertViewportAbs",value:function(e){var t=k.mat3.invert([],this.n);return k.vec3.transformMat3([],[e[0],e[1],1],t)}},{key:"convertClient",value:function(e){e=za(e);var t=this.getViewportClientBox(),n=k.vec3.transformMat3([],[e.x,e.y,1],this.m);return[n[0]+t.x,n[1]+t.y]}},{key:"invertClient",value:function(e){e=za(e);var t=this.getViewportClientBox(),n=[e.x-t.x,e.y-t.y,1],r=k.mat3.invert([],this.m),o=k.vec3.transformMat3([],[n[0],n[1],1],r);return[o[0],o[1]]}},{key:"getCenter",value:function(){var e=this.getViewportClientBox();return this.invertClient([e.x+e.width/2,e.y+e.height/2])}},{key:"getFocus",value:function(){var e=this.focusPoint;return this.invertClient(e)}},{key:"toObject",value:function(){var e=this.zoom,t=this.diagram;return{zoom:e,tlCanvasPoint:this.invertViewport([0,0]),width:t.width,height:t.height}}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tlCanvasPoint||e.originCanvasTlPoint;if(t){var n=e.zoom;this._restoreCanvasTlPoint(t,n)}else"number"==typeof e.scrollLeft&&"number"==typeof e.scrollTop&&(this.setViewport(e.zoom),this.setScroll(e.scrollLeft,e.scrollTop))}},{key:"setWYSIWYG",value:function(e){var t=this.diagram,n=this.scrollBarSize;if(t.width>e.width&&t.height>e.height)this.set({zoom:e.zoom,tlCanvasPoint:e.tlCanvasPoint});else{var r=Math.min((t.width-n)/(e.width-n),(t.height-n)/(e.height-n))*e.zoom;this.set({zoom:r,tlCanvasPoint:e.tlCanvasPoint})}}},{key:"_focus",value:function(e){var t=this.getViewportClientBox(),n=k.vec3.transformMat3([],[e[0],e[1],1],this.m),r=[t.width/2,t.height/2],o=r[0]-n[0],a=r[1]-n[1];this._setScrollLeft(this.scrollLeft-o),this._setScrollTop(this.scrollTop-a),this._setMatrix()}},{key:"focus",value:function(e){this._focus(e),this._change()}},{key:"autoFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.minZoom,n=e.maxZoom,r=e.zoom,o=this.getViewportClientBox(),a=this.diagram.rootGroup.getBBox();t=t||this.minZoom,n=n||1,null==r&&(o.width-=2*this.autoFitPadding,o.height-=2*this.autoFitPadding,r=Math.min(o.width/a.width,o.height/a.height)),r=Jt(r,t,n),this._focus([a.x+a.width/2,a.y+a.height/2]),this._resetFocusPoint(),this.setViewport(r),this.opRecord="autoFit"}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.destroyed=!0}}]),e}();c()(vu,"className","Viewport");var gu,bu,xu,wu=window.getSelection(),ku=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,c()(A()(r),"eventHelper",new fl),c()(A()(r),"destroyed",!1),c()(A()(r),"emitQueryChange",void 0),r.emitQueryChange=De()((function(){r.destroyed||r.emit("querychange",{query:r._getQuery()})}),32),r}return v()(n,[{key:"init",value:function(){var e=this,t=this.diagram,n=this.eventHelper,r=this.emitQueryChange;n.bind(t.contentEditor,"selectionchange",(function(){e._updateEditRange(),r()})),n.bind(t,"afterselect",(function(){e._updateEditRange(),r()}))}},{key:"_updateEditRange",value:function(){var e=this.diagram;try{var t=null==wu?void 0:wu.getRangeAt(0);if(!t)return;e.canvasContainer.contains(t.commonAncestorContainer)&&!xu&&(gu=t.cloneRange()),bu=t.cloneRange()}catch(e){return}}},{key:"_setRange",value:function(e){e&&(null==wu||wu.removeAllRanges(),null==wu||wu.addRange(e))}},{key:"_getSelections",value:function(){return this.diagram.selector.selections.filter((function(e){var t;return null===(t=e.canUpdateText)||void 0===t?void 0:t.call(e)}))}},{key:"_getQuery",value:function(){var e,t=this.diagram,n=this._getSelections();if(n.length>1){var r=n.filter((function(e){return e.textareaElement}));r.sort((function(e,t){return e.x-t.x}));var o=r.map((function(e){return e.textareaElement.htmlContainer}));e=t.contentEditor.query(o[0],null)}else{var a;e=dr(n[0])?t.contentEditor.query(null===(a=n[0].children[0])||void 0===a?void 0:a.textareaElement.htmlContainer,null):fr(n[0])?t.contentEditor.query(n[0].textareaElement.htmlContainer,null):t.contentEditor.query()}return e}},{key:"execCommand",value:function(e,t){var n=this.diagram,r=this.emitQueryChange;n.contentEditor.isBegin?(gu.commonAncestorContainer!==bu.commonAncestorContainer&&(xu=!0),xu&&this._setRange(gu),n.contentEditor.execCommand(e,t),gu=null==wu?void 0:wu.getRangeAt(0).cloneRange(),xu=!1):n.command.execute("ContentCommand",{name:e,value:t}),r()}},{key:"destroy",value:function(){this.eventHelper&&this.eventHelper.destroy(),this.destroyed=!0}}]),n}();c()(ku,"className","ContentEditorPlus");var Eu=Object.freeze({__proto__:null,CommandManager:Jc,ContentEditor:Cl,Delegator:Pl,Exporter:Wl,Highlight:Xl,Importer:Kl,Interaction:fu,Paper:hu,Register:pu,Selector:mu,SyncHook:yu,Viewport:vu,ContentEditorPlus:ku}),Ou=function(){function e(t){if(m()(this,e),c()(this,"default",void 0),c()(this,"anchors",void 0),c()(this,"stem",void 0),c()(this,"root",void 0),c()(this,"type",void 0),c()(this,"model",void 0),c()(this,"zIndex",void 0),c()(this,"matrix",void 0),c()(this,"graphicGroup",void 0),c()(this,"state",void 0),c()(this,"diagram",void 0),c()(this,"eventHelper",void 0),c()(this,"destroyed",void 0),c()(this,"cellMap",void 0),c()(this,"parent",void 0),c()(this,"depth",void 0),c()(this,"isStem",void 0),c()(this,"isRoot",void 0),c()(this,"isCell",void 0),c()(this,"cache",void 0),c()(this,"penetratedKeys",void 0),c()(this,"width",void 0),c()(this,"height",void 0),!t.diagram)throw new Error("cell requires diagram!");if(!t.cellMap)throw new Error("cell requires cellMap")}return v()(e,[{key:"init",value:function(e){Object.assign(this,e),this.stem=this.stem||this,this.root=this.root||this,this.type=this.stem.model.type,this.zIndex=this.model.zIndex||0}},{key:"setDefault",value:function(){}},{key:"get",value:function(e){return u()(this[e])}},{key:"draw",value:function(){}},{key:"percentage2Relative",value:function(e){return[(e=za(e)).x*this.width,e.y*this.height]}},{key:"relative2Percentage",value:function(e){return[(e=za(e)).x/this.width,e.y/this.height]}},{key:"canvas2percentage",value:function(e){return e=za(e),this.relative2Percentage(this.canvas2Relative(e))}},{key:"percentage2Canvas",value:function(e){return this.relative2Canvas(this.percentage2Relative(e))}},{key:"relative2Canvas",value:function(e){e=za(e);var t=k.vec3.transformMat3([],[e.x,e.y,1],this.matrix),n=b()(t,2);return{x:n[0],y:n[1]}}},{key:"canvas2Relative",value:function(e){e=za(e);var t=k.vec3.transformMat3([],[e.x,e.y,1],k.mat3.invert([],this.matrix)),n=b()(t,2);return{x:n[0],y:n[1]}}},{key:"capture",value:function(e){var t=this.graphicGroup,n=this.state;!0===e?t.css({"pointer-events":"auto"}):!1===e&&t.css({"pointer-events":"none"}),n.capture=e}},{key:"rotateTo",value:function(e){var t=[1,0,0,0,1,0,0,0,1];k.mat3.fromRotation(t,e),this.matrix[0]=t[0],this.matrix[1]=t[1],this.matrix[3]=t[3],this.matrix[4]=t[4],this.graphicGroup.update({matrix:this.matrix})}},{key:"getBBox",value:function(){var e=this.percentage2Canvas([0,0]),t=this.percentage2Canvas([1,0]),n=this.percentage2Canvas([0,1]),r=this.percentage2Canvas([1,1]),o=Math.min(e.x,t.x,n.x,r.x),a=Math.min(e.y,t.y,n.y,r.y),i=Math.max(e.x,t.x,n.x,r.x),c=Math.max(e.y,t.y,n.y,r.y);return{minX:o,minY:a,maxX:i,maxY:c,x:o,y:a,width:i-o,height:c-a}}},{key:"eventDelegation",value:function(){}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"getChildren",value:function(){var e=this.cellMap;return(this.model.children||[]).map((function(t){return e[t.id]}))}},{key:"getAllChildren",value:function(){var e=[];return this.deepEachWithoutSelf((function(t){return e.push(t),!0})),e}},{key:"getAllCellsByZIndex",value:function(){var e=this.getAllCells();return e.sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e}},{key:"getAllCells",value:function(){var e=this.cellMap,t=[];return Wt(this.model,(function(n){return t.push(e[n.id]),!0})),t}},{key:"getSiblings",value:function(){var e=this,t=this.cellMap;return this.parent?this.parent.model.children.filter((function(t){return t.id!==e.model.id})).map((function(e){return t[e.id]})):[]}},{key:"delegateEvent",value:function(e,t,n){var r=this,o=this.eventHelper,a=this.diagram;o.bind(e,t,(function(e){a.emit(n,r.getEventObject(e))}))}},{key:"hide",value:function(){this.graphicGroup.css({display:"none"}),this.state.visible=!1}},{key:"show",value:function(){this.graphicGroup.css({display:""}),this.state.visible=!0}},{key:"updateState",value:function(){}},{key:"select",value:function(){this.state.selected=!0,this.state.highlight=!1,this.updateState()}},{key:"unSelect",value:function(){this.state.selected=!1,this.updateState()}},{key:"highlight",value:function(){this.state.highlight=!0,this.updateState()}},{key:"unHighlight",value:function(){this.state.highlight=!1,this.updateState()}},{key:"toBack",value:function(){this.graphicGroup.toBack()}},{key:"toFront",value:function(){this.graphicGroup.toFront()}},{key:"forward",value:function(){this.graphicGroup.forward()}},{key:"backward",value:function(){this.graphicGroup.backward()}},{key:"getZIndex",value:function(){var e=this.graphicGroup.getZIndex();return ze()(e)?e:-1}},{key:"getNth",value:function(){return this.parent?this.parent.model.children.indexOf(this.model):0}},{key:"forEach",value:function(e){var t=this.cellMap;this.model.children.forEach((function(n,r){e(t[n.id],r)}))}},{key:"deepEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e.children},n=this.cellMap;Wt(this.model,(function(t){return e(n[t.id])}),t)}},{key:"deepEachWithoutSelf",value:function(e){var t=this.cellMap;Xt(this.model,(function(n){return e(t[n.id])}))}},{key:"render",value:function(){}},{key:"update",value:function(e){this.updateModel(e),this.draw()}},{key:"updateModel",value:function(e){e&&(h()(this.model,e,(function(e,t){if(Array.isArray(e))return t})),this._normalize(),this._merge())}},{key:"_normalize",value:function(){var e=this;Object.keys(this.model).forEach((function(t){var n=e.model[t];null==n?e.model[t]=void 0:d()(n)&&(Object.values(n).every((function(e){return null==e}))?e.model[t]=void 0:Object.keys(n).forEach((function(r){null==n[r]&&(e.model[t][r]=void 0)})))}))}},{key:"_merge",value:function(){var e=this,t=this.model,n=this.penetratedKeys;Object.keys(t).filter((function(e){return n.includes(e)})).forEach((function(n){var r=t[n],o=e.default&&u()(e.default[n]);d()(r)&&o?Object.keys(r).forEach((function(t){var a=r[t];e[n][t]=null==a?o[t]:a})):e[n]=null==r?o:r}))}},{key:"isCacheStale",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.some((function(t){return!Fe()(e.cache[t],e[t])}))}},{key:"drawPosition",value:function(){}},{key:"drawCollapse",value:function(){}},{key:"drawInherit",value:function(){}},{key:"destroy",value:function(){var e;null===(e=this.diagram)||void 0===e||e.cleanDomCellMap(this.graphicGroup.rendererElement),this.eventHelper.destroy(),this.graphicGroup.destroy(),this.destroyed=!0}}],[{key:"getDefaultProps",value:function(){return{model:{},parent:null,computedProps:{},penetratedKeys:[],anchors:[],state:{visible:!0,capture:!0,selected:!1,beginEdit:!1},cache:{},matrix:[1,0,0,0,1,0,0,0,1],isCell:!0,graphicGroup:new no,eventHelper:new fl}}}]),e}();function Cu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Ou,"className","Cell"),c()(Ou,"mergeKeys",["penetratedKeys","Subcells"]),c()(Ou,"Line",void 0);var Au={plugins:[]};function Pu(e){if(e&&e.body){var t=[];e.body.forEach((function(e){Wt(e,(function(e,n){e.isPlaceholder?t.push({model:e,parent:n}):(function(e){if(e&&e.layout){var t=e.layout.type,n=e.layout,r=n.quadrants,o=n.direction;"standrad"===t?(1===(r=Array.isArray(r)?r.length:Number(r))&&(cn(o,[-1,0])||cn(o,[0,-1])?e.layout.quadrantConstraint=[2]:e.layout.quadrantConstraint=[1]),cn(o,[-1,0])?e.layout.direction=[1,0]:cn(o,[0,-1])&&(e.layout.direction=[0,1])):"indent"===t&&(cn(o,[1,0])?e.layout.quadrantConstraint=[1]:cn(o,[-1,0])&&(e.layout.quadrantConstraint=[2]),e.layout.direction=[1,1])}}(e),function(e){if("line"===e.type&&e.children&&delete e.children,e.image&&e.image.src){var t=ml(e.image.src);e.image.src=yl.process(t)}}(e))}))})),t.forEach((function(t){var n=t.model,r=t.parent,o=r?r.children:e.body,a=o.indexOf(n);a>-1&&o.splice(a,1)}))}}function Su(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}var ju=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","hover","drop","dragover","contextmenu"],Ru=["pointerdown","pointermove","pointerup"],_u=["touchstart","touchmove","touchend"],Mu=["keydown","keyup","keypress"],Lu=["compositionstart","compositionend"],Tu=["copy","paste","cut"],Du=["wheel","scroll"],Nu=pe.HotKeyUtils.isHotkey,Bu=function(e){S()(n,I.a);var t=Su(n);function n(e){var r;m()(this,n),r=t.call(this),c()(A()(r),"options",void 0),c()(A()(r),"nativeEvents",void 0),c()(A()(r),"dataProcessors",void 0),c()(A()(r),"Cells",void 0),c()(A()(r),"head",void 0),c()(A()(r),"cellMap",void 0),c()(A()(r),"elementMap",void 0),c()(A()(r),"domCellMap",void 0),c()(A()(r),"signal",void 0),c()(A()(r),"settings",void 0),c()(A()(r),"container",void 0),c()(A()(r),"viewportContainer",void 0),c()(A()(r),"canvasContainer",void 0),c()(A()(r),"input",void 0),c()(A()(r),"calculatedContainer",void 0),c()(A()(r),"theme",void 0),c()(A()(r),"rough",void 0),c()(A()(r),"width",void 0),c()(A()(r),"height",void 0),c()(A()(r),"extend",void 0),c()(A()(r),"canvas",void 0),c()(A()(r),"rootGroup",void 0),c()(A()(r),"frontRootGroup",void 0),c()(A()(r),"backRootGroup",void 0),c()(A()(r),"defs",void 0),c()(A()(r),"destroyed",void 0),c()(A()(r),"command",void 0),c()(A()(r),"delegator",void 0),c()(A()(r),"contentEditor",void 0),c()(A()(r),"contentEditorPlus",void 0),c()(A()(r),"exporter",void 0),c()(A()(r),"importer",void 0),c()(A()(r),"interaction",void 0),c()(A()(r),"paper",void 0),c()(A()(r),"highlight",void 0),c()(A()(r),"register",void 0),c()(A()(r),"selector",void 0),c()(A()(r),"viewport",void 0),c()(A()(r),"vertexRotateResize",void 0),c()(A()(r),"groupRotateResize",void 0),c()(A()(r),"abstractView",void 0),c()(A()(r),"groupManager",void 0),c()(A()(r),"lineAlign",void 0),c()(A()(r),"connect",void 0),c()(A()(r),"lineCellAlign",void 0),c()(A()(r),"lineResizer",void 0),c()(A()(r),"font",void 0),c()(A()(r),"mouseDragCanvas",void 0),c()(A()(r),"modelManager",void 0),c()(A()(r),"align",void 0),c()(A()(r),"swimlane",void 0),c()(A()(r),"swimlaneResize",void 0),c()(A()(r),"drawBaseResizer",void 0),c()(A()(r),"penDrawInteract",void 0),c()(A()(r),"hooks",{forceDecorateImportModels:new yu(["models"]),decorateImportModels:new yu(["models"]),decorateAddVertexModel:new yu(["model"]),decorateAddStackModel:new yu(["model"]),decorateAddMindmapAbstract:new yu(["model"]),decorateAddMindmapStemModel:new yu(["model"]),decorateAddMindmapCellModel:new yu(["model"]),decorateAddLineModel:new yu(["model"]),decorateAddSwimlaneModel:new yu(["model"]),decorateAddSwimlaneChildModel:new yu(["model"]),decorateAddPenModel:new yu(["model"]),decorateAddDslModel:new yu(["model"]),decorateAddDslChildModel:new yu(["model"]),decorateNonMindmapCellModels:new yu(["models","sourceTheme"])}),c()(A()(r),"spm",void 0);var o=h()({locale:{},width:500,height:500,plugins:[],paper:null,padding:null,mode:"edit",head:{}},e);r.options=o,r.nativeEvents=[].concat(ju,Ru,_u,Mu,Lu,Tu,Du),r.dataProcessors=[Pu],r.Cells={Cell:Ou,Line:Ou.Line},r.head={version:"2.0.0"},r.cellMap={},r.elementMap={},r.signal={keydown:{}},r.settings={};var a=o.container,i=r._createViewportContainer(),l=r._createCanvasContainer(),u=r._createInputElement();return r.container=a,r.viewportContainer=i,r.canvasContainer=l,r.input=u,a.appendChild(i),i.appendChild(l),i.appendChild(u),r.width=o.width,r.height=o.height,r.calculatedContainer=r._appendCalculatedContainer(),r.domCellMap=new WeakMap,r._initCanvas(),r._initExtend(),r._initEvent(),r}return v()(n,[{key:"_initEvent",value:function(){var e,t=this,n=this.viewportContainer,r=this.nativeEvents,o=!1,a=!1,i=0,c=function(e,n){var r=e,o=r.target,a={target:o,clientX:r.clientX,clientY:r.clientY,button:r.button,preventDefault:function(){e.preventDefault()},stopPropagation:function(){e.stopPropagation()}},i=t.getCell(o);i&&(a.cell=i,t.emit("".concat(i.type,":").concat(n),a)),t.emit(n,a)};r.forEach((function(r){"mousedown"===r?n.addEventListener(r,(function(t){o=!0,c(t,r),i=t.button,e=[t.clientX,t.clientY]})):"mousemove"===r?n.addEventListener(r,(function(n){a&&t.emit("drag",{evt:n,button:i}),o&&!a&&ui(n.clientX,n.clientY,e[0],e[1])>8&&(a=!0,t.emit("dragstart",{evt:n,button:i})),t.emit(r,n)})):"mouseup"===r?n.addEventListener(r,(function(e){c(e,r),a?(t.emit("dragend",{evt:e}),a=!1):2===e.button&&t.emit("contextmenu",e),o=!1})):"contextmenu"===r?n.addEventListener(r,(function(e){e.preventDefault()})):"pointerdown"===r||"pointerup"===r?n.addEventListener(r,(function(e){c(e,r)})):n.addEventListener(r,(function(e){"touchmove"!==r||"free-hand"!==t.interaction.currentMode&&"eraser"!==t.interaction.currentMode?t.emit(r,e):e.preventDefault()}))})),Iu._boundGlobalEvent||(window.addEventListener("mousedown",(function(e){!e.target.closest("[data-lake_prevent_click_unselect]")||e.target.matches("input")||e.target.matches("textarea")||e.preventDefault()})),Iu._boundGlobalEvent=!0)}},{key:"_createViewportContainer",value:function(){var e=document.createElement("div");return e.classList.add("lake-diagram-viewport-container"),e.setAttribute("style","position: relative; outline: none; user-select: text"),e.setAttribute("tabindex","0"),e.setAttribute("focusable","true"),e.setAttribute("dragable","false"),e.addEventListener("dragstart",(function(e){return e.preventDefault()})),e}},{key:"_createCanvasContainer",value:function(){return document.createElement("div")}},{key:"_createInputElement",value:function(){var e=this,t=document.createElement("div");return t.setAttribute("contenteditable","true"),t.style.position="fixed",t.style.top="-300px",t.style.left="-300px",t.style.right="0",t.style.bottom="0",t.style.width="100px",t.style.height="40px",t.margin="auto",t.style["z-index"]=2,t.style.outline="none",t.style.opacity=0,t.style["pointer-events"]="none",t.addEventListener("keydown",(function(t){Nu("mod+c",t)&&0===e.selector.selections.length&&t.preventDefault()})),t.addEventListener("keydown",(function(t){Nu("mod+v",t)||e.selector.selections.length>0&&(Nu("mod+c",t)||Nu("mod+x",t))})),t.addEventListener("beforeinput",(function(e){e.preventDefault()})),pe.ua.mobile&&t.addEventListener("focus",(function(){t.blur()})),t}},{key:"_appendCalculatedContainer",value:function(){var e=this.options.container,t=document.createElement("div"),n=document.createElement("div");return t.appendChild(n),e.appendChild(t),t.setAttribute("style","opacity: 0; height: 0;width: 0"),t.style.overflow="hidden",n.style.width="10000px",n}},{key:"_initExtend",value:function(){var e,t=this.options;this.extend={},this.addExtend(Object.keys(Eu).map((function(e){return Eu[e]}))),this.register.init(Au.plugins.concat(t.plugins)),this.paper.init(t.paper||{size:[828,1170]}),this.viewport.init(),this.interaction.init(t.mode),null===(e=this.mouseDragCanvas)||void 0===e||e.init(),this.contentEditorPlus.init()}},{key:"_initCanvas",value:function(){var e=this.canvasContainer,t=this.calculatedContainer;this.canvas=new oo({container:e,calculatedContainer:t}),this.rootGroup=new no,this.frontRootGroup=new no,this.backRootGroup=new no,this.rootGroup.dataset({element:"root_group"}),this.frontRootGroup.dataset({element:"front_group"}),this.backRootGroup.dataset({element:"back_group"}),this.defs=new No,this.canvas.add(this.defs),this.canvas.add(this.backRootGroup),this.canvas.add(this.rootGroup),this.canvas.add(this.frontRootGroup)}},{key:"insertBefore",value:function(e,t){if(e.isStem&&t.isStem)for(var n=this.rootGroup,r=e.getAllCellsByZIndex(),o=t.getAllCellsByZIndex(),a=0;a<r.length;a++)n.insertBefore(r[a].graphicGroup,o[0].graphicGroup)}},{key:"cleanDomCellMap",value:function(e){var t=this.domCellMap;Wt(e,(function(e){t.delete(e)}),(function(e){return e.childNodes}))}},{key:"addExtend",value:function(e){var t=this;e.forEach((function(e){var n=e.className,r=n.charAt(0).toLowerCase()+n.substring(1),o=new e(t);t.extend[r]=o,t[r]=o}))}},{key:"addDataProcessor",value:function(e){this.dataProcessors.push(e)}},{key:"inherit",value:function(e,t){var n=this.cellMap;t||(t=this.getCells().filter((function(e){return e.isStem}))),t.forEach((function(t){Wt(t.model,(function(t,r){t=n[t.id],r=r&&n[r.id]||t.parent,t.computedProps=r?xe()({},r.computedProps,yn(t,e)):yn(t,e)}))}))}},{key:"deepEach",value:function(e){var t=this.cellMap;Object.keys(t).forEach((function(n){e(t[n])}))}},{key:"focus",value:function(){var e=this.input,t=window.getSelection(),n=document.createRange();e.innerHTML="ddd",n.setStart(e.childNodes[0],1),n.setEnd(e.childNodes[0],2),null==t||t.removeAllRanges(),null==t||t.addRange(n)}},{key:"tryFocus",value:function(){this.viewportContainer.contains(document.activeElement)||this.focus()}},{key:"clear",value:function(){this.rootGroup.clear(),this.cellMap={}}},{key:"destroy",value:function(){var e;if(!this.destroyed){var t=this.canvas,n=this.viewportContainer,r=this.extend,o=this.calculatedContainer;this.deepEach((function(e){e.destroy()})),Object.keys(r).forEach((function(e){r[e].destroy()})),null===(e=n.parentNode)||void 0===e||e.removeChild(n),o.remove(),t.destroy(),this.destroyed=!0}}},{key:"export",value:function(){this.emit("beforeexporter");var e=this.exporter.json();return this.emit("afterexporter"),e}},{key:"import",value:function(e){var t=this.dataProcessors,n=this.head;e.head&&Object.assign(n,e.head),this.emit("beforeimport"),t.forEach((function(t){t(e)}));var r=this.importer.json(e);return this.emit("afterimport"),this.viewport.refresh(),r}},{key:"setCursor",value:function(e){this.canvas.css({cursor:e})}},{key:"resetCursor",value:function(){this.setCursor(this.interaction.getModeCursor())}},{key:"isSelected",get:function(){return this.selector.selections.length>0}}]),n}();c()(Bu,"_boundGlobalEvent",void 0);var Iu=function(e){S()(n,e);var t=Su(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}(function(e){return function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"changePaper",value:function(e){Object.assign(this.paper,e),this.viewport.refresh()}},{key:"changeSize",value:function(e,t){this.width=e,this.height=t,this.viewport.refresh()}}]),n}(e)}(function(e){return function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"deduplicate",value:function(e){var t=this;if(!e||0===e.length)return e;if((e=e.concat([])).every((function(t){return t.depth===e[0].depth})))return e;Ye()(e,["depth"]);for(var n=0;n<e.length;n++){var r=e[n];r&&Xt(r.model,(function(n){n=t.find(n.id);var r=e.indexOf(n);-1!==r&&(e[r]=null)}))}return e.filter((function(e){return e}))}},{key:"snapshot",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[t.map((function(e){return u()(e.model)})),t.map((function(t){return e.getCellOptions(t)}))]}},{key:"getCell",value:function(e){var t,n=this.canvas,r=this.cellMap,o=this.domCellMap,a=this.rootGroup,i=this.find(null==e||null===(t=e.dataset)||void 0===t?void 0:t.cellid);if(i)return i;if(!e||!a.rendererElement.contains(e)||n.rendererElement===e)return null;var c=o.get(e);if(c)return c;for(var l=Object.keys(r),u=0;u<l.length;u++){var s=r[l[u]];if(s.graphicGroup.rendererElement.contains(e))return o.set(e,s),s}return null}},{key:"getCellOptions",value:function(e){var t=this,n=this.cellMap,r=[];return Wt(e.model,(function(e){var o=n[e.id],a=t.getSibling(o);a&&(a.unshift(o.model.id),a.push(o.getZIndex()),r.push(a))})),{parent:e.parent&&e.parent.model.id,nth:e.getNth(),siblingSheets:r}}},{key:"getSibling",value:function(e){var t=e.graphicGroup.getSiblingRendererElement();if(t){var n=this.getCell(t[1]);return n?(t[1]=n.model.id,t):null}return null}},{key:"getCells",value:function(){var e=[];return this.deepEach((function(t){e.push(t)})),e}},{key:"getCellsByZIndex",value:function(){var e=[];return this.deepEach((function(t){e.push([t,t.getZIndex()])})),e.sort((function(e,t){var n=b()(e,2)[1],r=b()(t,2)[1];return n>r?1:n<r?-1:0})),e.map((function(e){return e[0]}))}},{key:"getFreehands",value:function(){return this.getCells().filter((function(e){return wr(e)}))}}]),n}(e)}(function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"find",value:function(e){if(null!=e){var t=this.cellMap;return e instanceof Ou?e:t[e]}}},{key:"layout",value:function(e){var t=this.find(e);if(t&&!t.destroyed){if(!t.isStem)throw new Error("Only stem type cell can be layouted!");if(t.executeLayout){var n=this.cellMap;t.executeLayout(),this.emit("afterstemcelllayout",{stem:this}),Wt(t.model,(function(e){var r=n[e.id];return r!==t&&r.drawPosition(),!0}))}}}},{key:"findByContent",value:function(e){return this.getCells().find((function(t){return t.html.includes(e)}))}},{key:"_draw",value:function(e){var t=this;this.emit("beforedraw",e);var n=e.cells,r=void 0===n?[]:n,o=e.stems,a=void 0===o?[]:o,i=e.relatedLines,c=void 0===i?[]:i;a.forEach((function(e){!e.destroyed&&t.layout(e)})),r.forEach((function(e){!e.destroyed&&e.draw()})),c.forEach((function(e){!e.destroyed&&e.draw()})),this.emit("afterdraw",e)}},{key:"_getStems",value:function(e){return an(e.map((function(e){return e.stem})))}},{key:"_getRoots",value:function(e){return an(e.map((function(e){return e.root})))}},{key:"_processSiblingSheets",value:function(e){var t=this.cellMap;e.sort((function(e,t){return t[3]-e[3]}));for(var n=0;n<e.length;n++){var r=e[n],o=t[r[0]],a=t[r[2]];if(o&&a){var i=r[1];"before"!==i&&"after"!==i||a.graphicGroup[i](o.graphicGroup)}}}},{key:"getRelatedLines",value:function(e){var t=this.cellMap,n=e.reduce((function(e,t){return e[t.stem.model.id]=!0,e}),{}),r=this.getCells().filter((function(e){return e.isLine})),o=[];return r.forEach((function(e){["source","target"].some((function(r){var o=e[r].id,a=t[o];return o&&!a||a&&n[a.stem.model.id]}))&&o.push(e)})),o}},{key:"_getCellConstructors",value:function(e){var t=this.Cells;if(!e)return[t.Cell];var n=e.charAt(0).toUpperCase()+e.substring(1),r=t[n+"Stem"],o=t[n+"Cell"];return r&&o?[r,o]:o||(o=t[n])?[o]:void 0}},{key:"_getId",value:function(e){var t=this.cellMap;return null==e||t[e]?Object(F.a)():e}},{key:"_add",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={action:"add"};this.emit("beforechange",n);var r=this.cellMap,o=this.rootGroup,a=[],i=[];t.forEach((function(t){var n,o,c,l,u,s=t.model,d=t.options,f=[];if(d.parent){if((l=r[d.parent])&&(o=l.stem.model,c=l.root.model,n=e._getCellConstructors(o.type),u=l,fn(l.model,s),"number"==typeof d.nth&&d.nth>=0)){var h=l.model.children;ln(h,h.indexOf(s),d.nth),l.model.children=l.model.children.filter((function(e){return e}))}}else c=s;if(Wt(s,(function(t,a){a&&a.id&&(l=r[a.id]);var i=l?l.depth+1:0,u=0===i,s=!!t.type||u;s&&(o=t,n=e._getCellConstructors(t.type)),void 0!==t.html&&(t.html=xl(t.html)),t.id=e._getId(t.id);var d=t.id,h=s?n[0]:n[n.length-1],p={model:t,cellMap:r,parent:l,depth:i,isStem:s,isRoot:u,stem:r[o.id],root:r[c.id],diagram:e},m=new h(p),y=h.getDefaultProps();return m.default=Ka(y),Object.assign(m,y),m.init(p),r[d]=m,f.push(m),!0})),u){var p=e.find(s.id);a.push({cell:p,insertBeforeCell:u})}i=i.concat(f)})),i.sort((function(e,t){return e.zIndex-t.zIndex})),i.forEach((function(e){o.add(e.graphicGroup)})),a.forEach((function(e){var t=e.cell,n=e.insertBeforeCell;o.insertBefore(t.graphicGroup,n.graphicGroup)}));var c=[];t.forEach((function(e){var t=e.options;t.siblingSheets&&(c=c.concat(t.siblingSheets))})),this._processSiblingSheets(c);var l=t.map((function(e){return e.model})),u=this._getStems(i),s=this._getRoots(u),d=this.getRelatedLines(u);return n.models=l,n.stems=u,n.cells=i,n.roots=s,n.relatedLines=d,this._draw(n),this.emit("afterchange",n),l.map((function(e){return r[e.id]}))}},{key:"add",value:function(e,t){var n,r={};if(Array.isArray(e))n=e.map((function(e){return{model:e}}));else{if(!d()(e))throw new Error("Params is illegal");n=[{model:e,options:t}]}return Array.isArray(t)?n.forEach((function(e,n){e.options=t[n]})):d()(t)&&n.forEach((function(e){e.options=t})),n.forEach((function(e){e.options||(e.options=r)})),this._add(u()(n))}},{key:"_update",value:function(e){var t=this,n=this.cellMap,r=[],o={action:"update",models:[]},a=[];e=e.map((function(e){var n=t.find(e.id);return n?(e.cell=n,o.models.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:n.model.id},e.model)),e):null})).filter((function(e){return e})),o.arr=e,this.emit("beforechange",o),e.forEach((function(e){var t=e.model,o=e.options,i=e.cell,c=n[o.parent];if(c){var l=i.parent!==c,u=c.stem.type===i.stem.type,s=c.isStem&&i.isStem;if(l&&(u||s)){if(i.parent){var d=i.parent.model.children;d.splice(d.indexOf(i.model),1)}fn(c.model,i.model),i.parent=c,i.isRoot=!1,i.stem!==i&&i.deepEach((function(e){e.stem=c.stem})),i.deepEach((function(e){e.root=c.root,e.depth=e.parent.depth+1}))}}else if(null===o.parent&&i.isStem&&i.parent){var f=i.parent.model.children;f.splice(f.indexOf(i.model),1),i.parent=null,i.isRoot=!0,i.depth=0,i.deepEachWithoutSelf((function(e){e.root=i,e.depth=e.parent.depth+1}))}var h=o.nth;if(void 0!==h&&i.parent){var p=i.parent.model.children;ln(p,p.indexOf(i.model),h)}o.siblingSheets&&(a=a.concat(o.siblingSheets)),i.updateModel(t),r.push(i),void 0!==t.collapsed&&Wt(i.model,(function(e){var t=n[e.id];return t!==i&&t.drawCollapse(),!0}))})),this._processSiblingSheets(a);var i=this._getStems(r),l=this._getRoots(i),u=this.getRelatedLines(i);o.cells=r,o.stems=i,o.roots=l,o.relatedLines=u,this._draw(o),this.emit("afterchange",o)}},{key:"update",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(("string"==typeof e||"object"===a()(e)&&e.isCell)&&d()(n))t=[{id:e}];else{if(!Array.isArray(e))throw new Error("Please set id !");t=e.map((function(e){return{id:e}}))}d()(n)?t.forEach((function(e){e.model=n})):Array.isArray(n)&&t.forEach((function(e,t){e.model=n[t]})),d()(r)?t.forEach((function(e){e.options=r})):Array.isArray(r)?t.forEach((function(e,t){e.options=r[t]})):t.forEach((function(e){e.options={}})),t.forEach((function(e){e.model=e.model||{},e.model=Be()(e.model),e.options=e.options||{},e.options=Be()(e.options)})),this._update(t)}},{key:"_remove",value:function(e){var t=this,n=e.map((function(e){return t.find(e)})).filter((function(e){return e}));if(0!==n.length){n=this.deduplicate(n);var r=this.cellMap,o=n.map((function(e){return e.getAllCells()})).reduce((function(e,t){return e.concat(t)})),a=an(n.map((function(e){return e.stem}))),i=this.getRelatedLines(a),c=[],l={},u={action:"remove",stems:a,models:c,relatedLines:i};return n.forEach((function(e,t){if(c.push(e.model),e.parent){var n={nth:e.parent.model.children.indexOf(e.model),model:c[t]};l[e.parent.model.id]=l[e.parent.model.id]?l[e.parent.model.id].concat(n):[n]}else{var r={nth:-1,model:c[t]};l.root=l.root?l.root.concat(r):[r]}})),this.emit("beforechange",u),n.forEach((function(e){if(e.parent){var t=e.parent.model.children;t.splice(t.indexOf(e.model),1)}})),o.forEach((function(e){e.destroy();var n=t.selector.selections.indexOf(e);-1!==n&&t.selector.selections.splice(n,1),delete r[e.model.id]})),this._draw(u),this.emit("afterchange",u),{eventObj:u,deletedModelsInfo:l}}}},{key:"remove",value:function(e){return Array.isArray(e)||(e=[e]),this._remove(e)}}]),n}(Bu)))),Fu=function(){function e(t){m()(this,e),c()(this,"cell",void 0),c()(this,"destroyed",!1),c()(this,"shapeElement",void 0),this.cell=t}return v()(e,[{key:"render",value:function(){}},{key:"update",value:function(){}},{key:"draw",value:function(){}},{key:"drawInherit",value:function(){}},{key:"drawPosition",value:function(){}},{key:"setDefault",value:function(){}},{key:"updateState",value:function(){}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();function qu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}window.____lake_diagram_version="2.0.0";var Gu=function(e){S()(n,Ou);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"Subcells",void 0),c()(A()(e),"subcells",void 0),c()(A()(e),"textareaContentStyleSheets",void 0),c()(A()(e),"x",void 0),c()(A()(e),"y",void 0),c()(A()(e),"opacity",void 0),c()(A()(e),"roughFillStyle",void 0),c()(A()(e),"stroke",void 0),c()(A()(e),"isGroup",void 0),c()(A()(e),"isGeometry",void 0),c()(A()(e),"isLine",void 0),c()(A()(e),"isImage",void 0),c()(A()(e),"isText",void 0),c()(A()(e),"isVertex",void 0),c()(A()(e),"isBoardCell",void 0),c()(A()(e),"stem",void 0),e}return v()(n,[{key:"getRoughGraphicOptions",value:function(){var e=this.roughFillStyle;if(e)return{roughFillStyle:e}}},{key:"getOuterWidth",value:function(){return this.model.width}},{key:"shouldRefreshEndEditContent",value:function(){return!1}},{key:"beginEditContent",value:function(){}},{key:"endEditContent",value:function(){}},{key:"isContentEmpty",value:function(){var e=this.html,t=document.createElement("div");return t.innerHTML=e,!t.textContent||"%E2%80%8B"===encodeURI(t.textContent)}},{key:"canRough",value:function(){return!1}},{key:"canTextVerticalAlign",value:function(){return!0}},{key:"canDragCanvas",value:function(){return!0}},{key:"canDelete",value:function(){return!0}},{key:"canFill",value:function(){return!0}},{key:"canStroke",value:function(){return!0}},{key:"canStrokeWidth",value:function(){return!0}},{key:"canStrokeStyle",value:function(){return!0}},{key:"canConnect",value:function(){return!0}},{key:"canRotate",value:function(){return!0}},{key:"canCollapse",value:function(){var e=this.model;return e.children&&e.children.length>0&&!0!==this.collapsed}},{key:"canExpand",value:function(){var e=this.model;return e.children&&e.children.length>0&&!0===this.collapsed}},{key:"canUseAddLineButton",value:function(){return!1}},{key:"canArrange",value:function(){return!!this.isStem}},{key:"canText",value:function(){return!0}},{key:"canUpdateText",value:function(){return this.textareaElement}},{key:"canRound",value:function(){return!1}},{key:"getCanTextCell",value:function(){return this}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"center",get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.getPadding(),n=e.find((function(e){return"self"===e.query}));if("self"===n.query){var r=this.getOuterWidth();n.css.width=r?r-t[1]-t[3]+"px":""}}},{key:"getTextareaPosition",value:function(e){return{x:0,y:0}}},{key:"snapAnchor",value:function(e){var t=this,n=this.percentage2Canvas({x:.5,y:.5}),r=[e.x-n.x,e.y-n.y];return this.anchors.map((function(e){var o=t.percentage2Canvas(e);return zu(zu({},o),{},{rad:k.vec2.angle(r,[o.x-n.x,o.y-n.y])})})).sort((function(e,t){return e.rad-t.rad}))}},{key:"getPoint",value:function(e){var t=this.anchors;if("string"==typeof e){var n=t.find((function(t){return t.name===e}));if(n)return this.percentage2Canvas(n)}if("number"==typeof e)if(e>=1&&e<t.length){var r=t[e-1];if(r)return this.percentage2Canvas(r)}else if(e>=0)return this.getPointAtPercent(e);if(Array.isArray(e)){var o=b()(e,2),a=o[0],i=o[1];return e.every((function(e){return e>=0&&e<=1}))?this.percentage2Canvas({x:a,y:i}):{x:a,y:i}}throw new Error("unknown connection point ".concat(e))}},{key:"getKeyShape",value:function(){var e;return Xt(this.graphicGroup,(function(t){if(t.isPath)return e=t,!1})),e}},{key:"isPointInShape",value:function(e){var t=Ya(this.canvas2Relative(e)),n=this.getKeyShape();return n.isPointInFill(t)||n.isPointInStroke(t)}},{key:"isPointInFill",value:function(e){var t=Ya(this.canvas2Relative(e));return this.getKeyShape().isPointInFill(t)}},{key:"isPointInStroke",value:function(e){var t=Ya(this.canvas2Relative(e));return this.getKeyShape().isPointInStroke(t)}},{key:"getIntersectionPoint",value:function(e){var t=this.canvas2Relative(e),n={x:.5*this.width,y:.5*this.height},r=n.x,o=n.y,a=t.x,i=t.y,c=this.getKeyShape(),l=null==c?void 0:c.getIntersectionPoint(a,i,r,o),u={x:Jt((l=l||{x:0,y:0}).x/this.width,0,1),y:Jt(l.y/this.height,0,1)};return this.percentage2Canvas(u)}},{key:"getPointAtLength",value:function(e){return this.relative2Canvas(this.getKeyShape().getPointAtLength(e))}},{key:"getPointAtPercent",value:function(e){var t=this.getKeyShape(),n=t.getTotalLength(),r=t.getPointAtLength(e*n);return this.relative2Canvas(r)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"getAlignBBox",value:function(){return this.getBBox()}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=this.x+e.x,n=this.y+e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"getFullBBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.deepEach((function(o){if(o.state.visible){var a=o.getBBox();e=Math.min(e,a.minX),t=Math.min(t,a.minY),n=Math.max(n,a.maxX),r=Math.max(r,a.maxY)}return!0})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"getTextBox",value:function(){return this.getBBox()}},{key:"toBack",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(0!==n&&-1!==n){var r=t[0];e.insertBefore(this,r)}}}},{key:"toFront",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this),r=t.length;if(n!==r-1){var o=t[r-1];e.insertBefore(this,o),e.insertBefore(o,this)}}}},{key:"forward",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(n!==t.length-1){var r=t[n+1];e.insertBefore(r,this)}}}},{key:"backward",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(0!==n&&-1!==n){var r=t[n-1];e.insertBefore(this,r)}}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var e=this.x,t=this.y,n=this.width,r=this.height,o=this.rotate;this.matrix=$a(e,t,n,r,o)}}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stroke:{width:1},rotate:0,penetratedKeys:["strokeStyle","defaultContentStyle","roughFillStyle"],multiSelectHighlight:!0,isBoardCell:!0,defaultContentStyle:{color:"rgb(38, 38, 38)"},defaultFontFamily:Fr})}}]),n}();c()(Gu,"className","BoardCell");var Yu=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"geometryClipPath",void 0),c()(A()(e),"clipPath",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell.diagram.defs,t=new Fo({id:this.cell.clipPathID}),n=new ho({"clip-rule":"evenodd","fill-rule":"evenodd"});t.add(n),e.add(t),this.geometryClipPath=n,this.clipPath=t}},{key:"draw",value:function(){var e=this.cell,t=this.geometryClipPath,n=e.outlineElement.attr("d");t.update({d:n})}},{key:"destroy",value:function(){this.geometryClipPath.destroy(),this.clipPath.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();function Hu(e){var t=e.radius,n=e.outer,r=e.width+2*n,o=e.height+2*n;return"capsule"===e.shape&&(t=r<o?r/2:o/2),Jn(-n,-n,r,o,t)}function Vu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wu=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"clipPathID",Object(F.a)()),c()(A()(r),"group",new no),r.subCell=new Yu(A()(r)),r.diagram=e.diagram,r}return v()(n,[{key:"getSytle",value:function(){var e=this.cell,t=e.border,n=e.computedProps,r=yn(t,{fill:!0});return r.stroke=t.stroke||n.treeEdge.stroke,r["stroke-width"]=e.getBorderStrokeWidth(),"line"===t.shape&&(r.stroke="rgba(255,255,255,0)",r.fill="rgba(255,255,255,0)"),r}},{key:"createRendererElement",value:function(){var e=this.group,t=this.cell;if(!this.element||t.stem.isCacheStale("roughFillStyle")){var n=t.getRoughGraphicOptions(),r=new(n?ta:ho)(Uu({},n));n?this.group.update({"clip-path":"null"}):this.group.update({"clip-path":"url(#".concat(this.clipPathID,")")}),e.clear(),this.element=r,t.borderElement=r,this.outlineElement=r,t.cache.borderShape=t.border.shape,e.add(this.element)}}},{key:"render",value:function(){this.cell.graphicGroup.add(this.group),this.subCell.render()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=e.getRoughGraphicOptions(),r=e.cache,o=e.width,a=e.height,i=e.border,c=i.outer,l=i.radius,u=i.shape,s=this.getSytle(),d=vn(s,r.borderStyle,["stroke","fill","stroke-width"]);d["stroke-width"]&&!n&&(d["stroke-width"]*=2),o===r.width&&oi(a,r.height,1)&&i.shape===r.borderShape||(d.d=Hu({radius:l,outer:c,width:o,height:a,shape:u})),e.stem.isCacheStale("roughFillStyle")&&(d=Uu({d:Hu({radius:l,outer:c,width:o,height:a,shape:u})},s)),Object.keys(d).length>0&&(t.update(d),this.subCell.draw(),r.borderStyle=s)}},{key:"destroy",value:function(){this.element&&this.element.destroy()}}]),n}();c()(Wu,"className","Border"),c()(Wu,"configName","border"),c()(Wu,"zIndex",1);var Xu=xo,Ku=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Xu;this.element=t,e.imageElement=t}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.graphicGroup,r=e.image,o=e.contentBox,a=e.diagram.imageManager,i=e.getPadding();if(r.src){if(n.children.includes(t)||n.add(t),r){var c=r.src,l=r.width,u=r.height,s=r.naturalWidth,d=r.naturalHeight;t.update({x:o.x+(o.width-r.width)/2,y:i[0],width:l,height:u}),t.dataset({raw_src:r.src}),a.setImageHref(t,c,s,d)}}else t.remove()}},{key:"destroy",value:function(){this.element.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();function Zu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Ku,"className","ImageSubcell"),c()(Ku,"configName","image"),c()(Ku,"zIndex",2),Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n[data-lake-mindmap-icon-selected=\"true\"].lake-diagram-mindmap-icon {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-lake-board-mode='edit'] .lake-diagram-mindmap-icon:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n");var $u=go,Ju=["html","width","height","textVerticalAlign","icons"],es=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new $u({styleSheets:e.textareaContentStyleSheets,html:e.html});n.htmlContainer.classList.add("selection-transparent"),t.add(n),this.element=n,e.textareaElement=n,e.textarea=this,this.initCalculatedDOM()}},{key:"initCalculatedDOM",value:function(){var e=this.cell.diagram,t=document.createElement("div");e.calculatedContainer.appendChild(t),this.calculatedDOM=t}},{key:"update",value:function(){var e=this.cell,t=this.calculatedDOM,n=e.cache,r=e.textareaContentStyleSheets,o=Qu(Qu({},e.stem.defaultContentStyle),e.defaultContentStyle);if(n.html!==e.html&&(t.innerHTML=e.html),e.updateTextareaStyleSheets(),this._shouldRender()){if(o){var a=r.find((function(e){return"self"===e.query}));a&&Object.assign(a.css,o),o["font-family"]||(a.css["font-family"]=e.defaultFontFamily)}mn(t,r),this._setBBox()}}},{key:"getPosition",value:function(){var e=this.cell,t=this.getBBox();return e.getTextareaPosition(t)}},{key:"calculateBBox",value:function(){var e=this.calculatedDOM;e.style.display="inline-block";var t=e.getBoundingClientRect();return e.style.display="none",{x:t.x,y:t.y,width:Math.ceil(t.width),height:Math.ceil(t.height)}}},{key:"_setBBox",value:function(){this.box=this.calculateBBox()}},{key:"_shouldRender",value:function(){var e=this.cell,t=e.cache;return Ju.some((function(n){var r=t[n],o=e[n];return"number"==typeof r&&"number"==typeof o?!oi(o,r,1):!Fe()(o,r)}))||e.stem.isCacheStale("roughFillStyle")}},{key:"getBBox",value:function(){return this.box}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=this.box;e.cache;var r=e.textareaContentStyleSheets,o={};this._shouldRender()&&(o.html=e.html,mn(t.htmlContainer,r),Object.assign(o,Qu({width:n.width+2,height:n.height},this.getPosition()))),Object.keys(o).length>0&&(t.update(o),"read"===e.diagram.interaction.currentMode&&t.htmlContainer.querySelectorAll("a").forEach((function(e){var t=e.href,n=window.location.origin+window.location.pathname;(t===n||t.startsWith(n+location.search+"#"))&&e.removeAttribute("target")})))}},{key:"destroy",value:function(){this.element.destroy(),this.calculatedDOM.remove()}}]),n}();c()(es,"className","Textarea"),c()(es,"configName","textarea"),c()(es,"zIndex",2);var ts=function(e){S()(n,es);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"drawInherit",value:function(){this.update(),this.draw()}},{key:"calculateBBox",value:function(){var e=N()(M()(n.prototype),"calculateBBox",this).call(this),t=this.cell,r=this.calculatedDOM,o=t.image&&t.image.src;return r.textContent||t.state.beginEdit||!o?e:{x:e.x,y:e.y,width:e.width+1,height:0}}},{key:"getPosition",value:function(){var e=this.cell,t=e.image,n=e.contentBox,r=t&&t.src&&t.height+2||0;return{x:n.x,y:n.y+r}}}]),n}();c()(ts,"className","MindmapTextarea");var ns=go,rs=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"container",void 0),c()(A()(e),"size",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell.graphicGroup,t=new ns,n=t.htmlContainer;n&&(n.classList.add("lake-diagram-mindmap-icon-container"),n.style.display="flex",n.style.alignItems="center",n.style.boxSizing="border-box"),this.container=t,e.add(t)}},{key:"draw",value:function(){var e=this.cell,t=this.container,n=this.size,r=e.validIconKeys,o=e.model.icons,a=void 0===o?{}:o,i=this.getBBox(),c=t.htmlContainer;if(c){var l=c.children,u=r;if(u.length>0){c.style.width=i.width+"px",c.style.height=n+4+"px",t.attr(i),t.show();for(var s=0,d=0;;){var f=l[d],h=void 0,p=u[s];if(p){var m=u[s];if(f){var y=f.getAttribute("lake-mindmap-icon-key");y===m?(d++,s++):Mr.indexOf(y)<Mr.indexOf(m)?(f.remove(),f=null):(h=this.newIconElement(m),c.insertBefore(h,f),d++,s++)}else h=this.newIconElement(m),c.appendChild(h),d++,s++}else{if(!f)break;f.remove(),f=null}var v=h||f;v&&(Nr(p,a[p])!==v.src&&(v.setAttribute("src",Nr(p,a[p])),v.setAttribute("lake-mindmap-icon-key",p)),v.style.width=n+4+"px",v.style.height=n+4+"px",v.dataset.lakeMindmapIconSelected="false")}}else t.hide()}}},{key:"updateSize",value:function(){if(this.size=this.getIconSize(),isNaN(this.size))throw new Error("mindmap icon size nan")}},{key:"getIconSize",value:function(){var e=this.cell,t=e.subcells,n=e.isStem?18:14,r=t.find((function(e){return e instanceof ts}));if(!r.calculatedDOM)return n+2;for(var o=r.calculatedDOM,a=r.calculatedDOM,i=n;(null===(c=o.childNodes)||void 0===c?void 0:c.length)>0;){var c;if((o=o.childNodes[0])instanceof HTMLElement)a=o;else if(o){var l=window.getComputedStyle(a).fontSize.match(/^[0-9]*px/);if(l){var u=parseFloat(l[0]);"number"!=typeof u||isNaN(u)||(i=u)}}}return i+2}},{key:"getBBox",value:function(){var e=this.cell.validIconKeys,t=n.style.marginRight;return 0===e.length?{width:0,height:0}:{x:this.cell.getPadding()[3]-2,y:(this.cell.height-this.size-4)/2,width:(this.size+4+t)*e.length-t,height:this.size+4}}},{key:"newIconElement",value:function(e){var t=document.createElement("img");t.className="lake-diagram-mindmap-icon",t.setAttribute("lake-mindmap-icon-key",e);var r=n.style.marginRight;return t.style.border="none",t.style.padding="2px",t.style.marginRight="".concat(r,"px"),t.style.borderRadius="6px",t.style.userSelect="none",t.style.boxSizing="border-box",t}}]),n}();c()(rs,"className","MindmapIcons"),c()(rs,"zIndex",3),c()(rs,"style",{marginRight:0});var os=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"element",void 0),e}return v()(n,[{key:"setDefault",value:function(){var e=this.element;e&&e.hide()}},{key:"updateState",value:function(){var e=this.element,t=this.cell;if(t.state.selected){var n={d:""};n.d=t.borderElement.attr("d"),e.update(n),e.show()}else e.hide()}},{key:"render",value:function(){this.element=new ho({stroke:"#3384F5",fill:"transparent"}),this.element.css({"pointer-events":"none"}),this.cell.outlineElement=this.element,this.cell.graphicGroup.add(this.element)}},{key:"draw",value:function(){}},{key:"destroy",value:function(){N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();c()(os,"className","MindmapOutline"),c()(os,"configName","outline"),c()(os,"zIndex",3);var as=go,is=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e);var o=e.note,a=o.width,i=o.height,c=o.padding;return r.size=[a+c[1]+c[3],i+c[0]+c[2]],r}return v()(n,[{key:"render",value:function(){var e=this.cell.note,t=e.width,n=e.height,r=new as({width:t,height:n}),o=r.htmlContainer;o.classList.add("lake-diagram-note"),o.classList.add("lake-icon"),o.classList.add("lake-icon-diagram-cell-note"),o.style.cursor="pointer",o.style["vertical-align"]="top",o.style.color="#8C8C8C",o.style["font-size"]=t+"px",o.style.width=t+"px",o.style.height=n+"px",o.style["line-height"]=t+"px",this.element=r}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.model,r=e.note,o=e.graphicGroup,a=e.width,i=e.height,c=e.border;n.note?(t.attr({x:a-r.width-r.padding[1],y:(i-r.height)/2}),c.fill&&(t.htmlContainer.style.color=ga(c.fill)),o.add(t)):t.remove()}}]),n}();function cs(e){var t=e.naturalWidth/e.naturalHeight,n=e.firstInsertRatio?e.naturalWidth*e.firstInsertRatio:e.naturalWidth;return e.width=n>=480?480:n,e.height=e.width/t,e}c()(is,"className","Note"),c()(is,"zIndex",3);var ls=[Wu,os,Ku,is,ts,rs],us=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getRoughGraphicOptions",value:function(){var e=this.computedProps.roughFillStyle;if(e)return{roughFillStyle:e}}},{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.model.children||(this.model.children=[]),this.Subcells.sort((function(e,t){return e.zIndex-t.zIndex})),this.Subcells.forEach((function(e){var n=e.configName;n&&!t[n]&&(t[n]={},!t.default[n]&&(t.default[n]={}))})),this.initSubcell(),this.render(),this.eventDelegation()}},{key:"minContentWidth",get:function(){var e=this.border;if(e){var t=e.shape;if("rect"===t)return 38;if("capsule"===t)return 42}return 32}},{key:"minHeight",get:function(){return 16}},{key:"isPlaceholder",get:function(){return this.model.isPlaceholder}},{key:"getMinWidth",value:function(){return this.minContentWidth+this.getIconsWidth()}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.model,n=this.minHeight,r=this.subcells;if(!this.model.width){var o=this.getMinWidth(),a=this.getPadding(),i=a[1]+a[3]+this.getNoteWidth()+this.getIconsWidth(),c=a[0]+a[2],l=r.find((function(e){return e instanceof ts})),u=e.find((function(e){return"self"===e.query}));t.image&&t.image.src&&t.image.width?l.calculateBBox().width<t.image.width&&(u.css.width=t.image.width-1+"px",u.css["max-width"]=""):(u.css["max-width"]="480px",u.css.width=""),u.css["min-width"]=o-i+"px",u.css["min-height"]=n-c+"px"}}},{key:"updateTextareaCSS",value:function(){var e=this.textareaContentStyleSheets,t=this.model,n=this.minHeight,r=this.subcells,o=this.getMinWidth(),a=this.getPadding(),i=a[1]+a[3]+this.getNoteWidth()+this.getIconsWidth(),c=a[0]+a[2],l=r.find((function(e){return e instanceof ts})),u=e.find((function(e){return"self"===e.query}));if(t.width){var s=Math.max(t.width,o);u.css.width=s-i+"px",u.css["max-width"]="",u.css["min-width"]=o-i+"px",u.css["min-height"]=n-c+"px"}mn(l.calculatedDOM,e),l._setBBox()}},{key:"deprecatedGetBBox",value:function(){var e=this.graphicGroup.rendererElement.getBBox(),t=this.x+e.x,n=this.y+e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"getKeyShapeBox",value:function(){var e=this.collapsed,t=this.downSignX,n=this.downSignY,r=this.border.shape,o=this.getKeyShape().getBBox(),a=this.x+o.x,i=this.y+o.y,c=Math.abs(t)+Math.abs(n)===2,l=e&&-1===t&&!c?24*t:0,u=e&&-1===n?24*n:0,s=e&&!c?24*Math.abs(t):0,d=e?24*Math.abs(n):0;return"line"===r&&e&&0===n&&(d+=8),{x:a+l,y:i+u,width:o.width+s,height:o.height+d,minX:a,minY:i,maxX:a+o.width,maxY:i+o.height}}},{key:"getTimelineLayoutAlign",value:function(){var e=this.getTimelineLayoutSourceCell(),t="";return[e,this].forEach((function(e){e&&"line"===e.border.shape?t+="b":t+="c"})),t}},{key:"getTimelineLayoutSourceCell",value:function(){var e=this.parent;if(this.isStem)return null;var t=this.getNth();return 0===t?e:this.getSiblings()[t-1]}},{key:"showCollapsedButton",value:function(){this.state.collapsedButtonVisible||(this.state.collapsedButtonVisible=!0,this.updateState())}},{key:"hideCollapsedButton",value:function(){this.state.collapsedButtonVisible&&(this.state.collapsedButtonVisible=!1,this.updateState())}},{key:"findSubcell",value:function(e){return this.subcells.find((function(t){return t.constructor.className===e}))}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()&&this.image&&this.image.src}},{key:"canStroke",value:function(){return"line"!==this.border.shape}},{key:"canRotate",value:function(){return!1}},{key:"canStrokeWidth",value:function(){return!1}},{key:"canStrokeStyle",value:function(){return!1}},{key:"canFill",value:function(){return"line"!==this.border.shape}},{key:"get",value:function(e){var t=N()(M()(n.prototype),"get",this).call(this,e);return"border"===e?(t.stroke=t.stroke||this.computedProps.treeEdge.stroke,t["stroke-width"]=this.getBorderStrokeWidth(),t):"treeEdge"===e?(t.stroke=this.computedProps.treeEdge.stroke,t["stroke-width"]=this.getTreeEdgeStrokeWidth(),t):t}},{key:"getKeyShape",value:function(){return this.borderElement}},{key:"getPadding",value:function(){return[4,8,4,8]}},{key:"getBorderStrokeWidth",value:function(){return this.border["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getTreeEdgeStrokeWidth",value:function(){return this.computedProps.treeEdge["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getDefaultStrokeWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.depth;return this.stem.tapered&&function(e){return e<=2?3:e>=2&&e<=4?2:1}(e)||3}},{key:"initSubcell",value:function(){var e=this;this.subcells=this.Subcells.map((function(t){return new t(e)}))}},{key:"eventDelegation",value:function(){var e=this.graphicGroup,t=this.imageElement;this.delegateEvent(t,"mouseenter","mindmapcellimage:mouseenter"),this.delegateEvent(t,"mouseleave","mindmapcellimage:mouseleave"),this.delegateEvent(e,"mouseenter","mindmapcell:mouseenter"),this.delegateEvent(e,"mouseleave","mindmapcell:mouseleave")}},{key:"render",value:function(){this.subcells.forEach((function(e){e.render()})),this.updateModel(this.model)}},{key:"draw",value:function(){this.drawInner(),this.updateCache(),this.updateState()}},{key:"updateModel",value:function(e){e&&""===e.html&&(e.html="&#8203;"),N()(M()(n.prototype),"updateModel",this).call(this,e),this.calculate()}},{key:"isInCollapsed",value:function(){for(var e=this.parent;e;){if(!0===e.collapsed)return!0;e=e.parent}return!1}},{key:"getCellQuadrant",value:function(){for(var e=this;1!==e.depth;)e=e.parent;return e.model.quadrant}},{key:"drawInner",value:function(){this.subcells.forEach((function(e){e.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"drawInherit",value:function(){"capsule"===this.border.shape&&this.image.src&&this.calculate(),this.subcells.forEach((function(e){e.drawInherit()}))}},{key:"drawPosition",value:function(){this.subcells.forEach((function(e){e.drawPosition()}));var e=this.graphicGroup,t=this.x,n=this.y,r=this.cache;if(!r.matrix||t!==r.matrix[6]||n!==r.matrix[7]){var o=[1,0,0,0,1,0,t,n,1];e.update({matrix:o}),r.matrix=o,this.matrix=o}}},{key:"drawCollapse",value:function(){this.isInCollapsed()?this.hide():this.show()}},{key:"getNoteWidth",value:function(){return this.model.note&&this.findSubcell("Note").size[0]||0}},{key:"getIconsWidth",value:function(){return this.model.icons?this.findSubcell("MindmapIcons").getBBox().width:0}},{key:"calculate",value:function(){this.calculateSize()}},{key:"calculateSize",value:function(){var e=this,t=this.cache,n=this.findSubcell("MindmapTextarea");n.update();var r=this.findSubcell("MindmapIcons");r.updateSize(),this.model.width&&this.updateTextareaCSS(),this.textareaBBox=n.box;var o=this.getPadding(),a={noteWidth:this.getNoteWidth(),padding:o,iconsBBox:r.getBBox()};t.html&&this.html&&t.html!==this.html&&(this.model.height=null),(["image","width","height","html"].some((function(n){return t[n]!==e[n]}))||this.isCacheStale("icons"))&&(this.calculateImageSize(a),this.contentHeight=this.getContentHeight(a),this.contentWidth=this.getContentWidth(a),this.height=this.getHeight(a),this.width=this.getWidth(a),this.contentBox=this.getContentBox(a),"capsule"===this.border.shape&&(a.padding=this.getPadding(),this.contentHeight=this.getContentHeight(a),this.contentWidth=this.getContentWidth(a),this.height=this.getHeight(a),this.width=this.getWidth(a),this.contentBox=this.getContentBox(a)))}},{key:"getContentBox",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,o=this.width,a=this.contentWidth,i=this.contentHeight;return{x:(o-a-t[1]-t[3]-n-r.width)/2+t[3]+r.width,y:t[0],width:a,height:i}}},{key:"getHasModelSizeContentWidth",value:function(e){var t,n=e.padding,r=e.noteWidth,o=e.iconsBBox,a=this.model,i=this.border,c=this.getMinWidth(),l=Math.max(a.width,c),u=n[1]+n[3]+r+o.width,s=l-u;return"capsule"===i.shape&&(t=l>a.height?l-a.height+u:l/2,s=Math.min(s,t)),s}},{key:"calculateImageSize",value:function(e){var t=e.padding,r=this.image,o=this.model;if(!r.height||o.height){if(!r.src)return Object.assign(r,{width:0,height:0});var a=r.naturalWidth/r.naturalHeight,i=this.getTextareaHeight(),c=this.getHasModelSizeContentWidth(e),l=o.height-t[0]-t[2]-i-4,u=((l=Math.max(l>0?l:0,36))>0?c/l:a)<=a?c/a:l,s=u*a;N()(M()(n.prototype),"updateModel",this).call(this,{image:{width:s,height:u}})}}},{key:"getWidth",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,o=this.isPlaceholder,a=this.model,i=this.border,c=this.contentWidth,l=this.contentHeight;if(o)return a.width;var u,s=this.getMinWidth();if(a.width)u=Math.max(a.width,s);else if(u=c+t[1]+t[3]+n+r.width,"capsule"===i.shape){var d=t[1]+t[3];l>d&&(u+=l-d)}return nn(Math.ceil(u),s)}},{key:"getHeight",value:function(e){var t=e.padding;return this.isPlaceholder?this.model.height:nn(this.contentHeight+t[0]+t[2],this.minHeight)}},{key:"getContentWidth",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,o=this.textareaBBox,a=this.image,i=this.model;if(i.width){var c=this.getMinWidth();return Math.max(i.width,c)-n-t[1]-t[3]-r.width}return Math.ceil(Math.max(o.width,a.width))||100}},{key:"getTextareaHeight",value:function(){var e=this.textareaBBox,t=this.image,n=this.diagram;return t.src&&this.isContentEmpty()&&!n.contentEditor.isBegin?0:e.height}},{key:"getContentHeight",value:function(e){var t=this.image,n=this.getTextareaHeight();return Math.ceil(n+t.height)}},{key:"updateState",value:function(){this.setDefault(),this.subcells.forEach((function(e){e.updateState()}))}},{key:"setDefault",value:function(){this.subcells.forEach((function(e){e.setDefault()}))}},{key:"updateCache",value:function(){this.cache.width=this.width,this.cache.height=this.height,this.cache.html=this.html,this.cache.collapsed=this.collapsed,this.cache.icons=u()(this.icons),this.cache.roughFillStyle=this.computedProps.roughFillStyle}},{key:"preventDelete",value:function(){return!1}},{key:"beginEditContent",value:function(){this.state.beginEdit=!0,this.updateState()}},{key:"endEditContent",value:function(){this.state.beginEdit=!1,this.updateState()}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"destroy",value:function(){this.subcells.forEach((function(e){e.destroy()})),N()(M()(n.prototype),"destroy",this).call(this)}},{key:"getNewQuadIndexByNewRealIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.quadrantTreeLists[t-1],r=n.findIndex((function(t){return t>=e}));return-1!==r?r:n.length}},{key:"mindmapParent",get:function(){var e=this.parent;return e&&e.isMindmap?e:void 0}},{key:"quadrantTreeLists",get:function(){var e=this.getChildren();if(this.isTwoQuadrantLayout){var t=[[],[]];return e.forEach((function(e,n){var r=e.model,o=r.layout,a=(void 0===o?{}:o).quadrant,i=void 0===a?1:a,c=r.abstract,l=Math.min(2,Math.max(1,i));c||t[l-1].push(n)})),t}return[Pe()(e.filter((function(e){return!e.model.abstract})).length)]}},{key:"isTwoQuadrantLayout",get:function(){return n.modelIsTwoQuadrantLayout(this.model)}},{key:"realQuadrant",get:function(){var e=this.mindmapParent;if(e){var t=this.model.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n;if(e.layoutQuadrantConstraint&&e.layoutQuadrantConstraint.length>1)return r}return 1}},{key:"quadrantNth",get:function(){var e=this.parent&&this.parent.isTwoQuadrantLayout,t=this.getNth();if(e){var n=this.parent.quadrantTreeLists[this.realQuadrant-1];if(!this.isAbstract)return n.indexOf(t)}return this.parent&&this.parent.isMindmap?t:-1}},{key:"abstractCoveredCells",get:function(){var e=this.model,t=e.abstract,n=e.start,r=e.end,o=this.realQuadrant;if(this.parent&&t&&void 0!==n&&void 0!==r){var a=this.parent.getChildren();return this.parent.quadrantTreeLists[o-1].slice(n,r+1).map((function(e){return a[e]}))}return[]}},{key:"abstractCoveredCellsWithAllChildren",get:function(){var e=this.model,t=e.abstract,n=e.start,r=e.end,o=this.realQuadrant;if(this.parent&&t&&void 0!==n&&void 0!==r){var a=this.parent.getChildren();return this.parent.quadrantTreeLists[o-1].slice(n,r+1).map((function(e){return a[e]})).reduce((function(e,t,n){return e.concat(function e(t){return t.collapsed?[t]:[t].concat(t.getChildren().map((function(t){return e(t)})).reduce((function(e,t){return e.concat(t)}),[]))}(t))}),[])}return[]}},{key:"validIconKeys",get:function(){var e=this.model.icons;return e?Mr.filter((function(t,n){return"number"==typeof e[t]&&e[t]>=0&&e[t]<Tr[n]})):[]}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{x:0,y:0,rotate:0,collapsed:!1,html:"&#8203;",layout:{},image:{width:0,height:0},note:{width:14,height:14,padding:[0,8,0,0]},anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],Subcells:ls,penetratedKeys:["x","y","width","collapsed","quadrant","zIndex","html","layout","rainbow","tapered","note","treeEdge","icons","roughFillStyle"].concat(ls.map((function(e){return e.configName}))),isMindmap:!0,multiSelectHighlight:!1,resizeRotatePoints:["tr"]})}},{key:"modelIsTwoQuadrantLayout",value:function(e){var t=e.layout,n=void 0===t?{}:t,r=n.type,o=void 0===r?"standard":r,a=n.quadrantConstraint,i=void 0===a?void 0:a;return"mindmap"===e.type&&"standard"===o&&(!i||i.length>1)}}]),n}();function ss(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ds(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ss(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ss(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fs(e){"flowchart"===e.type&&(e.type="geometry"),"edge"===e.type&&(e.type="line")}function hs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ps(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hs(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ms(e,t){switch((e=ps(ps({"stroke-linecap":"butt","stroke-linejoin":"round"},t),e)).name){case"rect":return new(t?sa:Ao)(e);case"ellipse":return new(t?oa:yo)(e);case"polygon":return new(t?ca:Eo)(e);default:return new(t?ta:ho)(e)}}function ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(us,"className","MindmapBase");var gs=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"sceneKeys",[]),c()(A()(e),"group",new no),c()(A()(e),"elements",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;yr(e)?e.clipGroup.add(this.group):e.graphicGroup.add(this.group)}},{key:"renderElements",value:function(){var e=this.group,t=this.cell,n=t.stencil,r=[],o=t.getRoughGraphicOptions();n.scene.forEach((function(t){var n=ms(t,o);t.attr&&n.update(t.attr),e.add(n),r.push(n)})),this.elements=r}},{key:"update",value:function(){var e=this.cell,t=this.elements;e.isCacheStale("shape","roughFillStyle")&&(t&&t.forEach((function(e){return e.remove()})),this.renderElements())}},{key:"draw",value:function(){var e=this.cell,t=this.elements,n=e.stroke,r=e.width,o=e.height,a=e.stencil,i=vs({},e.convertStrokeStyle());e.isCacheStale("stroke","roughFillStyle")&&(i.stroke=n.color,i["stroke-width"]=!0===(null==a?void 0:a.open)?2*n.width:n.width),t.forEach((function(e,t){var n,c,l=null===(n=a.scene[t])||void 0===n?void 0:n.path;if(l)c=l(r,o);else{var u=r/a.width,s=o/a.height;c=e.getPath(u,s)}e.update(vs(vs({},i),{},{d:c},a.scene[t].attr))}))}}]),n}();function bs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var xs=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"shapeElement",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new no;this.group=t,sr(e)||dr(e)?e.clipGroup.add(this.group):vr(e)?e.group.add(this.group):e.graphicGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.group,n=e.createOutlineShapeElement();if(n){if(t.clear(),yr(e)){var r=e.stencil.outline;r.style&&n.css(r.style)}t.add(n),this.shapeElement=n,e.outlineElement=n}}},{key:"draw",value:function(){var e=this.cell,t=this.shapeElement,n=e.stroke,r=e.fill,o=e.stencil;if(n){var a={},i=e.getOutlinePath(t),l=e.getRoughGraphicOptions();i&&(a.d=i);var u=n.width;o&&(!1===o.isClip||l||(u*=2)),e.isCacheStale("stroke","roughFillStyle")&&Object.assign(a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stroke:n.color,"stroke-width":u},e.convertStrokeStyle())),vr(e)||lr(e)||dr(e)?a.fill="transparent":e.isCacheStale("fill","roughFillStyle")&&(a.fill=r.color),t.update(a)}}}]),n}();function ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}["getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(xs.prototype,e,{value:function(){var t;return(t=this.shapeElement)[e].apply(t,arguments)}})}));var ks=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"textareaContentStyleSheets",void 0),c()(A()(e),"rotate",void 0),c()(A()(e),"fill",void 0),c()(A()(e),"textareaRegion",void 0),c()(A()(e),"textVerticalAlign",void 0),c()(A()(e),"outlineElement",void 0),c()(A()(e),"clipPathID",Object(F.a)()),c()(A()(e),"clipGroup",new no),e}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.initSubcell(),this.eventDelegation(),this.render()}},{key:"canUseAddLineButton",value:function(){return!0}},{key:"initSubcell",value:function(){var e=this;this.subcells=this.Subcells.map((function(t){return new t(e)}))}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"eventDelegation",value:function(){var e=this.graphicGroup;this.delegateEvent(e,"mouseenter","vertexcell:mouseenter"),this.delegateEvent(e,"mouseleave","vertexcell:mouseleave")}},{key:"draw",value:function(){this.subcells.forEach((function(e){return e.draw()})),this.graphicGroup.attr({opacity:this.opacity}),this.drawPosition(),this.updateCache()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","height","rotate","shape","fill","stroke","controlPoints","round","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.updateModel(e),this.graphicGroup.prepend(this.clipGroup)}},{key:"getTextareaPosition",value:function(e){var t=this.width,n=this.height,r=this.getPadding(),o=e.height;return{x:Math.max((t-e.width)/2,r[3]),y:(n-o)/2}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var e=this.x,t=this.y,n=this.width,r=this.height,o=this.rotate;this.matrix=$a(e,t,n,r,o)}}},{key:"getKeyShape",value:function(){var e;return null===(e=this.subcells.find((function(e){return e instanceof xs})))||void 0===e?void 0:e.shapeElement}},{key:"destroy",value:function(){this.subcells.forEach((function(e){return e.destroy()})),N()(M()(n.prototype),"destroy",this).call(this)}},{key:"beforeUpdateModel",value:function(e){if(this.constraints&&this.constraints.proportion){var t=this.width/this.height;e.height>0&&null==e.width?e.width=e.height*t:e.width>0&&(e.height=e.width/t)}}},{key:"afterUpdateModel",value:function(){if(this.updateMatrix(),this.subcells.forEach((function(e){e.update()})),this.stencil){var e=this.getRoughGraphicOptions();!1===this.stencil.isClip||e?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}}},{key:"updateModel",value:function(e){this.beforeUpdateModel(e),N()(M()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{html:"",x:0,y:0,rotate:0,anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],opacity:1,penetratedKeys:["x","y","width","height","category","stroke","fill","rotate","html","shape","image","constraints","opacity"],textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],Subcells:[xs,Yu],isVertex:!0})}}]),n}();c()(ks,"className","VertexCell");var Es=function(e,t){return{minX:4,minY:4,maxX:e-4,maxY:t-4}};var Os=function(e){S()(n,ks);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"stencil",void 0),c()(A()(e),"stencils",void 0),c()(A()(e),"controlPoints",void 0),c()(A()(e),"round",void 0),c()(A()(e),"shape",void 0),c()(A()(e),"isGeometry",!0),c()(A()(e),"outlineElement",void 0),e}return v()(n,[{key:"canRough",value:function(){return!0}},{key:"canRound",value:function(){return void 0!==this.model.round}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.textareaRegion;e.find((function(e){return"self"===e.query})).css.width="".concat(t.maxX-t.minX,"px")}},{key:"getTextareaPosition",value:function(e){var t=this.textareaRegion,n=this.textVerticalAlign,r={x:t.minX,y:0};return r.y="top"===n?t.minY:"bottom"===n?t.maxY-e.height:(t.minY+t.maxY-e.height)/2,r}},{key:"_updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"process";if(!this.stencil||this.stencil.name!==n){var r=t.find((function(e){return e.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this._updateAnchors(),this._updateDefaultSize(),this.cache={}}}},{key:"_updateTextareaRegion",value:function(){var e,t=this.stencil,n=this.width,r=this.height,o=this.controlPoints,a=(null==t||null===(e=t.textarea)||void 0===e?void 0:e.region)||Es;this.textareaRegion=a(n,r,o)}},{key:"_updateDefaultSize",value:function(){var e=this,t=this.stencil;["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"_updateAnchors",value:function(){for(var e=this.anchors,t=this.stencil,n=function(){var n=e[r],o=t.anchors.find((function(e){return e.name===n.name}));o&&(e[r]=o)},r=0;r<e.length;r++)n()}},{key:"afterUpdateModel",value:function(){this._updateStencil(),this._updateTextareaRegion(),N()(M()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return ms(e.outline,t)}}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape","controlPoints","round","roughFillStyle")){var t,n=this.width,r=this.height,o=this.stencil,a=this.controlPoints,i=this.round;if(o.outline.path)t=o.outline.path(n,r,a,i);else{var c=n/o.width,l=r/o.height;t=e.getPath(c,l)}return t}return null}},{key:"render",value:function(){N()(M()(n.prototype),"render",this).call(this);var e=this.model;e.width||(e.width=this.width),e.height||(e.height=this.height)}},{key:"getOuterWidth",value:function(){return this.width}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stencils:uc,shape:"process",stroke:{color:"#595959",width:2},fill:{color:"#fff"},Subcells:[gs,es],textVerticalAlign:"center",penetratedKeys:["textVerticalAlign","controlPoints","round"]})}}]),n}();c()(Os,"className","Geometry");var Cs=ho,As=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).eventHelper=new fl,r}return v()(n,[{key:"render",value:function(){var e=this.cell.graphicGroup,t=new Cs;e.add(t),this.element=t,this.delegateEvent()}},{key:"delegateEvent",value:function(){var e=this.element,t=this.cell;t.delegateEvent(e,"mouseenter","groupcellrect:mouseenter"),t.delegateEvent(e,"mouseleave","groupcellrect:mouseleave")}},{key:"getClassNames",value:function(){return this.classNames.join(" ")}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.width,r=e.height;e.isCacheStale("width","height")&&t.update({d:Jn(0,0,n,r),"stroke-width":1,fill:"rgba(0, 0, 0, 0)"})}},{key:"updateState",value:function(){var e=this.cell,t=this.element,n=e.diagram,r=e.state,o=r.actived,a=r.hover,i=n.signal;return o||a&&!i.dragging?t.update({stroke:"rgba(9, 109, 217, 0.4)"}):t.update({stroke:"none"})}},{key:"destroy",value:function(){this.element.destroy(),this.eventHelper.destroy()}}]),n}();var Ps=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"isGroup",!0),r}return v()(n,[{key:"children",get:function(){return this.getChildren()}},{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.render()}},{key:"canText",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.updateModel(e)}},{key:"hover",value:function(e){this.state.hover=e,this.updateState()}},{key:"updateState",value:function(){this.subcells.forEach((function(e){e.updateState()}))}},{key:"_hasEntity",value:function(){var e=!1;return this.deepEach((function(t){return!!t.isGroup||(e=!0,!1)})),e}},{key:"_drawInner",value:function(){var e=this.graphicGroup,t=this.getChildren(),n=1/0,r=1/0,o=-1/0,a=-1/0;this.show(),t.forEach((function(e){var t;t=e.isGroup?e.getBBox():ur(e)?e.getPointBox():pr(e)?e.getFullBBox():e.getBBox(),n=Math.min(n,t.minX),r=Math.min(r,t.minY),o=Math.max(o,t.maxX),a=Math.max(a,t.maxY)}));var i=[1,0,0,0,1,0,n,r,1];this.x=n,this.y=r,this.width=o-n,this.height=a-r,this.matrix=i,this.isCacheStale("x","y","width","height")&&(this.subcells.forEach((function(e){return e.draw()})),e.update({matrix:i})),this.cache.x=n,this.cache.y=r,this.cache.width=o-n,this.cache.height=a-r}},{key:"draw",value:function(){var e=this.diagram.interaction;if(!this._hasEntity()||"edit"!==e.currentMode)return this.hide();this._drawInner()}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{fill:"rgba(2, 2, 2, 0.3)",x:0,y:0,width:1,height:1,isGroup:!0,Subcells:[As]})}}]),n}();c()(Ps,"className","GroupCell");var Ss=xo,js=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Ss;this.element=t,e.graphicGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.element,n=e.diagram,r=e.image,o=n.imageManager;if(r&&e.isCacheStale("image","width","height")){var a=r.src,i=r.naturalWidth,c=r.naturalHeight;t.update({width:e.width,height:e.height}),o.setImageHref(t,a,i,c)}}},{key:"destroy",value:function(){this.element.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();var Rs=function(e){S()(n,ks);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return ms({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape")){var t=this.width/120,n=this.height/60;return e.getPath(t,n)}return null}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},image:{},shape:"image",stroke:{width:1},Subcells:[js],isImage:!0})}}]),n}();c()(Rs,"className","ImageCell");var _s=function(){function e(t){m()(this,e),c()(this,"line",void 0),c()(this,"points",void 0),this.line=t}return v()(e,[{key:"getFirstInsertControlPoints",value:function(){return!1}},{key:"getTextareaPosition",value:function(){return this.line.getPointByPercent(void 0===this.line.textPosition?.5:this.line.textPosition)}},{key:"getControlPointButtonPosition",value:function(e){return this.line.controlPoints[e]}},{key:"updatePoints",value:function(){var e=this.line,t=e.source,n=e.target,r=e.sourceCell,o=e.targetCell,a=e.controlPoints.map((function(e){var t=b()(e,2);return{x:t[0],y:t[1]}})).filter((function(e){return!isNaN(e.x)})),i=a.length,c=e.getEndpoint(t),l=e.getEndpoint(n);if(Ha(c)&&Ha(l))if(c&&l){if(c.x===l.x&&c.y===l.y&&0===a.length)return l.x+=2,l.y+=2,void(this.points=[c,l]);"elbow"===e.shape?(r&&!t.connection&&(c=r.snapAnchor(a[0]||l)[0]),o&&!n.connection&&(l=o.snapAnchor(a[i-1]||c)[0])):(r&&!t.connection&&(c=r.getIntersectionPoint(a[0]||l)),o&&!n.connection&&(l=o.getIntersectionPoint(a[i-1]||c))),this.points=[c].concat(a).concat(l)}else this.points=[c,l]}},{key:"getPoints",value:function(){return this.points||this.updatePoints(),this.points}},{key:"getPath",value:function(){return""}}]),e}();var Ms=function(e){S()(n,_s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getPath",value:function(){var e,t=this.line,n=t.tailOffset,r=t.tipOffset,o=this.getPoints();if(2===o.length){(e=Fn(t)).unshift(["M",o[0].x,o[0].y]);var a={x:e[0][1],y:e[0][2]},i={x:e[1][1],y:e[1][2]},c={x:e[1][5],y:e[1][6]},l={x:e[1][3],y:e[1][4]};a=di(i.x,i.y,a.x,a.y,n),c=di(l.x,l.y,c.x,c.y,r),e[0][1]=a.x,e[0][2]=a.y,e[1][5]=c.x,e[1][6]=c.y}else if(3===o.length){var u=o[0],s=o[1],d=o[2];u=di((s={x:(s.x-.25*d.x-.25*u.x)/.5,y:(s.y-.25*d.y-.25*u.y)/.5}).x,s.y,u.x,u.y,n),d=di(s.x,s.y,d.x,d.y,r),s={x:(o[1].x-.25*d.x-.25*u.x)/.5,y:(o[1].y-.25*d.y-.25*u.y)/.5},e=[["M",u.x,u.y],["Q",s.x,s.y,d.x,d.y]]}else{(e=qn(o)).unshift(["M",o[0].x,o[0].y]);var f=e.length-1,h={x:e[f][5],y:e[f][6]},p={x:e[f][3],y:e[f][4]},m={x:e[0][1],y:e[0][2]},y={x:e[1][1],y:e[1][2]};m=di(y.x,y.y,m.x,m.y,n),h=di(p.x,p.y,h.x,h.y,r),e[0][1]=m.x,e[0][2]=m.y,e[f][5]=h.x,e[f][6]=h.y}return Gn(e)}}]),n}();function Ls(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ds(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ts(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ns=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ls(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ls(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({expandRectGap:16},t))}return v()(e,[{key:"getExpandedBBox",value:function(e){var t=this.expandRectGap;return{minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t}}},{key:"getRectLines",value:function(e){var t=500;return[{x1:e.minX,y1:e.minY-t,x2:e.minX,y2:e.maxY+t},{x1:e.minX-t,y1:e.minY,x2:e.maxX+t,y2:e.minY},{x1:e.maxX,y1:e.minY-t,x2:e.maxX,y2:e.maxY+t},{x1:e.minX-t,y1:e.maxY,x2:e.maxX+t,y2:e.maxY}]}},{key:"getVertexLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ray",r=500;return"all"===t?[{x1:e.x,y1:e.y,x2:e.x,y2:e.y-r,type:n},{x1:e.x,y1:e.y,x2:e.x-r,y2:e.y,type:n}]:"N"===t||"S"===t?["N"===t?{x1:e.x,y1:e.y,x2:e.x,y2:e.y-r,type:n}:{x1:e.x,y1:e.y,x2:e.x,y2:e.y+r,type:n}]:["W"===t?{x1:e.x,y1:e.y,x2:e.x-r,y2:e.y,type:n}:{x1:e.x,y1:e.y,x2:e.x+r,y2:e.y,type:n}]}},{key:"vMiddleLine",value:function(e,t){var n;n=Math.abs(e.minX-t.maxX)<Math.abs(e.maxX-t.minX)?(e.minX+t.maxX)/2:(e.maxX+t.minX)/2;var r=((e.minY+e.maxY)/2+(t.minY+t.maxY)/2)/2;return{x1:n,y1:r-500,x2:n,y2:r+500}}},{key:"hMiddleLine",value:function(e,t){var n;n=Math.abs(e.minY-t.maxY)<Math.abs(e.maxY-t.minY)?(e.minY+t.maxY)/2:(e.maxY+t.minY)/2;var r=((e.minX+e.maxX)/2+(t.minX+t.maxX)/2)/2;return{x1:r-500,y1:n,x2:r+500,y2:n}}},{key:"cost",value:function(e){var t,n=e.vertex,r=e.end,o=e.middleLine,a=0,i=0;return t=n.distance+mi(n.x,n.y,r.x,r.y),n.from&&n.from.from&&hi(n.x,n.y,n.from.x,n.from.y)!==hi(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(a=-1),o&&n.from&&n.from.from&&wi(n,o)&&!wi(n.from.from,o)&&n.from&&n.from.from&&hi(n.x,n.y,n.from.x,n.from.y)!==hi(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(i=2),-t+a+i}},{key:"getSide",value:function(e,t){var n=[(e.minX+e.maxX)/2,(e.minY+e.maxY)/2],r=[e.maxX,e.minY],o=[e.maxX,e.maxY],a=[r[0]-n[0],r[1]-n[1]],i=[o[0]-n[0],o[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]],l=k.vec2.angle(a,i),u=l/2,s=[0,u],d=[s[1],u+Math.PI-l],f=[d[1],u+Math.PI],h=[2*Math.PI-u,2*Math.PI],p=k.vec2.angle(c,[1,0]);return c[1]<0&&(p=2*Math.PI-p),rn(p,s)||rn(p,h)?"E":rn(p,d)?"S":rn(p,f)?"W":"N"}},{key:"dedupePoints",value:function(e){if(e.length>=3){for(var t=[e[0]],n=1;n<e.length-1;n++){var r=e[n-1],o=e[n],a=e[n+1];oi(r.x,o.x)&&oi(a.x,o.x)||oi(r.y,o.y)&&oi(a.y,o.y)||t.push(o)}return t.push(e[e.length-1]),t}return e}},{key:"getExpandPoint",value:function(e,t,n){return"N"===n?{x:e.x,y:t.minY}:"S"===n?{x:e.x,y:t.maxY}:"W"===n?{x:t.minX,y:e.y}:"E"===n?{x:t.maxX,y:e.y}:null}},{key:"find",value:function(e,t){var n=this,r=e.cell,o=t.cell,a=r&&r.getBBox(),i=o&&o.getBBox(),c=a&&this.getExpandedBBox(a),l=i&&this.getExpandedBBox(i),u=[];u=c?u.concat(this.getRectLines(c)):u,u=l?u.concat(this.getRectLines(l)):u;var s,d,f,h=new Ni("start"),p=new Ni("end"),m=[e.x,e.y],y=[t.x,t.y];Object.assign(h,{x:m[0],y:m[1]}),Object.assign(p,{x:y[0],y:y[1]}),a?(d=this.getSide(a,m),u=u.concat(this.getVertexLine(h,d))):u=u.concat(this.getVertexLine(h,"all","straight")),i?(f=this.getSide(i,y),u=u.concat(this.getVertexLine(p,f))):u=u.concat(this.getVertexLine(p,"all","straight")),o&&r&&("E"===d&&"W"===f?s=r.x+r.width<o.x?this.vMiddleLine(a,i):this.hMiddleLine(a,i):"W"===d&&"E"===f?s=r.x+r.width<o.x?this.hMiddleLine(a,i):this.vMiddleLine(a,i):"S"===d&&"N"===f?s=r.y+r.height>o.y?this.vMiddleLine(a,i):this.hMiddleLine(a,i):"N"===d&&"S"===f&&(s=r.y+r.height>o.y?this.hMiddleLine(a,i):this.vMiddleLine(a,i))),e.d&&("N"===d?h.y-=e.d:"S"===d?h.y+=e.d:"E"===d?h.x+=e.d:"W"===d&&(h.x-=e.d)),t.d&&("N"===f?p.y-=t.d:"S"===f?p.y+=t.d:"E"===f?p.x+=t.d:"W"===f&&(p.x-=t.d)),s&&u.push(s);var v=zi(u);a&&i&&!ci(c,l)&&v.getAllEdges().forEach((function(e){var t=e.startVertex,n=e.endVertex,r={x1:t.x,y1:t.y,x2:n.x,y2:n.y};(xi(r,a)||xi(r,i))&&v.deleteEdge(e)}));var g,b=this.getExpandPoint(h,c,d)||h,x=this.getExpandPoint(p,l,f)||p,w=v.snap(b),k=v.snap(x);return w.from=h,k.from=p,(g=oi(w.x,k.x)&&oi(w.y,k.y)?[]:Gi(v,w,k,(function(e,t,r){return n.cost({vertex:e,start:t,end:r,middleLine:s})}))).unshift(h),g.push(p),this.dedupePoints(g)}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}()),Bs=function(e){S()(n,_s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"truncate",value:function(e){var t=this.line,n=t.tailOffset,r=t.tipOffset,o=Qn(e),a=o[o.length-1],i=o[o.length-2],c=o[0],l=o[1],u=di(i[1],i[2],a[1],a[2],r),s=di(l[1],l[2],c[1],c[2],n);return a[1]=u.x,a[2]=u.y,c[1]=s.x,c[2]=s.y,Gn(o)}},{key:"getPath",value:function(){return this.truncate(this._getPath())}},{key:"_getPath",value:function(){var e=this.line,t=e.source,n=e.target,r=e.diagram;if(!r)return"";var o=this.getPoints();if(e.controlPoints.length>0)return Gn(Vn(e.controlPoints,o,e.resizer.getElbowMergeSig()));var a=r.find(t.id),i=r.find(n.id),c=e.getEndpoint(t),l=e.getEndpoint(n);if(null!=a&&a===i&&ui(c.x,c.y,l.x,l.y)<8&&0!==e.controlPoints.length)return Gn([["M",(c=a.getPoint([1,.5])).x,c.y-8],["l",16,0],["l",0,16],["L",c.x,c.y+8]]);if(!c||!l)return Gn([["M",0,0],["L",50,0],["L",50,50]]);if(!a&&!i&&0===e.controlPoints.length){if(c.x===l.x)return"M".concat(c.x,",").concat(c.y," L").concat(l.x,",").concat(l.y);var u=.5*(c.x+l.x);return"M".concat(c.x,",").concat(c.y," L").concat(u,",").concat(c.y," L").concat(u,",").concat(l.y," L").concat(l.x,",").concat(l.y)}return $n(Ns.find(Ds(Ds({cell:a},o[0]),{},{d:0}),Ds(Ds({cell:i},o[1]),{},{d:0})))}}]),n}(),Is={none:function(){return{baseOffset:0,pc:0,path:[]}},"open-triangle":function(e){return{baseOffset:0,pc:1,fill:"none",path:[["M",-1*e,-1*e*Math.sin(ri(30))],["L",0,0],["L",-1*e,e*Math.sin(ri(30))]]}},"one-side-up":function(e){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*e,-1*e*Math.sin(ri(30))]]}},"one-side-down":function(e){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*e,e*Math.sin(ri(30))]]}},arrow:function(e){return{baseOffset:2*e*Math.cos(ri(20))-e,pc:1/(2*Math.sin(ri(20))),path:[["M",-e*Math.cos(ri(20)),-e*Math.sin(ri(20))],["A",e,e,20,0,1,-e*Math.cos(ri(20)),e*Math.sin(ri(20))],["L",0,0],["Z"]]}},"hollow-triangle":function(e){return{baseOffset:e,pc:1,fill:"white",path:[["M",0,0],["L",-1*e,-1*e*Math.sin(ri(30))],["L",-1*e,e*Math.sin(ri(30))],["Z"]]}},"sharp-solid-square":function(e){var t=e/=2,n=Math.tan(ri(60))*t;return{baseOffset:2*n,pc:1,path:[["M",0,0],["L",-n,-t],["L",-2*n,0],["L",-n,t],["Z"]]}},"sharp-hollow-square":function(e){var t=e/=2,n=Math.tan(ri(60))*t;return{baseOffset:2*n,pc:1,fill:"white",path:[["M",0,0],["L",-n,-t],["L",-2*n,0],["L",-n,t],["Z"]]}},"flat-solid-square":function(e){return{baseOffset:2*(e*=Math.tan(ri(30))),pc:.5,path:[["M",0,-1*e],["L",-2*e,-1*e],["L",-2*e,e],["L",0,e],["Z"]]}},"flat-hollow-square":function(e){return{baseOffset:2*(e*=Math.tan(ri(30))),pc:.5,fill:"white",path:[["M",0,-1*e],["L",-2*e,-1*e],["L",-2*e,e],["L",0,e],["Z"]]}},"solid-circle":function(e){return{baseOffset:2*(e*=Math.tan(ri(30))),pc:.5,path:Hn(-1*e,0,e)}},"hollow-circle":function(e){return{baseOffset:2*(e*=Math.tan(ri(30))),pc:.5,fill:"white",path:Hn(-e,0,e)}},"cross-circle":function(e){var t=-(e*=Math.tan(ri(30))),n=e;return{baseOffset:2*e,pc:.5,fill:"white",path:Hn(t,0,n)+Gn([["M",t,-n],["L",t,n],["M",-2*n,0],["L",0,0]])}},"half-open-circle":function(e){return{baseOffset:e*=Math.tan(ri(30)),pc:0,fill:"none",path:[["M",0,0],["m",0,-e],["A",e,e,0,1,0,0,e]]}},"end-vertical-line":function(e){return{baseOffset:0,pc:.5,fill:"none","stroke-linecap":"square",path:[["M",0,-(e*=Math.tan(ri(30)))],["L",0,e]]}},"middle-vertical-line":function(e){return{baseOffset:e/=1.5,pc:0,fill:"none",path:[["M",-1*e,2*-e/3],["L",-1*e,2*e/3],["M",-1*e,0],["L",0,0]]}},"double-vertical-line":function(e){var t=2*(e/=1.5)/3;return{baseOffset:2*e,pc:0,fill:"none",path:[["M",-2*e,-t],["L",-2*e,t],["M",-e,-t],["L",-e,t],["M",-2*e,0],["L",0,0]]}},"single-slash":function(e){return{baseOffset:e/=1.5,pc:0,path:[["M",0,0],["L",-e,0],["M",-(e+e*Math.cos(ri(60))),-e*Math.sin(ri(60))],["L",-(e-e*Math.cos(ri(60))),e*Math.sin(ri(60))]]}},"three-line":function(e){return{baseOffset:e,pc:0,fill:"none",path:[["M",-1*e,0],["L",0,0],["M",-1*e,0],["L",0,-1*Math.sin(ri(30))*e],["M",-1*e,0],["L",0,Math.sin(ri(30))*e]]}},"three-line-plus-vertical":function(e){var t=Math.sin(ri(30))*e;return{baseOffset:e,pc:0,fill:"none",path:[["M",-e,0],["L",0,0],["M",-e,0],["L",0,-t],["M",-e,0],["L",0,t],["M",-e,-t],["L",-e,t]]}},"three-line-plus-circle":function(e){var t=Math.sin(ri(30))*e,n=-e-t;return{baseOffset:e+2*t,pc:0,fill:"white",path:Gn([["M",-e,0],["L",0,0],["M",-e,0],["L",0,-t],["M",-e,0],["L",0,t]])+Hn(n,0,t)}},"circle-vertical":function(e){var t=.5*e,n=-(e+t);return{baseOffset:2*e,pc:0,fill:"white",path:Gn([["M",-t,-t],["L",-t,t],["M",0,0],["L",-e,-0]])+Hn(n,0,t)}}},Fs=["none","open-triangle","one-side-up","one-side-down","arrow","hollow-triangle","sharp-solid-square","sharp-hollow-square","flat-solid-square","flat-hollow-square","solid-circle","hollow-circle","cross-circle","half-open-circle","end-vertical-line","middle-vertical-line","double-vertical-line","single-slash","three-line","three-line-plus-vertical","three-line-plus-circle","circle-vertical"];var qs=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e,r){var o;return m()(this,n),(o=t.call(this,e)).type=r,c()(A()(o),"element",void 0),c()(A()(o),"group",void 0),c()(A()(o),"stencil",void 0),c()(A()(o),"sp",void 0),c()(A()(o),"ep",void 0),c()(A()(o),"cell",void 0),o.cell=e,o}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new no;n.update({"clip-path":"url(#".concat(e.clipPathID,")")}),this.group=n,t.add(this.group)}},{key:"createRendererElement",value:function(){var e=this.group,t=this.cell;if(t.isCacheStale("shape","roughFillStyle")){var n=new(t.getRoughGraphicOptions()?ta:ho)({"stroke-miterlimit":"10",roughFillStyle:"solid"});e.add(n),this.element&&this.element.remove(),this.element=n}}},{key:"getEndPointName",value:function(){var e=this.cell;return("tip"===this.type?e.target.marker:e.source.marker)||"none"}},{key:"getOhterEndPointName",value:function(){var e=this.cell;return("tail"===this.type?e.target.marker:e.source.marker)||"none"}},{key:"getRatio",value:function(){return 6+2*(this.cell.stroke.width-1)}},{key:"update",value:function(){var e=this.cell,t=this.type,n=this.getEndPointName(),r=this.getRatio();this.stencil=Is[n](r);var o=this.stencil,a=o.baseOffset,i=o.pc,c=Is[this.getOhterEndPointName()](r),l=c.baseOffset+c.pc,u=a+e.stroke.width*i;e["".concat(t,"Offset")]=u;var s=e.getPoints();if(Array.isArray(s)){var d=s.length,f=s[0],h=s[1];if("tip"===t&&(f=s[d-1],h=s[d-2]),f&&h){var p=ui(f,h),m=e.target.marker&&"none"!==e.target.marker&&e.source.marker&&"none"!==e.source.marker?40:20;if(p<=(m=Math.max(m,u+l+20))){var y=Jt(p/m*r,.01,r);this.stencil=Is[n](y);var v=this.stencil,g=v.baseOffset,b=v.pc;u=g+e.stroke.width*b}e["".concat(t,"Offset")]=u}}}},{key:"computeEndPoints",value:function(){this.update();var e,t,n,r,o=this.type,a=this.cell,i=a.d,c=a.shape,l=Qn(i),u=this.cell.getPoints();if("curve"===c){if(l.length<=1)return;if("tail"===o)e=u[0].x,t=u[0].y,n=l[1][1],r=l[1][2];else{var s=u.length;if(e=u[s-1].x,t=u[s-1].y,2===u.length)n=l[1][3],r=l[1][4];else if(3===u.length)n=l[1][1],r=l[1][2];else{var d=l.length-1;n=l[d][3],r=l[d][4]}}}else if("tail"===o)if("straight"===c)e=u[0].x,t=u[0].y,n=u[1].x,r=u[1].y;else{e=u[0].x,t=u[0].y;var f=b()(l[1],3);n=f[1],r=f[2]}else if("straight"===c){var h=u.length;e=u[h-1].x,t=u[h-1].y,n=u[h-2].x,r=u[h-2].y}else{e=u[u.length-1].x,t=u[u.length-1].y;var p=b()(l[l.length-2],3);n=p[1],r=p[2]}this.sp={x:n,y:r},this.ep={x:e,y:t}}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=this.type,r=e.stroke;if(this.computeEndPoints(),this.ep&&this.sp){var o=[1,0,0,0,1,0,-1*e.stroke.width*this.stencil.pc,0,1],a=[1,0,0,0,1,0,this.ep.x,this.ep.y,1],i=k.mat3.rotate([],[1,0,0,0,1,0,0,0,1],fi(this.sp.x,this.sp.y,this.ep.x,this.ep.y)),c=o;if("tail"===n){var l=e.source.marker;"one-side-up"!==l&&"one-side-down"!==l&&"single-slash"!==l||k.mat3.multiply(c,[1,0,0,0,-1,0,0,0,1],c)}k.mat3.multiply(c,i,c),k.mat3.multiply(c,a,c),t.update({stroke:r.color,d:this.stencil.path,"stroke-width":e.stroke.width,"stroke-linecap":this.stencil["stroke-linecap"]||"butt",fill:this.stencil.fill||r.color,matrix:c}),t.dataset({test_id:("tip"===n?e.target.marker:e.source.marker)||"none"})}}},{key:"destroy",value:function(){this.group.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();var zs=ho,Gs=Fo,Ys=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell.diagram.defs,t=new Gs({id:this.cell.clipPathID}),n=new zs({"clip-rule":"evenodd","fill-rule":"evenodd"});n.update({fill:"black",opacity:.1}),t.add(n),e.add(t),this.lineTextClipPath=n,this.clipPath=t}},{key:"draw",value:function(){var e=this.cell,t=this.lineTextClipPath,n=e.textarea,r=n.box,o=r.width,a=r.height,i=n.getPosition(),c=i.x,l=i.y,u=e.getBBox(),s=u.x,d=u.y,f=u.width,h=u.height;r.width>0?t.update({d:Jn(s-15,d-15,f+30,h+30)+Jn(c,l,o,a)}):t.update({d:Jn(s-15,d-15,f+30,h+30)})}},{key:"destroy",value:function(){this.lineTextClipPath.destroy(),this.clipPath.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();var Hs=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"group",new no),c()(A()(r),"element",void 0),c()(A()(r),"cell",void 0),r.cell=e,r}return v()(n,[{key:"render",value:function(){var e=ms({name:"path"});this.element=e,this.group.add(this.element),this.cell.graphicGroup.add(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){if("center"!==this.cell.textDirection){this.group.show();var e=this.cell.getPointByPercent(this.cell.textPosition);this.element.update({d:Hn(e.x,e.y,this.cell.stroke.width),fill:this.cell.stroke.color})}else this.group.hide()}},{key:"destroy",value:function(){var e;null===(e=this.group)||void 0===e||e.remove()}}]),n}();function Vs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Us(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vs(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ws(e){for(var t=[],n=1;n<e+1;n++)t.push(n);return t}function Xs(e,t,n){n=n||Ws(t);for(var r,o,a,i={},c=0;c<e.length;c++){for(o=r=e[c],a=1;!n.includes(o)&&a<100;)a%2==1?(o+=a)>t&&(o%=t):(o-=a)<1&&(o=t+o%t),a++;i[r]=o}return i}var Ks=function(e){var t=e.abstract,n=e.start,r=void 0===n?0:n,o=e.parent,a=e.direction;if(t&&o){var i=o.children,c=void 0===i?[]:i;if("timeline"===o.layout){var l=c[r].quadrantConstraint,u=(void 0===l?[]:l)[0],s=a[1];switch(u){case 1:case 2:return 0!==s&&(e.quadrantConstraint=[s>0?1:2]),{direction:[0,1],layout:"timeline"};case 3:case 4:return 0!==s&&(e.quadrantConstraint=[s>0?2:1]),{direction:[0,-1],layout:"timeline"};default:return}}if("indent"===o.layout){var d=o,f=d.directions,h=void 0===f?[]:f,p=d.layout,m=void 0===p?"":p,y=e.mergedQuadrant,v=void 0===y?0:y;return{direction:[Math.sign(h[v-1][0]),0],layout:m}}}},Zs=function(){function e(t){m()(this,e),c()(this,"algorithms",void 0),c()(this,"model",void 0),c()(this,"options",void 0),c()(this,"tree",void 0),c()(this,"trees",void 0),c()(this,"destroyed",void 0),c()(this,"beforeLayoutAdjust",void 0),c()(this,"afterLayoutAdjust",void 0),Object.assign(this,Us({algorithms:{},model:{}},t))}return v()(e,[{key:"buildTree",value:function(){var e=this.model,t=this.parse(e);t.x=void 0!==e.x?e.x:0,t.y=void 0!==e.y?e.y:0,t.layout=t.layout||"standard",this.tree=t}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.algorithms,o=Us(Us({w:10,h:10,quadrant:void 0,quadrantConstraint:void 0,direction:[1,0],collapsed:!1,layout:void 0},e),{},{origin:e,depth:n,children:[],parent:t,isAbstractUnderTimeline:!1,ax:0,ay:0,al:0,ad:"x",ap:1,quadrantTreeLists:[]});if(o.quadrant?o.quadrant=Number(o.quadrant):o.quadrant=1,e.children&&!e.collapsed)for(var a=0;a<e.children.length;a++){var i=e.children[a];o.children.push(this.parse.call(this,i,o,n+1))}return o.layout&&(o.algorithm=r[o.layout],this.calculateDQ(o)),o}},{key:"calculateDQ",value:function(e){e.quadrants=e.algorithm.constructor.QUADRANTS,e.directionAngles=function(e,t){for(var n=[],r=2*Math.PI/t,o=Oi(e,[1,0]),a=0;a<t;a++){var i=o+r*a;i=i>=2*Math.PI?i-2*Math.PI:i,n.push(i)}return n}(e.direction,e.quadrants),e.directions=e.directionAngles.map((function(e){return[Number(Math.cos(e).toFixed(3)),Number(Math.sin(e).toFixed(3))]})),e.quadrantRange=Ws(e.quadrants),e.childQuadrantRange=an(e.children.map((function(e){return e.quadrant}))),e.quadrantConstraint=e.quadrantConstraint||e.quadrantRange}},{key:"splitSubTrees",value:function(){var e=this.tree,t=[e];Xt(e,(function(e){e.layout&&(e.isSubTree=!0,e.x=0,e.y=0,e.tx=0,e.ty=0,t.unshift(e))})),this.trees=t}},{key:"firstMergeQuadrant",value:function(){var e=this;this.trees.forEach((function(t){e.mergeQuadrant(t,"mergedQuadrant")}))}},{key:"mergeQuadrant",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mergedQuadrant",r=e.quadrantConstraint,o=e.quadrants,a=Xs(e.childQuadrantRange,o,r);null===(t=e.children)||void 0===t||t.forEach((function(e){e[n]=a[e.quadrant]}))}},{key:"fixQuadrantConflict",value:function(){var e=this;this.trees.concat([]).reverse().forEach((function(t){if(t.parent){for(var n=t.quadrants,r=function(e){if(e.parent){var t=e,n=t.parent;if(e.abstract){var r=Ks(e);if(r)return r}for(;n&&!n.layout;)t=n,n=n.parent;var o=n,a=o.directions,i=void 0===a?[]:a,c=o.layout,l=void 0===c?"":c;return{direction:i[t.mergedQuadrant-1],layout:l}}}(t),o=[],a=0,i=function(){var n=t.quadrantRange,i=t.directions,c=void 0===i?[]:i;if(0===(o=n.filter((function(e,t){return Ta(c[t],r.direction)}))).length){var l=t.algorithm.constructor.VAILD_DIRECTION_ANGLES,u=Oi(r.direction,[1,0]);if(!l.some((function(e){return oi(e,u)})))return"break";e.forceUseUpDirection(t,r.direction)}a++};0===o.length&&a<10&&"break"!==i(););if(t.upDirection=r.direction,t.upLayoutType=r.layout,o.length>0){var c=Xs(t.quadrantConstraint,n,o);t.quadrantConstraint=Object.keys(c).map((function(e){return c[e]})),e.mergeQuadrant(t,"mergedQuadrant")}else delete t.layout,t.isSubTree=!1}}))}},{key:"forceUseUpDirection",value:function(e,t){e.direction=t,this.calculateDQ(e)}},{key:"filterSimilarSubTree",value:function(){this.trees.forEach((function(e){if(!e.parent)return!0;var t=e.quadrantConstraint,n=void 0===t?[]:t,r=e.upDirection,o=e.upLayoutType,a=e.directions,i=void 0===a?[]:a,c=e.layout;!e.abstract&&o===c&&1===n.length&&ai(r,i[n[0]-1])&&(e.isSubTree=!1)}))}},{key:"removeSubTree",value:function(){this.trees=this.trees.filter((function(e){var t=e.isSubTree;return!e.parent||t}))}},{key:"setUpAndDown",value:function(){var e=this,t=this.trees,n=this.tree;n.upDirection=n.directions[n.quadrantConstraint[0]-1],n.upLayoutType=n.layout,n.upSignX=Math.sign(n.upDirection[0]),n.upSignY=Math.sign(n.upDirection[1]),t.forEach((function(t){var n=e.splitTreeByQuadrant(t);(n=n.filter((function(e){return e.children&&e.children.length>0}))).forEach((function(t){e.setUp(t)})),t.quadrantTrees=n})),this.setDown(n)}},{key:"splitTreeByQuadrant",value:function(e){for(var t=e.quadrants,n=void 0===t?0:t,r=e.directionAngles,o=void 0===r?[]:r,a=e.directions,i=void 0===a?[]:a,c=e.children,l=void 0===c?[]:c,u=[],s=0;s<n;s++){var d=Us(Us({},e),{},{directionAngle:o[s],quadrantTreeDirection:i[s],children:[]});u.push(d),e.quadrantTreeLists.push([])}return l.forEach((function(t,n){var r;null===(r=u[t.mergedQuadrant-1].children)||void 0===r||r.push(t),t.abstract||e.quadrantTreeLists[t.mergedQuadrant-1].push(n)})),u.forEach((function(t){t.quadrantTreeLists=e.quadrantTreeLists})),u}},{key:"setUp",value:function(e){var t;null===(t=e.children)||void 0===t||t.forEach((function(t){Wt(t,(function(t){t.upDirection=e.quadrantTreeDirection;var n=t.abstract,r=t.parent;if(n&&r){var o=Ks(t);o&&(t.upDirection=o.direction)}t.upLayoutType=e.layout,t.upSignX=Math.sign(t.upDirection[0]),t.upSignY=Math.sign(t.upDirection[1])}),(function(e){if(!e.isSubTree)return e.children}))}))}},{key:"setDown",value:function(e){Wt(e,(function(e){e.isSubTree?(e.downDirection=e.directions[e.quadrantConstraint[0]-1],e.downLayoutType=e.layout):(e.downDirection=e.upDirection,e.downLayoutType=e.upLayoutType),e.downSignX=Math.sign(e.downDirection[0]),e.downSignY=Math.sign(e.downDirection[1])}))}},{key:"layout",value:function(){var e=this,t=this.trees,n=this.tree;t.forEach((function(t){var n=t.algorithm,r=t.quadrantTrees,o=[];(void 0===r?[]:r).forEach((function(e){n.layout(e,o)})),e.calculateSubTreeBBox(t),o.push(t),t.zNodes=o})),n.zNodes=function e(t){return t.reduce((function(t,n){return Array.isArray(n)?[].concat(T()(t),T()(e(n))):[].concat(T()(t),[n])}),[])}(n.zNodes)}},{key:"calculateSubTreeBBox",value:function(e){if(e.collapsed)return e.tx=e.x,e.ty=e.y,e.tw=e.w,void(e.th=e.h);var t=e.x,n=e.x+e.w,r=e.y,o=e.y+e.h;Xt(e,(function(e){var a,i,c,l;e.isSubTree?(a=e.tx,i=e.ty,c=e.tx+e.tw,l=e.ty+e.th):(a=e.x,i=e.y,c=e.x+e.w,l=e.y+e.h),a<t&&(t=a),i<r&&(r=i),c>n&&(n=c),l>o&&(o=l)}),(function(t){if(!t.isSubTree||t===e)return t.children})),e.tx=t,e.ty=r,e.tw=n-t,e.th=o-r}},{key:"execute",value:function(){return this.buildTree(),this.splitSubTrees(),this.firstMergeQuadrant(),this.fixQuadrantConflict(),this.filterSimilarSubTree(),this.removeSubTree(),this.setUpAndDown(),this.beforeLayoutAdjust&&this.beforeLayoutAdjust(this.tree),this.layout(),this.afterLayoutAdjust&&this.afterLayoutAdjust(this.tree),this.tree}},{key:"destroy",value:function(){var e=this;this.destroyed=!0,Object.keys(this).forEach((function(t){e[t]=void 0}))}}]),e}(),Qs=Object.freeze({__proto__:null,Event:fl,Layout:Zs,Comparator:Ti});var $s=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),Object.assign(A()(e),r);var o=A()(e),a=o.group,i=o.cell,c=["source","target"].map((function(e){return Ba(e)}));return c.forEach((function(e){return a.add(e.group)})),e.buttons=c,e.diagram=i.diagram,e.eventHelper=new fl,e.cellModel=null,e}return v()(n,[{key:"update",value:function(){var e=this.buttons,t=this.cell,n=this.diagram,r=this.group;if(r&&r.parent){var o=b()(e,2),a=o[0],i=o[1],c=t.getPoints(),l=c[0],u=c[c.length-1],s=1/n.viewport.zoom;a.group.update({scale:s,x:l.x,y:l.y}),i.group.update({scale:s,x:u.x,y:u.y})}}},{key:"bindEvent",value:function(){var e,t,n,r,o=this,a=this.buttons,i=this.cell,l=this.diagram,s=this.eventHelper,d=!0,f=function(){l.resetCursor(),e=void 0,t=void 0,n=void 0,r=void 0,d=!0,l.lineResizer.reset()};a.forEach((function(n){var a=n.name,c=n.group;s.bind(c,"mousedown",(function(){l.lineAlign.init(o.cell,a),e=a,t=xe()({connection:null,id:null},yn(i.model[e],{connection:!0,id:!0})),r=u()(i.controlPoints),l.emit("endpointcontrolpointmousedown"),l.lineResizer.init(o.cell,a)}))})),s.bind(l,"mousemove",(function(t){if("source"===e||"target"===e){d&&(d=!1,l.emit("endpointcontrolpointmousemovestart"));var a="source"===e?i.target:i.source,u=l.viewport.invertClient([t.clientX,t.clientY]);n=l.lineResizer.resize(t),a.id&&n.id===a.id&&null==a.connection&&null==n.connection&&r.length>0&&(n.id=null,n.connection=u),l.update(i,c()({},e,n)),o.update()}})),s.bind(l,"mouseup",(function(){var a,u,s;"source"!==e&&"target"!==e||("elbow"===i.shape?l.command.execute("Update",{id:i.model.id,model:(a={},c()(a,e,n),c()(a,"controlPoints",Ia(i,!0)),a),originModels:(u={},c()(u,e,t),c()(u,"controlPoints",r),u)}):l.command.execute("Update",{id:i.model.id,model:c()({},e,n),originModels:(s={},c()(s,e,t),c()(s,"controlPoints",r),s)}),o.emit("endpointControlMouseup"),f())})),s.bind(l,"keydown",(function(n){var r=o.cell,a=o.diagram;!e||"Esc"!==n.key&&"Escape"!==n.key||(a.update(r,c()({},e,t)),o.update(),f())})),s.bind(l,"afterviewportchange",Le()((function(){var e=o.buttons,t=o.cell;e&&t&&o.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null}}]),n}();var Js=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),Object.assign(A()(e),r);var o=A()(e).cell;return e.diagram=o.diagram,e.eventHelper=new fl,e.onMove=!1,e}return v()(n,[{key:"_refresh",value:function(){var e=this.group,t=this.cell,n=qa(t);e&&e.clear();var r=t.controlPoints.map((function(e,t){return Na(t,!1)})),o=n.map((function(e,t){return Na(t,!0)}));o.forEach((function(t){return e.add(t.group)})),r.forEach((function(t){return e.add(t.group)})),this.buttons=r,this.uiButtons=o,this.uiPoints=n}},{key:"update",value:function(){var e=this.cell;this._refresh();var t=this.buttons,n=this.diagram,r=this.group,o=this.uiButtons,a=this.uiPoints;if(r.parent)if(e.isLoop&&0===e.controlPoints.length)r.css({display:"none"});else{this.onMove?r.css({display:"none"}):r.css({display:""});var i=1/n.viewport.zoom;t.forEach((function(t){var n=t.group,r=t.index,o=e.getControlPointButtonPosition(r);n.update({scale:i,x:o[0],y:o[1]})})),o.forEach((function(e){var t=e.group,n=e.index;t.update({scale:i,x:a[n][0],y:a[n][1]})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,o=this,a=this.cell,i=this.diagram,c=this.eventHelper,l=this.group,s=!1,d={},f=!0,h=!1,p=function(){i.resetCursor(),e=void 0,t=void 0,n=void 0,s=!1,o.onMove=!1,r=void 0,d={},f=!0,h=!1};c.bind(i,"mousedown",(function(r){if("true"===(d=r.target&&r.target.dataset).isUIPoints&&"false"===d.isControlPoint){var c=Number(d.index);t=c,n={controlPoints:u()(a.controlPoints)},s=!0,h=!0}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var l=Number(d.index);e=l,n={controlPoints:u()(a.controlPoints)},s=!1,o.afterMove=!1,h=!0}i.emit("endpointcontrolpointmousedown")})),c.bind(i,"mousemove",(function(n){if(h&&f&&(i.emit("endpointcontrolpointmousemovestart"),f=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&s){var r=Number(d.index);t=r;var c=Fa({cell:a,uiPoints:o.uiPoints,uiPointIndex:t});i.update(a,{controlPoints:c}),e=r,s=!1}if(void 0!==e){var l=i.viewport.invertClient([n.clientX,n.clientY]),p=u()(a.controlPoints),m=p[[e]];void 0!==m&&(m[0]=l[0],m[1]=l[1]),i.update(a,{controlPoints:p}),o.onMove=!0}})),c.bind(i,"mouseup",(function(){if(void 0!==e)if(o.onMove){var c=u()(a.controlPoints);i.command.execute("Update",{id:a.model.id,model:{controlPoints:c},originModels:n,diagram:i}),l.css({display:""}),p()}else r=e,e=void 0;else void 0!==t&&p()})),c.bind(i,"dblclick",(function(){if(void 0!==r&&void 0===t){var e=u()(a.controlPoints);i.update(a,n),e.splice(r,1),i.command.execute("Update",{id:a.model.id,model:{controlPoints:e},diagram:i}),p()}})),c.bind(i,"keydown",(function(t){var r=o.cell,a=o.diagram;!e||"Esc"!==t.key&&"Escape"!==t.key||(a.update(r,n),o.update(),p())})),c.bind(i,"afterviewportchange",Le()((function(){var e=o.buttons,t=o.cell;e&&t&&o.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}();var ed=function(e){S()(n,I.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),c()(A()(e),"lastPoints",void 0),Object.assign(A()(e),r);var o=A()(e).cell;return e.diagram=o.diagram,e.eventHelper=new fl,e.onMove=!1,e.mergeSig=!1,e}return v()(n,[{key:"_refresh",value:function(){var e=this.group,t=this.cell,n=qa(t,this.mergeSig);e&&e.clear();var r=n.map((function(e,r){return 0===t.controlPoints.length||0===r||r===n.length-1?Na(r,!0,!0,e):Na(r,!1,!0,e)}));r.forEach((function(t){return e.add(t.group)})),this.uiButtons=r,this.uiPoints=n}},{key:"update",value:function(){var e=this.cell;Fe()(this.lastPoints,e.getPoints())||(this._refresh(),this.lastPoints=e.getPoints());var t=this.diagram,n=this.group,r=this.uiButtons,o=this.uiPoints;if(n.parent){this.onMove?n.css({display:"none"}):n.css({display:""});var a=e.getPoints(),i=a[0],c=a[a.length-1],l=1/t.viewport.zoom;r.forEach((function(e){var t=e.group,n=e.index;0===n?ui(i.x,i.y,o[n][0],o[n][1])<8.5&&t.css({display:"none"}):n===r.length-1&&ui(c.x,c.y,o[n][0],o[n][1])<8.5&&t.css({display:"none"}),t.update({scale:l,x:o[n][0],y:o[n][1]})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,o=this,a=this.cell,i=this.diagram,c=this.eventHelper,l=this.group,s=!1,d={},f=!0,h=!1,p=function(){i.resetCursor(),e=void 0,t=void 0,n=void 0,s=!1,o.onMove=!1,d={},o.mergeSig=!1,r=void 0,f=!0,h=!1};c.bind(i,"mousedown",(function(c){if(d=c.target&&c.target.dataset,r=[c.clientX,c.clientY],"true"===d.isUIPoints&&"false"===d.isControlPoint){var l=Number(d.index);t=l,n={controlPoints:0===a.controlPoints.length?null:u()(a.controlPoints)},s=!0,h=!0,t=void 0,i.setCursor(0===o.uiPoints[l][2]?"row-resize":"col-resize")}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var f=Number(d.index);e=0===f?0:f===o.uiPoints.length-1?a.controlPoints.length-1:f-1,n={controlPoints:u()(a.model.controlPoints)},s=!1,h=!0;var p=o.uiPoints[f];p&&i.setCursor("V"===p[p.length-1]?"row-resize":"col-resize")}i.emit("endpointcontrolpointmousedown")})),c.bind(i,"mousemove",(function(n){if(h&&f&&(i.emit("endpointcontrolpointmousemovestart"),f=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&s){var r=Number(d.index);t=r;var c=Fa({cell:a,uiPoints:o.uiPoints,uiPointIndex:t});i.update(a,{controlPoints:c}),e=0===r?0:r===o.uiPoints.length-1?a.controlPoints.length-1:r-1,s=!1,o.mergeSig=!0}if(void 0!==e){o.onMove=!0;var l=i.viewport.invertClient([n.clientX,n.clientY]),p=u()(a.controlPoints),m=p[e];void 0!==m&&("V"===m[m.length-1]?m[1]=l[1]:m[0]=l[0]),i.update(a,{controlPoints:p})}})),c.bind(i,"dblclick",(function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.dataset;"false"===n.isUIPoints&&"true"===n.isControlPoint&&1===a.controlPoints.length&&(i.command.execute("Update",{id:a.model.id,model:{controlPoints:[]}}),p())})),c.bind(i,"mouseup",(function(t){if(void 0!==e&&ui(r[0],r[1],t.clientX,t.clientY)>4){var o=Ia(a,!0);i.command.execute("Update",{id:a.model.id,model:{controlPoints:o},originModels:n,diagram:i}),l.css({display:""}),p()}else p()})),c.bind(i,"keydown",(function(t){var r=o.cell,a=o.diagram;!e||"Esc"!==t.key&&"Escape"!==t.key||(a.update(r,n),o.update(),p())})),c.bind(i,"afterviewportchange",Le()((function(){var e=o.uiButtons,t=o.cell;e&&t&&o.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}(),td=function(){function e(t){m()(this,e),this.cell=t,c()(this,"eventHelper",new fl),c()(this,"subResizers",void 0),c()(this,"lineControlPointResizer",void 0),c()(this,"lineEndpointResize",void 0),c()(this,"group",void 0),c()(this,"diagram",void 0),c()(this,"isBegin",void 0),this._init(t)}return v()(e,[{key:"update",value:function(){this.subResizers.forEach((function(e){return e.update()}))}},{key:"bindEvent",value:function(){var e=this,t=this.eventHelper,n=this.cell,r=n.diagram;t.bind(r,"endpointcontrolpointmousedown",(function(){"elbow"===n.shape&&(e.lineControlPointResizer.mergeSig=!0)})),t.bind(r,"endpointcontrolpointmousemovestart",(function(){e.group.hide()})),t.bind(r,"mouseup",(function(){"elbow"===n.shape&&(e.lineControlPointResizer.mergeSig=!1),e.group.show()}))}},{key:"begin",value:function(){var e=this.subResizers;this.diagram.frontRootGroup.add(this.group),e.forEach((function(e){return e.begin()})),this.isBegin=!0}},{key:"end",value:function(){var e=this.subResizers,t=this.group;e.forEach((function(e){return e.end()})),t&&t.remove(),this.isBegin=!1}},{key:"destroy",value:function(){this.group.remove(),this.subResizers.forEach((function(e){return e.destroy()})),this.isBegin=!1,this.eventHelper.destroy()}},{key:"renew",value:function(e){this.destroy(),this._init(e),this.begin()}},{key:"_init",value:function(e){var t=new no,n=[],r=new no,o=new $s({group:r,cell:e});t.add(r),n.push(o);var a,i=new no;a="elbow"===e.shape?new ed({group:i,cell:e}):new Js({group:i,cell:e}),t.add(i),n.push(a),this.cell=e,this.diagram=e.diagram,this.subResizers=n,this.group=t,this.lineEndpointResize=o,this.lineControlPointResizer=a,this.bindEvent()}},{key:"getElbowMergeSig",value:function(){return this.lineControlPointResizer.mergeSig}}]),e}();var nd=function(e){S()(n,_s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getPath",value:function(){var e=this.line,t=e.getPoints(),n=e.tipOffset,r=e.tailOffset,o=t[t.length-1],a=t[t.length-2],i=di(a.x,a.y,o.x,o.y,n),c=t[0],l=t[1],u=[di(l.x,l.y,c.x,c.y,r)];return 0===e.controlPoints.length?u.push(i):u=u.concat(e.controlPoints.map((function(e){var t=b()(e,2);return{x:t[0],y:t[1]}})).filter((function(e){return!isNaN(e.x)})),i),$n(u)}}]),n}();function rd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function od(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ad={"stroke-linejoin":"round"},id=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"element",void 0),c()(A()(e),"hitElement",void 0),e}return v()(n,[{key:"createRendererElement",value:function(){var e=this.cell,t=e.graphicGroup;if(!this.element||e.isCacheStale("shape","roughFillStyle")){var n=e.getRoughGraphicOptions(),r=new(n?ta:ho)(od(od({"clip-path":"url(#".concat(e.clipPathID,")")},n),ad)),o=new ho(ad);r.capture(!1),t.prepend(r),this.element&&this.element.remove(),this.hitElement&&this.hitElement.remove(),this.element=r,this.hitElement=o,e.wireElement=r,!o.parent&&t.insertAfter(o,r)}}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=this.hitElement,r=e.d,o=e.stroke,a={d:r};t.update(od(od({stroke:o.color,"stroke-width":o.width,fill:"none"},e.convertStrokeStyle()),a)),n.update({stroke:"rgba(255,255,255,0)","stroke-width":o.width+8,fill:"none",d:a.d})}},{key:"destroy",value:function(){this.element.destroy(),this.hitElement.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();function cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ld=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"clipPathID",Object(F.a)()),c()(A()(r),"tailOffset",0),c()(A()(r),"tipOffset",0),c()(A()(r),"shape",void 0),c()(A()(r),"shapes",void 0),c()(A()(r),"resizer",void 0),c()(A()(r),"textareaElement",void 0),c()(A()(r),"wireElement",void 0),c()(A()(r),"target",void 0),c()(A()(r),"source",void 0),c()(A()(r),"textPosition",void 0),c()(A()(r),"textDirection",void 0),c()(A()(r),"isLoop",void 0),c()(A()(r),"sourceCell",void 0),c()(A()(r),"targetCell",void 0),c()(A()(r),"controlPoints",void 0),c()(A()(r),"d",void 0),r}return v()(n,[{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.unshift(new qs(this,"tail")),this.subcells.unshift(new qs(this,"tip")),this.subcells.push(new Ys(this)),this.shapes={straight:new nd(this),curve:new Ms(this),elbow:new Bs(this)},this.render(),this.resizer=new td(this)}},{key:"canRough",value:function(){return!0}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.getShapeObj().getTextareaPosition(),n=this.getPercentPointSlope(this.textPosition),r=t.x-e.width/2,o=t.y-e.height/2;return"left"===this.textDirection?n>=0&&n<=15?o=t.y-e.height-5:15<n&&n<=75?(r=t.x+5,o=t.y-e.height-5):75<=n&&n<=105?r=t.x+5:105<n&&n<165?(r=t.x+5,o=t.y+5):165<=n&&n<=195?o=t.y+5:195<n&&n<=255?(r=t.x-5-e.width,o=t.y+5):255<=n&&n<=285?r=t.x-5-e.width:285<n&&n<345?(r=t.x-5-e.width,o=t.y-e.height-5):345<=n&&n<=360&&(o=t.y-e.height-5):"right"===this.textDirection&&(n>=0&&n<=15?o=t.y+5:15<n&&n<=75?(r=t.x-5-e.width,o=t.y+5):75<=n&&n<=105?r=t.x-5-e.width:105<n&&n<165?(r=t.x-5-e.width,o=t.y-e.height-5):165<=n&&n<=195?o=t.y-e.height-5:195<n&&n<=255?(r=t.x+5,o=t.y-e.height-5):255<=n&&n<=285?r=t.x+5:285<n&&n<345?(r=t.x+5,o=t.y+5):345<=n&&n<=360&&(o=t.y+5)),{x:r,y:o}}},{key:"getKeyShape",value:function(){return this.wireElement}},{key:"isConnected",value:function(){return this.target.id||this.source.id}},{key:"getPointBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.getPoints().forEach((function(o){e=Math.min(e,o.x),t=Math.min(t,o.y),n=Math.max(n,o.x),r=Math.max(r,o.y)})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=e.x,n=e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"canArrange",value:function(){var e=this;return["source","target"].every((function(t){var n=e[t];return!n.id&&Array.isArray(n.connection)}))}},{key:"isDrawable",value:function(){var e=this.diagram,t=this.target,n=this.source,r=e.find(n.id),o=n.id&&!r||r&&!1===r.state.visible,a=e.find(t.id),i=t.id&&!a||a&&!1===a.state.visible;return!(o||i)}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets.find((function(e){return"self"===e.query}));this.diagram.contentEditor.isBegin&&this.diagram.contentEditor.dom===this.textareaElement.htmlContainer?(e.css["min-width"]="12px",e.css["min-height"]="24px"):(e.css["min-width"]=0,e.css["min-height"]=0)}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()}},{key:"canFill",value:function(){return!1}},{key:"beginEditContent",value:function(){this.textareaElement.css({outline:"1px solid #096DD9"})}},{key:"endEditContent",value:function(){this.textareaElement.css({outline:"none"})}},{key:"getPointByPercent",value:function(e){var t=this.wireElement,n=t.getTotalLength();return t.getPointAtLength(e*n)}},{key:"getPercentPointSlope",value:function(e){var t=this.getTwoPointsByPercent(e),n=b()(t,2),r=n[0],o=n[1];return ni(fi(r.x,r.y,o.x,o.y))}},{key:"getTwoPointsByPercent",value:function(e){var t=this.wireElement,n=t.getTotalLength(),r=n*e;return[t.getPointAtLength(Jt(r-1,0,n)),t.getPointAtLength(Jt(r+1,0,n))]}},{key:"getPadding",value:function(){return[0,0,0,0]}},{key:"getEndpoint",value:function(e){var t=this.diagram,n=e.id,r=e.connection,o=t.find(n);if(o)return r?o.getPoint(r):o.getPoint([.5,.5]);if(Array.isArray(r)){var a=b()(r,2);return{x:a[0],y:a[1]}}return r}},{key:"getAlignBBox",value:function(){var e=this.wireElement.rendererElement.getBBox();return{x:e.x,y:e.y,width:e.width,height:e.height,minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}}},{key:"getBBox",value:function(){var e=this.graphicGroup.rendererElement.getBBox();return{x:e.x,y:e.y,width:e.width,height:e.height,minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}}},{key:"getShapeObj",value:function(){var e=this.shape;return this.shapes[e]}},{key:"getFirstInsertControlPoints",value:function(){return this.getShapeObj().getFirstInsertControlPoints()}},{key:"getControlPointButtonPosition",value:function(e){return this.getShapeObj().getControlPointButtonPosition(e)}},{key:"getPath",value:function(){var e=this.shape,t=this.sourceCell,n=this.isLoop,r=this.getShapeObj();if(n&&0===this.controlPoints.length){var o=null==t?void 0:t.getPoint([1,.5]);return Gn([["M",o.x,o.y-8],["l",16,-4],["l",0,24],["L",o.x,o.y+8]])}if(r)return r.getPath();throw new Error("unsupported line shape ".concat(e))}},{key:"updatePath",value:function(){this.isCacheStale("shape","source","target","controlPoints")&&(this.d=this.getPath())}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.renderModel(e)}},{key:"renderModel",value:function(e){N()(M()(n.prototype),"updateModel",this).call(this,e),this.subcells.forEach((function(e){e.update()}))}},{key:"_updateResizer",value:function(){var e=this.diagram;this.resizer&&this.resizer.update(),1===e.selector.selections.length&&e.selector.selections[0]===this||this.resizer.end()}},{key:"updateModel",value:function(e){var t=!1;void 0!==e.shape&&e.shape!==this.shape&&(e.controlPoints=null,t=!0),N()(M()(n.prototype),"updateModel",this).call(this,e),t&&(this.updatePoints(),this.resizer&&this.resizer.renew(this)),this.subcells.forEach((function(e){e.update()}))}},{key:"draw",value:function(){if(this.isDrawable()){var e=this.source,t=this.target,n=this.diagram,r=n.find(e.id),o=n.find(t.id);this.isLoop=null!=r&&r===o,this.sourceCell=r,this.targetCell=o,this.show(),this.updatePoints(),this.updatePath(),this.subcells.forEach((function(e){return e.draw()})),this.drawPosition(),this.graphicGroup.attr({opacity:this.opacity}),this._updateResizer()}else this.hide();this.updateCache()}},{key:"updatePoints",value:function(){this.getShapeObj().updatePoints()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["shape","source","target","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t}),this.resizer.update()}}},{key:"getPoints",value:function(){return this.shapes[this.shape].getPoints()}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"destroy",value:function(){this.subcells.forEach((function(e){return e.destroy()})),this.resizer.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","font-family":'PingFangSC-Regular, "PingFang SC", sans-serif',"line-height":"1.74","word-break":"break-word","box-sizing":"border-box"}}],shape:"straight",stroke:{color:"#595959",width:2},textPosition:.5,textDirection:"center",html:'<div style="text-align: center;">'.concat("&#8203;","</div>"),source:{},target:{},controlPoints:[],opacity:1,Subcells:[id,Hs,es],penetratedKeys:["source","target","stroke","fill","html","shape","controlPoints","opacity","textPosition","textDirection"],isLine:!0,isLoop:!1})}}]),n}();c()(ld,"className","LineCell"),c()(ld,"Shapes",{});var ud=function(e){S()(n,ks);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"textarea",void 0),e}return v()(n,[{key:"getTextareaPosition",value:function(e){var t=this.textareaRegion,n=this.textVerticalAlign,r={x:t.minX,y:0};return r.y="top"===n?t.minY:"bottom"===n?t.maxY-e.height:(t.minY+t.maxY-e.height)/2,r}},{key:"canRough",value:function(){return!0}},{key:"getRoughGraphicOptions",value:function(){}},{key:"_updateSize",value:function(){var e=this.subcells.find((function(e){return e instanceof es})),t=this.getPadding();e.update();var n=e.getBBox();n&&(this.width="number"!=typeof this.model.width?n.width+t[1]+t[3]:this.width,this.height="number"!=typeof this.model.height?n.height+t[1]+t[3]:this.height)}},{key:"_updateTextareaRegion",value:function(){var e=this.width,t=this.height;this.textareaRegion={minX:4,minY:4,maxX:e-4,maxY:t-4}}},{key:"afterUpdateModel",value:function(){this._updateSize(),this._updateTextareaRegion(),N()(M()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return ms({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape")){var t=this.width/120,n=this.height/60;return e.getPath(t,n)}return null}},{key:"getPadding",value:function(){return[4,4,4,4]}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},shape:"text",stroke:{width:1},isText:!0,Subcells:[es],penetratedKeys:["textVerticalAlign"]})}}]),n}();c()(ud,"className","TextCell");var sd=new Map;sd.set(0,new Map([["tc",2],["rc",0],["bc",0],["lc",1],["tl",2],["tr",3],["br",0],["bl",1]]));var dd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"tolerance",5),c()(this,"lengthTolerance",10),c()(this,"bleed",10),c()(this,"toAlignPointSets",[]),c()(this,"toAlignLengths",[]),c()(this,"toAlignDistributes",[]),c()(this,"refLines",[]),c()(this,"widthLines",[]),c()(this,"heightLines",[]),c()(this,"distributeWLines",[]),c()(this,"distributeHLines",[]),c()(this,"showLine",!0),c()(this,"refLinesGroup",void 0),c()(this,"startBox",void 0),c()(this,"preventAlignX",!1),c()(this,"preventAlignY",!1),c()(this,"alignRst",{dx:0,dy:0}),this.diagram=t,this.refLinesGroup=new no,t.frontRootGroup.add(this.refLinesGroup)}return v()(e,[{key:"getPointsByBox",value:function(e){var t={x:e.maxX,y:e.minY,weight:0,box:e},n={x:e.minX,y:e.maxY,weight:0,box:e};return[{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2,weight:1,box:e},t,n]}},{key:"getPointsByPoint",value:function(e){return[e]}},{key:"getPointsByCell",value:function(e){var t=e.getBBox();return this.getPointsByBox(t)}},{key:"drawRefLines",value:function(){var e=this.refLines,t=this.refLinesGroup,n=1/this.diagram.viewport.zoom;e.forEach((function(e){var r=e.x1,o=e.y1,a=e.x2,i=e.y2;t.add(new ho({d:"M".concat(r,",").concat(o," L").concat(a,",").concat(i),stroke:"#1672F3","stroke-width":n}))}))}},{key:"drawDistributeLines",value:function(){var e=this.refLinesGroup,t=1/this.diagram.viewport.zoom,n=3/this.diagram.viewport.zoom,r=1.5/this.diagram.viewport.zoom;this.distributeWLines.forEach((function(o){var a=b()(o,5),i=a[0],c=a[1],l=a[2],u=a[3],s=a[4];i+=r,c-=r,l+=r,u-=r;var d=s-n,f=s+n;e.add(new ho({d:"M".concat(i,",").concat(s," L").concat(c,",").concat(s," M").concat(i,",").concat(d," L").concat(i,",").concat(f," M").concat(c,",").concat(d," L").concat(c,",").concat(f),stroke:"#1672F3","stroke-width":t})),e.add(new ho({d:"M".concat(l,",").concat(s," L").concat(u,",").concat(s," M").concat(l,",").concat(d," L").concat(l,",").concat(f," M").concat(u,",").concat(d," L").concat(u,",").concat(f),stroke:"#1672F3","stroke-width":t}))})),this.distributeHLines.forEach((function(o){var a=b()(o,5),i=a[0],c=a[1],l=a[2],u=a[3],s=a[4];i+=r,c-=r,l+=r,u-=r;var d=s-n,f=s+n;e.add(new ho({d:"M".concat(s,",").concat(i," L").concat(s,",").concat(c," M").concat(d,",").concat(i," L").concat(f,",").concat(i," M").concat(d,",").concat(c," L").concat(f,",").concat(c),stroke:"#1672F3","stroke-width":t})),e.add(new ho({d:"M".concat(s,",").concat(l," L").concat(s,",").concat(u," M").concat(d,",").concat(l," L").concat(f,",").concat(l," M").concat(d,",").concat(u," L").concat(f,",").concat(u),stroke:"#1672F3","stroke-width":t}))}))}},{key:"drawRefLengths",value:function(){var e=this.refLinesGroup,t=1/this.diagram.viewport.zoom,n=5/this.diagram.viewport.zoom,r=15/this.diagram.viewport.zoom;this.widthLines.forEach((function(o){var a=o.x1,i=o.y1,c=o.x2,l=o.y2;i-=r,l-=r,e.add(new ho({d:"M".concat(a,",").concat(i," L").concat(c,",").concat(l," M").concat(a,",").concat(i-n," L").concat(a,",").concat(i+n," M").concat(c,",").concat(l-n," L").concat(c,",").concat(l+n),stroke:"#1672F3","stroke-width":t}))})),this.heightLines.forEach((function(o){var a=o.x1,i=o.y1,c=o.x2,l=o.y2;a-=r,c-=r,e.add(new ho({d:"M".concat(a,",").concat(i," L").concat(c,",").concat(l," M").concat(a-n,",").concat(i," L").concat(a+n,",").concat(i," M").concat(c-n,",").concat(l," L").concat(c+n,",").concat(l),stroke:"#1672F3","stroke-width":t}))}))}},{key:"prepareForDistribute",value:function(e){var t=this.diagram,n=t.viewport.getViewportCanvasBox(),r=Ar(e),o=t.groupManager.getCells().filter((function(t){if(!t.isStem||ur(t)||e.includes(t))return!1;var o=t.getBBox();return!ii(o,r)&&ci(o,n)}));this.toAlignDistributes=o.map((function(e){return e.getBBox()}))}},{key:"prepareForLength",value:function(e){this.startBox=e.getBBox();var t=this.diagram,n=t.viewport.getViewportCanvasBox(),r=t.groupManager.getCells().filter((function(t){return!(!t.isStem||ur(t)||t===e)&&ci(t.getBBox(),n)}));this.toAlignLengths=r.map((function(e){return e.getBBox()}))}},{key:"updateToAlignPointSet",value:function(e){this.toAlignPointSets=e}},{key:"updateToAlginPoints",value:function(e){var t=this,n=[];Array.isArray(e)?n=e:e&&(n=[e]);var r=this.diagram,o=r.paper,a=r.viewport.getViewportCanvasBox(),i=r.groupManager.getCells().filter((function(e){if("line"===e.model.type)return!1;for(var t=0;t<n.length;t++){var r=n[t];if(e.stem===r.stem)return!1}return ci(e.getBBox(),a)})),c=[];if(i.forEach((function(e){c.push(t.getPointsByCell(e))})),o.visible){var l=o.getBBox();c.push(this.getPointsByBox({minX:l.left,minY:l.top,maxX:l.right,maxY:l.bottom}))}this.toAlignPointSets=c}},{key:"alignDistribute",value:function(e){var t=this,n=5/this.diagram.viewport.zoom,r={dx:0,dy:0};if(0===this.toAlignDistributes.length)return r;var o=[],a=[];this.toAlignDistributes.forEach((function(n){t.isIntersectVericallly(n,e)&&o.push(n),t.isIntersectHorizontally(n,e)&&a.push(n)}));var i=1/0,c=1/0,l=1/0,u=1/0,s=(e.minX+e.maxX)/2,d=(e.minY+e.maxY)/2;if(this.distributeWLines=[],this.distributeHLines=[],0===this.alignRst.dx)for(var f=0;f<o.length;f++)for(var h=f+1;h<o.length;h++){var p=o[f],m=o[h],y=m,v=p;if(p.maxX<m.minX&&(y=p,v=m),this.horizontalDistance(p,m)>this.regionWidth(e)&&this.isIntersectVericallly(p,m)){var g=(y.maxX+v.minX)/2;if((c=Math.abs(s-g))<=n&&c<i){i=c,r.dx=g-s,this.distributeWLines=[[y.maxX,e.minX+r.dx,e.maxX+r.dx,v.minX,0]];var b=[y.minY,y.maxY,v.minY,v.maxY];b.sort((function(e,t){return e-t}));var x=(b[1]+b[2])/2;this.distributeWLines[0][4]=x}}}if(0===this.alignRst.dy)for(var w=0;w<a.length;w++)for(var k=w+1;k<a.length;k++){var E=a[w],O=a[k],C=O,A=E;if(E.minY<O.minY&&(C=E,A=O),this.verticalDistance(E,O)>this.regionHeight(e)&&this.isIntersectHorizontally(E,O)){var P=(C.maxY+A.minY)/2;if((u=Math.abs(d-P))<=n&&u<l){l=u,r.dy=P-d,this.distributeHLines=[[C.maxY,e.minY+r.dy,e.maxY+r.dy,A.minY,0]];var S=[C.minX,C.maxX,A.minX,A.maxX];S.sort((function(e,t){return e-t}));var j=(S[1]+S[2])/2;this.distributeHLines[0][4]=j}}}return this.draw(),r}},{key:"regionWidth",value:function(e){return e.maxX-e.minX}},{key:"regionHeight",value:function(e){return e.maxY-e.minY}},{key:"isIntersectVericallly",value:function(e,t){return!(e.maxY<t.minY||e.minY>t.maxY)}},{key:"isIntersectHorizontally",value:function(e,t){return!(e.maxX<t.minX||e.minX>t.maxX)}},{key:"horizontalDistance",value:function(e,t){return Math.min(Math.abs(e.minX-t.maxX),Math.abs(e.maxX-t.minX))}},{key:"verticalDistance",value:function(e,t){return Math.min(Math.abs(e.minY-t.maxY),Math.abs(e.maxY-t.minY))}},{key:"alignByLength",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===ti(e.r)){var o,a,i=this.diagram,c=this.toAlignLengths,l=this.lengthTolerance/i.viewport.zoom;this.widthLines=[],this.heightLines=[];var u=1/0,s=1/0;c.forEach((function(t){var r=Math.abs(t.width-e.w),i=Math.abs(t.height-e.h);n.preventAlignX||r<=l&&(oi(r,u)?n.widthLines.push({x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y}):r<u&&(u=r,o=t.width,n.widthLines=[{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y}])),n.preventAlignY||i<=l&&(oi(i,s)?n.heightLines.push({x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height}):i<s&&(s=i,a=t.height,n.heightLines=[{x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height}]))})),this.adjustRect(e,o,a,t,r),this.addItselfRefLengths(e),this.draw()}}},{key:"addItselfRefLengths",value:function(e){var t=Cr(e);this.widthLines.length>0&&!this.preventAlignX&&this.widthLines.push({x1:t.minX,y1:t.minY,x2:t.maxX,y2:t.minY}),this.heightLines.length>0&&!this.preventAlignY&&this.heightLines.push({x1:t.minX,y1:t.minY,x2:t.minX,y2:t.maxY})}},{key:"adjustRect",value:function(e,t,n,r,o){var a,i=this.startBox;t=t||e.w,n=n||e.h,o&&(n=e.h*t/e.w);var c=Cr(e);switch(null===(a=sd.get(e.r))||void 0===a?void 0:a.get(r)){case 0:oi(c.minX,i.minX)||(e.x=i.minX-t),oi(c.minY,i.minY)||(e.y=i.minY-n);break;case 1:oi(c.maxX,i.maxX)&&(e.x=i.maxX-t),oi(c.minY,i.minY)||(e.y=i.minY-n);break;case 2:oi(c.maxX,i.maxX)&&(e.x=i.maxX-t),oi(c.maxY,i.maxY)&&(e.y=i.maxY-n);break;case 3:oi(c.minX,i.minX)||(e.x=i.minX-t),oi(c.maxY,i.maxY)&&(e.y=i.maxY-n)}e.w=t,e.h=n}},{key:"alignByPoint",value:function(e){return this.align("Point",e)}},{key:"alignByBox",value:function(e){return this.align("Box",e)}},{key:"align",value:function(e,t){var n,r=this,o=this.bleed,a=this.showLine,i=this.toAlignPointSets,c=this.diagram,l=this.preventAlignX,u=this.preventAlignY,s={dx:0,dy:0},d=this.tolerance/c.viewport.zoom;if(0===i.length)return s;"Point"===e?(n=this.getPointsByPoint(t))[1]=n[2]=n[0]:n=this.getPointsByBox(t);var f=[];return this.refLines=[],n.forEach((function(e,t){i.forEach((function(n){if(0===t)f.push(r.computeDis(e,n[0]));else for(var o=1;o<n.length;++o)f.push(r.computeDis(e,n[o]))}))})),l||(f.sort((function(e,t){return e.hDis-t.hDis})),[f[0]].forEach((function(e){e.hDis<d&&(s.dx=e.dx,r.refLines.push({x1:e.to.x,x2:e.to.x,y1:Math.min(e.to.box.minY,e.from.box.minY)-o,y2:Math.max(e.to.box.maxY,e.from.box.maxY)+o}))}))),u||(f.sort((function(e,t){return e.vDis-t.vDis})),[f[0]].forEach((function(e){e.vDis<d&&(s.dy=e.dy,r.refLines.push({x1:Math.min(e.to.box.minX,e.from.box.minX)-o,x2:Math.max(e.to.box.maxX,e.from.box.maxX)+o,y1:e.to.y,y2:e.to.y}))}))),a&&this.draw(),this.alignRst=s,s}},{key:"computeDis",value:function(e,t){var n=t.x-e.x,r=t.y-e.y;return{from:e,to:t,weight:e.weight+t.weight,dx:n,dy:r,hDis:Math.abs(n),vDis:Math.abs(r)}}},{key:"draw",value:function(){this.refLinesGroup.clear(),this.drawRefLengths(),this.drawDistributeLines(),0===this.widthLines.length&&0===this.heightLines.length&&this.drawRefLines()}},{key:"clear",value:function(){this.refLines=[],this.widthLines=[],this.heightLines=[],this.distributeWLines=[],this.distributeHLines=[],this.toAlignPointSets=[],this.refLinesGroup.clear()}},{key:"reset",value:function(){this.alignRst={dx:0,dy:0},this.clear(),this.preventAlignX=!1,this.preventAlignY=!1}},{key:"destroy",value:function(){}}]),e}();function fd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(dd,"className","Align");var pd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"startTime",void 0),c()(this,"tmpTargetCell",void 0),c()(this,"lastTmpTargetCell",void 0),c()(this,"sourceCell",void 0),c()(this,"targetCell",void 0),c()(this,"group",new no),c()(this,"anchors",void 0),c()(this,"cacheDockCell",void 0),c()(this,"cachePath",new Map),c()(this,"getInnerConnection",(function(e,t){var n=t.canvas2percentage({x:e[0],y:e[1]});return{id:t.model.id,connection:n}})),t.frontRootGroup.prepend(this.group),this.anchors=[]}return v()(e,[{key:"getConnectableCells",value:function(e){return this.diagram.getCellsByZIndex().filter((function(t){var n,r,o,a;return t.canConnect()&&(!e||(r=e,!(ii(o=t.getBBox(),a=r.getBBox())||ii(a,o))))&&(null==e||null===(n=e.model)||void 0===n?void 0:n.id)!==t.model.id}))}},{key:"isPointInPath",value:function(e,t){return Array.isArray(e)&&(e={x:e[0],y:e[1]}),wr(t)?t.isPointInFill(e):t.isPointInFill(e)&&!t.isPointInStroke(e)}},{key:"init",value:function(e,t){var n=e[t],r=e.getEndpoint(n),o="source"===t?e.target:e.source;if(this.sourceCell=this.diagram.find(o.id),!this.targetCell)for(var a=this.getConnectableCells(this.sourceCell),i=a.length-1;i>=0;i--){var c=a[i];if(this.isPointInPath(r,c))return void(this.targetCell=c)}}},{key:"isPointNearCell",value:function(e,t){t=za(t);var n=e.canvas2Relative(t),r=e.width,o=e.height,a=8;return Er(e)&&(a=24),!(n.x<-a||n.x>r+a||n.y<-a||n.y>o+a)}},{key:"findEndPoint",value:function(e){for(var t,n=this.getConnectableCells(this.sourceCell),r=n.length-1;r>=0;r--){var o=n[r];if(this.isPointNearCell(o,e)){this.dock(o);var a=this.getConnection(o,e);if(a){if(this.lastTmpTargetCell=this.tmpTargetCell,this.tmpTargetCell=o,a===o){t={id:o.model.id,connection:null};break}t={id:o.model.id,connection:a};break}}}if(this.cacheDockCell&&!this.isPointNearCell(this.cacheDockCell,e)&&this.clearDock(),!t&&this.tmpTargetCell&&(this.tmpTargetCell=void 0,this.startTime=void 0),this.tmpTargetCell&&this.tmpTargetCell!==this.targetCell&&(this.targetCell=void 0),this.targetCell){if(this.isPointInPath(e,this.targetCell))return this.getInnerConnection(e,this.targetCell);this.startTime=void 0,this.targetCell=void 0}return this.tmpTargetCell&&this.lastTmpTargetCell===this.tmpTargetCell&&this.isPointInPath(e,this.tmpTargetCell)&&(this.startTime||(this.startTime=Date.now()),Date.now()-this.startTime>=1500)?(this.targetCell=this.tmpTargetCell,this.tmpTargetCell=void 0,this.startTime=void 0,this.getInnerConnection(e,this.targetCell)):t||{id:null,connection:e}}},{key:"getCellConnectStateElement",value:function(e){if(Er(e)){var t;if(this.cachePath.has(e.model.id))t=this.cachePath.get(e.model.id);else{var n=e.getKeyShapeBox();t=new ho({d:Jn(n.x,n.y,n.width,n.height),stroke:"#3384F5",fill:"transparent","stroke-width":2}),this.cachePath.set(e.model.id,t)}return t}var r=new ho({"stroke-width":1,stroke:"#3384F5",fill:"rgba(192,217,252,0.2)"});r.dataset({testid:"connect_dock_line"});var o=e.getKeyShape(),a=T()(e.matrix),i=o.attr("d");return r.update({matrix:a,d:i}),r}},{key:"dock",value:function(e){var t,n=this;if(this.cacheDockCell!==e){this.clearDock(),this.cacheDockCell=e,this.group.add(this.getCellConnectStateElement(e));var r,o=1/this.diagram.viewport.zoom;r=null!==(t=e.stencil)&&void 0!==t&&t.antiAnchors?e.stencil.antiAnchors:e.anchors;var a=0;mr(e)||(a=e.rotate/360*2*Math.PI),r.forEach((function(t){var r,i=n.createAnchor(t.name);n.group.add(i.group);var c,l,u=e.percentage2Canvas(t);!1===(null===(r=e.stencil)||void 0===r?void 0:r.closed)||e.isPointInStroke(u)||Er(e)?(c=u,l=[t.x,t.y]):(c=e.getIntersectionPoint(u),l=e.canvas2percentage(c)),i.group.update(hd(hd({},c),{},{scale:o,rotate:a})),n.anchors.push({x:l[0],y:l[1],shape:i.shape})}))}}},{key:"clearDock",value:function(){this.cacheDockCell=void 0,this.group.clear(),this.anchors=[]}},{key:"getConnection",value:function(e,t){for(var n=e.canvas2Relative({x:t[0],y:t[1]}),r=n.x,o=n.y,a=e.width,i=e.height,c=[r,o],l=Er(e)?24:8,u=0;u<this.anchors.length;u++){var s=this.anchors[u],d=[s.x*a,s.y*i];if(ui(c[0],c[1],d[0],d[1])<=l)return[Jt(s.x,0,1),Jt(s.y,0,1)]}var f,h=e.getKeyShape();if(Er(e)){if(f=Qa(this.cachePath.get(e.model.id),t,8)){var p=e.canvas2percentage(f);return[Jt(p[0],0,1),Jt(p[1],0,1)]}}else if(f=Qa(h,[r,o],8))return[Jt(f[0]/a,0,1),Jt(f[1]/i,0,1)];var m=Ya({x:r,y:o});if(wr(e)){if(e.isPointInFill(za(t)))return e}else if(Er(e)){if(h.isPointInFill(Ya({x:t[0],y:t[1]})))return e}else if(h.isPointInFill(m))return e}},{key:"createAnchor",value:function(e){var t=new io,n=new ho({d:Hn(0,0,3),stroke:"#3384F5",fill:"white"});return t.add(n),{group:t,shape:n,name:e}}},{key:"reset",value:function(){this.clearDock(),this.cachePath.clear(),this.tmpTargetCell=void 0,this.startTime=void 0,this.sourceCell=void 0}},{key:"destroy",value:function(){}}]),e}();c()(pd,"className","Connect");var md=new jo;md.css({fontFamily:"system-ui"});var yd=function(){function e(t){m()(this,e),this.diagram=t,this.diagram.canvas.calculateCanvas.appendChild(md.rendererElement)}return v()(e,[{key:"measureTextLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fontSize:"12px"};return md.update({text:e}),md.css({fontSize:t.fontSize}),md.getBBox().width}},{key:"destroy",value:function(){}}]),e}();c()(yd,"className","Font");var vd=function(){function e(t){m()(this,e),this.diagram=t,this.group=null}return v()(e,[{key:"getStemsByZIndex",value:function(){var e,t=this.diagram,n=this.group;return(e=n?n.getChildren():t.getCells().filter((function(e){return e.isRoot}))).sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e}},{key:"_getGroupCells",value:function(e){var t=[];return e.deepEachWithoutSelf((function(e){if(e.isGroup)return t.push(e),!1;t.push(e)})),t}},{key:"getCells",value:function(){var e=this.diagram,t=this.group;return t?this._getGroupCells(t):e.getCells().filter((function(e){return e.isRoot})).reduce((function(e,t){return t.isStem&&!t.isGroup?t.deepEach((function(t){e.push(t)})):e.push(t),e}),[])}},{key:"enter",value:function(e,t){this.group&&this.exit();var n,r=this.diagram,o=r.getCells(),a=e.getChildren();return a.forEach((function(e){if(e.isStem&&!e.isGroup)e.deepEach((function(e){if(e.isPointInShape(t))return n=e,!1}));else if(e.isPointInShape(t))return n=e,!1})),n?(o.forEach((function(e){a.includes(e.stem)?e.capture(!0):e.capture(!1)})),e.state.actived=!0,this.group=e,r.emit("afteractivedgroupchange"),n):null}},{key:"exit",value:function(){var e=this.group,t=this.diagram;if(e){for(var n=t.getCells(),r=e;r;)r.isGroup&&r.show(),r=r.parent;n.forEach((function(e){return e.capture(!0)})),e.state.actived=!1}this.group=null,t.emit("afteractivedgroupchange")}},{key:"destroy",value:function(){this.destroyed=!0,this.group=null}}]),e}();c()(vd,"className","GroupManager");var gd=function(e,t,n){var r,o,a,i=new Mn(t);if(void 0!==e.width||void 0!==e.height)r=i.tl,e=Object.assign({},{x:t.x,y:t.y,width:t.w,height:t.h},e),o=[e.width/t.w,e.height/t.h],a=function(e){return[(e[0]-r.x)*o[0]+r.x,(e[1]-r.y)*o[1]+r.y]};else if(void 0!==e.x||void 0!==e.y){var c=i.tl,l=[(e=Object.assign({},{x:t.x,y:t.y,width:t.w,height:t.h},e)).x-c.x,e.y-c.y];o=[1,1],a=function(e){return[e[0]+l[0],e[1]+l[1]]}}return n.map((function(e){var t=e.type;if("line"===t||"points"===t)return{type:t,points:e.points.map((function(e){return a(e)}))};var n=a([e.x,e.y]),r=b()(n,2);return{x:r[0],y:r[1],w:e.w*o[0],h:e.h*o[1],r:e.r,type:t}}))};function bd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wd={lake_prevent_click_unselect:!0,group_resize_controller:!0},kd=function e(t){var n=t.type;if("group"===n){var r=[],o=[],a=[];return t.getChildren().forEach((function(t){var n=e(t);Array.isArray(n)?(r.push.apply(r,T()(n[0])),o.push.apply(o,T()(n[1])),a.push.apply(a,T()(n[2]))):(r.push(n.cell),o.push(n.data),a.push(n.originModel))})),[r,o,a]}if("line"===n){var i={},c=t,l=c.source,s=c.target,d=c.controlPoints,f=[];return!l.id&&l.connection&&(f.push(l.connection),i.source=u()(l)),f.push.apply(f,T()(d)),i.controlPoints=d,!s.id&&s.connection&&(f.push(s.connection),i.target=u()(s)),{cell:t,data:{type:"line",points:f},originModel:i}}if(Er(t)){var h=u()(t.points);return{cell:t,data:{type:"points",points:h},originModel:{points:h}}}return{cell:t,data:{type:n,x:t.x,y:t.y,w:t.width,h:t.height,r:t.rotate},originModel:{x:t.x,y:t.y,width:t.width,height:t.height,rotate:t.rotate}}},Ed=function(e,t,n){return e.map((function(e,r){if("line"===e.type){var o=e.points,a=t[r],i={};return a.source.id||(i.source={},i.source.connection=o.shift()),a.target.id||(i.target={},i.target.connection=o.pop()),i.controlPoints=T()(o),"elbow"===a.shape&&i.controlPoints.forEach((function(e,t){e.push(a.controlPoints[t][2])})),i}if("points"===e.type)return{points:e.points};var c={x:e.x,y:e.y,width:e.w,height:e.h,rotate:e.r};return"stack"===e.type&&delete c.height,"lc"===n||"rc"===n?c.height=void 0:"tc"!==n&&"bc"!==n||(c.width=void 0),c}))},Od=function(){function e(t){m()(this,e);var n=new no,r=ma("tc",wd),o=ma("bc",wd),a=ma("lc",wd),i=ma("rc",wd),c=pa("tl",wd),l=pa("tr",wd),u=pa("bl",wd),s=pa("br",wd),d=ya("rotate");n.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.add(r.group),n.add(o.group),n.add(a.group),n.add(i.group),n.add(c.group),n.add(l.group),n.add(u.group),n.add(s.group),n.add(d.group),this.diagram=t,this.group=n,this.tl=c,this.tr=l,this.bl=u,this.br=s,this.tc=r,this.bc=o,this.lc=a,this.rc=i,this.rotateBtn=d,this.eventHelper=new fl}return v()(e,[{key:"init",value:function(e){var t=this.tl,n=this.tr,r=this.bl,o=this.br,a=this.rotateBtn;Array.isArray(e)?(this.cells=e,t.group.css({display:"none"}),n.group.css({display:"none"}),r.group.css({display:"none"}),o.group.css({display:"none"}),a.group.css({display:"none"})):(this.groupCell=e,t.group.css({display:"initial"}),n.group.css({display:"initial"}),r.group.css({display:"initial"}),o.group.css({display:"initial"}),a.group.css({display:"initial"}))}},{key:"update",value:function(){var e,t,n,r,o,a=this.groupCell,i=this.tl,c=this.tr,l=this.bl,u=this.br,s=this.tc,d=this.bc,f=this.lc,h=this.rc,p=this.diagram,m=this.rotateBtn,y=this.cells,v=1/p.viewport.zoom,g=v,b=8*v;if(y){var x=Ar(y.reduce((function(e,t){return t.isAbstract?e.concat(t.abstractCoveredCellsWithAllChildren,t):e.concat(t)}),[]),(function(e){return mr(e)?e.getKeyShapeBox():ur(e)?e.getPointBox():e.getBBox()})),w=x.minX,k=x.minY,E=x.maxX,O=x.maxY;e={x:w,y:k},t={x:E,y:k},n={x:w,y:O},r={x:E,y:O}}else{if(!a)return;e=a.percentage2Canvas({x:0,y:0}),t=a.percentage2Canvas({x:1,y:0}),n=a.percentage2Canvas({x:0,y:1}),r=a.percentage2Canvas({x:1,y:1});var C=14*v;o=a.relative2Canvas({x:-C,y:a.height+C})}i.group.update(xd(xd({},e),{},{scale:v,rotate:0})),c.group.update(xd(xd({},t),{},{scale:v,rotate:0})),l.group.update(xd(xd({},n),{},{scale:v,rotate:0})),u.group.update(xd(xd({},r),{},{scale:v,rotate:0})),m.group.update(xd(xd({},o),{},{scale:v,rotate:0})),s.shape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(t.x,",").concat(t.y),"stroke-width":b}),d.shape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),f.shape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(n.x,",").concat(n.y),"stroke-width":b}),h.shape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),s.visShape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(t.x,",").concat(t.y),"stroke-width":g}),d.visShape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":g}),f.visShape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(n.x,",").concat(n.y),"stroke-width":g}),h.visShape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(r.x,",").concat(r.y),"stroke-width":g})}},{key:"bindEvent",value:function(){var e,t,n,r,o,a,i,c,l,s,d=this,f=this.groupCell,h=this.tl,p=this.tr,m=this.bl,y=this.br,v=this.tc,g=this.bc,x=this.lc,w=this.rc,E=this.eventHelper,O=this.rotateBtn,C=f.diagram,A=C.viewport.zoom,P=-1;[h,p,m,y,v,g,x,w,O].forEach((function(i){var c=i.shape,l=i.name;E.bind(c,"mousedown",(function(i){s=C.viewport.invertClient([i.clientX,i.clientY]),C.contentEditor.unbind(),e=l,t={x:f.x,y:f.y,w:f.width,h:f.height,r:0};var c=kd(f),u=b()(c,3);r=u[0],n=u[1],o=u[2];for(var d=0;d<n.length;d++)if("line"!==n[d].type||n[d].points[0]){P=d;break}a=n[P]}))})),E.bind(C,"mousemove",(function(o){if(e){var a,h=C.viewport.invertClient([o.clientX,o.clientY]);if("rotate"===e){var p=function(e,t,n,r){var o=Sn(n),a=Rn(o,e,t),i=ti(n.r+a);i=Math.ceil(i);for(var c=[-180,-90,0,90,180],l=0;l<c.length;l++){var u=c[l];if(oi(i,u,4)){i=u;break}}return{newChildrenRect:r.map((function(e){if("line"===e.type||"points"===e.type)return{type:e.type,points:e.points.map((function(e){var t=[];return k.vec2.rotate(t,[e[0]-o.x,e[1]-o.y],[0,0],ri(i)),t[0]+=o.x,t[1]+=o.y,t}))};var t=ji(o,i,[e]),n=b()(t,1)[0];return{x:n.x,y:n.y,w:e.w,h:e.h,r:n.r}})),groupRotate:i}}({x:s[0],y:s[1]},{x:h[0],y:h[1]},t,n);a=p.newChildrenRect,C.emit("cellrotate",{cell:f,rotate:p.groupRotate})}else{var m=!1;["tl","tr","bl","br"].includes(e)&&(m=!0),a=function(e,t,n,r,o){var a,i,c,l=new Mn(n),u=e,s=[];if(o){switch(t){case"tl":case"br":s=[l.tl,l.br];break;case"tr":case"bl":s=[l.tr,l.bl];break;case"tc":case"bc":s=[l.tc,l.bc];break;case"lc":case"rc":s=[l.lc,l.rc];break;default:s=[]}2===s.length&&(u=_n(s,e))}switch(t){case"tl":i=l.tl,a=l.br,c=[i.x-u.x,i.y-u.y];break;case"tr":i=l.tr,a=l.bl,c=[u.x-i.x,i.y-u.y];break;case"bl":i=l.bl,a=l.tr,c=[i.x-u.x,u.y-i.y];break;case"br":i=l.br,a=l.tl,c=[u.x-i.x,u.y-i.y];break;case"rc":i=l.rc,a=l.lc,c=[u.x-i.x,0];break;case"lc":i=l.lc,a=l.rc,c=[i.x-u.x,0];break;case"bc":i=l.bc,a=l.tc,c=[0,u.y-i.y];break;case"tc":i=l.tc,a=l.bc,c=[0,i.y-u.y]}var d=[1+c[0]/n.w,1+c[1]/n.h];d[0]<0&&(d[0]=.01),d[1]<0&&(d[1]=.01);var f=function(e){return[(e[0]-a.x)*d[0]+a.x,(e[1]-a.y)*d[1]+a.y]};return{newChildrenRect:r.map((function(e){var t=e.type;if("line"===t||"points"===t)return{type:t,points:e.points.map((function(e){return f(e)}))};var n=f([e.x,e.y]),r=b()(n,2);return{x:r[0],y:r[1],w:e.w*d[0],h:e.h*d[1],r:e.r,type:t}}))}}({x:h[0],y:h[1]},e,t,n,m).newChildrenRect}i=u()(a[P]),c=Ed(a,r,e),C.update(r,c),"rotate"===e?d.hide():d.update(),C.emit("groupresizestart")}else if(o.target.dataset.group_resize_controller){var y;if("line"===o.target.dataset.type){var v=Qn(o.target.getAttribute("d"));y=xa([v[1][1]-v[0][1],v[1][2]-v[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else y=wa(C.viewport.invertClient([o.clientX,o.clientY]),f.getBBox());l||(l=!0),C.setCursor(y)}else l&&(C.resetCursor(),l=void 0)})),E.bind(C,"mouseup",(function(){var u=d.groupCell;C.resetCursor();var s=!1;if(i&&a&&P>=0)if("line"===a.type||"points"===a.type){var f=a.points[0],h=i.points[0];f[0]===h[0]&&f[1]===h[1]||(s=!0)}else i.x===a.x&&i.y===a.y&&i.w===a.w&&i.h===a.h&&i.r===a.r||(s=!0);s&&C.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:c,originModels:o,select:function(){C.selector.select([u.model.id])}}),e=void 0,t=void 0,n=void 0,r=void 0,o=void 0,i=void 0,a=void 0,c=void 0,l=void 0})),E.bind(C,"afterviewportchange",Le()((function(){A!==C.viewport.zoom&&(d.update(),A=C.viewport.zoom)})))}},{key:"begin",value:function(){this.diagram.frontRootGroup.add(this.group),this.update(),this.show(),this.cells||this.bindEvent()}},{key:"end",value:function(){this.group&&this.group.remove(),this.groupCell=void 0,this.cells=void 0,this.eventHelper.unbind()}},{key:"show",value:function(){this.group.css({display:"initial"})}},{key:"hide",value:function(){this.group.css({display:"none"})}},{key:"destroy",value:function(){this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}}]),e}();c()(Od,"className","GroupRotateResize");var Cd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new no),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new no).css({"pointer-events":"none"})}return v()(e,[{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t=this.diagram.viewport.zoom;e=e.filter((function(e){return e.state.visible})),this.render(e,(function(){return{shapeStyle:{fill:"none",stroke:"#3384F5","stroke-width":1/t}}}))}},{key:"render",value:function(e,t){var n=this.group,r=this.diagram;this.clear(),e&&!e.some((function(e){return!e||!e.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=e.map((function(e){var r=t(e),o=r.type,a=r.shapeStyle,i={cell:e,type:"function"==typeof o?o(e):o,shape:a&&new ho(a)};return i.shape&&n.add(i.shape),i})),this.draw())}},{key:"updateShape",value:function(e){var t,n=e.cell,r=e.shape,o=[1,0,0,0,1,0,0,0,1];if(ur(n)){var a=n.getPointBox();t=Jn(a.x,a.y,a.width,a.height)}else if(wr(n)||kr(n)){var i=n.getKeyShapeBox();t=Jn(i.x,i.y,i.width,i.height)}else if(pr(n)){var c=n.percentage2Canvas({x:0,y:0}),l=n.percentage2Canvas({x:1,y:0}),u=n.percentage2Canvas({x:0,y:1});t=$n([c,l,n.percentage2Canvas({x:1,y:1}),u,c])+"z"}else mr(n)&&(t=n.borderElement.attr("d"),o=T()(n.matrix));r.update({matrix:o,d:t,"stroke-width":1})}},{key:"_draw",value:function(){var e=this;this.arr.forEach((function(t){e.updateShape(t)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),e}();c()(Cd,"className","Highlight");var Ad=function(){function e(t){m()(this,e),this.diagram=t,this.eventHelper=new fl,this.zoom=-1/0,this.arr=[],this.maxStashes={},this.bindEvent()}return v()(e,[{key:"bindEvent",value:function(){var e=this,t=this.diagram;this.eventHelper.bind(t,"afterviewportchange",De()((function(){t.destroyed||e._update()}),100))}},{key:"setImageHref",value:function(e,t,n,r){this.arr.push({image:e,href:t,naturalWidth:n,naturalHeight:r}),this._setImageHref(e,t,n,r)}},{key:"_setImageHref",value:function(e,t,n,o){var a,i=this.diagram,c=this.maxStashes,l=i.viewport.zoom,u=Number(e.attr("width")),s=e.attr("href"),d=c[t],f=u*l;d&&d.clientWidth>f?a=d.href:(a=r.OssUtil.resizeImage({maxWidth:f,src:t,data:{width:f,originWidth:n,originHeight:o}})||t,c[t]={clientWidth:f,href:a}),s!==a&&e.update({href:a})}},{key:"_gc",value:function(){this.arr=this.arr.filter((function(e){return e&&!e.image.destroyed}))}},{key:"_refreshOssUrl",value:function(){var e=this,t=this.arr,n=this.diagram,r=this.zoom;n.viewport.zoom>r&&(t.forEach((function(t){var n=t.image,r=t.href,o=t.naturalWidth,a=t.naturalHeight;e._setImageHref(n,r,o,a)})),this.zoom=n.viewport.zoom)}},{key:"_update",value:function(){this._gc(),this._refreshOssUrl()}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.destroyed=!0}}]),e}();function Pd(e,t,n){if(e&&!e.id){var r=e.connection;e.connection=[r[0]+t,r[1]+n]}}c()(Ad,"className","ImageManager");var Sd=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).caches={},r}return v()(n,[{key:"clone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram,r=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;return e.forEach((function(e){var a,i,c,l;if("edge"===e.type){var u=[];e.source&&!e.source.id&&e.source.connection&&u.push(e.source.connection),e.target&&!e.target.id&&e.target.connection&&u.push(e.target.connection);var s=u.map((function(e){return e[0]})),d=u.map((function(e){return e[1]}));a=Math.min.apply(Math,T()(s)),i=Math.min.apply(Math,T()(d)),c=Math.max.apply(Math,T()(s)),l=Math.max.apply(Math,T()(d))}else a=e.x,i=e.y,c=e.x+(e.width||0),l=e.y+(e.height||0);a<t&&(t=a),i<n&&(n=i),c>r&&(r=c),l>o&&(o=l)})),{minX:t,minY:n,maxX:r,maxY:o}}(e);if(!ci(r,n.viewport.viewportCanvasBox)){var o=n.viewport.getCenter(),a=o[0]-(r.minX+r.maxX)/2,i=o[1]-(r.minY+r.maxY)/2;e.forEach((function(e){!function(e,t,n){"edge"===e.type?(Pd(e.source,t,n),Pd(e.target,t,n)):(e.x=(e.x||0)+t,e.y=(e.y||0)+n)}(e,a,i)}))}return ba(e,t),e}}]),n}(),jd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"line",void 0),c()(this,"refLinesGroup",new no),c()(this,"fixedPoint",void 0),c()(this,"ns",void 0),c()(this,"we",void 0),c()(this,"nwse",void 0),c()(this,"nesw",void 0),c()(this,"_enable",!1),this.diagram.frontRootGroup.add(this.refLinesGroup)}return v()(e,[{key:"init",value:function(e,t){this.line=e;var n=e.getPoints();this.fixedPoint="source"===t?n[1]:n[n.length-2]}},{key:"align",value:function(e){if(e=za(e),e=function(e,t){e=za(e),t=za(t);var n=e,r=n.x,o=n.y,a=t,i=a.x,c=a.y,l=li(r,o,i,c);return Math.abs(l)<.1&&Math.abs(c-o)<8?t.y=o:Math.abs(l)>10&&Math.abs(i-r)<8&&(t.x=r),t}(this.fixedPoint,e),!this._enable)return e;var t=this.createOneRefLine(e);if(t){this.refLinesGroup.clear(),this.refLinesGroup.add(t.path);var n=1/(this.diagram.viewport.zoom||1);t.path.update({"stroke-width":n});var r=t.start,o=t.end;return _n([{x:r[0],y:r[1]},{x:o[0],y:o[1]}],e)}return e}},{key:"createOneRefLine",value:function(e){var t=this.fixedPoint,n=t.x,r=t.y,o=ni(fi(n,r,e.x,e.y));return(o=o>180?o-180:o)>=0&&o<22.5?{path:new ho({d:"M".concat(n-5e4,",").concat(r," L").concat(n+5e4,",").concat(r),stroke:"#1672F3"}),start:[n-5e4,r],end:[n+5e4,r]}:o>=22.5&&o<67.5?{path:new ho({d:"M".concat(n-5e4,",").concat(r-5e4," L").concat(n+5e4,",").concat(r+5e4),stroke:"#1672F3"}),start:[n-5e4,r-5e4],end:[n+5e4,r+5e4]}:67.5<=o&&o<112.5?{path:new ho({d:"M".concat(n,",").concat(r-5e4," L").concat(n,",").concat(r+5e4),stroke:"#1672F3"}),start:[n,r-5e4],end:[n,r+5e4]}:112.5<=o&&o<157.5?{path:new ho({d:"M".concat(n+5e4,",").concat(r-5e4," L").concat(n-5e4,",").concat(r+5e4),stroke:"#1672F3"}),start:[n+5e4,r-5e4],end:[n-5e4,r+5e4]}:157.5<=o&&o<=180?{path:new ho({d:"M".concat(n-5e4,",").concat(r," L").concat(n+5e4,",").concat(r),stroke:"#1672F3"}),start:[n-5e4,r],end:[n+5e4,r]}:void 0}},{key:"reset",value:function(){this.refLinesGroup.clear()}},{key:"setEnable",value:function(e){this._enable=e}},{key:"destroy",value:function(){}}]),e}();c()(jd,"className","LineAlign");var Rd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new no),c()(this,"highlightPath",void 0),t.frontRootGroup.add(this.group)}return v()(e,[{key:"align",value:function(e,t,n){e=za(e),t=za(t);var r,o,a=[0,0],i=0,c=!1;return 0===(null==n?void 0:n.rotate)&&(oi(e.y,t.y,4)?(a=[t.x,e.y],c=!0,i=0):oi(e.x,t.x,4)&&(a=[e.x,t.y],c=!0,i=1),c&&(oi((r=function(e){return[Jt(e[0],0,1),Jt(e[1],0,1)]}(r=n.canvas2percentage(a)))[i],0,.1)?(r[i]=0,o=r):oi(r[i],1,.1)&&(r[i]=1,o=r),o))?(this.highlight(e,a),o):(this.clearHighlight(),null)}},{key:"highlight",value:function(e,t){var n;this.highlightPath||(this.highlightPath=new ho({stroke:"#1672F3"}),this.group.add(this.highlightPath)),e=za(e),t=za(t);var r,o,a=24/this.diagram.viewport.zoom;e.x===t.x?(r=e.y<t.y?e:t,o=e.y>=t.y?e:t,n="M".concat(r.x,",").concat(r.y-a," L").concat(o.x,",").concat(o.y+a)):(r=e.x<t.x?e:t,o=e.x>=t.x?e:t,n="M".concat(r.x-a,",").concat(r.y," L").concat(o.x+a,",").concat(o.y)),this.highlightPath.update({d:n})}},{key:"clearHighlight",value:function(){this.group.clear(),this.highlightPath=null}},{key:"reset",value:function(){this.clearHighlight()}},{key:"destroy",value:function(){}}]),e}();c()(Rd,"className","LineCellAlign");var _d=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"line",void 0),c()(this,"name",void 0),c()(this,"basePoint",void 0),c()(this,"highlight",void 0),c()(this,"group",new no)}return v()(e,[{key:"init",value:function(e,t){this.line=e,this.name=t,this.diagram.lineAlign.init(e,t),this.diagram.connect.init(e,t),this.highlight=Ba(t,3),this.highlight.group.hide(),this.highlight.shape.update({stroke:"#3384F5",fill:"#3384F5"}),this.diagram.frontRootGroup.add(this.highlight.group);var n=this.line.getPoints();"target"===this.name?this.basePoint=n[0]:this.basePoint=n[n.length-1]}},{key:"resize",value:function(e){if(!this.line)throw new Error("line not exist, must call prepareUpdate before updateEndPoint");var t,n=this.diagram,r=n.viewport.invertClient([e.clientX,e.clientY]),o=n.connect.findEndPoint(r);if(o.id){n.lineAlign.reset();var a=n.lineCellAlign.align(this.basePoint,r,n.find(o.id));a&&(o.connection=a),this.updateHighlight(o)}else if(!o.id&&o.connection){var i=n.lineAlign.align(r);o.connection=[(t=i).x,t.y],this.highlight.group.hide()}return o}},{key:"updateHighlight",value:function(e){if(this.line){var t,n=1/this.diagram.viewport.zoom,r=this.line.getPoints();t=e.id&&!e.connection?za(r[r.length-1]):this.line.getEndpoint(e),this.highlight.group.show(),this.highlight.group.update({scale:n,x:t.x,y:t.y})}}},{key:"reset",value:function(){var e,t;null===(e=this.highlight)||void 0===e||null===(t=e.group)||void 0===t||t.remove(),this.diagram.lineAlign.reset(),this.diagram.connect.reset(),this.diagram.lineCellAlign.reset(),this.group.clear()}},{key:"destroy",value:function(){}}]),e}();c()(_d,"className","LineResizer");var Md='<div style="text-align:center;">&nbsp;</div>',Ld=["text","mindmap","geometry","stack","image","swimlane","dsl"],Td=function(e){return!!e.type&&Ld.includes(e.type)};function Dd(e,t,n){if(e.type){if(Td(e)){var r="number"==typeof e.x?e.x:0,o="number"==typeof e.y?e.y:0;return{x:r+t,y:o+n}}if(Ui(e)){var a={};return e.target&&!e.target.id&&e.target.connection&&(a.target=u()(e.target),Array.isArray(a.target.connection)&&(a.target.connection[0]+=t,a.target.connection[1]+=n)),e.source&&!e.source.id&&e.source.connection&&(a.source=u()(e.source),Array.isArray(a.source.connection)&&(a.source.connection[0]+=t,a.source.connection[1]+=n)),a}if(function(e){return!!e.type&&"freehand"===e.type}(e)){var i={};return i.points=e.points.map((function(e){return[e[0]+t,e[1]+n,e[2]]})),i}if(function(e){return!!e.type&&"pen"===e.type}(e)){var c={};return c.points=e.points.map((function(e){return[e[0]+t,e[1]+n]})),c}}return{}}function Nd(e,t,n){return!!e.type&&(Td(e)?("number"==typeof e.x?e.x=e.x+t:e.x=t,"number"==typeof e.y?e.y=e.y+n:e.y=n):Ui(e)?(e.target&&!e.target.id&&Array.isArray(e.target.connection)&&(e.target.connection[0]+=t,e.target.connection[1]+=n),e.source&&!e.source.id&&Array.isArray(e.source.connection)&&(e.source.connection[0]+=t,e.source.connection[1]+=n),e.controlPoints&&e.controlPoints.forEach((function(e){"number"==typeof e[0]&&(e[0]+=t),"number"==typeof e[1]&&(e[1]+=n)}))):Wi(e)&&e.points.forEach((function(e){e[0]+=t,e[1]+=n})),!0)}function Bd(e,t,n){return e.map((function(e){return Dd(e,t,n)}))}function Id(e,t,n){e.forEach((function(e){Wt(e,(function(e){return Nd(e,t,n)}))}))}function Fd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var qd=function(){function e(){m()(this,e),c()(this,"destroyed",void 0)}return v()(e,[{key:"bbox",value:function(e){return function(e){var t={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,width:10,height:10};return e.forEach((function(e){Wt(e,(function(n){var r=1/0,o=1/0,a=-1/0,i=-1/0;if(Td(n)){var c=n.width||50,l=n.height||50;r=n.x,o=n.y,a=n.x+c,i=n.y+l}else if(Ui(e)){var u=[],s=[];e.target&&!e.target.id&&e.target.connection&&(u.push(e.target.connection[0]),s.push(e.target.connection[1])),e.source&&!e.source.id&&e.source.connection&&(u.push(e.source.connection[0]),s.push(e.source.connection[1])),e.controlPoints&&e.controlPoints.forEach((function(e){"number"==typeof e[0]&&u.push(e[0]),"number"==typeof e[1]&&s.push(e[1])})),r=Math.min.apply(Math,u),o=Math.min.apply(Math,s),a=Math.max.apply(Math,u),i=Math.max.apply(Math,s)}else if(Wi(e)){var d=[],f=[];e.points.forEach((function(e){d.push(e[0]),f.push(e[1])})),r=Math.min.apply(Math,d),o=Math.min.apply(Math,f),a=Math.max.apply(Math,d),i=Math.max.apply(Math,f)}r<t.minX&&(t.minX=r),o<t.minY&&(t.minY=o),a>t.maxX&&(t.maxX=a),i>t.maxY&&(t.maxY=i)}))})),t.width=t.maxX-t.minX,t.height=t.maxY-t.minY,t}(e)}},{key:"translate",value:function(e,t,n,r){var o=r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({deep:!0,returnUpdateModels:!1},r),a=o.deep,i=o.returnUpdateModels?[]:null,l=function(e,t,n){if(Nd(e,t,n),i){var r=Dd(e,t,n);r&&i.push(r)}};return e.forEach((function(e){!0===a?Wt(e,(function(e){l(e,t,n)})):l(e,t,n)})),i}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();c()(qd,"className","ModelManager");var zd=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r}return v()(n,[{key:"init",value:function(){if("read"!==this.diagram.interaction.currentMode){var e,t,n,r,o=this.diagram,a=!1,i=!1,c=!1,l="edit";this.bind(o,"dragstart",(function(l){var u=l.evt,d=l.button;e=u.clientX,t=u.clientY,n=o.viewport.scrollLeft,r=o.viewport.scrollTop,function(e){return!!(2===e||0===e&&c||"dragCanvas"===o.interaction.currentMode)}(d)&&(2===d&&(i=!0),a=!0,o.input.style.display="none","dragCanvas"!==o.interaction.currentMode&&s(),o.setCursor("grabbing"),o.selector.select([]))})),this.bind(o,"drag",Le()((function(a){var i=a.evt;if("dragCanvas"===o.interaction.currentMode){var c=n-(i.clientX-e),l=r-(i.clientY-t);o.viewport.setScroll(c,l)}}),16));var u=function(){i=!1};this.bind(o,"dragend",(function(){u(),!a||c||o.signal.buttonDragCanvas||(d(),o.tryFocus())})),this.bind(o,"mouseleave",(function(){u(),a&&!o.signal.buttonDragCanvas&&d()})),this.bind(o,"keydown",(function(e){" "===e.key&&(e.preventDefault(),c=!0,"dragCanvas"!==o.interaction.currentMode&&(o.highlight.clear(),o.selector.select([]),s()))})),this.bind(o,"keyup",(function(e){" "===e.key&&(c=!1,o.signal.buttonDragCanvas=!1,i||d())})),this.bind(window,"blur",d)}function s(){l=o.interaction.currentMode,o.interaction.changeMode("dragCanvas")}function d(){a=!1,c=!1,i=!1,o.input.style.display="","dragCanvas"===o.interaction.currentMode&&(o.interaction.changeMode(l),l="edit")}}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(zd,"className","MouseDragCanvas");var Gd=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r.init(),r}return v()(n,[{key:"init",value:function(){var e=this.diagram;this.bind(e,"keydown",(function(t){"read"!==e.interaction.currentMode&&"edit"!==e.interaction.currentMode&&("v"!==t.key&&"Esc"!==t.key&&"Escape"!==t.key||e.interaction.changeMode("edit"))}))}}]),n}();function Yd(e,t,n){var r=new Mn(n),o=_n([r.tl,r.tr],t),a=_n([r.tl,r.bl],t),i=_n([r.tr,r.br],t),c=_n([r.bl,r.br],t),l=Jt(_n([a,i],e).x,0,n.w),u=Jt(_n([o,c],e).y,0,n.h);return[Pn(a,{x:l,y:t.y})/n.w,Pn(o,{x:t.x,y:u})/n.h]}function Hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Gd,"className","VBackToEdit");var Ud=function(){function e(t){m()(this,e),c()(this,"cell",void 0),c()(this,"diagram",void 0),c()(this,"controlPointsButtons",void 0),c()(this,"roundButton",void 0),c()(this,"group",void 0),c()(this,"eventHelper",void 0),c()(this,"shape",void 0),c()(this,"isMouseMove",void 0),this.diagram=t,this.group=new no,this.group.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.eventHelper=new fl}return v()(e,[{key:"init",value:function(e){this.cell=e,this.shape=this.cell.shape,this.prepareButtons()}},{key:"begin",value:function(){this.controlPointsButtons&&(this.isMouseMove=!1,this.diagram.frontRootGroup.add(this.group),this.update(),this.bindEvent())}},{key:"end",value:function(){this._clear(),this.eventHelper.unbind()}},{key:"_clear",value:function(){this.group&&this.group.clear()}},{key:"update",value:function(){var e=this;if(this.cell){this.shape!==this.cell.shape&&(this._clear(),this.eventHelper.unbind(),this.prepareButtons(),this.bindEvent(),this.shape=this.cell.shape);var t=1/(this.diagram.viewport.zoom||1),n=this.cell.rotate/360*2*Math.PI;if(this.controlPointsButtons.length>0&&this.cell.controlPoints.forEach((function(r,o){var a=e.cell.percentage2Canvas({x:Jt(r[0],0,1),y:Jt(r[1],0,1)});e.controlPointsButtons[o].group.update(Vd(Vd({},a),{},{scale:t,rotate:n}))})),this.roundButton){var r=Jt(this.cell.round/this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2/this.cell.width);this.isMouseMove||(this.cell.round<8&&(r=8/this.cell.width),this.cell.width<8?this.roundButton.group.hide():this.roundButton.group.show());var o=r,a=this.cell.percentage2Canvas({x:r,y:o});this.roundButton.group.update(Vd(Vd({},a),{},{scale:t,rotate:n}))}}}},{key:"destroy",value:function(){this.group.remove()}},{key:"hide",value:function(){this.group.hide()}},{key:"show",value:function(){this.group.show()}},{key:"prepareButtons",value:function(){this.createControlPointsButtons(),this.createRoundButton()}},{key:"bindEvent",value:function(){var e,t,n,r=this,o=!1;function a(){t=void 0,n=void 0}this.controlPointsButtons.forEach((function(i,c){var l=i.shape;r.eventHelper.bind(l,"mousedown",(function(){r.diagram.contentEditor.unbind(),o=!0,e=c,t={controlPoints:r.cell.controlPoints}})),r.eventHelper.bind(r.diagram,"mousemove",Le()((function(t){o&&(n=r.computeControlPoints(t,e),r.diagram.update(r.cell,{controlPoints:n}))}),16)),r.eventHelper.bind(r.diagram,"mouseup",(function(){o&&(o=!1,e=0,Fe()(t.controlPoints,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{controlPoints:n},originModels:[t]}),a()))}))})),this.roundButton&&(this.eventHelper.bind(this.roundButton.shape,"mousedown",(function(){r.diagram.contentEditor.unbind(),o=!0,t={round:r.cell.round}})),this.eventHelper.bind(this.diagram,"mousemove",Le()((function(e){o&&(r.isMouseMove=!0,n=r.computeRoundPoint(e),r.diagram.update(r.cell,{round:n}))}),16)),this.eventHelper.bind(this.diagram,"mouseup",(function(){o&&(r.isMouseMove=!1,r.update(),o=!1,Fe()(t.round,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{round:n},originModels:[t]}),a()))})))}},{key:"createRoundButton",value:function(){"number"==typeof this.cell.round?this.roundButton=this.createButton("round"):this.roundButton=void 0}},{key:"createControlPointsButtons",value:function(){var e=this;this.cell.controlPoints?this.controlPointsButtons=this.cell.controlPoints.map((function(){return e.createButton("control_point")})):this.controlPointsButtons=[]}},{key:"createButton",value:function(e){var t=new io,n=9*Math.sin(Math.PI/4),r=Jn(n/-2,n/-2,n,n,1.5),o=k.mat3.rotate([],[1,0,0,0,1,0,0,0,1],Math.PI/4),a=new ho({d:r,stroke:"rgba(255,255,255,0.8)","stroke-width":1,fill:"#3384F5",matrix:o});return a.dataset({testid:e}),t.add(a),this.group.add(t),{group:t,shape:a}}},{key:"computeControlPoints",value:function(e,t){var n=this.diagram.viewport.invertClient([e.clientX,e.clientY]),r=this.cell.stencil.controlPointsConfig,o=this.cell.controlPoints,a=o[t],i=k.vec3.transformMat3([],k.vec3.clone([n[0],n[1],1]),k.mat3.invert([],this.cell.matrix)),c=b()(i,2),l=Yd({x:c[0],y:c[1]},{x:a[0]*this.cell.width,y:a[1]*this.cell.height},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0}),s=["x","y"].map((function(e,n){var i=[0,1],c=r[t][e].limit;return void 0===c?i=[0,1]:Array.isArray(c)?i=c.map((function(e){return"string"==typeof e?o[Number(e)][n]:e})):!0===c&&(i=[a[n],a[n]]),Jt(l[n],i[0],i[1])})),d=u()(o);return d[t]=s,["x","y"].forEach((function(e,n){var o=r[t][e].proportional;if(o){var i=s[n]-a[n];o.forEach((function(e){d[Number(e)][n]+=i}))}})),d}},{key:"computeRoundPoint",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]),n=k.vec3.transformMat3([],k.vec3.clone([t[0],t[1],1]),k.mat3.invert([],this.cell.matrix)),r=b()(n,2),o=Yd({x:r[0],y:r[1]},{x:Jt(this.cell.round,0,Math.min(this.cell.width,this.cell.height)/2),y:0},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0});return Jt(o[0]*this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2)}}]),e}();function Wd(e,t){return[e[0]+t[0],e[1]+t[1]]}function Xd(e,t){return[e[0]-t[0],e[1]-t[1]]}function Kd(e,t){return[e[0]*t,e[1]*t]}function Zd(e){return Math.hypot(e[0],e[1])}function Qd(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=e[0]-t[0],i=e[1]-t[1],c=a*r+i*o;return[a*o-i*r+t[0],c+t[1]]}function $d(e){return e.map((function(e){return Math.round(100*e)/100}))}var Jd=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=function(e){return function(e,t){return[e[0]/t,e[1]/t]}(e,Zd(e))}(Xd(t,e)),a=Wd(e,Kd(o,function(e,t){return function(e,t){return e[0]*t[0]+e[1]*t[1]}(e,t)/Zd(t)}(Xd(n,e),o)));if(r){if(a[0]<Math.min(e[0],t[0]))return e[0]<t[0]?e:t;if(a[0]>Math.max(e[0],t[0]))return e[0]>t[0]?e:t;if(a[1]<Math.min(e[1],t[1]))return e[1]<t[1]?e:t;if(a[1]>Math.max(e[1],t[1]))return e[1]>t[1]?e:t}return a};function ef(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ef(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nf={lake_prevent_click_unselect:"true",vertex_resize_controller:"true"},rf=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"cell",void 0),c()(this,"group",new no),c()(this,"eventHelper",new fl),c()(this,"controlPointsManager",void 0),c()(this,"tl",void 0),c()(this,"tr",void 0),c()(this,"bl",void 0),c()(this,"br",void 0),c()(this,"tc",void 0),c()(this,"bc",void 0),c()(this,"lc",void 0),c()(this,"rc",void 0),c()(this,"rotateBtn",void 0),c()(this,"resizeRotatePoints",[]),c()(this,"cursors",void 0);var n=ma("tc",nf),r=ma("bc",nf),o=ma("lc",nf),a=ma("rc",nf),i=pa("tl",nf),l=pa("tr",nf),u=pa("bl",nf),s=pa("br",nf),d=ya("rotate");this.group.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.group.add(n.group),this.group.add(r.group),this.group.add(o.group),this.group.add(a.group),this.group.add(i.group),this.group.add(l.group),this.group.add(u.group),this.group.add(s.group),this.group.add(d.group),this.tl=i,this.tr=l,this.bl=u,this.br=s,this.tc=n,this.bc=r,this.lc=o,this.rc=a,this.rotateBtn=d,this.controlPointsManager=new Ud(t)}return v()(e,[{key:"init",value:function(e){var t=this,n=this.tl,r=this.tr,o=this.bl,a=this.br,i=this.tc,c=this.bc,l=this.lc,u=this.rc,s=this.rotateBtn;this.cell=e;var d={tl:n,tr:r,bl:o,br:a,tc:i,bc:c,lc:l,rc:u,rotate:s};e.resizeRotatePoints?this.resizeRotatePoints=e.resizeRotatePoints.map((function(e){return d[e]})):this.resizeRotatePoints=Object.keys(d).map((function(e){return d[e]})),this.cursors={},this.resizeRotatePoints.forEach((function(e){e===l||e===u?t.cursors["ew-resize"]=!0:e===i||e===c?t.cursors["ns-resize"]=!0:e===n||e===a?t.cursors["nwse-resize"]=!0:e!==o&&e!==r||(t.cursors["nesw-resize"]=!0)})),yr(e)&&this.controlPointsManager.init(e)}},{key:"update",value:function(){var e=this.cell,t=this.tl,n=this.tr,r=this.bl,o=this.br,a=this.tc,i=this.bc,c=this.lc,l=this.rc,u=this.rotateBtn,s=this.diagram;if(e){this.controlPointsManager.update();var d=1/s.viewport.zoom,f=ri(e.rotate||0),h=e.percentage2Canvas({x:0,y:0}),p=e.percentage2Canvas({x:1,y:0}),m=e.percentage2Canvas({x:0,y:1}),y=e.percentage2Canvas({x:1,y:1});if(mr(e)){var v=Qn(e.outlineElement.attr("d"));v&&(p=e.getPointAtLength(v[1][1]+v[2][1]))}else fr(e)&&([h,p,m,y].forEach((function(t){t.x+=e.x,t.y+=e.y})),"stage"===e.parent.shape&&0!==e.nth&&(h.x-=25,m.x-=25));var g=d,b=8*d,x=12*d+e.stroke.width/2,w=e.relative2Canvas({x:0-x,y:e.height+x});t.group.update(tf(tf({},h),{},{scale:d,rotate:f})),n.group.update(tf(tf({},p),{},{scale:d,rotate:f})),r.group.update(tf(tf({},m),{},{scale:d,rotate:f})),o.group.update(tf(tf({},y),{},{scale:d,rotate:f})),u.group.update(tf(tf({},w),{},{scale:d,rotate:f})),a.shape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(p.x,",").concat(p.y),"stroke-width":b}),i.shape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(y.x,",").concat(y.y),"stroke-width":b}),c.shape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(m.x,",").concat(m.y),"stroke-width":b}),l.shape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(y.x,",").concat(y.y),"stroke-width":b}),a.visShape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(p.x,",").concat(p.y),"stroke-width":g}),i.visShape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(y.x,",").concat(y.y),"stroke-width":g}),c.visShape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(m.x,",").concat(m.y),"stroke-width":g}),l.visShape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(y.x,",").concat(y.y),"stroke-width":g}),[t,n,r,o,u].forEach((function(e){return e.group.css({visibility:"hidden"})})),this.resizeRotatePoints.forEach((function(e){return e.group.css({visibility:"initial"})})),mr(e)&&[a,i,c,l].forEach((function(e){return e.group.css({visibility:"hidden"})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,o,a,i,c,l=this,s=this.cell,d=this.eventHelper,f=s.diagram,h=f.viewport.zoom,p=function(){if(e&&t&&a&&r.points){var n;if("rotate"===e){var o=[t.x+t.w/2,t.y+t.h/2];return r.points.map((function(e){var t=[e[0],e[1]];return t=Qd(t,o,ri(a.r)),wr(s)?[].concat(T()(t),[e[2]]):t}))}var i=[0,0],c=1,l=1;switch(null===(n=sd.get(0))||void 0===n?void 0:n.get(e)){case 0:c=oi((i=[t.x,t.y])[0],a.x)?1:-1,l=oi(i[1],a.y)?1:-1;break;case 1:c=oi((i=[t.x+t.w,t.y])[0],a.x+a.w)?1:-1,l=oi(i[1],a.y)?1:-1;break;case 2:c=oi((i=[t.x+t.w,t.y+t.h])[0],a.x+a.w)?1:-1,l=oi(i[1],a.y+a.h)?1:-1;break;case 3:c=oi((i=[t.x,t.y+t.h])[0],a.x)?1:-1,l=oi(i[1],a.y+a.h)?1:-1}for(var u=a.w/t.w*c,d=a.h/t.h*l,f=[],h=0;h<r.points.length;h++){var p=r.points[h],m=Wd(Kd(Xd(p,i),u),i),y=b()(m,1)[0],v=Wd(Kd(Xd(p,i),d),i),g=b()(v,2)[1];f.push(wr(s)?[y,g,p[2]]:[y,g])}return f}};function m(){var t,n,r,o,i;if(Er(s))return{points:p()};var c,l,u={x:null===(t=a)||void 0===t?void 0:t.x,y:null===(n=a)||void 0===n?void 0:n.y,width:null===(r=a)||void 0===r?void 0:r.w,height:null===(o=a)||void 0===o?void 0:o.h,rotate:null===(i=a)||void 0===i?void 0:i.r};return"lc"===e||"rc"===e?u.height=void 0:"tc"!==e&&"bc"!==e||(u.width=void 0),mr(s)&&(u={width:Jt(null===(c=a)||void 0===c?void 0:c.w,s.getMinWidth(),1/0),height:Jt(null===(l=a)||void 0===l?void 0:l.h,s.minHeight,1/0)}),u}this.resizeRotatePoints.forEach((function(o){var a=o.shape,l=o.name;d.bind(a,"mousedown",(function(o){if(f.contentEditor.unbind(),e=l,n=f.viewport.invertClient([o.clientX,o.clientY]),Er(s)){r={points:u()(s.points)};var a=s.getPointBox();t={x:a.x,y:a.y,w:a.width,h:a.height,r:0}}else r={x:s.x,y:s.y,width:s.width,height:s.height,rotate:s.rotate},t={x:s.x,y:s.y,w:s.width,h:s.height,r:s.rotate};f.align.updateToAlginPoints(s),f.align.prepareForLength(s),"tc"!==e&&"bc"!==e||(f.align.preventAlignX=!0),"lc"!==e&&"rc"!==e||(f.align.preventAlignY=!0);var d=new Mn(t);c=bi(d.tl.x,d.tl.y,d.br.x,d.br.y),i=bi(d.tr.x,d.tr.y,d.bl.x,d.bl.y)}))})),d.bind(f,"mousemove",(function(r){if(e){var u=f.viewport.invertClient([r.clientX,r.clientY]),d=f.signal.keydown.Shift||s.constraints&&s.constraints.proportion;if(t)if("rotate"===e&&n)k={x:n[0],y:n[1]},E={x:u[0],y:u[1]},C=d&&15,A=Sn(O=t),P=Rn(A,k,E),(S=O.r+P)>=180&&(S-=360),S<=-180&&(S+=360),C&&(S=C*Math.round(S/C)),a=kn(kn({},O),{},{r:S}),l.alignRotate(a),f.emit("cellrotate",{cell:s,rotate:a.r});else{var h=("tl"===e||"br"===e)&&c||("bl"===e||"tr"===e)&&i;d&&("rc"!==e&&"bc"!==e||(h=c),"lc"!==e&&"tc"!==e||(h=i));var p=h&&h.f(u[0]);u[1]=d&&p?p:u[1];var y,v=f.align.alignByPoint({x:u[0],y:u[1],weight:1,box:s.getBBox()});u[0]+=v.dx,u[1]+=v.dy,d&&h&&(0!==v.dx?(y=h.f(u[0]))&&(u[1]=y):0!==v.dy&&(y=h.fy(u[1]))&&(u[0]=y)),d&&("rc"===e?e="br":"lc"===e?e="bl":"tc"===e?e="tr":"bc"===e&&(e="br")),(a=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=new Mn(n),a=null,i=[],c=e;if(r){switch(t){case"tl":case"br":i=[o.tl,o.br];break;case"tr":case"bl":i=[o.tr,o.bl];break;case"tc":case"bc":i=[o.tc,o.bc],a="height";break;case"lc":case"rc":i=[o.lc,o.rc],a="width";break;default:i=[]}2===i.length&&(c=_n(i,e))}var l=[];switch(t){case"tl":l=[o.br];break;case"tr":l=[o.bl];break;case"bl":l=[o.tr];break;case"br":l=[o.tl];break;case"bc":l=[o.tl,o.tr];break;case"tc":l=[o.bl,o.br];break;case"lc":l=[o.tr,o.br];break;case"rc":l=[o.tl,o.bl];break;default:l=[]}var u,s=l.length;return 1===s?u=function(e,t,n){var r=On(e,t),o=An(t,r,-n),a=o.x,i=o.y,c=Math.abs(2*(a-r.x)),l=Math.abs(2*(i-r.y));return{x:r.x-c/2,y:r.y-l/2,w:c,h:l,r:n}}(l[0],c,n.r):2===s&&(u=r?function(e,t,n,r){var o,a,i=b()(e,2),c=i[0],l=i[1],u=On(c,l),s=t,d=On(u,s),f=Pn(u,s),h=n.w/n.h;return"width"===r?a=(o=f)/h:o=h*(a=f),{x:d.x-o/2,y:d.y-a/2,w:o,h:a,r:n.r}}(l,c,n,a):function(e,t,n){var r=e.map((function(e){return Cn(e,-n)})),o=b()(r,2),a=o[0],i=o[1],c=Cn(t,-n),l=0,u=0,s={x:0,y:0};oi(a.y,i.y)?(l=Math.abs(a.x-i.x),u=Math.abs(c.y-a.y),s={x:(a.x+i.x)/2,y:(a.y+c.y)/2}):oi(a.x,i.x)&&(u=Math.abs(a.y-i.y),l=Math.abs(c.x-a.x),s={x:(a.x+c.x)/2,y:(a.y+i.y)/2});var d=Cn(s,n);return{x:d.x-l/2,y:d.y-u/2,w:l,h:u,r:n}}(l,c,n.r)),u}({x:u[0],y:u[1]},e,t))&&!mr(l.cell)&&f.align.alignByLength(a,e,d)}if(f.update(s,m()),l.update(),-1!==["tl","bl","tr","br"].indexOf(e)){var g=xa(f.viewport.invertClient([r.clientX,r.clientY]),s.getBBox(),Math.PI/8);f.setCursor(g)}f.signal.vertexResizing=!0,f.emit("vertexresizestart")}else if(r.target.dataset.vertex_resize_controller){var x;if("line"===r.target.dataset.type){var w=Qn(r.target.getAttribute("d"));x=xa([w[1][1]-w[0][1],w[1][2]-w[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else x=wa(f.viewport.invertClient([r.clientX,r.clientY]),s.getBBox());o||(o=!0),l.cursors[x]&&f.setCursor(x)}else o&&(f.resetCursor(),o=void 0);var k,E,O,C,A,P,S})),d.bind(f,"mouseup",(function(){f.emit("vertexresizeend"),a&&t&&(t.x!==a.x||t.y!==a.y||t.w!==a.w||t.h!==a.h||t.r!==a.r)&&(vr(s)?f.command.execute("UpdateSwimlane",{id:s,model:m(),originModels:[r]}):f.command.execute("Update",{id:s,model:m(),originModels:[r]}),f.signal.vertexResizing=!1,f.emit("aftervertexresize")),e=void 0,t=void 0,a=void 0,n=void 0,o=void 0,r=void 0,f.align.reset()})),d.bind(f,"afterviewportchange",Le()((function(){h!==f.viewport.zoom&&(l.update(),h=f.viewport.zoom)}))),d.bind(f,"vertexresizestart",(function(){return l.hide()})),d.bind(f,"vertexresizeend",(function(){return l.show()}))}},{key:"hide",value:function(){this.group.css({display:"none"}),this.controlPointsManager.hide()}},{key:"show",value:function(){this.group.css({display:"initial"}),this.controlPointsManager.show()}},{key:"begin",value:function(){this.cell.diagram.frontRootGroup.add(this.group),this.controlPointsManager.begin(),this.update(),this.show(),Er(this.cell)&&this.cell.points.length<=2||this.bindEvent()}},{key:"end",value:function(){this.hide(),this.eventHelper.unbind(),this.controlPointsManager.end(),this.diagram&&this.diagram.align.reset()}},{key:"destroy",value:function(){this.controlPointsManager.destroy(),this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}},{key:"alignRotate",value:function(e){e.r=Math.ceil(e.r);for(var t=[-180,-90,0,90,180],n=0;n<t.length;n++){var r=t[n];if(oi(e.r,r,4)){e.r=r;break}}}}]),e}();c()(rf,"className","VertexRotateResize");var of=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),(r=t.call(this)).diagram=e;var o=r.diagram.signal.keydown;function a(e,t){var n=function(e){return function(e){return pe.ua.macos?"Meta"===e.key:"Control"===e.key}(e)?["Mod",e.key]:["Alt","Shift"].includes(e.key)&&[e.key]}(e);n&&n.forEach((function(e){o[e]=t}))}return r.bind(window,"keydown",(function(e){a(e,!0)})),r.bind(window,"keyup",(function(e){a(e,!1)})),r.bind(window,"blur",(function(){for(var e in o)o[e]=!1})),r}return v()(n)}();c()(of,"className","KeyboardPressKey");var af=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"aftercommandexecute",(function(e){var t=e.command,n=e.commandName;if(!("Add"!==n&&"AddVertex"!==n&&"AddStack"!==n&&"AddStackVertex"!==n||"geometry"!==t.model.type&&"stack"!==t.model.type)){var o;try{o=JSON.parse(r.LocalStorageUtil.getItem("lake_diagram_graphic_latest_used"))||[]}catch(e){o=[]}var a=t.model.shape,i=uc.findIndex((function(e){return e.name===a}));if(i>=0){var c=uc[i],l=o.findIndex((function(e){return e.name===a}));if(l>=0){var u=o.splice(l,1);o.unshift(u[0])}else o.unshift({name:a,category:c.category}),o.length>6&&o.pop();r.LocalStorageUtil.setItem("lake_diagram_graphic_latest_used",JSON.stringify(o))}}}))}}]),n}();var cf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"updateControlPoints",value:function(e){var t=this.beforeData,n=this.afterData;e.forEach((function(e){var r=e.model,o=r.controlPoints,a=[0,0];["source","target"].forEach((function(e){var o=r[e]&&r[e].id||"".concat(r.id,"-").concat(e);if(o){var i=t[o],c=n[o];if(a&&i&&c){var l=k.vec2.sub([],c.slice(0,2),i.slice(0,2));a=cn(l,[0,0])?null:k.vec2.add(a,a,l)}}})),a&&!cn(a,[0,0])&&(a=a.map((function(e){return e/2})),Fe()(t["".concat(r.id,"-controlPoints")],n["".concat(r.id,"-controlPoints")])&&e.update({controlPoints:o.map((function(e){return[e[0]+a[0],e[1]+a[1],e[2]]}))}))}))}},{key:"getData",value:function(e){var t={},n=this.diagram;return e.forEach((function(e){var r=e.model;["source","target"].forEach((function(e){var o=r[e]&&r[e].id;if(o){var a=n.find(o),i=a.percentage2Canvas([.5,.5]);t[a.model.id]=[i.x,i.y]}else r[e].connection&&(t["".concat(r.id,"-").concat(e)]=r[e].connection)})),t["".concat(r.id,"-controlPoints")]=u()(e.controlPoints)})),t}},{key:"getLines",value:function(){return this.diagram.getCells().filter((function(e){return e.isLine})).filter((function(e){return e.isDrawable()&&e.model.controlPoints}))}},{key:"onBeforeChange",value:function(){var e=this.getLines();this.beforeData=this.getData(e)}},{key:"onAfterChange",value:function(){var e=this.getLines();this.afterData=this.getData(e),this.updateControlPoints(e)}},{key:"reset",value:function(){this.beforeData={},this.afterData={}}},{key:"init",value:function(){var e=this.diagram;this.reset(),this.bind(e,"beforechange",this.onBeforeChange.bind(this)),this.bind(e,"afterchange",this.onAfterChange.bind(this))}}]),n}();var lf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.groups=[]}},{key:"_calculateGroups",value:function(e,t){var n=[];e.concat(t).forEach((function(e){for(var t=e.parent;t&&!n.includes(t);)t.isGroup&&n.push(t),t=t.parent})),this.groups=n.sort((function(e,t){return t.depth-e.depth}))}},{key:"_draw",value:function(){var e=this.groups,t=this.diagram,n=this.action,r=t.rootGroup;e.forEach((function(e){if("add"===n){var t=e.getAllChildren(),o=t.length;if(o>0){t.sort((function(e,t){return e.getZIndex()-t.getZIndex()}));var a=t[o-1];r.insertBefore(e.graphicGroup,a.graphicGroup),r.insertBefore(a.graphicGroup,e.graphicGroup)}}e.draw()}))}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"beforechange",this._onBeforeChange.bind(this)),this.bind(e,"afterchange",this._onAfterChange.bind(this))}},{key:"_onBeforeChange",value:function(e){var t=e.stems,n=e.relatedLines,r=e.action;this.destroyed||"remove"===r&&this._calculateGroups(t,n)}},{key:"_onAfterChange",value:function(e){var t=e.stems,n=e.relatedLines,r=e.action;this.destroyed||("update"!==r&&"add"!==r||this._calculateGroups(t,n),this.action=r,this._draw(),this._initParam())}}]),n}();var uf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterchange",(function(t){if(t){var n=t.models,r=t.action;"remove"===r?function(e,t){t.forEach((function(t){e.emit("vertexcell:remove",{id:t.id})}))}(e,n):"update"===r&&function(e,t){for(var n={},r=!1,o=function(){var o=t[a],i=e.find(o.id),c=["x","y","width","height","shape","rotate","controlPoints","round"];lr(i)&&c.push("html"),mr(i)&&c.push("html"),vr(i)&&c.push("widths","heights"),Er(i)&&c.push("points");var l,u=!1;mr(i)&&(o.hasOwnProperty("width"),u=!0),(sr(i)||hr(i)||mr(i)||vr(i)||Er(i))&&c.some((function(e){return null!=o[e]}))&&(u=!0),u&&(n[o.id]=!0,r||(function(e){for(;e.parent;){if(e.parent.state.selected)return!0;e=e.parent}return!1}(i)||e.selector.selections.length>1)&&(r=!0),i.state.selected&&(Er(i)?e.drawBaseResizer.update():e.vertexRotateResize.update()),null===(l=e.swimlaneResize)||void 0===l||l.update(),e.emit("vertexcell:update",{cell:i}))},a=0;a<t.length;a++)o();r&&e.groupRotateResize.update()}(e,n)}}))}}]),n}();var sf={default:{insertParagraphKey:function(e){return"Enter"===e.key},cancelKey:function(e){return"Escape"===e.key}}},df=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.contentEditor;function n(){if(!e.signal.mouseMultiSelecting){var n=e.selector.selections,r=n[0];if(1===n.length&&r&&r.textareaElement&&r.canText()){var o=r.textareaElement;if(e.destroyed)return;var a=o.htmlContainer;if(t.dom&&t.dom!==a&&t.unbind(),!t.dom&&e.viewportContainer.contains(a)){var i=sf[r.type]||sf.default;t.bind(a,i)}t.isBegin||t.prepareEdit()}else t.unbind(),e.focus()}}var r=De()(n,32);this.bind(e,"afterselect",(function(){e.signal.beforePasteSelect?r():n()})),this.bind(e,"keydown",(function(n){if(!(e.selector.selections.length>1)&&n.key&&["Up","ArrowUp","Left","ArrowLeft","Down","ArrowDown","Right","ArrowRight"].includes(n.key)){var r=e.getCell(n.target);ur(r)&&(t.unbind(),e.focus())}})),this.bind(e,"mousedown",(function(t){var n=e.getCell(t.target);n&&n.textareaElement&&!n.textareaElement.htmlContainer.contains(t.target)&&t.preventDefault()})),this.bind(e,"dblclick",(function(n){var r=n.target,o=n.clientX,a=n.clientY,i=e.getCell(r);if(i&&i.state.selected&&i.textareaElement&&!e.contentEditor.isBegin&&i.canText()){e.selector.selections.length>1&&e.selector.select([i]),t.prepareEdit(),t.beginEdit();var c={};if(ur(i)&&function(e){var t=(new DOMParser).parseFromString(e,"text/html").body;if(0===t.childElementCount){if(""===t.innerText)return!0}else if(1===t.childElementCount){var n;if("​"===(null===(n=t.firstElementChild)||void 0===n?void 0:n.innerText))return!0}return!1}(i.html)){var l=e.viewport.invertClient([o,a]),u=i.getKeyShape().getClosestPoint(l[0],l[1]);c.textPosition=u.percentage}e.update(i,c)}})),this.bind(e,"click",(function(t){var n=e.getCell(t.target);if(n&&n.textareaElement&&n.textareaElement.htmlContainer.contains(t.target)&&"A"===t.target.tagName){if(e.signal.keydown.Mod){var r=t.target.getAttribute("href");if(r)return void window.open(r,"_blank")}t.preventDefault()}}))}}],[{key:"registerContentEditorOptions",value:function(e,t){sf[e]=t}}]),n}();var ff=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;this.bind(e,"afteractivedgroupchange",(function(){t&&(t.updateState(),t=null);var n=e.groupManager.group;n&&(n.updateState(),t=n)}))}}]),n}();var hf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(t){var n=t.selections;n.length>1?e.highlight.select(n.filter((function(e){return e.multiSelectHighlight}))):e.highlight.clear()}))}}]),n}();var pf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"resizer",void 0),c()(A()(e),"selections",[]),c()(A()(e),"cell",void 0),e}return v()(n,[{key:"init",value:function(e){var t=this,n=e.groupRotateResize,r=e.vertexRotateResize,o=e.swimlaneResize,a=e.drawBaseResizer;this.bind(e,"afterselect",(function(e){var i,c=e.selections;if(t.selections=c,t.resizer&&(t.resizer.end(),t.resizer=void 0),1===c.length)i=c[0],hr(i)?t.resizer=n:sr(i)||mr(i)||dr(i)||fr(i)?t.resizer=r:vr(i)||gr(i)?t.resizer=o:Er(i)&&(t.resizer=a);else{var l=t.selections.filter((function(e){return!xr(e)}));l.length>1&&(t.resizer=n,i=l)}t.resizer&&(t.cell=i,t.resizer.init(i),t.resizer.begin())})),this.bind(e,"aftercommandbackward",(function(){t.resizer&&(t.resizer.end(),t.resizer.init(t.cell),t.resizer.begin())})),this.bind(e,"aftercommandforward",(function(){t.resizer&&(t.resizer.end(),t.resizer.init(t.cell),t.resizer.begin())})),this.bind(e,"cell:dragstart",(function(){t.resizer&&t.resizer.hide()})),this.bind(e,"cell:dragend",(function(){t.resizer&&(t.resizer.update(),t.resizer.show())}))}}]),n}();var mf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforechange",(function(e){var t=e.action,n=e.arr;"update"===t&&n.forEach((function(e){var t=e.cell,n=e.model;if(n.shape){if("geometry"!==t.type)return;var r=uc.find((function(e){return e.name===n.shape}));["controlPoints","round"].forEach((function(e){var o=null==r?void 0:r[e];o?n[e]=o:(delete t.model[e],delete t[e])}))}}))}))}}]),n}();function yf(e){var t={stems:[],originModels:[]};return e.forEach((function(e){e.deepEach((function(e){if(!e.isStem)return!1;!function(e){var n=function(e){var t,n=e.model;return ur(e)?t={type:n.type,source:u()(n.source),target:u()(n.target)}:wr(e)||kr(e)?t={type:n.type,points:u()(n.points)}:e.isGroup||(t={type:n.type,x:e.x,y:e.y}),t}(e);n&&Object.keys(n).length>0&&(t.stems.push(e),t.originModels.push(n))}(e)}),(function(t){return"swimlane"===t.type?t.contain.map((function(t){var n;return null===(n=e.diagram.find(t))||void 0===n?void 0:n.model})).filter((function(e){return e})):t.children}))})),t}var vf=[],gf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.originModels=null,this.stems=null,this.dx=0,this.dy=0,this.prepare=!1,this.selectionIds=void 0}},{key:"executeCommand",value:function(){var e=this.diagram,t=this.stems,n=this.dx,r=this.dy,o=this.originModels,a=this.selectionIds;!e.destroyed&&o&&(e.command.execute("Update",{id:t,model:Bd(t,n,r),originModels:o,select:function(){e.selector.select(a)}}),this._initParam())}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"keydown",(function(n){var r,o=t.selector.selections,a=o.filter((function(e){return vf.every((function(t){return t(e)}))})),i=0,c=0;if(!(a.length<=0)){switch(e.selectionIds=o.map((function(e){return e.model.id})),r=n.shiftKey?10:1,n.key){case"Left":case"ArrowLeft":i=-r;break;case"Right":case"ArrowRight":i=r;break;case"Up":case"ArrowUp":c=-r;break;case"Down":case"ArrowDown":c=r;break;default:return}if(0!==i||0!==c){var l=yf(a),u=l.stems,s=l.originModels;e.originModels=e.originModels||s,e.prepare||(e.prepare=!0,t.align.updateToAlginPoints(o));var d=Ar(o),f=t.align.alignByBox({minX:d.minX+i,minY:d.minY+c,maxX:d.maxX+i,maxY:d.maxY+c}),h=!1;Math.abs(f.dx)<1&&0!==f.dx&&(h=!0,i+=f.dx),Math.abs(f.dy)<1&&0!==f.dy&&(h=!0,c+=f.dy),h||t.align.clear(),n.preventDefault(),t.update(u,Bd(u,i,c)),e.stems=u}}})),this.bind(t,"keyup",De()((function(){e.executeCommand()}),400))}}],[{key:"filterCell",value:function(e){vf.push(e)}}]),n}();var bf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"s"!==t.key||ja(t)||(t.preventDefault(),e.command.execute("BeginInsertGeometry"))}))}}]),n}();var xf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"keydown",(function(n){if(ja(n)&&"l"===n.key){n.preventDefault();var r=e.selector.selections;if(t.cell=r[0],2===r.length&&r.every((function(e){return!e.isLine&&!e.isGroup})))return e.command.execute("Add",{model:{type:"line",shape:null,source:{id:r[0].model.id},target:{id:r[1].model.id,marker:"arrow"}}});e.command.execute("BeginInsertLine",{shape:null,marker:"arrow"})}}))}}]),n}();var wf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"t"!==t.key||ja(t)||(t.preventDefault(),e.command.execute("BeginInsertText"))}))}}]),n}();var kf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){e.selector.selections.some((function(e){return e.textareaElement}))&&ja(t)&&("b"===t.key?(t.preventDefault(),e.command.execute("ContentCommand",{name:"bold"})):"i"===t.key?e.command.execute("ContentCommand",{name:"italic"}):"k"===t.key?e.command.execute("CreateLink"):"u"===t.key?e.command.execute("ContentCommand",{name:"underline"}):t.shiftKey&&"x"===t.key&&e.command.execute("ContentCommand",{name:"strikethrough"}))}))}}]),n}();var Ef=new Oc,Of=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector,r=e.viewport;n.selections.length>0&&"d"===t.key&&ja(t)&&(t.preventDefault(),e.command.execute("Copy",{e:Ef}),e.command.execute("Paste",{e:Ef,focusPoint:r.getFocus()}))}))}}]),n}();function Cf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Af(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(!ja(t)&&["Backspace","Delete"].includes(t.key)){if(t.preventDefault(),e.selector.selections.every((function(e){return xr(e)}))||e.selector.selections.every((function(e){return fr(e)})))return;var n=e.deduplicate(e.selector.selections);if(1===n.length&&n[0].isMindmap){var r=n[0],o=r.graphicGroup.rendererElement.querySelector('[data-lake-mindmap-icon-selected="true"]');if(o){var a=o.getAttribute("lake-mindmap-icon-key"),i={icons:Af(Af({},r.model.icons||{}),{},c()({},a,null))};return e.command.execute("Update",{id:r.model.id,model:i,notSelect:!0}),void e.tryFocus()}}e.command.execute("Delete",{cells:n.map((function(e){return e.model.id}))}),e.tryFocus()}}))}}]),n}();var Sf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector;e.groupManager.group&&"Escape"===t.key&&!ja(t)&&(t.preventDefault(),n.clear())}))}}]),n}();var jf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){"g"===t.key&&ja(t)&&!t.shiftKey?(t.preventDefault(),e.command.execute("MakeGroup")):("g"===t.key||"G"===t.key)&&ja(t)&&t.shiftKey&&(t.preventDefault(),e.command.execute("Ungroup"))}))}}]),n}();var Rf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n;t.altKey&&(n={ArrowLeft:"AlignLeft",ArrowRight:"AlignRight",ArrowUp:"AlignTop",ArrowDown:"AlignBottom",KeyH:"AlignHCenter",KeyV:"AlignVCenter"}[t.code]),ja(t)&&(n=(t.altKey?{BracketLeft:"Backward",BracketRight:"Forward"}:{BracketLeft:"ToBack",BracketRight:"ToFront"})[t.code]),n&&(t.preventDefault(),e.command.execute(n))}))}}]),n}();var _f=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ja(t)&&"a"===t.key&&(t.preventDefault(),t.stopPropagation(),e.command.execute("SelectAll"),e.tryFocus())}))}}]),n}();var Mf=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=function(){e.lineAlign.setEnable(!1),e.lineAlign.reset()};this.bind(window,"keydown",(function(){e.signal.keydown.Shift&&e.lineAlign.setEnable(!0)})),this.bind(window,"keyup",(function(){e.signal.keydown.Shift||t()})),this.bind(window,"blur",(function(){t()}))}}]),n}();function Lf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Df=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(A()(e),"updateLine",(function(t){var n=A()(e),r=n.diagram,o=n.line,a=n.origin,i=n.sourceCell,c=r.viewport.invertClient([t.clientX,t.clientY]);if(a&&!o&&i&&ui(a[0],a[1],c[0],c[1])>8)e.line=r.add(e.initLine(c))[0],e.line.graphicGroup.css({cursor:"crosshair"}),r.lineResizer.init(e.line,"target"),r.setCursor("crosshair"),e.clearButton();else if(o){var l=r.lineResizer.resize(t);r.update(o,xe()({},r.settings.line,{target:l}))}})),c()(A()(e),"commitLine",(function(t){var n=A()(e),r=n.line,o=n.diagram,a=n.origin,i=n.sourceCell;if(r||a){var c;if(r)c=r.model,o.remove(r);else if(a){e.updateCurrentDirection(t);var l=e.getTargetConnection(e.currentDirection);c=e.initLine(l)}var u=Object(F.a)();o.command.execute("Add",{model:Tf(Tf({},c),{},{id:u})}),e.clear(),null==c.target.id&&requestAnimationFrame((function(){o.emit("vertexcell:prompt",{line:o.find(u),sourceCell:i})}))}})),c()(A()(e),"revertLine",(function(t){var n=A()(e),r=n.line,o=n.diagram;r&&("Esc"!==t.key&&"Escape"!==t.key||(o.remove(r),e.clear()))})),e.cacheEndpointId=null,e.eventHelper=new fl,e}return v()(n,[{key:"_initHoverButtonDefs",value:function(){var e=this.diagram.defs,t=Object(F.a)(),n=new ho({id:t,fill:"rgba(95, 159, 246, 0.6)",stroke:"rgba(255,255,255,0.15)","stroke-width":1,d:Hn(0,0,5)});e.add(n),this.hoverButtonDefId=t,this.hoverButtonDef=n}},{key:"_initButtonDefs",value:function(){var e=this.diagram.defs,t=Object(F.a)(),n=new ho({id:t,fill:"rgba(51, 132, 245, 0.3)",stroke:"rgba(255,255,255,0.15)","stroke-width":1,d:Hn(0,0,3.5)});e.add(n),this.buttonDefId=t,this.buttonDef=n}},{key:"_initDefs",value:function(){this._initHoverButtonDefs(),this._initButtonDefs()}},{key:"_initButton",value:function(){var e=this,t=this.buttonDefId,n=this.hoverButtonDefId,r=this.diagram,o=new no,a={};["N","E","S","W"].forEach((function(i){var c=new io,l=new To({width:15.27,height:15.27,href:"#".concat(t)}),u=new ho({fill:"rgba(0,0,0,0)",d:Jn(-7.635,-7.635,15.27,15.27)});c.add(l),c.add(u),l.css("pointer-events","none"),u.dataset({testid:"add_line_button_".concat(i)}),u.on("mousedown",(function(n){var o=r.viewport.invertClient([n.clientX,n.clientY]),a=b()(o,2),c=a[0],u=a[1];e.origin=[c,u],l.update({href:"#".concat(t)}),e.updateCurrentDirection(i),r.emit("addlinebuttonmousedown"),r.vertexRotateResize.hide()})),u.on("mouseenter",(function(){r.signal.mouseMultiSelecting||l.update({href:"#".concat(n)})})),u.on("mouseleave",(function(){l.update({href:"#".concat(t)})})),o.add(c),a[i]=c})),o.css({cursor:"copy"}),o.dataset({lake_prevent_click_unselect:!0,testid:"add_line_button_group"}),this.buttonMap=a,this.buttonGroup=o}},{key:"updateButton",value:function(){var e=this.diagram,t=this.sourceCell,n=this.buttonGroup,r=this.buttonMap;if(t){var o=1/e.viewport.zoom,a=t.rotate,i=t.width,c=t.height,l=16/e.viewport.zoom;0===i&&(i=1/0),0===c&&(c=1/0),e.frontRootGroup.add(n),Object.keys(r).forEach((function(e){var n,u=r[e];switch(e){case"N":n=t.percentage2Canvas([.5,-l/c]);break;case"E":n=t.percentage2Canvas([1+l/i,.5]);break;case"S":n=t.percentage2Canvas([.5,1+l/c]);break;case"W":n=t.percentage2Canvas([-l/i,.5])}u.update(Tf(Tf({},n),{},{scale:o,rotate:a}))}))}}},{key:"clearButton",value:function(){var e=this.showButtonGroup;e&&(e.remove(),this.showButtonGroup=null)}},{key:"hide",value:function(){this.buttonGroup.hide()}},{key:"show",value:function(){this.buttonGroup.show()}},{key:"initLine",value:function(e){var t=this.sourceCell,n=this.currentDirection,r=this.diagram,o={type:"line",source:{id:t.model.id,connection:n},target:{connection:e}};return r.hooks.decorateAddLineModel.call(o),o}},{key:"getTargetConnection",value:function(e){var t=this.sourceCell,n=t.getPoint(e),r=n.x,o=n.y,a=t.rotate;switch(e){case"N":a+=270;break;case"E":break;case"S":a+=90;break;case"W":a+=180;break;default:throw new Error("unexpected direction ".concat(e))}var i=ri(a);return[r+50*Math.cos(i),o+50*Math.sin(i)]}},{key:"updateCurrentDirection",value:function(e){var t=this.diagram;if("string"==typeof e)this.currentDirection=e;else{var n=t.viewport.invertClient([e.clientX,e.clientY]),r=b()(n,2),o=r[0],a=r[1],i=this.sourceCell,c=i.getPoint([.5,.5]);if(ui(c.x,c.y,n[0],n[1])>16){var l=fi(c.x,c.y,o,a),u=i.rotate;u<0&&(u+=360);var s=l-(u=ri(u));s<0&&(s+=2*Math.PI),this.currentDirection=Ua(s)}}}},{key:"updateBoundingRect",value:function(e){var t=e.graphicGroup.getBoundingClientRect(),n=t.x,r=t.y,o=r-15.27-16,a=n+t.width+15.27+16,i=r+t.height+15.27+16,c=n-15.27-16;this.boundingRect={top:o,right:a,bottom:i,left:c}}},{key:"update",value:function(e){e&&(this.sourceCell=e,this.showButtonGroup=this.buttonGroup,this.updateBoundingRect(e),this.updateButton())}},{key:"clear",value:function(){this.diagram.lineResizer.reset(),this.clearButton(),this.sourceCell=null,this.boundingRect=null,this.origin=null,this.line=null,this.diagram.resetCursor()}},{key:"init",value:function(e){var t,n=this,r=e.selector;this._initDefs(),this._initButton(),this.eventHelper.bind(e,"afterviewportchange",Le()((function(){t!==e.viewport.zoom&&n.sourceCell&&(n.updateButton(),t=e.viewport.zoom)}))),this.bind(e,"afterselect",(function(){var t=r.selections,o=t[0];1!==t.length||o.isLine||!o.canUseAddLineButton()||n.line||e.signal.cellDragStart?n.clear():n.update(o)})),this.bind(e,"vertexcell:update",(function(e){e.cell===n.sourceCell&&n.updateButton()})),this.bind(e,"vertexcell:remove",(function(e){var t=e.id,r=n.sourceCell;r&&r.model.id===t&&n.clear()})),this.bind(e,"cell:dragstart",(function(){n.clear()})),this.bind(e,"mousemove",Le()((function(e){n.origin&&n.updateLine(e)}),16)),this.bind(e,"mouseup",this.commitLine),this.bind(e,"keydown",this.revertLine),this.bind(e,"vertexresizestart",(function(){return n.hide()})),this.bind(e,"vertexresizeend",(function(){return n.show()}))}},{key:"reset",value:function(){this.hoverButtonDef&&this.hoverButtonDef.destroy(),this.buttonDef&&this.buttonDef.destroy()}}]),n}(),Nf=function(){var e,t=window.appData;return"dark"===(null===(e=(void 0===t?{}:t).themeManager)||void 0===e?void 0:e.current)},Bf=function(e){return Nf()?Ur[e]:Vr[e]},If=[{name:"rect",title:jr("矩形")},{name:"rounded-rect",title:jr("圆角矩形")},{name:"circle",title:jr("圆形")},{name:"triangle",title:jr("三角形")},{name:"diamond",title:jr("菱形")},{name:"parallelogram",title:jr("平行四边形")},{name:"trapezoid",title:jr("梯形")},{name:"cross",title:jr("十字")},{name:"comment-2",title:jr("标注 2")},{name:"comment",title:jr("标注")},{name:"polygon",title:jr("五边形")},{name:"star",title:jr("五角星")},{name:"arrow-1",title:jr("左箭头")},{name:"arrow-2",title:jr("右箭头")},{name:"arrow-3",title:jr("双向箭头")},{name:"pentagon-arrow",title:jr("五边箭头")},{name:"process-arrow",title:jr("流程箭头")},{name:"cloud",title:jr("云")}],Ff=[{name:"swimlane-vertical",title:jr("泳道垂直")},{name:"swimlane-horizontal",title:jr("泳道水平")}],qf=[{name:"pyramid",title:jr("金字塔")},{name:"segmented pyramid",title:jr("分段金字塔")},{name:"stage",title:jr("阶段图")},{name:"architecture",title:jr("架构图")}],zf=[{name:"process",title:jr("过程")},{name:"decision",title:jr("决策")},{name:"start-end",title:jr("起止符")},{name:"subroutine",title:jr("预定义流程")},{name:"document",title:jr("文档")},{name:"multi-document",title:jr("多文档")},{name:"manual-input",title:jr("手动输入")},{name:"preparation",title:jr("准备")},{name:"data",title:jr("数据")},{name:"database",title:jr("数据库")},{name:"hard-disk",title:jr("硬盘")},{name:"internal-storage",title:jr("内部存储")},{name:"paper-tape",title:jr("条带")},{name:"manual-loop",title:jr("手动循环")},{name:"delay",title:jr("延迟")},{name:"stored-data",title:jr("存储数据")},{name:"merge",title:jr("合并")},{name:"connector",title:jr("连接器")},{name:"or",title:jr("或者")},{name:"summing-junction",title:jr("汇总连接")},{name:"display",title:jr("显示")},{name:"off-page",title:jr("页外连接符")},{name:"loop-limit",title:jr("循环起止符")},{name:"card",title:jr("卡片")},{name:"sort",title:jr("排序")},{name:"collate",title:jr("整理")},{name:"parallel",title:jr("并行模式")},{name:"annotation",title:jr("批注")}],Gf=[{name:"actor",title:jr("角色")},{name:"use-case",title:jr("用例")},{name:"package",title:jr("包")},{name:"frame",title:jr("组合片段")},{name:"constraint",title:jr("约束")},{name:"note",title:jr("注释")},{name:"class",title:jr("类")},{name:"activity-class",title:jr("活动类")},{name:"simple-class",title:jr("简单类")},{name:"interface",title:jr("接口")},{name:"multiplicity",title:jr("多类例")},{name:"frequency",title:jr("时间信号")},{name:"activation",title:jr("激活")},{name:"entity",title:jr("实体")},{name:"control",title:jr("控制")},{name:"boundary",title:jr("绑定")},{name:"deletion",title:jr("删除")},{name:"state",title:jr("状态")},{name:"object",title:jr("对象")},{name:"start",title:jr("开始")},{name:"finish",title:jr("结束")},{name:"termination-pseudostate",title:jr("流终止")},{name:"history-pseudostate",title:jr("历史")},{name:"choice",title:jr("分支")},{name:"activity",title:jr("活动")},{name:"send-signal",title:jr("发送信号")},{name:"receive-signal",title:jr("接收信号")},{name:"fork",title:jr("同步")},{name:"component",title:jr("组件")},{name:"node",title:jr("节点")}],Yf=[{name:"er-entity",title:jr("实体")},{name:"weak-entity",title:jr("弱实体")},{name:"derived-attribute",title:jr("派生属性")},{name:"attribute",title:jr("属性")},{name:"multivalued-attribute",title:jr("多值属性")},{name:"relationship",title:jr("关系")},{name:"weak-relationship",title:jr("弱关系")},{name:"generalization",title:jr("概化")},{name:"total-generalization",title:jr("全部概化")}];function Hf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Uf=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var o=Vf({width:32,height:32},e),a=o.width,i=o.height,c=o.noFill,l=e.matrix||[1,0,0,0,1,0,0,0,1];a>0&&(l[0]=a/32),i>0&&(l[4]=i/32),r=t.call(this,Vf(Vf({},e),{},{matrix:l}));var u=e.stencil,s=e.title,d=u.name,f=u.thumb,h=new Ao({x:0,y:0,width:a,height:i,rx:2,fill:c?"none":"#ffffff",stroke:"none"});return r.add(new Mo({title:s})),r.add(h),f.forEach((function(e){var t=ms(e);e.attr&&t.update(e.attr),r.add(t)})),A()(r).rendererElement.setAttribute("data-name",d),r.css({cursor:"pointer"}),r}return v()(n)}();var Wf=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e),c()(A()(r),"shapes",void 0),c()(A()(r),"_height",0);var o=e.key,a=e.title,i=e.shapes;return r.shapes=i,r.title=a,r.rendererElement.setAttribute("data-group",o),r.init(),r}return v()(n,[{key:"init",value:function(){var e=this,t=12,n=0;if(0!==this.shapes.length){Nf();var r=new jo({text:this.title,matrix:[1,0,0,0,1,0,12,15,1],fill:Bf("text")});this.text=r,r.css({fontSize:"14px","dominant-baseline":"hanging"}),this.add(r),n+=39,this.shapes.forEach((function(r){var o=r.name,a=r.title,i=uc.find((function(e){return e.name===o}));t>=200&&(t=12,n+=34);var c=new Uf({stencil:i,matrix:[1,0,0,0,1,0,t,n,1],noFill:!0,stroke:Bf("text"),fill:"transparent",title:a});e.add(c),t+=32})),n+=32,this._height=n}}},{key:"height",get:function(){return this._height}}]),n}();function Xf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zf={basic:{title:jr("基础图形"),shapes:If},flowchart:{title:jr("流程图"),shapes:zf},UML:{title:jr("UML"),shapes:Gf},ER:{title:jr("ER"),shapes:Yf},DSL:{title:jr("Smart"),shapes:qf}},Qf=function(e){S()(n,no);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var o=Kf({groups:["basic"]},e);return r=t.call(this,o),c()(A()(r),"latest",{title:jr("最近使用"),shapes:[]}),c()(A()(r),"latestGroup",void 0),c()(A()(r),"shapeGroups",[]),c()(A()(r),"_height",0),c()(A()(r),"backgroundColor",void 0),c()(A()(r),"groupMap",void 0),c()(A()(r),"cancelThemeListener",void 0),r.groups=o.groups,r.containerHeight=o.containerHeight,r.init(),r.bindEvent(),r}return v()(n,[{key:"width",get:function(){return 215}},{key:"height",get:function(){return this._height}},{key:"init",value:function(){var e,t=this,n=this.options;this.backgroundColor=null!==(e=n.backgroundColor)&&void 0!==e?e:Bf("background");var r=0;this.groupMap=u()(Zf);var o=this.groups.map((function(e){var n;if("latest"===e)(n=t.latest).shapes=t.getLatest();else{n=t.groupMap[e];var o=t.options.basicWithSwimlane;"basic"===e&&o&&(n.shapes=[].concat(T()(n.shapes),T()(Ff)))}var a=r,i=new Wf(Kf(Kf({},n),{},{key:e,title:n.title}));return i.update({matrix:[1,0,0,0,1,0,0,a,1]}),r+=i.height,n.height=i.height,"latest"===e&&(t.latestGroup=i),t.shapeGroups.push(i),i}));this.background=new Ao({x:0,y:0,width:215,height:r,fill:this.backgroundColor}),this.add(this.background),o.forEach((function(e){return t.add(e)})),this.updateHeight(r)}},{key:"getLatest",value:function(){var e,t=r.LocalStorageUtil.getItem("lake_diagram_graphic_latest_used");try{e=JSON.parse(t)||[]}catch(t){e=[]}for(var n=function(){var t,n=e[o];n.title="";var r=null===(t=Zf[n.category])||void 0===t?void 0:t.shapes;if(r){var a=r.findIndex((function(e){return e.name===n.name}));a>=0&&(n.title=r[a].title)}},o=0;o<e.length;o++)n();return e}},{key:"bindEvent",value:function(){var e,t,n,r,o=this;this.on("mouseover",Le()((function(e){for(var t=e.target.closest("[data-name]"),n=o.rendererElement.querySelectorAll("[data-name]"),r=0;r<n.length;r++){var a=n[r],i=a.querySelector("path");i&&i.setAttribute("fill",a===t?Bf("hover"):"transparent")}}),16)),this.on("mouseleave",Le()((function(){if(e){var t=e.querySelector("path");t&&t.setAttribute("fill","transparent")}}),16)),this.on("click",(function(t){var n=t.target.closest("[data-name]");if(n){var r,a=n.dataset.name,i=n.closest("[data-group]").dataset.group,c=uc[uc.findIndex((function(e){return e.name===a}))],l=(null==c||null===(r=c.outline)||void 0===r?void 0:r.attr)||{},u=c.type||"geometry",s=c.category;o.emit("shape:select",{shape:a,group:i,type:u,category:s,attr:l}),e=n}})),this.cancelThemeListener=(t=function(){o.init()},null==(r=(void 0===(n=window.appData)?{}:n).themeManager)?void 0:r.onChange(t))}},{key:"updateGroups",value:function(e){this.groups=e,this.init(),this.updatePosition()}},{key:"updatePosition",value:function(){var e=this,t=0;this.groups.forEach((function(n,r){var o,a=e.shapeGroups[r];o="latest"===n?e.latest:e.groupMap[n];var i=t;t+=o.height,a.update({matrix:[1,0,0,0,1,0,0,i,1]})})),this.updateHeight(t),this.emit("update:height",{height:t})}},{key:"updateHeight",value:function(e){var t=this.containerHeight,n=this.groups;this._height=t?e+(t-this.groupMap[n[n.length-1]].height):e,this._height+=6,this.background.update({d:Jn(0,0,215,this._height)})}},{key:"getOffset",value:function(e){for(var t=this.groups,n=t.indexOf(e),r=0,o=0;o<n;o++){var a=t[o];r+=this.groupMap[a].height}return r}},{key:"destroy",value:function(){this.cancelThemeListener&&this.cancelThemeListener(),N()(M()(n.prototype),"destroy",this).call(this)}}]),n}();function $f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$f(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var eh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"onShapeSelect",(function(t){var n=t.shape,r=t.type,o=t.category,a=A()(e),i=a.diagram,c=a.line,l=a.sourceCell,u=c.target.connection,s=e.computeInheritedStyles(n,r),d=uc.find((function(e){return e.name===n})),f=e.adjustVertexPosition(u,n,l.stroke,d),h=b()(f,2),p=h[0],m=h[1],y={model:Jf({shape:n,type:r,category:o,x:p,y:m},s),lineId:c.model.id,cellOptions:{}};i.hooks.decorateAddVertexModel.call(y.model);var v="AddVertex";["controlPoints","round"].forEach((function(e){null!=d&&d[e]&&!y.model[e]&&(y.model[e]=d[e])})),"stack"===r?(v="AddStackVertex",y.htmls=d.htmls,y.model.row=d.row):y.model.html=d.html||Md,i.command.execute(v,y),e.closePanel()})),e}return v()(n,[{key:"initPanel",value:function(){var e=this.diagram.defs;this.filterId=Object(F.a)();var t=new Vo,n=new Go({dx:0,dy:0,stdDeviation:4,"flood-color":"rgba(0, 0, 0, 0.13)"});t.attr({id:this.filterId}),t.add(n),e.add(t)}},{key:"computeInheritedStyles",value:function(e,t){var n=this.sourceCell;if(n.type!==t)return{};var r=n.width,o=n.height,a={stroke:n.stroke,fill:n.fill};return n.shape===e&&(Object.assign(a,{width:r,height:o}),["controlPoints","round"].forEach((function(e){n[e]&&Object.assign(a,c()({},e,n[e]))}))),a}},{key:"closePanel",value:function(){var e=this.diagram,t=this.panel,n=e.frontRootGroup;t&&n.removeChild(t),e.signal.addVertexPanelVisibility=!1,this.direction=null,this.line=null,this.sourceCell=null}},{key:"adjustPanelPosition",value:function(e){var t=this.diagram,n=this.direction,r=this.panel,o=t.viewportContainer.getBoundingClientRect(),a=r.getBBox(),i=t.viewport.invertViewport([o.width-a.width-8,o.height-a.height-8]),c=Math.min(e[0]+8,i[0]),l=Math.min(e[1]+8,i[1]);return"N"===n?c<e[0]+8&&(c=e[0]-8-a.width):"E"===n?c<e[0]+8&&l<e[1]+8&&(l=e[1]-8-a.height):"S"===n?c<e[0]+8&&l<e[1]+8&&(c=e[0]-8-a.width):"W"===n&&l<e[1]+8&&(l=e[1]-8-a.height),[c,l]}},{key:"adjustVertexPosition",value:function(e,t,n,r){var o,a,i=this.direction,c=this.sourceCell,l=b()(e,2),u=l[0],s=l[1],d=(n.width||2)/2;switch(t===c.shape?(o=c.width,a=c.height):(o=r.width,a=r.height),i){case"N":u-=o/2,s-=a+d;break;case"E":u+=d,s-=a/2;break;case"S":s+=d,u-=o/2;break;case"W":u-=o+d,s-=a/2}return[u,s]}},{key:"getDirection",value:function(e){var t=Qn(e.d).slice(-2),n=t[0].slice(1),r=t[1].slice(1);return Ua({x:n[0],y:n[1]},{x:r[0],y:r[1]})}},{key:"updatePanel",value:function(e){var t=this.diagram,n=t.frontRootGroup,r=e.line,o=e.sourceCell,a=uc.find((function(e){return e.name===o.shape})),i=(null==a?void 0:a.category)||"basic",c=new Qf({groups:["latest",i]});c.css({filter:"url(#".concat(this.filterId,")")}),this.panel=c,this.panel.on("shape:select",this.onShapeSelect),n.add(this.panel),this.line=r,this.sourceCell=o,this.direction=this.getDirection(r);var l=r.target.connection,u=this.adjustPanelPosition(l),s=b()(u,2),d=s[0],f=s[1],h=1/t.viewport.zoom;this.panel.update({matrix:[h,0,0,0,h,0,d,f,1]}),t.signal.addVertexPanelVisibility=!0}},{key:"init",value:function(e){var t=this;this.diagram=e,this.line=null,this.sourceCell=null,this.direction=null,this.initPanel(),this.bind(e,"vertexcell:prompt",(function(e){return t.updatePanel(e)})),this.bind(e,"mousedown",(function(e){var n=t.panel;n&&!n.rendererElement.contains(e.target)&&t.closePanel()})),this.bind(e,"keyup",(function(e){!t.panel||"Esc"!==e.key&&"Escape"!==e.key||t.closePanel()}))}}]),n}();function th(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var nh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"onMouseMove",(function(t){e.delegation||e.initDelegation();var n=A()(e).delegation,r=e.getPoint(t),o=b()(r,2),a=o[0],i=o[1];n.translate(a,i)})),c()(A()(e),"onClick",(function(t){e.clear();var n=A()(e).diagram,r=n.settings.image,o=r.insertFiles,a=r.insertModel,i=e.getPoint(t),c=b()(i,2),l=c[0],u=c[1];n.interaction.changeMode("edit"),n.emit("importimage",{files:o,x:l,y:u,from:"clickinsert",width:a.width,height:a.height})})),e}return v()(n,[{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"initDelegation",value:function(){var e=this.diagram,t=e.settings.image,n=e.add(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?th(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):th(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:"image",x:0,y:0},t.insertModel))[0];this.delegation=e.delegator.create([n]),this.cell=n,n.hide()}},{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){e.canvas.rendererElement.contains(n.target)||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var e=this.cell,t=this.delegation,n=this.diagram;e&&!e.destroyed&&n.remove(e.model.id),t&&t.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),N()(M()(n.prototype),"unbind",this).call(this)}}]),n}();function rh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ah=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"line",void 0),c()(A()(e),"source",void 0),c()(A()(e),"target",void 0),c()(A()(e),"onMouseDown",(function(t){var n=A()(e).diagram,r=e.getPoint(t);e.source=n.connect.findEndPoint(r)})),c()(A()(e),"onMouseMove",(function(t){var n=A()(e),r=n.diagram,o=n.line,a=n.source,i=e.getPoint(t),c=r.connect.findEndPoint(i);if(o){var l=r.lineResizer.resize(t);r.update(o,{target:l})}else a&&function(e,t){return t.id!==e.id||(t.connection&&e.connection?ui(t.connection[0],t.connection[1],e.connection[0],e.connection[1])>8:void 0)}(a,c)&&e.beginInsertLine({source:a,target:c})})),c()(A()(e),"onMouseUp",(function(){var t=A()(e),n=t.diagram,r=t.line;e.clear(),n.interaction.changeMode("edit"),r&&n.command.execute("Add",{model:oh(oh({},r.model),{},{id:null})})})),e}return v()(n,[{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"beginInsertLine",value:function(e){var t=e.source,n=e.target,r=this.diagram;t.id&&(t.connection=null);var o=xe()({},r.settings.line,{type:"line",source:t,target:oh({},n)});r.hooks.decorateAddLineModel.call(o);var a=r.add(o)[0];this.line=a,r.lineResizer.init(a,"target")}},{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"begininsertline",(function(e){t.beginInsertLine(e)})),this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"mousedown",this.onMouseDown),this.bind(e,"mouseup",this.onMouseUp),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var e=this.line,t=this.diagram;t&&(t.lineResizer.reset(),e&&t.remove(e),this.line=void 0,this.source=void 0)}},{key:"unbind",value:function(){this.clear(),N()(M()(n.prototype),"unbind",this).call(this)}}]),n}();function ih(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ch(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ih(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ih(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"delegation",void 0),c()(A()(e),"cell",void 0),c()(A()(e),"lastSwimlane",void 0),c()(A()(e),"onMouseMove",(function(t){e.delegation||e.initDelegation();var n=A()(e).diagram,r=A()(e).delegation,o=e.getPoint(t),a=b()(o,2),i=a[0],c=a[1];if(e.cell){var l;e.cell.matrix=[1,0,0,0,1,0,i,c,1];var u,s=null===(l=n.swimlane)||void 0===l?void 0:l.findSwimlane([e.cell]);if(s&&s!==e.lastSwimlane)null===(u=n.swimlane)||void 0===u||u.highlight(s);else if(!s){var d;null===(d=n.swimlane)||void 0===d||d.unhighlight()}e.lastSwimlane=s}null==r||r.translate(i,c)})),c()(A()(e),"onClick",(function(t){var n=A()(e).diagram;e.clear();var r=n.settings.vertex,o=e.getPoint(t),a=b()(o,2),i=a[0],c=a[1],l=Object(F.a)(),u=uc.find((function(e){return e.name===r.shape})),s={model:ch(ch({},r),{},{id:l,x:i,y:c})};null!=u&&u.controlPoints&&(s.model.controlPoints=u.controlPoints),null!=u&&u.round&&(s.model.round=u.round);var d="Add";if(n.interaction.changeMode("edit"),u)if("stack"===r.type)d="AddStack",s.model.row=u.row,s.htmls=u.htmls,delete s.model.html;else if("swimlane"===r.type)d="AddSwimlane",s.number=u.number,s.model.widths=u.widths,s.model.heights=u.heights,s.htmls=u.htmls,s.stencil=u,delete s.model.html;else if("dsl"===r.type){var f;d="AddDsl";var h=null===(f=u.parse)||void 0===f?void 0:f.call(u,u.htmls);s.models=null==h?void 0:h.models,delete s.model.html}n.hooks.decorateAddVertexModel.call(s.model),n.command.execute(d,s),delete r.fill,delete r.stroke,delete r.controlPoints,delete r.round})),e}return v()(n,[{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){e.canvas.rendererElement.contains(n.target)||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"initDelegation",value:function(){var e=this.diagram,t=e.settings.vertex,n=uc[uc.findIndex((function(e){return e.name===t.shape}))],r={};"swimlane"===(null==n?void 0:n.type)&&(r.number=n.number,r.widths=n.widths,r.heights=n.heights,r.htmls=n.htmls);var o=ch(ch(ch({},t),r),{},{x:0,y:0});e.hooks.decorateAddVertexModel.call(o);var a=e.add(o)[0];this.delegation=e.delegator.create([a]),this.cell=a,a.hide()}},{key:"clear",value:function(){var e,t=this.cell,n=this.delegation,r=this.diagram;null==r||null===(e=r.swimlane)||void 0===e||e.unhighlight(),t&&!t.destroyed&&r.remove(t.model.id),n&&n.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),N()(M()(n.prototype),"unbind",this).call(this)}}]),n}();var uh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"dblclick",(function(t){var n=e.viewport.invertClient([t.clientX,t.clientY,1]),r=e.getCell(t.target);if(r&&r.isGroup){var o=e.groupManager.enter(r,{x:n[0],y:n[1]});o&&e.selector.select(o)}})),this.bind(e,"afterselect",(function(t){e.groupManager.group&&0===t.selections.length&&e.groupManager.exit()}))}}]),n}();var sh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,o,a=!1;function i(){a=!1,t=0,n=0,r=0,o=0,e.input.style.display=""}this.bind(e,"dragstart",(function(i){var c=i.evt;a=!0,t=c.clientX,n=c.clientY,r=e.viewport.scrollLeft,o=e.viewport.scrollTop,e.input.style.display="none"})),this.bind(e,"drag",Le()((function(i){var c=i.evt;if(a){var l=r-(c.clientX-t),u=o-(c.clientY-n);e.viewport.setScroll(l,u)}}),16)),this.bind(e,"dragend",(function(){i()})),this.bind(e,"mouseleave",(function(){i()}))}}]),n}();var dh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(A()(e),"default",void 0),c()(A()(e),"diagram",void 0),c()(A()(e),"selectedCells",void 0),c()(A()(e),"dragCells",void 0),c()(A()(e),"startBox",void 0),c()(A()(e),"originModels",void 0),c()(A()(e),"dragClone",void 0),c()(A()(e),"dragCloneModels",void 0),c()(A()(e),"dx",0),c()(A()(e),"dy",0),c()(A()(e),"startClient",void 0),c()(A()(e),"startPoint",void 0),c()(A()(e),"onMouseMoveEvent",void 0),e.default={selectedCells:void 0,dragClone:void 0,dragCells:void 0,startPoint:void 0,startBox:void 0,originModels:void 0,startClient:void 0,onMouseMoveEvent:void 0,dx:0,dy:0},Object.assign(A()(e),e.default),e}return v()(n,[{key:"reset",value:function(){var e=this.diagram;this.dragCells&&this.dragCells.length>1&&e.highlight.show(),this.onMouseMoveEvent&&this.unbind(this.onMouseMoveEvent),e.signal.cellDragStart=!1,e.align.clear(),Object.assign(this,this.default)}},{key:"initDragData",value:function(){var e=this.diagram;if(!e.contentEditor.isBegin){var t=e.selector.selections;if(1!==t.length||!ur(t[0])||!t[0].isConnected()){var n,r=e.selector.selections.filter((function(e){return e}));if(e.signal.keydown.Alt){var o=r.sort((function(e,t){return e.getZIndex()-t.getZIndex()})).map((function(e){return u()(e.model)}));o.forEach((function(e){"swimlane"===e.type&&(e.contain=[])})),n=e.add(e.importer.clone(o)),this.dragClone=!0,this.dragCloneModels=o}else n=r;var a=n[0];1!==n.length||a.isLine?n.length>1&&e.align.updateToAlginPoints(n):e.align.updateToAlginPoints(a),1!==n.length||a.isLine?n.length>1&&(this.startBox=Ar(n)):(this.startBox=a.getBBox(),n=n.filter((function(e){return!ur(e)||["source","target"].every((function(t){return!e[t].id}))})));var i=yf(n),c=i.stems,l=i.originModels;this.selectedCells=n,e.align.prepareForDistribute(n),this.dragCells=c,this.originModels=l}}}},{key:"getCurrentBox",value:function(){return{minX:this.startBox.minX+this.dx,maxX:this.startBox.maxX+this.dx,minY:this.startBox.minY+this.dy,maxY:this.startBox.maxY+this.dy}}},{key:"init",value:function(){var e,t,n=this,r=this.diagram,o=function(){return Bd(n.originModels,n.dx,n.dy)},a=Le()((function(a){if(r.signal.cellDragStart){var i,c=r.viewport.invertClient([a.clientX,a.clientY]);if(n.dx=c[0]-n.startPoint[0],n.dy=c[1]-n.startPoint[1],n.startBox){var l=r.align.alignByBox(n.getCurrentBox());n.dx+=l.dx,n.dy+=l.dy,l=r.align.alignDistribute(n.getCurrentBox()),n.dx+=l.dx,n.dy+=l.dy}var u,s=o();if(r.update(n.dragCells,s),(t=null===(i=r.swimlane)||void 0===i?void 0:i.findSwimlane(n.dragCells))&&e!==t)null===(u=r.swimlane)||void 0===u||u.highlight(t);else if(!t){var d;null===(d=r.swimlane)||void 0===d||d.unhighlight()}e=t}else{if(ui(n.startClient[0],n.startClient[1],a.clientX,a.clientY)<8)return;if(n.initDragData(),!n.dragCells)return;r.signal.cellDragStart=!0,r.emit("cell:dragstart"),n.dragCells.length>1&&r.highlight.hide(),1===n.dragCells.length&&r.contentEditor&&(r.contentEditor.unbind(),r.focus())}}),16),i=function(){var e,t,i=n.selectedCells,c=n.originModels,l=n.dragCloneModels,u=[],s=function(){var e=i.map((function(e){return e.model.id})).map((function(e){return r.find(e)})).filter((function(e){return e}));r.selector.select(e)};if(n.dragClone)r.remove(i),Id(l,n.dx,n.dy),u.push("Add",{model:l,select:s});else{var d,f=o(),h=null===(d=r.swimlane)||void 0===d?void 0:d.findSwimlane(n.dragCells);(n.dragCells.some((function(e){return e.swimlane}))||h)&&n.dragCells.every((function(e){return!vr(e)}))?u.push("InteractSwimlane",{id:n.dragCells,model:f,parent:h,select:s,originModels:c}):u.push("Update",{id:n.dragCells.map((function(e){return e.model.id})),model:f,select:s,originModels:c})}r.emit("cell:dragend",{cells:n.dragCells}),a.cancel(),n.reset(),(e=r.command).execute.apply(e,u),null===(t=r.swimlane)||void 0===t||t.unhighlight()},c=function(){var t;e=void 0,null===(t=r.swimlane)||void 0===t||t.unhighlight(),a.cancel(),n.reset()};this.bind(r,"mousedown",(function(e){if(!r.signal.lineTextMouseDown){var t=e.target,o=e.clientX,i=e.clientY,c=e.button,l=r.getCell(t);0===c&&l&&l.isStem&&(n.startClient=[o,i],n.startPoint=r.viewport.invertClient([o,i]),n.onMouseMoveEvent=n.bind(r,"mousemove",a))}})),this.bind(r,"mouseup",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?i():c()})),this.bind(r,"mouseleave",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?i():c()}))}}]),n}();var fh=ho,hh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"unbindMousemoveEvent",value:function(){this.mouseMoveEvent&&(this.unbind(this.mouseMoveEvent),this.mouseMoveEvent=void 0)}},{key:"init",value:function(e){var t,n,r,o=this;e.signal.mouseMultiSelecting=!1;var a=new fh({fill:"rgba(9, 109, 217, .05)",stroke:"#3384F5"});function i(o){if(t){e.signal.mouseMultiSelecting=!0,n=e.viewport.invertClient([o.clientX,o.clientY]);var i={minX:Math.min(t[0],n[0]),minY:Math.min(t[1],n[1]),width:Math.abs(n[0]-t[0]),height:Math.abs(n[1]-t[1])};i.maxX=i.minX+i.width,i.maxY=i.minY+i.height;var c=Jn(i.minX,i.minY,i.width,i.height);a.update({d:c}),cn(r=e.groupManager.getCells().filter((function(e){if(e.state.visible&&e.state.capture){var t=mr(e)?e.getKeyShapeBox():e.getBBox();if(ci(t,i)){if(vr(e))return ii(i,t);if(gr(e))return!1;if(ur(e)){var n=e.d;if(!ii(i,t)&&0===Ve()(c,n).length)return!1}return!0}}return!1})),e.selector.selections)||e.selector.select(r)}}a.dataset({testid:"mouse-drag-multi-select"}),this.selectBox=a,this.bind(e,"mousedown",(function(n){(function(t){return 0===t.button&&(t.target===e.canvas.rendererElement||void 0)})(n)&&(o.unbindMousemoveEvent(),o.mouseMoveEvent=o.bind(window,"mousemove",Le()(i,16)),e.frontRootGroup.add(a),t=e.viewport.invertClient([n.clientX,n.clientY]))})),this.bind(window,"mouseup",(function(){t&&e.tryFocus(),e.signal.mouseMultiSelecting=!1,r&&r.length>0&&e.selector.select(r),r=void 0,t=void 0,n=void 0,o.unbindMousemoveEvent(),a.remove(),a.update({d:""})}))}},{key:"unbind",value:function(e){!e&&this.selectBox&&(this.selectBox.remove(),this.selectBox=void 0),N()(M()(n.prototype),"unbind",this).call(this,e)}}]),n}();var ph=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"reset",value:function(){this.unbind()}},{key:"init",value:function(e){var t,n,r,o,a,i,c=this,l=!0;this.bind(e,"line:mousedown",(function(u){if(!e.contentEditor.isBegin&&ur(u.cell)&&u.target.closest("foreignObject")){e.selector.select([]),n=u.cell,e.signal.lineTextMouseDown=!0,a={textPosition:void 0===n.textPosition?.5:n.textPosition,textDirection:void 0===n.textDirection?"center":n.textDirection};var s=n.getKeyShape();t=c.bind(e,"mousemove",Le()((function(t){if(n&&s)if(l){e.selector.select([]),l=!1;var a="curve"===n.shape?s.getTotalLength()/500:1.5;i=function(e,t){for(var n,r=e.getTotalLength(),o=[],a=[],i=0;i<=r;i+=t)n=e.getPointAtLength(i),o.push([n.x,n.y]),a.push(i/r);return{points:o,percentages:a}}(s,a)}else if(i){var c=e.viewport.invertClient([t.x,t.y]),u=s.getClosestPoint(n.canvas2Relative(c),i.points),d=i.points[u],f=ui(c[0],c[1],d[0],d[1]);r=i.percentages[u];var h=1;if(f<=20)o="center",h=1;else if(f<=60){var p=n.getTwoPointsByPercent(r),m=b()(p,2),y=m[0],v=m[1],g=n.canvas2Relative(c),x=Ai(g,y,v);o=x?"right":"left"}else r=void 0,h=.5;e.update(n,{textPosition:r,textDirection:o,opacity:h})}}),16))}}));var u=function(){e.signal.lineTextMouseDown=!1,t&&n&&(e.update(n,{opacity:1}),r&&n&&e.command.execute("Update",{id:n.model.id,model:{textPosition:r,textDirection:o},originModels:a}),c.unbind(t),t=void 0,n=void 0,a=void 0,l=!0,i=void 0,o=void 0,r=void 0)};this.bind(e,"mouseup",(function(){u()})),this.bind(e,"mouseleave",(function(){u()}))}}]),n}();var mh=r.FileUtils.isImage,yh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"dragover",(function(e){e.preventDefault()})),this.bind(e,"drop",(function(t){t.preventDefault();var n=Array.from(t.dataTransfer.files).filter((function(e){return mh(e)}));n[0]&&e.emit("importimage",{files:n,from:"drop"})}))}}]),n}();var vh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"groupcellrect:mouseenter",(function(e){e.cell.hover(!0)})),this.bind(e,"groupcellrect:mouseleave",(function(e){e.cell.hover(!1)}))}}]),n}();var gh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"mouseenter",(function(){e.signal.mouseenter=!0})),this.bind(e,"mouseleave",(function(){e.signal.mouseenter=!1})),this.bind(e,"mousedown",(function(){t.mousemovePrevent=t.bind(e,"mousemove",(function(t){e.signal.dragging||(e.signal.dragging=!0)}))})),this.bind(e,"mouseup",(function(){e.signal.dragging=!1,t.mousemovePrevent&&t.unbind(t.mousemovePrevent)}))}}]),n}();var bh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforecommandexecute",(function(t){var n=t.commandName,r=t.command;if("Add"===n&&"line"===r.model.type){var o={};xe()(o,e.settings.line,r.model),r.model=o}})),this.bind(e,"aftercommandexecute",(function(t){var n=t.command;if("Update"===t.commandName&&1===(null==n?void 0:n.id.length)&&n.id[0].isLine){var r,o,a=n.id[0];e.settings.line={shape:a.shape,stroke:a.stroke,target:{marker:null==a||null===(r=a.target)||void 0===r?void 0:r.marker},source:{marker:null==a||null===(o=a.source)||void 0===o?void 0:o.marker}}}}))}}]),n}();var xh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",new no),e}return v()(n,[{key:"init",value:function(e){var t=this,n=new jo({fill:"#fff","dominant-baseline":"hanging"});n.css({fontFamily:"system-ui",fontSize:"".concat(12,"px")});var r=new ho({fill:"rgba(0,0,0,0.7)",stroke:"none"});this.group.add(r),this.group.add(n),this.group.hide(),e.frontRootGroup.add(this.group),this.bind(e,"cellrotate",(function(o){var a=o.cell,i="".concat(o.rotate,"°"),c=1/e.viewport.zoom,l=8*c,u=4*c,s=24*c,d=3*c,f=12*c,h=e.font.measureTextLength(i,{fontSize:"".concat(f,"px")})+l+u,p=16*c,m=a.x,y=a.y,v=a.width,g=a.height,b=a.rotate,x=new Mn({x:m,y:y,w:v,h:g,r:b}),w=x.center.x,k=Math.max(x.tl.y,x.tr.y,x.bl.y,x.br.y)+s,E=4*c,O=h/2,C=p/2,A=O<E?O:E,P=C<E?C:E;r.update({d:Jn(w-h/2,k,h,p,A,P)}),n.update({x:w-h/2+l,y:k+d,text:i}),n.css({fontSize:"".concat(f,"px")}),t.group.show()})),this.bind(e,"mouseup",(function(){t.group.hide()}))}},{key:"reset",value:function(){this.group.clear(),this.unbind()}}]),n}();var wh=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"manager",void 0),e}return v()(n,[{key:"init",value:function(e){if(pe.ua.mobile){var t=e.viewport,n=new We.a.Manager(e.canvasContainer);this.manager=n;var r=new We.a.Pan,o=new We.a.Pinch({enable:!0}),a=new We.a.Tap({event:"doubleTap",taps:2});n.add(o),n.add(a),n.add(r);var i=1,c=t.scrollLeft,l=t.scrollTop;n.on("panstart",(function(){c=t.scrollLeft,l=t.scrollTop})),n.on("panmove",(function(e){t.setScroll(c-e.deltaX,l-e.deltaY)})),n.on("pinchstart",(function(){i=t.zoom})),n.on("pinchmove",(function(e){t.setViewport(e.scale-1+i,[e.center.x,e.center.y])})),n.on("doubleTap",(function(){t.autoFit()}))}}},{key:"reset",value:function(){var e;null===(e=this.manager)||void 0===e||e.destroy()}}]),n}(),kh=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),c()(this,"lineCache",void 0),this.diagram=t}return v()(e,[{key:"reset",value:function(){this.diagram.update(this.lineCache.map((function(e){return e.id})),this.lineCache)}},{key:"pin",value:function(){var e=this.diagram;this.lineCache.map((function(t){return e.find(t.id)})).filter((function(e){return e})).forEach((function(e){var t=e.source,n=e.target,r=e.diagram,o=Qn(e.wireElement.attr("d")),a={};if(r.find(t.id)||(a.source={id:null,connection:[o[0][1],o[0][2]]}),!r.find(n.id)){var i=o.length-1,c=o[i].length;a.target={id:null,connection:[o[i][c-2],o[i][c-1]]}}e.update(a)}))}},{key:"cache",value:function(e){var t=this.diagram,n=e.reduce((function(e,t){return"string"==typeof t?e[t]=!0:t.getAllCells().forEach((function(t){e[t.model.id]=!0})),e}),{});this.lineCache=t.getCells().filter((function(e){if(e.isLine){var t=e.model,r=t.target.id,o=t.source.id;return r&&n[r]||o&&n[o]}return!1})).map((function(e){var t=e.model,n={id:t.id,target:u()(t.target),source:u()(t.source)};return n.target.connection||(n.target.connection=null),n.source.connection||(n.source.connection=null),n}))}}]),e}();var Eh=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).pinLine=new kh(e.diagram),r}return v()(n,[{key:"selectParent",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id).parent;this.select(n&&n.model.id)}},{key:"findNearestCell",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id),r=[];if(!mr(n))return r;var o=n.parent;if(t[0].length>1&&o)return r.push(o.model.id),r;if(1===t[0].length&&o){var a=o.getChildren().filter((function(e){return e.upSignX===n.upSignX&&e.upSignY===n.upSignY})),i=a.indexOf(n);if(o.model.children){var c=a[i-1];if(c)return r.push(c.model.id),r;var l=a[i+1];if(l)return r.push(l.model.id),r}return r.push(o.model.id),r}return r}},{key:"execute",value:function(){var e=this.diagram,t=this.id,n=this.pinLine,r=ar(t,{}),o=r[0].map((function(t){return e.find(t)}));o.forEach((function(t,n){r[0][n]=u()(t.model),r[1][n]=e.getCellOptions(t)})),this.changeArguments=r,n.cache(o),this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.pinLine,r=this.findNearestCell();e.remove(t[0].map((function(e){return e.id}))),this.select(r),e.tryFocus(),n.pin()}},{key:"backward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.pinLine,r=e.add.apply(e,T()(t));n.reset(),this.select(r),e.tryFocus()}}]),n}();function Oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(Eh,"className","Remove");var Ch=function(e){S()(n,Eh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"diagram",void 0),c()(A()(r),"deletedCells",void 0),c()(A()(r),"records",void 0),r.diagram=e.diagram,r}return v()(n,[{key:"execute",value:function(){var e=this;this.cells||(this.cells=this.diagram.selector.selections);var t=this.cells;this.id=[],this.records=new Map,this.deletedCells=new Set,this.deletedSwimlanes=new Set,t.forEach((function(t){var n=e.diagram.find(t);n&&n.canDelete()&&(e.id.push(n.model.id),e.deletedCells.add(n.model.id))})),N()(M()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e=this,t=this.diagram,r=new Set;this.deletedCells.forEach((function(n){var o=t.find(n);if(o){var a=va(o);if(vr(a))a.model.contain.forEach((function(n){if(!e.deletedCells.has(n)){var r=t.find(n);r&&(t.swimlane.unbind(r,a),e.records.set(r.model.id,a.model.id))}}));else if(e.deletedCells.has(a.model.id)&&!r.has(a.model.id)&&a.swimlane&&!e.deletedCells.has(a.swimlane)){var i=t.find(a.swimlane);i&&(r.add(i.model.id),t.swimlane.unbind(a,i),e.records.set(a.model.id,i.model.id))}}})),N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){N()(M()(n.prototype),"backward",this).call(this);var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Oh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oh(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(this.records.entries());try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),o=r[0],a=r[1];this.diagram.swimlane.bind(o,a)}}catch(e){t.e(e)}finally{t.f()}}}]),n}();c()(Ch,"className","Delete"),c()(Ch,"enable",(function(e){return!0}));var Ah=function(e){S()(n,Ch);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){jc(this.e,this.diagram),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Ah,"className","Cut"),c()(Ah,"isModelChange",!0);var Ph=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this);var e=this.diagram,t=this.lineId,r=this.model,o=e.find(t);this.originTarget=["id","connection","marker"].reduce((function(e,t){var n=o.target[t];return e[t]=null==n?null:n,e}),{}),e.update(o,{target:{id:r.id,connection:null}})}},{key:"forward",value:function(){N()(M()(n.prototype),"forward",this).call(this);var e=this.diagram,t=this.lineId,r=this.model,o=e.find(t);o&&!o.destroyed&&e.update(o,{target:{id:r.id,connection:null}})}},{key:"backward",value:function(){var e=this.diagram,t=this.lineId,n=this.originTarget,r=this.model,o=e.find(t);e.remove(r.id),o&&!o.destroyed&&e.update(o.model.id,{target:n}),this.select()}}]),n}();function Sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Ph,"className","AddVertex");var Rh=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.attr,n=this.shape||"rect",r=uc[uc.findIndex((function(e){return e.name===n}))],o=r.type||"geometry",a=r.category,i=r.html||Md,c=r.controlPoints||void 0,l=r.round||void 0;Object.assign(e.settings.vertex,jh(jh({},t),{},{type:o,html:i,shape:n,category:a,controlPoints:c,round:l})),e.selector.clear(),e.interaction.changeMode("beginInsertVertex")}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Rh,"className","BeginInsertGeometry"),c()(Rh,"isModelChange",!1);var _h=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.model,n=this.files;e.settings.image.insertModel=t,e.settings.image.insertFiles=n,e.selector.clear(),e.interaction.changeMode("beginInsertImage")}}],[{key:"enable",value:function(){return!0}}]),n}();function Mh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(_h,"className","BeginInsertImage"),c()(_h,"isModelChange",!1);var Lh=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({html:jr("文本")},e))).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.html,n=this.stroke;Object.assign(e.settings.vertex,{type:"text",html:t,stroke:n,shape:"text"}),e.selector.clear(),e.interaction.changeMode("beginInsertVertex")}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Lh,"className","BeginInsertText"),c()(Lh,"isModelChange",!1);var Th=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"arrange",value:function(){}},{key:"getArrangeTstem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=[],r=[];return e.forEach((function(e,o){var a=yf([e]),i=a.stems,c=a.originModels,l=t(o,e),u=l.dx,s=l.dy;r.push.apply(r,T()(i)),n.push.apply(n,T()(Bd(c,u,s)))})),{tStems:r,models:n}}},{key:"execute",value:function(){var e=this.diagram.selector.selections.concat([]),t=this.arrange(),r=t.tStems,o=t.models;this.id=r,this.model=o,this.selectedIds=e.map((function(e){return e.model.id})),N()(M()(n.prototype),"execute",this).call(this)}},{key:"select",value:function(){N()(M()(n.prototype),"select",this).call(this,this.selectedIds)}}]),n}();c()(Th,"className","Arrange");var Dh=function(e){S()(n,Th);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_getAlignCells",value:function(e){return e.filter((function(e){return e.canArrange()}))}},{key:"_getAlignCellPoints",value:function(e){var t=[];return e.forEach((function(e){var n=[],r=e.getAlignBBox();n.push([r.minX,r.minY]),n.push([r.maxX,r.maxY]),n.push([(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]),t.push(n)})),t}},{key:"arrange",value:function(){var e=this.diagram.selector.selections.concat([]),t=this._getAlignCells(e),n=this._getAlignCellPoints(t);return this.align(t,n)}},{key:"align",value:function(){}}]),n}();c()(Dh,"className","AlignBase"),c()(Dh,"enable",(function(e){return e.selector.selections.filter((function(e){return e.canArrange()})).length>1}));var Nh=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.max.apply(Math,T()(n.map((function(e){return e[1]}))));return this.getArrangeTstem(e,(function(e,n){var o=t[e];return{dx:0,dy:n.isLine?r-Math.max.apply(Math,T()(o.map((function(e){return e[1]})))):r-o[1][1]}}))}}]),n}();c()(Nh,"className","AlignBottom");var Bh=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n,r=e.map((function(e){return e.getAlignBBox()})),o=en(r,"width");if(r.every((function(e){return e.minX>=o.minX&&e.maxX<=o.maxX})))n=o.x+o.width/2;else{var a=t.reduce((function(e,t){return e.concat([t[2]])}),[]).map((function(e){return e[0]}));n=(Math.max.apply(Math,T()(a))+Math.min.apply(Math,T()(a)))/2}return this.getArrangeTstem(e,(function(e,r){var o=t[e];return{dx:(r.isLine,n-o[2][0]),dy:0}}))}}]),n}();c()(Bh,"className","AlignHCenter");var Ih=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.min.apply(Math,T()(n.map((function(e){return e[0]}))));return this.getArrangeTstem(e,(function(e,n){var o=t[e];return{dx:n.isLine?r-Math.min.apply(Math,T()(o.map((function(e){return e[0]})))):r-o[0][0],dy:0}}))}}]),n}();c()(Ih,"className","AlignLeft");var Fh=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.max.apply(Math,T()(n.map((function(e){return e[0]}))));return this.getArrangeTstem(e,(function(e,n){var o=t[e];return{dx:n.isLine?r-Math.max.apply(Math,T()(o.map((function(e){return e[0]})))):r-o[1][0],dy:0}}))}}]),n}();c()(Fh,"className","AlignRight");var qh=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.min.apply(Math,T()(n.map((function(e){return e[1]}))));return this.getArrangeTstem(e,(function(e,n){var o=t[e];return{dx:0,dy:n.isLine?r-Math.min.apply(Math,T()(o.map((function(e){return e[1]})))):r-o[0][1]}}))}}]),n}();c()(qh,"className","AlignTop");var zh=function(e){S()(n,Dh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n,r=e.map((function(e){return e.getAlignBBox()})),o=en(r,"height");if(r.every((function(e){return e.minY>=o.minY&&e.maxY<=o.maxY})))n=o.y+o.height/2;else{var a=t.reduce((function(e,t){return e.concat([t[2]])}),[]).map((function(e){return e[1]}));n=(Math.max.apply(Math,T()(a))+Math.min.apply(Math,T()(a)))/2}return this.getArrangeTstem(e,(function(e,r){var o=t[e];return{dx:0,dy:(r.isLine,n-o[2][1])}}))}}]),n}();c()(zh,"className","AlignVCenter");var Gh=function(e){S()(n,Th);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(){}},{key:"arrange",value:function(){var e=this.diagram.selector.selections.filter((function(e){return e.canArrange()}));return this.distribute(e)}}]),n}();c()(Gh,"enable",(function(e){return e.selector.selections.filter((function(e){return e.canArrange()})).length>2}));var Yh=function(e){S()(n,Gh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(e){var t=e.length,n=e.map((function(e){return{cell:e,box:e.getAlignBBox()}}));n=n.sort((function(e,t){return e.box.minX-t.box.minX}));var r=Math.min.apply(Math,T()(n.map((function(e){return e.box.minX})))),o=(Math.max.apply(Math,T()(n.map((function(e){return e.box.maxX}))))-r-n.reduce((function(e,t){return e+t.box.width}),0))/(t-1),a=n[0].box;e=n.map((function(e){return e.cell}));var i=0;return this.getArrangeTstem(e,(function(e){var t=0;if(e>0){var r=n[e-1],c=n[e];i=i+o+r.box.width,t=a.minX+i-c.box.minX}return{dx:t,dy:0}}))}}]),n}();c()(Yh,"className","DistributeHorizontally");var Hh=function(e){S()(n,Gh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(e){var t=e.length,n=e.map((function(e){return{cell:e,box:e.getAlignBBox()}}));n=n.sort((function(e,t){return e.box.minY-t.box.minY}));var r=Math.min.apply(Math,T()(n.map((function(e){return e.box.minY})))),o=(Math.max.apply(Math,T()(n.map((function(e){return e.box.maxY}))))-r-n.reduce((function(e,t){return e+t.box.height}),0))/(t-1),a=n[0].box;e=n.map((function(e){return e.cell}));var i=0;return this.getArrangeTstem(e,(function(e){var t=0;if(e>0){var r=n[e-1],c=n[e];i=i+o+r.box.height,t=a.minY+i-c.box.minY}return{dx:0,dy:t}}))}}]),n}();c()(Hh,"className","DistributeVertically");var Vh=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.diagram,r=n.selector.selections.filter((function(e){return e.isStem}));r.sort(t);var o=r.map((function(e){return e.model.id})),a=r.map((function(e){return n.getCellOptions(e)}));r.forEach((function(t){t[e]()}));var i=r.map((function(e){return n.getCellOptions(e)}));this.beforeCellOptions=a,this.afterCellOptions=i,this.id=o,this.select(o)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.beforeCellOptions;e.update(t,{},n),this.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.id,n=this.afterCellOptions;e.update(t,{},n),this.select(t)}}]),n}();c()(Vh,"className","ZIndex");var Uh=function(e){S()(n,Vh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"backward",(function(e,t){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(Uh,"className","Backward");var Wh=function(e){S()(n,Vh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"forward",(function(e,t){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(Wh,"className","Forward");var Xh=function(e){S()(n,Vh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"toBack",(function(e,t){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(Xh,"className","ToBack");var Kh=function(e){S()(n,Vh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,"toFront",(function(e,t){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(Kh,"className","ToFront");var Zh=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.diagram;this.model={type:"geometry",html:Md,shape:"rect",x:e,y:t},r.hooks.decorateAddVertexModel.call(this.model),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Zh,"className","InsertGeometry"),c()(Zh,"enable",(function(e){return"edit"===e.interaction.currentMode}));var Qh=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.image,o=this.diagram,a=r.naturalWidth/r.naturalHeight,i=this.width||Math.min(r.naturalWidth,1e3,1e3*a),c=this.height||i/a,l=o.viewport.getCenter();this.model={type:"image",image:r,width:i,height:c,x:null==e?l[0]:e,y:null==t?l[1]:t,constraints:{proportion:!0}},N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Qh,"className","InsertImage"),c()(Qh,"enable",(function(e){return"read"!==e.interaction.currentMode}));var $h=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.diagram;this.model={type:"text",html:jr("文本"),x:e,y:t},r.hooks.decorateAddVertexModel.call(this.model),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()($h,"className","InsertText"),c()($h,"enable",(function(e){return"edit"===e.interaction.currentMode}));var Jh=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.contentEditor.execCommand("createLink",jr("链接"))}}]),n}();c()(Jh,"className","AttachLink"),c()(Jh,"enable",(function(e){var t=e.getCell(e.contentEditor.dom);return e.contentEditor.getRange()&&t}));var ep=r.FileUtils.isImage;function tp(e){var t=e.model,n=e.offset;t.x=(t.x||0)+n[0],t.y=(t.y||0)+n[1]}var np={text:{lake:tp,text:function(e){var t=e.text,n=e.focusPoint;return[{type:"text",html:t,x:n[0],y:n[1]}]},textIndex:1},geometry:{lake:tp},stack:{lake:tp},image:{lake:tp},dsl:{lake:tp},group:{lake:function(e){var t=e.model,n=e.offset;Id([t],n[0],n[1])}},line:{lake:function(e){var t=e.extraInformation,n=e.extraInformations,r=e.offset,o=e.model,a=t.points;["source","target"].forEach((function(e){var t=o[e];if(!t.id&&t.connection&&(t.connection[0]+=r[0],t.connection[1]+=r[1]),t.id&&!n[t.id]){var i="source"===e?a[0]:a[a.length-1];t.connection=[i.x+r[0],i.y+r[1]],delete t.id}})),o.controlPoints&&o.controlPoints.forEach((function(e){e[0]+=r[0],e[1]+=r[1]}))}},freehand:{lake:function(e){var t=e.model,n=e.offset;t.points.forEach((function(e){e[0]+=n[0],e[1]+=n[1]}))}},pen:{lake:function(e){var t=e.model,n=e.offset;t.points.forEach((function(e){e[0]+=n[0],e[1]+=n[1]}))}}},rp=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"_getOptions",value:function(e,t){var n=this.diagram.groupManager.group;return e.map((function(e,r){var o=Object.assign(e.options||{},t[r]);return delete e.options,n&&!o.parent&&(o.parent=n.model.id),Object.assign(t[r],o)}))}},{key:"execute",value:function(){var e,t=this.diagram,n=this.e,r=n.clipboardData.getData("text/html"),o=n.clipboardData.getData("text/plain"),a=this.focusPoint,i=bl(r);if(a=a||t.viewport.getFocus(),i){var c=i.body,l=i.extraInformations,u=function(e,t,n){var r=[[],[]];return e.forEach((function(e){Wt(e,(function(e){var t=e.id,o=e.x,a=e.y,i=e.type,c=n[t];"line"===i?["source","target"].forEach((function(t){var n=e[t];if(null!=n&&n.id){var o=c.points,a="source"===t?o[0]:o[o.length-1];r[0].push(a.x),r[1].push(a.y)}else null!=n&&n.id||null==n||!n.connection||(r[0].push(n.connection[0]),r[1].push(n.connection[1]))})):"freehand"===i||"pen"===i?(r[0].push(c.topLeft[0]),r[1].push(c.topLeft[1])):(o=null==o?null==c?void 0:c.x:o,a=null==a?null==c?void 0:c.y:a,null!=o&&null!=a&&(r[0].push(o),r[1].push(a)))}))})),r[0]=[r[0].length>0&&Math.min.apply(Math,T()(r[0]))||0],r[1]=[r[1].length>0&&Math.min.apply(Math,T()(r[1]))||0],[t[0]-r[0][0],t[1]-r[1][0]]}(c,a,l);!function(e,t){var n=function(e){return"mindmap"===t[e.id].rootType},r=e.filter((function(e){return n(e)}));e.sort((function(e,t){return e.zIndex-t.zIndex})),e.forEach((function(e){Wt(e,(function(e){var t=e.children;t&&"group"===e.type&&t.sort((function(e,t){return e.zIndex-t.zIndex}))}))}));var o=0;e.forEach((function(t,a){n(t)&&(e[a]=r[o],o++)}))}(c,l);var s=ba(c,l);t.hooks.forceDecorateImportModels.call(c),c.forEach((function(e){fs(e);var n=l[e.id];e.type||(e.type=n.rootType||"text","mindmap"===e.type&&t.hooks.decorateAddMindmapStemModel.call(e)),e.options={},Wt(e,(function(e){e.zIndex&&delete e.zIndex,"swimlane"===e.type&&(e.contain=e.contain.map((function(e){return s[e]})).filter((function(e){return e})))}));var r=np[e.type];r&&r.lake&&r.lake({model:e,extraInformation:n,extraInformations:l,offset:u,diagram:t})}));var d={body:c,options:c.map((function(){return{}})),extraInfomations:l,offset:u};return t.emit("beforepaste:lake",d),void t.command.execute("Add",{model:d.body,cellOptions:this._getOptions(d.body,d.options)})}if(n.clipboardData.files.length>0&&(""===r&&/^.+\.\w+$/.test(o)||""===o&&/^(<meta.+?>)?<img.+?>$/.test(r)||!o||!r)&&(e=Array.from(n.clipboardData.files)),e){var f=Array.from(e).filter((function(e){return ep(e)}));f[0]&&t.emit("importimage",{files:f,from:"clipboard",x:a[0],y:a[1]})}else if(o){var h,p=Object.keys(np),m=[];p.forEach((function(e){var t,n=np[e].text;n&&m.push({textProcessor:n,textIndex:null!==(t=np[e].textIndex)&&void 0!==t?t:0})})),m.sort((function(e,t){return t.textIndex-e.textIndex})),m=m.map((function(e){return e.textProcessor}));for(var y=0;y<m.length&&!(h=(0,m[y])({text:o,focusPoint:a,diagram:t}));y++);t.hooks.forceDecorateImportModels.call(h);var v={body:h,options:h.map((function(){return{}}))};t.emit("beforepaste:text",v),t.command.execute("Add",{model:v.body,cellOptions:this._getOptions(v.body,v.body.map((function(e){return{}})))}),t.emit("afterpasteplaintext",{body:h,focusPoint:a})}}}],[{key:"registerClipboardProcessor",value:function(e,t){np[e]=t}}]),n}();c()(rp,"className","Paste");var op=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram.selector.selections,t=e.map((function(e){return{target:{marker:e.source.marker||"none"},source:{marker:e.target.marker||"none"}}}));this.model=t,this.id=e.map((function(e){return e.model.id})),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();function ap(e){return e.isStem}c()(op,"className","LineSwapEndpoint"),c()(op,"enable",(function(e){return e.selector.selections.every((function(e){return ur(e)}))}));var ip=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.groupManager.group,n=e.selector.selections.filter(ap),r={},o=Object(F.a)();t&&(r.parent=t.model.id),n.sort((function(e,t){return e.getZIndex()-t.getZIndex()}));var a={id:o,type:"group"},i={parent:o};this.beforeZIndexCache=e.getCellsByZIndex().map((function(e){return e.model.id})),this.newGroupModel=a,this.newGroupOption=r,this.selectionIds=n.map((function(e){return e.model.id})),this.updateModel={},this.updateOption=i,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.newGroupModel,n=this.selectionIds,r=this.newGroupOption,o=this.updateModel,a=this.updateOption,i=e.rootGroup,c=n.map((function(t){return e.find(t)})),l=t.id,u=c[c.length-1].getAllCellsByZIndex(),s=u[u.length-1];e.add(t,r),e.update(c,o,a);var d=e.find(l);i.insertBefore(d.graphicGroup,s.graphicGroup);for(var f=0;f<c.length;f++)c[f].getAllCellsByZIndex().forEach((function(e){i.insertBefore(e.graphicGroup,d.graphicGroup)}));e.selector.select(l)}},{key:"backward",value:function(){var e=this.diagram,t=this.selectionIds,n=this.newGroupModel,r=this.newGroupOption,o=this.beforeZIndexCache,a=n.id,i=e.rootGroup,c=t.map((function(t){return e.find(t)}));r.parent?e.update(c,{parent:r.parent}):e.update(c,{},{parent:null}),e.groupManager.exit(),e.remove(a);for(var l=0;l<o.length;l++){var u=e.find(o[l]);i.append(u.graphicGroup)}e.selector.select(t)}}]),n}();c()(ip,"className","MakeGroup"),c()(ip,"enable",(function(e){var t=e.selector.selections;return(t=t.filter(ap)).length>1}));var cp=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections,n=t.map((function(e){return e.model.id})),r={};t.forEach((function(e){e.getChildren().forEach((function(t){r[t.model.id]=e.model.id}))})),this.beforeZIndexCache=e.getCellsByZIndex().map((function(e){return e.model.id})),this.selectionIds=n,this.groupMap=r,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.selectionIds.map((function(t){return e.find(t)})),n=[];t.forEach((function(t){var r=t.parent&&t.parent.model.id||null;t.getChildren().forEach((function(t){n.push(t),e.update(t,{},{parent:r})}))})),e.groupManager.exit(),e.remove(t),e.selector.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.groupMap,n=this.selectionIds,r=this.beforeZIndexCache,o=e.rootGroup;e.add(n.map((function(e){return{id:e,type:"group"}}))),Object.keys(t).forEach((function(n){e.update(n,{},{parent:t[n]})}));for(var a=0;a<r.length;a++){var i=e.find(r[a]);o.append(i.graphicGroup)}e.selector.select(n)}}]),n}();c()(cp,"className","Ungroup"),c()(cp,"enable",(function(e){return e.selector.selections.every((function(e){return e.isGroup}))}));var lp={Extends:[dd,Sd,Cd,vd,Od,rf,Ad,pd,jd,Rd,_d,yd,zd,qd,Gd,of],Cells:[ud,ld,Rs,Os,Ps],Commands:[Eh,Ch,Ah,ip,cp,rp,Ph,Rh,Lh,_h,Nh,Bh,Ih,Fh,qh,zh,Yh,Hh,Xh,Kh,Uh,Wh,$h,Zh,Qh,Jh,op],defaultCursors:{edit:"default",read:"grab",dragCanvas:"grab",beginInsertLine:"crosshair"},settings:{line:{shape:"elbow",target:{marker:"arrow"}},image:{},vertex:{},freehand:{}},dataProcessor:function(e){if(e&&e.body){var t=[],n=[],r=[],o={};e.body.forEach((function(e){Wt(e,(function(e,t){e.id||(e.id=Object(F.a)()),o[e.id]={model:e,parent:t},e.type&&n.push(e)})),e.type?t.push(e):r.push(e.id)})),t.forEach((function(e){fs(e)})),n.forEach((function(e){!function(e){if(function(e){return!!e.type&&"image"===e.type}(e)){var t,n,r=e.width,o=e.height,a=null==e||null===(t=e.image)||void 0===t?void 0:t.naturalWidth,i=null==e||null===(n=e.image)||void 0===n?void 0:n.naturalHeight;if(null==o&&"number"==typeof r&&"number"==typeof a&&"number"==typeof i){var c=i/a;e.height=r*c}}}(e),function(e){"line"===e.type&&e.controlPoints&&(e.controlPoints=e.controlPoints.filter((function(e){return e&&e[0]&&e[1]})))}(e),!1===function(e){if("dsl"===e.type&&null==e.shape)return!1}(e)&&r.push(e.id),!1===function(e){if(Ki(e)){var t=uc.find((function(t){return t.name===e.shape}));if(!t)return!1;t.controlPoints&&!e.controlPoints&&(e.controlPoints=t.controlPoints),t.round&&!e.round&&(e.round=t.round)}}(e)&&r.push(e.id),!1===function(e,t){if(Ui(e))for(var n=["target","source"],r=0;r<n.length;r++){var o=e[n[r]];if(o&&o.id&&!t[o.id])return!1}}(e,o)&&r.push(e.id)})),r.forEach((function(t){var n=o[t],r=n.model,a=n.parent;un(a?a.children:e.body,r)})),function(e){e.body.forEach((function(e){Wt(e,(function(e){"mindmap"===e.type&&(delete e.abstract,delete e.start,delete e.end,Wt(e,(function(e,t){var n=us.modelIsTwoQuadrantLayout(e),r=e.children;if(r&&0!==r.length){for(var o=n?2:1,a=r.length,i=[1/0,1/0],c=[void 0,void 0],l=r.length-1;l>=0;l--){var u=r[l];if(!u.abstract||void 0===u.start||void 0===u.end){a=l+1;break}var s=u.start,d=u.end,f=u.layout,h=(void 0===f?{}:f).quadrant,p=void 0===h?1:h;if(p>o){if(n){a=l+1;break}u.layout=ds(ds({},u.layout),{},{quadrant:1})}if(p<o&&(o=p),d>=i[o-1]){var m=i[o-1]-1;if(m<0){a=l+1;break}u.end=m}if(s>d||s>i[o-1]||d<0){a=l+1;break}s<0&&(u.start=0),i[o-1]=u.start,u.end,void 0===c[o-1]&&(c[o-1]=l),void 0!==u.border&&void 0!==u.border.shape&&"line"!==u.border.shape||(u.border=ds(ds({},u.border),{},{shape:"rect"}))}var y=function(e,t){var n=r[e],o=n.abstract,a=n.start,i=void 0===a?0:a,c=n.end;return!o||i>=t||((void 0===c?0:c)>=t&&(r[e].end=t-1),!1)},v=!1;if(n){var g=[[],[]],b=[[],[]];r.forEach((function(e,t){var n=e.layout,r=(void 0===n?{}:n).quadrant,o=void 0===r?1:r,i=Math.min(2,Math.max(1,o));t<a?g[i-1].push(t):b[i-1].push(t)})),v=b.some((function(e,t){if(e.length>0){var n=e[e.length-1],r=g[t].length;return y(n,r)}return!1}))}else r[r.length-1].abstract&&(v=y(r.length-1,a));v&&(a=r.length);for(var x=0;x<a;x++)delete r[x].abstract,delete r[x].start,delete r[x].end}})))}))}))}(e)}},modes:[{mode:"edit",Behaviours:[lf,cf,df,ff,hf,pf,uf,af,mf,ph,hh,dh,Df,eh,yh,uh,gh,vh,Pf,Sf,xf,bf,wf,gf,_f,kf,Of,jf,Rf,Mf,bh,xh]},{mode:"read",Behaviours:[sh,wh]},{mode:"dragCanvas",Behaviours:[]},{mode:"beginInsertLine",Behaviours:[ah,Mf]},{mode:"beginInsertVertex",Behaviours:[lh]},{mode:"beginInsertImage",Behaviours:[nh]}]};function up(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var sp=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"element",new ho),c()(A()(r),"isPoints",!0),c()(A()(r),"points",void 0),r}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.updateModel(this.model),this.graphicGroup.add(this.element)}},{key:"canConnect",value:function(){return!1}},{key:"canUpdateText",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){return this.element}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=e.x,n=e.y,r=e.width,o=e.height;return{x:t,y:n,width:r,height:o,minX:t,minY:n,maxX:t+r,maxY:n+o}}},{key:"getBBox",value:function(){return this.getPointBox()}},{key:"getPointBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.points.forEach((function(o){e=Math.min(e,o[0]),t=Math.min(t,o[1]),n=Math.max(n,o[0]),r=Math.max(r,o[1])})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"canvas2Relative",value:function(e){e=za(e);var t=this.getKeyShapeBox();return{x:e.x-t.x,y:e.y-t.y}}},{key:"canvas2percentage",value:function(e){return this.relative2Percentage(this.canvas2Relative(e))}},{key:"relative2Percentage",value:function(e){e=za(e);var t=this.getKeyShapeBox();return[e.x/t.width,e.y/t.height]}},{key:"relative2Canvas",value:function(e){e=za(e);var t=this.getKeyShapeBox();return{x:t.x+e.x,y:t.y+e.y}}},{key:"percentage2Canvas",value:function(e){e=za(e);var t=this.getKeyShapeBox();return{x:t.x+t.width*e.x,y:t.y+t.height*e.y}}},{key:"percentage2Relative",value:function(e){e=za(e);var t=this.getKeyShapeBox();return[t.width*e.x,e.y*t.height]}},{key:"isPointInFill",value:function(e){return this.getKeyShape().isPointInFill(Ya(e))}},{key:"isPointInStroke",value:function(e){return this.getKeyShape().isPointInStroke(Ya(e))}},{key:"updateModel",value:function(e){var t;null===(t=e.points)||void 0===t||t.forEach((function(e){var t=$d([e[0],e[1]]);e[0]=t[0],e[1]=t[1]})),N()(M()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n={x:t.x+t.width/2,y:t.y+t.height/2},r=n.x,o=n.y;return this.getKeyShape().getIntersectionPoint(e.x,e.y,r,o)}},{key:"isPointInShape",value:function(e){var t=Ya(e),n=this.getKeyShape();return n.isPointInFill(t)||n.isPointInStroke(t)}},{key:"updateGeometryProperties",value:function(){var e=this.getPointBox();this.height=e.height,this.width=e.width,this.x=e.x,this.y=e.y}},{key:"afterUpdateModel",value:function(){this.updateGeometryProperties()}},{key:"draw",value:function(){this.updateCache()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?up(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):up(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity"],points:[],opacity:1})}}]),n}();function dp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{didIntersect:n.length>0,message:e,points:n}}function fp(e,t,n,r){var o=Xd(e,n),a=Xd(r,n),i=Xd(t,e),c=a[0]*o[1]-a[1]*o[0],l=i[0]*o[1]-i[1]*o[0],u=a[1]*i[0]-a[0]*i[1];if(0===c||0===l)return dp("coincident");if(0===u)return dp("parallel");if(0!==u){var s=c/u,d=l/u;if(s>=0&&s<=1&&d>=0&&d<=1)return dp("intersection",Wd(e,Kd(i,s)))}return dp("no intersection")}function hp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(sp,"className","Freehand");var pp=function(e){S()(n,sp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"element",new ho),c()(A()(r),"isFreeHand",!0),c()(A()(r),"opacity",void 0),c()(A()(r),"points",void 0),r}return v()(n,[{key:"draw",value:function(){var e={};"mark-pencil"===this.shape&&(e.start={taper:0,cap:!1},e.end={taper:0,cap:!1},e.simulatePressure=!1),e.size=3*this.stroke.width;var t=Va(dt(this.points,e));this.element.update({d:t,fill:this.stroke.color,opacity:this.opacity}),N()(M()(n.prototype),"draw",this).call(this)}},{key:"isIntersectLineSegment",value:function(e){var t,n,r,o=this.points,a=this.getKeyShapeBox(),i=b()(e,2),c=i[0],l=i[1];if(a.width<8&&a.height<8)return function(e,t,n){return function(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}(n,Jd(e,t,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]))}(c,l,function(e){return[e.minX+e.width/2,e.minY+e.height/2]}(a))<5;if(n=c,r=l,function(e,t,n,r){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[e[0]+t[0]/2,e[1]+t[1]/2],o=Qd(e,r,n),a=Qd(Wd(e,[t[0],0]),r,n),i=Qd(Wd(e,t),r,n),c=Qd(Wd(e,[0,t[1]]),r,n);return[["top",[o,a]],["right",[a,i]],["bottom",[i,c]],["left",[c,o]]]}(e,t).reduce((function(e,t){var o=b()(t,2),a=o[0],i=b()(o[1],2),c=i[0],l=i[1],u=fp(n,r,c,l);return u&&e.push(dp.apply(void 0,[a].concat(T()(u.points)))),e}),[]).filter((function(e){return e.didIntersect}))}([(t=a).minX,t.minY],[t.width,t.height],n,r))for(var u=1;u<o.length;u++)if(fp(o[u-1],o[u],c,l).didIntersect)return!0;return!1}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n=[t.x,t.y+t.height/2],r=[t.maxX,t.y+t.height/2],o=[t.x+t.width/2,t.minY],a=[t.x+t.width/2,t.maxY],i=1/0,c=n;return[n,r,o,a].forEach((function(t){var n=ui(e,t);n<i&&(i=n,c=t)})),za(c)}},{key:"isPointInFill",value:function(e){return Pi(e,function(e){return{x:e.x,y:e.y,w:e.width,h:e.height,r:0}}(this.getKeyShapeBox()))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke","fill"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity","shape"],Subcells:[],points:[]})}}]),n}();function mp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(pp,"className","Freehand");var vp=function(e){S()(n,sp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"isPen",!0),c()(A()(r),"fill",void 0),c()(A()(r),"isClosed",void 0),c()(A()(r),"points",void 0),r}return v()(n,[{key:"createRendererElement",value:function(){if(!this.element||this.isCacheStale("roughFillStyle")){var e=this.getRoughGraphicOptions(),t=new(e?ta:ho)(yp({},e));this.element&&this.element.remove(),this.element=t,this.graphicGroup.add(this.element)}}},{key:"canRough",value:function(){return!0}},{key:"draw",value:function(){this.createRendererElement();var e=this.points.reduce((function(e,t,n){return e+(0===n?"M ".concat(t[0],",").concat(t[1]):"L ".concat(t[0],",").concat(t[1]))}),"");this.isClosed&&(e+="Z"),this.element.update(yp({d:e,fill:this.fill.color,stroke:this.stroke.color,opacity:this.opacity,"stroke-width":this.stroke.width},this.convertStrokeStyle())),N()(M()(n.prototype),"draw",this).call(this)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke","fill","isClosed","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?yp({},r):r}))}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n=[t.x,t.y+t.height/2],r=[t.maxX,t.y+t.height/2],o=[t.x+t.width/2,t.minY],a=[t.x+t.width/2,t.maxY],i=1/0,c=n;return[n,r,o,a].forEach((function(t){var n=ui(e,t);n<i&&(i=n,c=t)})),za(c)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},fill:{color:"transparent"},rotate:0,penetratedKeys:["points","stroke","fill","isClosed"],Subcells:[],points:[],isClosed:!1})}}]),n}();c()(vp,"className","Pen");var gp=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r._initEvent(),r}return v()(n,[{key:"_initEvent",value:function(){var e,t,n=this,r=this.diagram,o=[],a=[1/0,1/0,0];this.bind(r,"pointerdown",(function(i){var c,l,u,s,d,f,h;if(2!==i.button&&n.isEnable){var p=null===(c=r.settings)||void 0===c||null===(l=c.freehand)||void 0===l?void 0:l.strokeWidth,m=null===(u=r.settings)||void 0===u||null===(s=u.freehand)||void 0===s?void 0:s.stroke,y=null!==(d=null===(f=r.settings)||void 0===f||null===(h=f.freehand)||void 0===h?void 0:h.shape)&&void 0!==d?d:"pencil";o=[];var v=n.client2draw(i);o.push(v),e=r.add({shape:y,type:"freehand",points:o,stroke:{width:p,color:m},opacity:"pencil"===y?1:.5})[0],t=n.bind(window,"pointermove",Le()((function(t){if(n.isEnable&&e){var i=n.client2draw(t);Fe()(a,i)||(a=i,o.push(i),r.update(e,{points:o}))}}),16))}})),this.bind(window,"pointerup",(function(i){if(e){var c=u()(e.model);n.count(c),delete c.id,r.remove(e),r.command.execute("Add",{model:c,autoSelect:!1}),n.unbind(t),o=[],e=void 0,a=[1/0,1/0,0]}}))}},{key:"count",value:function(e){var t,n=this.diagram;null!==(t=n.spm)&&void 0!==t&&t.click&&("pencil"===e.shape?n.spm.click("a385.b4693.c121188.d251467",{shape:e.shape}):"mark-pencil"===e.shape&&n.spm.click("a385.b4693.c121188.d251468",{shape:e.shape}))}},{key:"client2draw",value:function(e){var t=$d(this.diagram.viewport.invertClient([e.clientX,e.clientY]));return t.push(e.pressure),t}},{key:"isEnable",get:function(){return"free-hand"===this.diagram.interaction.currentMode}},{key:"reset",value:function(){this.unbind()}}]),n}();function bp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(gp,"className","FreehandDraw");var wp="url('https://gw.alipayobjects.com/zos/bmw-prod/b0d18072-618f-49fe-8523-923c08d19764.svg') 14.72 8, auto",kp="url(https://gw.alipayobjects.com/zos/bmw-prod/87c9f5e3-90b6-46b6-b051-44b013e1dce7.svg) 9 9, auto",Ep=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),(r=t.call(this)).diagram=e,c()(A()(r),"lineElement",ms({stroke:"#aaa","stroke-width":2})),c()(A()(r),"group",new no),c()(A()(r),"drawGroup",new no),c()(A()(r),"interactGroup",new no),c()(A()(r),"pen",void 0),c()(A()(r),"lastPen",void 0),c()(A()(r),"controlPointButtons",[]),c()(A()(r),"controlPoints",[]),c()(A()(r),"activeIndex",0),c()(A()(r),"activeIndexes",[]),c()(A()(r),"drawEvents",[]),c()(A()(r),"interactEvents",[]),c()(A()(r),"uiControlPointButton",Na(1,!0)),c()(A()(r),"_closeToControlPoints",!1),c()(A()(r),"start",!0),c()(A()(r),"startpoint",[1/0,1/0]),c()(A()(r),"interact",!1),r.initEvent(),r.initInteractEvent(),r.group.add(r.drawGroup),r.group.add(r.interactGroup),r.uiControlPointButton.group.hide(),r.group.add(r.uiControlPointButton.group),r.drawGroup.add(r.lineElement),r.diagram.frontRootGroup.prepend(r.group),r.bind(e,"aftermodechange",(function(){var t;if("pen"===e.interaction.currentMode){if(r.start=!0,!r.pen){var n=e.find(r.lastPen);n&&(r.pen=n),r.pen&&(r.start=!1,r.initControlPoints())}}else r.lastPen=null===(t=r.pen)||void 0===t?void 0:t.model.id,r.reset()}));var o=e.viewport.zoom;return r.bind(e,"afterviewportchange",Le()((function(){o!==e.viewport.zoom&&(r.updateControlPoints(),o=e.viewport.zoom)}))),r}return v()(n,[{key:"createElements",value:function(){var e=this;if(this.pen){var t=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){var o=Na(r,!1);o.group.update(xp(xp({},za(n)),{},{scale:t})),e.controlPointButtons.push(o),e.controlPoints.push(T()(n)),e.interactGroup.add(o.group)})),this.updateActiveButton(this.pen.points.length-1,!0)}}},{key:"closeToControlPoints",value:function(){this._closeToControlPoints=!0,this.diagram.align.clear(),this.lineElement.hide()}},{key:"notCloseToControlPoints",value:function(){this.updateAlignPoints(),this._closeToControlPoints=!1}},{key:"enable",get:function(){return"pen"===this.diagram.interaction.currentMode}},{key:"setCursor",value:function(e){var t=this.diagram;"pen"===t.interaction.currentMode&&t.setCursor(e)}},{key:"finishDraw",value:function(){var e=this;this._closeToControlPoints=!1,this.start=!0,this.lineElement.hide();var t=this.pen;this.reset(),setTimeout((function(){e.diagram.interaction.changeMode("edit"),t&&e.diagram.selector.select([t])}))}},{key:"initEvent",value:function(){var e,t=this,n=this.diagram;this.drawEvents.push(this.bind(n,"aftercommandforward",(function(){t.initControlPoints()}))),this.drawEvents.push(this.bind(n,"aftercommandbackward",(function(){t.initControlPoints()}))),this.drawEvents.push(this.bind(n,"mousedown",(function(r){var o;if(2!==r.button&&t.enable&&!(t._closeToControlPoints||null!==(o=t.pen)&&void 0!==o&&o.isClosed)){var a=t.client2draw(r);if(t.start){var i;t.start=!1,t.startpoint=a;var c=Object(F.a)(),l={id:c,type:"pen",points:[t.startpoint]};n.hooks.decorateAddPenModel.call(l),n.command.execute("Add",{model:l}),null===(i=n.spm)||void 0===i||i.click("a385.b4693.c124035"),t.pen=n.find(c)}else if(t.pen){if(t.activeIndex!==t.pen.points.length-1)return;if(ui(a,t.pen.points[0])<=6)return n.command.execute("Update",{id:t.pen,model:{isClosed:!0}}),void t.finishDraw();var s=u()(t.pen.points);s.push(e||a),n.command.execute("Update",{id:t.pen,model:{points:s}}),e=void 0}t.updateAlignPoints(),t.initControlPoints(),t.lineElement.update({d:""})}}))),this.drawEvents.push(this.bind(n,"mousemove",Le()((function(n){if(t.enable&&t.pen&&!t.pen.isClosed&&!t.start&&t.isSelectedLast()&&!t.interact){var r=t.client2draw(n);t.align(r),ui(r,t.startpoint)<=6&&(r=t.startpoint),e=r;var o=["M",t.pen.points[t.pen.points.length-1],"L",r].join(" ");t.lineElement.show(),t.lineElement.update({d:o})}}),16))),this.drawEvents.push(this.bind(n,"keyup",(function(e){"Escape"!==e.key&&"Enter"!==e.key||!t.pen||t.finishDraw()})))}},{key:"isSelectedLast",value:function(){return!!this.pen&&this.activeIndex===this.pen.points.length-1}},{key:"cleanInteract",value:function(){var e=this;this.interactGroup.clear(),this.interactEvents.forEach((function(t){e.unbind(t)})),this.controlPointButtons=[],this.controlPoints=[]}},{key:"initControlPoints",value:function(){this.updateAlignPoints(),this.cleanInteract(),this.createElements(),this.initInteractEvent()}},{key:"updateControlPoints",value:function(){var e=this;if(this.pen){this.controlPoints=[];var t=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){e.controlPointButtons[r].group.update(xp(xp({},za(n)),{},{scale:t})),e.controlPoints.push(T()(n))}))}}},{key:"align",value:function(e){var t=this.diagram.align.alignByPoint(xp(xp({},za(e)),{},{weight:1,box:this.p2b(e)}));e[0]+=t.dx,e[1]+=t.dy}},{key:"selectActiveButton",value:function(e){this.updateActiveButton(e)}},{key:"updateActiveButton",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.diagram,o=u()(this.activeIndexes);if(Array.isArray(e))this.activeIndexes=e;else if(r.signal.keydown.Shift&&!n){var a=this.activeIndexes.indexOf(e);a>=0?this.activeIndexes.splice(a,1):this.activeIndexes.push(e)}else this.activeIndexes=[e];o.forEach((function(e){var n;null===(n=t.controlPointButtons[e])||void 0===n||n.shape.update({stroke:Hr,fill:"#FFFFFF"})})),this.activeIndexes.forEach((function(e){var n;null===(n=t.controlPointButtons[e])||void 0===n||n.shape.update({stroke:"#3384F5","stroke-width":1,fill:"#C0D9FC"})})),1===this.activeIndexes.length?this.activeIndex=this.activeIndexes[0]:this.activeIndex=-1,this.activeIndex===this.controlPointButtons.length-1?(this.lineElement.update({d:""}),this.lineElement.show()):this.lineElement.hide()}},{key:"initInteractEvent",value:function(){var e=this,t=this.diagram,n=this.pen;if(n){var r,o,a=-1,i=!1,c=!1;this.interactEvents.push(this.bind(t,"mousedown",(function(t){var r,l,s=null===(r=t.target)||void 0===r?void 0:r.dataset;null!==(l=s.test_id)&&void 0!==l&&l.startsWith("line-control-point")&&(a=Number(s.index),o={points:u()(n.points)},e.updateActiveButton(a),ze()(a)&&(c=!0,e.updateAlignPoints(),e.interact=!0,e.lineElement.hide()),"true"===s.isUIPoints?i=!0:"false"===s.isUIPoints&&(i=!1))}))),this.interactEvents.push(this.bind(this.diagram,"mousemove",Le()((function(t){var o=e.diagram,l=e.client2draw(t);c&&e.align(l);for(var s=!1,d=e.controlPoints,f=0;f<d.length;++f){var h=d[f];if(0===f&&ui(l,h)<=6)return e.notCloseToControlPoints(),e.uiControlPointButton.group.hide(),void(e.isSelectedLast()?e.setCursor("url(https://gw.alipayobjects.com/zos/bmw-prod/eaa8e58e-4b6a-41a2-a17a-c2ac014ca278.svg) 14.72 8, auto"):e.setCursor(kp));if(ui(l,h)<=6&&!c){e.closeToControlPoints(),e.uiControlPointButton.group.hide(),s=!0,e.setCursor(kp);break}}if(!s&&!c){a<0&&e.setCursor(wp);var p=n.getKeyShape().getClosestPoint(l[0],l[1]);if(ui(l,p.point)<=6){e.uiControlPointButton.group.show(),e.uiControlPointButton.group.update(xp(xp({},za(p.point)),{},{scale:1/o.viewport.zoom}));for(var m=[],y=0,v=0;v<e.controlPoints.length;v++){var g=void 0;if(v===e.controlPoints.length-1){if(!n.isClosed)break;g=ui(e.controlPoints[v],e.controlPoints[0])}else g=ui(e.controlPoints[v],e.controlPoints[v+1]);m.push(g),y+=g}var b=0,x=0;m.reduce((function(e,t,n){var r=(e+t)/y;return x<=p.percentage&&p.percentage<=r&&(b=n+1),x=r,e+t}),0),e.uiControlPointButton.group.dataset({index:b+""}),e.uiControlPointButton.shape.dataset({index:b+""}),c||e.closeToControlPoints(),e.lineElement.hide(),s=!0}else e.uiControlPointButton.group.hide()}!s&&a<0&&e.notCloseToControlPoints(),a<0||(c||e.closeToControlPoints(),r=u()(n.points),e.interactGroup.hide(),e.uiControlPointButton.group.hide(),i?(r.splice(a,0,l),i=!1):r[a]=l,o.update(n,{points:r}))}),16))),this.interactEvents.push(this.bind(this.diagram,"mouseup",(function(i){e.interactGroup.show(),r&&(t.command.execute("Update",{id:n.model.id,model:{points:r},originModels:o}),e.initControlPoints(),e.updateActiveButton(a),e.lineElement.hide(),e._closeToControlPoints=!1,r=void 0),a<0&&(!e.isSelectedLast()||n.isClosed)&&e.finishDraw(),t.align.reset(),a=-1,c=!1,e.interact=!1}))),this.interactEvents.push(this.bind(t,"keydown",(function(r){if(n){r.preventDefault();var o=u()(n.points),a={points:u()(n.points)};if("Backspace"===r.key)e.activeIndexes.length>=0&&(o.length===e.activeIndexes.length?(t.command.execute("Delete",{cells:[n.model.id],originModels:a}),e.start=!0,e.reset()):(sn(o,e.activeIndexes),t.command.execute("Update",{id:n.model.id,model:{points:o},originModels:a}),e.initControlPoints()));else if("a"===r.key&&ja(r))e.updateActiveButton(n.points.map((function(e,t){return t})));else{var i=0,c=0;switch(r.key){case"Left":case"ArrowLeft":i=-1;break;case"Right":case"ArrowRight":i=1;break;case"Up":case"ArrowUp":c=-1;break;case"Down":case"ArrowDown":c=1;break;default:return}if(e.activeIndexes.length>0){e.activeIndexes.forEach((function(e){o[e][0]+=i,o[e][1]+=c})),t.command.execute("Update",{id:n.model.id,model:{points:o},originModels:a});var l=u()(e.activeIndexes);e.initControlPoints(),e.updateActiveButton(l)}}}})))}}},{key:"init",value:function(e){this.pen=e,this.initControlPoints(),this.start=!1,this.startpoint=u()(e.points[0])}},{key:"client2draw",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]);return $d([t[0],t[1]])}},{key:"updateAlignPoints",value:function(){var e=this,t=this.pen;if(t){var n=[],r=t.getBBox(),o=[r.x+r.width/2,r.y+r.height/2];n.push([xp(xp({},za(o)),{},{weight:1,box:r})]),t.points.forEach((function(t){n.push([xp(xp({},za(t)),{},{weight:1,box:e.p2b(t)})])})),this.diagram.align.updateToAlignPointSet(n)}}},{key:"p2b",value:function(e){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1]}}},{key:"reset",value:function(){this.start=!0,this.pen=void 0,this.activeIndexes=[],this.lineElement.hide(),this.uiControlPointButton.group.hide(),this._closeToControlPoints=!1,this.cleanInteract(),this.diagram.align.reset()}},{key:"clearCache",value:function(){this.lastPen=void 0}},{key:"destory",value:function(){this.unbind(),this.group.clear()}}]),n}();c()(Ep,"className","PenDrawInteract");var Op=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"pen",void 0),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=function(n){e.pen=n,t.interaction.changeMode("pen"),t.penDrawInteract.init(n)};this.bind(t,"dblclick",(function(e){var r=t.getCell(e.target);r&&kr(r)&&n(r)})),this.bind(t,"keyup",(function(e){var r=t.selector.selections;1===r.length&&kr(r[0])&&"Enter"===e.key&&n(r[0])}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Cp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"pen",void 0),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"aftermodechange",(function(){"pen"===e.interaction.currentMode&&e.vertexRotateResize.end()}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Ap=function(e){S()(n,Ql);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.bind(e,"aftercommandbackward",(function(e){var n=e.command;n instanceof fc?t.reDraw():n instanceof Eh&&t.reEnter(n.cells[0])})),this.bind(e,"aftercommandforward",(function(e){var n=e.command;n instanceof fc?t.reEnter(n.model.id):n instanceof Eh&&t.reDraw()}))}},{key:"reDraw",value:function(){this.diagram.penDrawInteract.reset()}},{key:"reEnter",value:function(e){var t=this.diagram,n=t.find(e);n&&kr(n)&&t.penDrawInteract.init(n)}}]),n}();var Pp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"group",new no),c()(A()(e),"eraserPoints",[]),c()(A()(e),"prevPoint",void 0),c()(A()(e),"prevEraserPoint",void 0),c()(A()(e),"timestamp",0),c()(A()(e),"interval",void 0),c()(A()(e),"eraserPath",new ho),c()(A()(e),"loop",(function(){var t=Date.now(),n=t-e.timestamp,r=!1;if(e.prevEraserPoint!==e.prevPoint&&(r=!0,e.eraserPoints.push(e.prevPoint),e.prevEraserPoint=e.prevPoint),n>32&&e.eraserPoints.length>1&&(r=!0,e.eraserPoints.splice(0,Math.ceil(.1*e.eraserPoints.length)),e.timestamp=t),r){var o=e.diagram.viewport.zoom,a=Va(dt(e.eraserPoints,{size:16/o,start:{taper:!0}}));e.eraserPath.update({d:a})}e.interval=requestAnimationFrame(e.loop)})),c()(A()(e),"cancel",(function(){e.eraserPath.update({d:""}),e.eraserPoints=[],cancelAnimationFrame(e.interval)})),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.preparePath(),this._initEvent()}},{key:"preparePath",value:function(){this.eraserPath.css({id:"eraser"}),this.eraserPath.update({fill:"#aaa",opacity:.33}),this.group.add(this.eraserPath),this.diagram.frontRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=[],r=new Set,o=0,a=!1,i=function(){var e=[];return r.forEach((function(t){return e.push(t)})),e};this.bind(t,"pointerdown",(function(r){n=t.getFreehands(),a=!0;var o=e.client2draw(r);e.eraserPoints=[o],e.prevPoint=o,e.loop()})),this.bind(window,"pointermove",Le()((function(c){if(a){var l=e.client2draw(c);if(n.forEach((function(t){r.has(t.model.id)||t.isIntersectLineSegment([e.prevPoint,l])&&r.add(t.model.id)})),e.prevPoint=l,r.size!==o){o=r.size;var u=i();t.update(u,{opacity:.3})}}}),16)),this.bind(window,"pointerup",(function(n){if(a=!1,cancelAnimationFrame(e.interval),e.eraserPath.update({d:""}),r.size>0){var o=i(),c=[];o.forEach((function(e){var n=t.find(e);"pencil"===(null==n?void 0:n.shape)?c.push({opacity:1}):c.push({opacity:.5})})),t.update(o,c),t.command.execute("Delete",{cells:o}),r.clear()}}))}},{key:"client2draw",value:function(e){return $d(this.diagram.viewport.invertClient([e.clientX,e.clientY]))}},{key:"reset",value:function(){this.unbind(),this.cancel(),this.group.clear()}}]),n}();function Sp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rp={lake_prevent_click_unselect:"true",draw_base_resize_controller:"true"},_p=function(e){S()(n,rf);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"cell",void 0),c()(A()(r),"drawbaseGroup",new no),c()(A()(r),"p0",pa("start",Rp)),c()(A()(r),"p1",pa("end",Rp)),r.drawbaseGroup.add(r.p0.group),r.drawbaseGroup.add(r.p1.group),r.drawbaseGroup.hide(),e.frontRootGroup.add(r.drawbaseGroup),r}return v()(n,[{key:"init",value:function(e){this.cell=e,this.lowMode()?this._init():N()(M()(n.prototype),"init",this).call(this,e)}},{key:"_init",value:function(){this.bindEvent()}},{key:"update",value:function(){var e=this.p0,t=this.p1,r=this.cell;if(r){var o=1/this.diagram.viewport.zoom;this.lowMode()?(r.points.forEach((function(n,r){n&&(0===r?e:t).group.update(jp(jp({},za(n)),{},{scale:o}))})),1===r.points.length&&t.group.hide()):N()(M()(n.prototype),"update",this).call(this)}}},{key:"bindEvent",value:function(){var e,t,r,o=this,a=this.eventHelper,i=this.p0,c=this.p1,l=this.cell,s=!1;this.lowMode()?([i,c].forEach((function(n){var r=n.shape,o=n.name;a.bind(r,"mousedown",(function(n){s=!0,t=o,e={points:u()(l.points)}}))})),a.bind(this.diagram,"mousemove",(function(e){if(s){o.hide();var n,a=o.client2draw(e),i=u()(l.points),c=i[n="start"===t?0:1];i[n]=T()(a),wr(l)&&(i[n][2]=c[2]),r={points:i},o.diagram.update(l,r)}})),a.bind(this.diagram,"mouseup",(function(){t&&(s=!1,t="",o.update(),o.show(),o.diagram.command.execute("Update",{id:l,model:r,originModels:e}))}))):N()(M()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.lowMode()?(this.update(),this.show(),N()(M()(n.prototype),"hide",this).call(this)):(this.hide(),N()(M()(n.prototype),"begin",this).call(this))}},{key:"show",value:function(){this.lowMode()?(this.drawbaseGroup.show(),this.p1.group.show()):N()(M()(n.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.lowMode()?(this.drawbaseGroup.hide(),this.p1.group.hide()):N()(M()(n.prototype),"hide",this).call(this)}},{key:"end",value:function(){this.eventHelper.unbind(),this.drawbaseGroup.hide(),this.p1.group.hide(),N()(M()(n.prototype),"end",this).call(this)}},{key:"lowMode",value:function(){return this.cell.points.length<=2}},{key:"client2draw",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]);return $d([t[0],t[1]])}}]),n}();c()(_p,"className","DrawBaseResizer");var Mp,Lp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ja(t)&&"a"===t.key&&(e.interaction.changeMode("edit"),t.preventDefault(),t.stopPropagation(),e.command.execute("SelectAll"),e.tryFocus())}))}}]),n}(),Tp={Cells:[vp,pp],Extends:[Ep,gp,_p],defaultCursors:(Mp={},c()(Mp,"pen",wp),c()(Mp,"free-hand","url(https://gw.alipayobjects.com/zos/bmw-prod/f16b8ea8-336e-4ea8-a900-70e59408ec3e.svg) 10.61 21.32, auto"),c()(Mp,"eraser","url(https://gw.alipayobjects.com/zos/bmw-prod/16f33e84-9723-4005-b6ad-4a0d3e37c06b.svg) 14.73 20.61,auto"),Mp),modes:[{mode:"edit",Behaviours:[Op]},{mode:"pen",Behaviours:[Cp,Ap]},{mode:"free-hand",Behaviours:[Ql,Lp]},{mode:"eraser",Behaviours:[Pp,Ql]}],Commands:[]};rp.registerClipboardProcessor("mindmap",{text:function(e){var t=e.text,n=e.diagram,r=n.selector.selections,o=r[0];if(1===r.length&&o.isMindmap){var a=wl(t);if(a){o.collapsed&&n.update(o,{collapsed:null});var i=o.model.children.filter((function(e){return!e.abstract})).length;return a.forEach((function(e,t){e.options={parent:o.model.id,nth:i+t}})),a}}return!1},textIndex:2}),df.registerContentEditorOptions("mindmap",{insertParagraphKey:function(e){return(e.metaKey||e.ctrlKey||e.altKey)&&"Enter"===e.key},cancelKey:function(e){return"Tab"===e.key||"Tag"===e.key||"Enter"===e.key||"Escape"===e.key}}),gf.filterCell((function(e){return!e.isMindmap}));var Dp=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).className="MindmapCollapseButton",r.configName="mindmapCollapseButton",r.current="none",r.zIndex=1,r.radius=8,r.outer=12,r}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new no;this.group=n,e.collapsedButtonElement=n,t.add(n),this.delegateEvent()}},{key:"delegateEvent",value:function(){var e=this.group;this.cell.delegateEvent(e,"click","collapsedbutton:click")}},{key:"drawPosition",value:function(){this.draw()}},{key:"updateState",value:function(){this.drawButton()}},{key:"_getCurrent",value:function(e){var t=this.cell,n=t.computedProps.treeEdge,r=t.x,o=t.y,a=t.width,i=t.height;return e+r+o+n.stroke+a+i}},{key:"_setDirection",value:function(){var e=this.cell,t=e.downLayoutType,n=e.downDirection;"standard"===t?0===n[0]?Math.sign(-1===n[1])?this.direction="top":this.direction="bottom":Math.sign(-1===n[0])?this.direction="left":this.direction="right":"indent"===t?-1===Math.sign(n[1])?this.direction="top":this.direction="bottom":"timeline"===t&&-1===Math.sign(n[0])?this.direction="left":this.direction="right"}},{key:"_updatePosition",value:function(e){var t,n,r=this.cell,o=this.direction,a=this.bbox,i=r.border,c=a.width,l=a.height;switch(o){case"top":t=r.width/2-c/2,n=-l;break;case"bottom":t=r.width/2-c/2,n=r.height+8;break;case"left":n="line"===i.shape?r.height-l/2:r.height/2-l/2,t=-c;break;default:n="line"===i.shape?r.height-l/2:r.height/2-l/2,t=r.width+8}var u=[1,0,0,0,1,0,t,n,1];e.update({matrix:u})}},{key:"_setBBox",value:function(){var e,t,n=this.direction,r=2*this.radius,o=2*this.radius;switch(n){case"top":case"bottom":e=r,t=o+8;break;default:t=o,e=r+8}this.bbox={width:e,height:t}}},{key:"_drawCollapseButtonHotspot",value:function(){var e=this.bbox,t=this.group,n=this.outer,r=new ho,o=2*n;t.clear(),r.update({fill:"transparent",d:Jn(-n,-n,e.width+.8*o,e.height+o)}),t.add(r),r.toBack(),this._updatePosition(t)}},{key:"_drawCollapseButton",value:function(){var e,t=this.cell,n=this.group,r=this.direction,o=this.radius,a=t.computedProps,i=t.diagram.viewport.zoom,c=2*o;switch(r){case"top":e=-Math.PI/2;break;case"bottom":e=Math.PI/2;break;case"left":e=Math.PI;break;default:e=0}var l=["border-radius: 16px","width: ".concat(c,"px"),"height: ".concat(c,"px"),"cursor: pointer","background: white","border: 3px solid ".concat(a.treeEdge.stroke),"display: inline-block"],u=[1,0,0,0,1,0,0,0,1];k.mat3.translate(u,u,[o,o,1]),k.mat3.rotate(u,u,e),k.mat3.translate(u,u,[-o,-o,1]);var s=new go({html:'<span style="'.concat(l.join(";"),'" data-diagram-collapsed-button=true data-testid="diagram-collapsed-button"></span>'),x:0,y:0,width:0,height:0,matrix:u});s.css({"line-height":"normal"}),n.add(s);var d=s.htmlContainer.querySelector("span"),f=d.getBoundingClientRect(),h=f.width/i,p=f.height/i;s.update({width:h,height:p}),d.style.background=a.treeEdge.stroke,d.style.setProperty("background-repeat","no-repeat"),d.style.setProperty("background-position","1px 1px"),d.style.setProperty("background-image","url(".concat("https://gw.alipayobjects.com/zos/bmw-prod/c8f8bbfd-df13-421d-85f1-e310d67c89fc.svg",")"))}},{key:"_drawExpandButton",value:function(){var e=this.cell,t=this.group,n=this.radius,r=e.computedProps,o=e.diagram,a=r.treeEdge.stroke;t.clear();var i=-1;e.deepEach((function(){i++}));var c=o.font.measureTextLength(String(i))+8,l=ga(a),u=new jo({x:4,y:3,text:"".concat(i),fill:l,"dominant-baseline":"hanging"});u.dataset({diagramCollapsedButton:"true"}),u.css({fontFamily:"system-ui",fontSize:"12px",cursor:"pointer"});var s=new Ao({x:0,y:0,rx:n,width:c,height:2*n,fill:"".concat(a)});t.add(u),u.before(s),this._drawTail(),this._updatePosition(t)}},{key:"_drawTail",value:function(){var e,t=this.group,n=this.direction,r=this.cell,o=r.computedProps,a=2*this.radius,i=2*this.radius,c={x:a/2,y:i/2};switch(n){case"top":e="M".concat(c.x," ").concat(i," L").concat(c.x," ").concat(i+8);break;case"bottom":e="M".concat(c.x," 0 L").concat(c.x," -").concat(8);break;case"left":e="M".concat(a," ").concat(c.y," L").concat(a+8," ").concat(c.y);break;default:e="M0 ".concat(c.y," L-").concat(8," ").concat(c.y)}t.add(new ho({d:e,stroke:o.treeEdge.stroke,"stroke-width":r.getTreeEdgeStrokeWidth()}))}},{key:"draw",value:function(){var e=this.cell,t=this.current,n=e.state;this._setDirection(),this._setBBox(),e.canExpand()?(t!==this._getCurrent("expandButton")&&this._drawExpandButton(),this.current=this._getCurrent("expandButton")):e.canCollapse()&&(this._drawCollapseButtonHotspot(),n.collapsedButtonVisible&&this._drawCollapseButton())}},{key:"drawButton",value:function(){var e=this.cell,t=this.current,n=e.state;this._setDirection(),this._setBBox(),e.canExpand()?t!==this._getCurrent("expandButton")&&(this._drawExpandButton(),this.current=this._getCurrent("expandButton")):e.canCollapse()&&n.collapsedButtonVisible?t!==this._getCurrent("collapseButton")&&(this._drawCollapseButton(),this.current=this._getCurrent("collapseButton")):("none"!==t&&this.draw(),this.current="none")}},{key:"destroy",value:function(){this.group.destroy()}}]),n}();function Np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Bp=ho,Ip=Fo,Fp=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"createRendererElement",value:function(){var e=this.cell,t=e.graphicGroup,n=e.parent;if(!this.element||e.isCacheStale("roughFillStyle")){var r=e.getRoughGraphicOptions(),o=new(r?ta:Bp)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Np(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Np(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},r));o.capture(!1),t.add(o),this.element&&this.element.remove(),this.element=o,e.treeEdgeElement=o,e.cache.treeEdgeStyle={},e.cache.treeEdgePath=null,n&&n.isStem&&!e.isAbstract&&this._createClipPath()}}},{key:"_createClipPath",value:function(){var e=this.cell,t=this.element,n=e.parent,r=e.diagram;if(n){var o=r.defs,a=Object(F.a)(),i=new Ip({id:a}),c=new Bp({"fill-rule":"nonzero"});i.add(c),o.add(i),this.clipPath&&this.clipPath.remove(),this.treeEdgeClipPath=c,this.clipPath=i,t.update({"clip-path":"url(#".concat(a,")")})}}},{key:"VH",value:function(e,t){return"M".concat(e[0],",").concat(e[1]," L").concat(e[0],",").concat(t[1]," L").concat(t[0],",").concat(t[1])}},{key:"curveHVH",value:function(){var e,t,n,r,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.cell,l=c.parent,u=.5,s="";return c.x>l.x?(t=l.isStem?[l.x-c.x+l.width-36,l.y-c.y+l.height/2]:[l.x-c.x+l.width,l.y-c.y+l.height/2+a],(n=[0,c.height/2])[1]+=i,r=[t[0]+4,t[1]],e=(o=[n[0]-4,n[1]])[0]-r[0],s+="M".concat(t[0]," ").concat(t[1]," "),s+="L".concat(r[0]," ").concat(r[1]," "),s+="C".concat(r[0]+.5*e," ").concat(r[1],", ").concat(o[0]-e*u," ").concat(o[1],", ").concat(o[0]," ").concat(o[1]," "),s+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(s+="L".concat(n[0]+c.width," ").concat(n[1]))):(t=l.isStem?[l.x-c.x+36,l.y-c.y+l.height/2]:[l.x-c.x,l.y-c.y+l.height/2+a],(n=[c.width,c.height/2])[1]+=i,r=[t[0]-4,t[1]],o=[n[0]+4,n[1]],e=r[0]-o[0],s+="M".concat(t[0]," ").concat(t[1]," "),s+="L".concat(r[0]," ").concat(r[1]," "),s+="C".concat(r[0]-.5*e," ").concat(r[1],", ").concat(o[0]+e*u," ").concat(o[1],", ").concat(o[0]," ").concat(o[1]," "),s+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(s+="L".concat(n[0]-c.width," ").concat(n[1]))),s}},{key:"VHV",value:function(){var e,t,n=this.cell,r=n.parent,o={x:r.x-n.x,y:r.y-n.y},a="";n.y<r.y?(e=[o.x+r.width/2,o.y],t=[n.width/2,n.height]):(e=[o.x+r.width/2,o.y+r.height],t=[n.width/2,0]);var i=(e[1]+t[1])/2;return a+="M".concat(e[0]," ").concat(e[1]," "),a+="L".concat(e[0]," ").concat(i," "),(a+="L".concat(t[0]," ").concat(i," "))+"L".concat(t[0]," ").concat(t[1])}},{key:"HVH",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this.cell,i=a.parent,c="";return a.x>i.x?(e=i.isStem?[i.x-a.x+i.width,i.y-a.y+i.height/2]:[i.x-a.x+i.width,i.y-a.y+i.height/2+r],(t=[0,a.height/2])[1]+=o,n=(i.x-a.x+i.width)/2,"line"===a.border.shape&&(t[0]+=a.width)):(e=1===a.depth?[i.x-a.x,i.y-a.y+i.height/2]:[i.x-a.x,i.y-a.y+i.height/2+r],(t=[a.width,a.height/2])[1]+=o,n=(i.x-a.x+a.width)/2,"line"===a.border.shape&&(t[0]-=a.width)),c+="M".concat(e[0]," ").concat(e[1]," "),c+="L".concat(n," ").concat(e[1]," "),(c+="L".concat(n," ").concat(t[1]," "))+"L".concat(t[0]," ").concat(t[1])}},{key:"curveVHV",value:function(){var e,t,n,r,o,a=this.cell,i=a.parent,c={x:i.x-a.x,y:i.y-a.y},l="",u=1===a.depth?0:8;return a.y<i.y?(t=[c.x+i.width/2,c.y],n=[a.width/2,a.height],r=[t[0],t[1]-u],o=[n[0],n[1]+0],e=r[1]-o[1]):(t=[c.x+i.width/2,c.y+i.height],n=[a.width/2,0],r=[t[0],t[1]+u],o=[n[0],n[1]-0],e=r[1]-o[1]),l+="M".concat(t[0]," ").concat(t[1]," "),l+="L".concat(r[0]," ").concat(r[1]," "),(l+="C".concat(r[0]," ").concat(r[1]-.5*e,", ").concat(o[0]," ").concat(o[1]+.5*e,", ").concat(o[0]," ").concat(o[1]," "))+"L".concat(n[0]," ").concat(n[1])}},{key:"getStandardLayoutPath",value:function(){var e=this.cell,t=e.parent,n=e.computedProps,r=e.upDirection,o=n.treeEdge.shape;if(0===r[0])return"polyline"===o?this.VHV():this.curveVHV();var a=0,i=0;return"line"===t.border.shape&&(a=t.height/2),"line"===e.border.shape&&(i=e.height/2),"polyline"===o?this.HVH(a,i):this.curveHVH(a,i)}},{key:"getIndentLayoutPath",value:function(){var e,t,n=this.cell,r=n.computedProps,o=n.border,a=n.parent,i=r.treeEdge.shape,c={x:a.x-n.x,y:a.y-n.y},l=a.x+a.width/2-(n.x+n.width)>0,u=a.y-n.y-n.height>0,s="";if(u?(e=[c.x+a.width/2,c.y],t=l?"line"===o.shape?[0,n.height]:[n.width,n.height/2]:"line"===o.shape?[n.width,n.height]:[0,n.height/2]):(e=[c.x+a.width/2,c.y+a.height],t=l?"line"===o.shape?[0,n.height]:[n.width,n.height/2]:"line"===o.shape?[n.width,n.height]:[0,n.height/2]),"polyline"===i)s+="M".concat(e[0],",").concat(e[1]),s+="L".concat(e[0],",").concat(t[1]),s+="L".concat(t[0],",").concat(t[1]);else{var d=16;if(s+="M".concat(e[0],",").concat(e[1]),u){var f=Math.abs(t[1]-e[1]);f<=d&&(d=f),l?(s+="L".concat(e[0],",").concat(t[1]+d),s+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(e[0]-d,", ").concat(t[1]),s+="L".concat(t[0],",").concat(t[1])):(s+="L".concat(e[0],",").concat(t[1]+d),s+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(e[0]+d,", ").concat(t[1]),s+="L".concat(t[0],",").concat(t[1]))}else l?(s+="L".concat(e[0],",").concat(t[1]-d),s+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(e[0]-d,", ").concat(t[1]),s+="L".concat(t[0],",").concat(t[1])):(s+="L".concat(e[0],",").concat(t[1]-d),s+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(e[0]+d,", ").concat(t[1]),s+="L".concat(t[0],",").concat(t[1]))}return s}},{key:"getTimelineLayoutPath",value:function(){var e,t=this.cell,n=t.upSignX,r=t.getTimelineLayoutAlign(),o=t.getTimelineLayoutSourceCell(),a={x:o.x-t.x,y:o.y-t.y},i=[0,0];return 1===n?(e="b"===r[0]?[a.x+o.width,a.y+o.height]:[a.x+o.width,a.y+o.height/2],i="b"===r[1]?[t.width,t.height]:[0,t.height/2]):-1===n&&(e="b"===r[0]?[a.x,a.y+o.height]:[a.x,a.y+o.height/2],i="b"===r[1]?[0,t.height]:[t.width,t.height/2]),e&&"M".concat(e[0],",").concat(e[1]," L").concat(i[0],",").concat(i[1])}},{key:"getAbstractLayoutPath",value:function(){var e=this.cell,t=e.al,n=void 0===t?10:t,r=e.ad,o=void 0===r?"x":r,a=e.ap,i=void 0===a?1:a,c=e.width,l=void 0===c?2:c,u=e.height,s=void 0===u?2:u,d=e.computedProps.treeEdge.shape,f=[0,0],h=[0,0],p=[0,0];"x"===o?(f[0]+=.5*l,f[1]+=(1-(i+1)/2)*s,h[0]=f[0]-n/2,p[0]=f[0]+n/2,h[1]=p[1]=f[1]-48*i):(f[0]+=(1-(i+1)/2)*l,f[1]+=.5*s,h[1]=f[1]-n/2,p[1]=f[1]+n/2,h[0]=p[0]=f[0]-48*i);var m="y"===o?[h[0]+12*i,h[1]]:[h[0],h[1]+12*i],y="y"===o?[p[0]+12*i,p[1]]:[p[0],p[1]+12*i],v="y"===o?[f[0]-0*i,f[1]]:[f[0],f[1]-0*i],g="y"===o?[v[0]-16*i,v[1]]:[v[0],v[1]-16*i];return"polyline"===d?"y"===o?"M".concat(m[0],",").concat(m[1]," L").concat(g[0],",").concat(m[1]," L").concat(g[0],",").concat(y[1]," L").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"M".concat(m[0],",").concat(m[1]," L").concat(m[0],",").concat(g[1]," L").concat(y[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"y"===o?"M".concat(m[0],",").concat(m[1]," Q").concat(g[0],",").concat(m[1]," ").concat(g[0],",").concat(g[1]," Q").concat(g[0],",").concat(y[1]," ").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"M".concat(m[0],",").concat(m[1]," Q").concat(m[0],",").concat(g[1]," ").concat(g[0],",").concat(g[1]," Q").concat(y[0],",").concat(g[1]," ").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1])}},{key:"getPath",value:function(){var e=this.cell,t=e.upLayoutType,n=e.isAbstract;return t||n?n?this.getAbstractLayoutPath():"indent"===t?this.getIndentLayoutPath():"timeline"===t?this.getTimelineLayoutPath():this.getStandardLayoutPath():""}},{key:"getSytle",value:function(){var e=this.cell;return{stroke:e.computedProps.treeEdge.stroke,"stroke-width":e.getTreeEdgeStrokeWidth()}}},{key:"drawClipPath",value:function(){var e=this.cell,t=this.treeEdgeClipPath;if(t){var n=e.parent,r={x:n.x-e.x,y:n.y-e.y},o=n.getPadding(),a=[r.x+o[3],r.y+o[0]],i=[r.x+n.width-o[1],r.y+n.height-o[2]],c=[Math.min(0,r.x)-50,Math.min(0,r.y)-50],l=[Math.max(e.width,r.x+n.width)+50,Math.max(e.height,r.y+n.height)+50];t.update({d:Un(c[0],c[1],l[0],l[1],a[0],a[1],i[0],i[1])})}}},{key:"_drawPath",value:function(){var e=this.cell,t=this.element,n=e.cache,r=this.getPath();n.treeEdgePath!==r&&(t.update({d:r}),n.treeEdgePath=r,this.drawClipPath())}},{key:"drawPosition",value:function(){this._drawPath()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=e.cache,r=this.getSytle(),o=vn(r,n.treeEdgeStyle,["stroke","stroke-width"]);this._drawPath(),Object.keys(o).length>0&&(t.update(o),n.treeEdgeStyle=u()(r))}},{key:"destroy",value:function(){this.element.destroy(),this.clipPath&&this.clipPath.destroy()}}]),n}();function qp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Fp,"className","TreeEdge"),c()(Fp,"configName","treeEdge"),c()(Fp,"zIndex",1);var zp=function(e){S()(n,us);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=1===e.depth?400:"normal",r=1===e.depth?'PingFangSC-Medium, "PingFang SC"':'PingFangSC-Regular, "PingFang SC"';N()(M()(n.prototype),"init",this).call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"0.1px","font-size":"".concat(14,"px"),"font-weight":"".concat(t),"line-height":"1.74","word-break":"break-word"}}],defaultFontFamily:r},e))}},{key:"_calculateCapsulePadding",value:function(){var e=this.width,t=this.height;return e&&t?Math.min(e,t)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"getPadding",value:function(){var e,t=this.model;if(1===this.depth)if("line"===this.border.shape)e=[2,8,2,8];else if("rect"===this.border.shape)e=[6,12,6,12];else{var r=this._calculateCapsulePadding();e=new Array(4).fill(r)}else if(this.depth>1)if("line"===this.border.shape)e=[2,8,2,8];else if("rect"===this.border.shape)e=[6,8,6,8];else{var o=this._calculateCapsulePadding();e=new Array(4).fill(o)}else e=N()(M()(n.prototype),"getPadding",this).call(this);return t.note&&(e[1]/=2),e}},{key:"isAbstract",get:function(){return this.model.abstract}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{mindmapCollapseButton:{},border:{outer:0,radius:3,shape:"line",fill:"transparent"},treeEdge:{},Subcells:[Fp,Dp]})}}]),n}();c()(zp,"className","MindmapCell");var Gp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),c()(this,"zNodes",[]),c()(this,"options",{}),this.options=t,Object.assign(this,t)}return v()(e,[{key:"getHGap",value:function(e){return 20}},{key:"getVGap",value:function(e){return 20}},{key:"getAGap",value:function(e){return 48}},{key:"beforeInsert",value:function(e){var t=this.zNodes;e.isSubTree?t.unshift.apply(t,T()(e.zNodes)):t.unshift(e)}},{key:"getAxisNorm",value:function(e,t,n){var r=e.isSubTree?"t":"";return{axis:r+t,norm:r+n}}},{key:"getAxisNormValue",value:function(e,t,n){var r=e.isSubTree?"t":"",o=r+t,a=r+n;return{coord:null==e[o]?e[t]:e[o],normValue:null==e[a]?e[n]:e[a]}}},{key:"getPureAxisNormValue",value:function(e,t,n){return{coord:e[t],normValue:e[n]}}},{key:"updateParentMaxDepth",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.parent;r;)r.maxDepth=n?Math.max(r.maxDepth,t):Math.min(r.maxDepth,t),r=r.parent}},{key:"setNodeCoord",value:function(e,t,n){if(e.isSubTree){var r="t"+t,o=e[r]-n;Wt(e,(function(e){e.isSubTree&&(e[r]-=o),e[t]-=o}))}else e[t]=n}},{key:"preOrder",value:function(e,t,n){var r=this,o=e.children,a=void 0===o?[]:o;t(e,n),!a||e.isSubTree&&n||e.collapsed||a.forEach((function(n){r.preOrder(n,t,e)}))}},{key:"preOrderWithOutSelf",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=e.children,l=void 0===c?[]:c;if(l&&(!e.isSubTree||!n)&&!e.collapsed){var u=i.concat(l.filter((function(e){return!e.abstract})).length);l.forEach((function(n,i){var c=a.concat(i);t(n,e,i,l,o,c,u),r.preOrderWithOutSelf(n,t,e,o+1,c,u)}))}}},{key:"postOrder",value:function(e,t,n){var r=this,o=e.children,a=void 0===o?[]:o;!a||e.isSubTree&&n||e.collapsed||a.forEach((function(n){r.postOrder(n,t,e)})),t(e,n)}},{key:"postOrderWithOutSelf",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=e.children,l=void 0===c?[]:c;if(l&&(!e.isSubTree||!n)&&!e.collapsed){var u=i.concat(l.filter((function(e){return!e.abstract})).length);l.forEach((function(n,i){var c=a.concat(i);r.postOrderWithOutSelf(n,t,e,o+1,c,u),t(n,e,i,l,o,c,u)}))}}},{key:"orderByGroupWithoutSelf",value:function(e,t,n){var r=this,o=new Map,a=n.initInfo,i=n.enterGroup,c=n.exitGroup,l=n.beforecallback,u=n.callback,s=n.aftercallback;return e.call(this,t,(function(e,t,n,d,f,h,p){if(0===n){var m=d.filter((function(e){return e.abstract})),y=m.length,v=d.length-y,g=[];m.forEach((function(e){var t=r.getAbstractLocateString(e,v);g.push(t)}));var b={areasQueue:g,nowGroup:null,groupIndex:-1,childrenLength:v,abstractLength:y,nowGroupData:void 0};o.set(t,Object.assign(b,a(b,e,t,n,d,f,h,p)))}var x=o.get(t);if(l&&n<x.childrenLength&&l(x,e,t,n,d,f,h,p),!x.nowGroup){var w=x.areasQueue[0]?r.parseAbstractLocateString(x.areasQueue[0]):void 0;w&&n===w[0]&&(x.nowGroup=w,x.areasQueue.shift(),x.groupIndex++,i&&(x.nowGroupData=i(x,e,t,n,d,f,h,p)))}u&&n<x.childrenLength&&u(x,e,t,n,d,f,h,p),!x.nowGroup||n!==x.nowGroup[0]+x.nowGroup[1]-1&&n!==x.childrenLength-1||(c&&c(x,e,t,n,d,f,h,p),x.nowGroup=null,x.nowGroupData=void 0),s&&n<x.childrenLength&&s(x,e,t,n,d,f,h,p)})),o}},{key:"postOrderByGroupWithoutSelf",value:function(e,t){return this.orderByGroupWithoutSelf(this.postOrderWithOutSelf,e,t)}},{key:"preOrderByGroupWithoutSelf",value:function(e,t){return this.orderByGroupWithoutSelf(this.preOrderWithOutSelf,e,t)}},{key:"deeperAllLast",value:function(e,t,n){for(var r=e+1;r<t.length;r++)if(t[r]!==n[r]-1)return!1;return!0}},{key:"makeAbstractBreadthOffset",value:function(e,t,n,r,o,a,i,c){var l="x"===e?"x":"y",u="x"===e?"w":"h",s=this.getAxisNorm(a,l,u),d=s.norm,f=s.axis,h=a[d],p=Math.abs(c-i),m=(c+i)/2,y=a[u]/2+a[l]-a[f],v=h-y,g=t?Math.max(y-p/2,0):Math.min(p/2-v,0),b=m+g-y;if(this.setNodeCoord(a,l,b),0!==g)for(var x=r[0];x<r[0]+r[1];x++){var w=o[x];"x"===l?this.move(w,g,0):this.move(w,0,g)}var k=t?Math.max(c+g,a[d]+a[f]):Math.min(c+g,a[f]),E=Math.abs(k-i);return a.al=p,a.ad=l,a.ap=n?1:-1,a.breadthPositive=t?1:-1,[g,E,k]}},{key:"move",value:function(e,t,n){Wt(e,(function(e){e.x+=t,e.y+=n,e.isSubTree&&(e.tx+=t,e.ty+=n)}))}},{key:"moveX",value:function(e,t){Wt(e,(function(e){e.x+=t,e.isSubTree&&(e.tx+=t)}))}},{key:"moveY",value:function(e,t){Wt(e,(function(e){e.y+=t,e.isSubTree&&(e.ty+=t)}))}},{key:"layout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.constructor.VAILD_DIRECTION_ANGLES,r=e.directionAngle;this.zNodes=t,n.some((function(e){return oi(e,r)}))?(this.setKeys(e),this.normalize(e),this.setCoord(e),this.setZIndex(e)):console.warn("The layout does not support the direction")}},{key:"getAbstractLocateString",value:function(e,t){var n=e.start,r=void 0===n?0:n,o=e.end,a=void 0===o?0:o,i=Math.max(0,r);return i+":"+(Math.min(t,a)-i+1)}},{key:"parseAbstractLocateString",value:function(e){return e.split(":").map((function(e){return parseInt(e)}))}},{key:"setKeys",value:function(e){}},{key:"normalize",value:function(e){}},{key:"setCoord",value:function(e){}},{key:"setZIndex",value:function(e){}}]),e}();c()(Gp,"VAILD_DIRECTION_ANGLES",[]),c()(Gp,"QUADRANTS",4);var Yp=function(e){S()(n,Gp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"breadthAxis","y"),c()(A()(e),"depthAxis","x"),c()(A()(e),"breadthNorm","h"),c()(A()(e),"depthNorm","w"),c()(A()(e),"mainGap","vgap"),c()(A()(e),"secondaryGap","hgap"),c()(A()(e),"isMainPositive",!1),c()(A()(e),"isPositive",!1),e}return v()(n,[{key:"setKeys",value:function(e){var t=e.directionAngle,n=this.constructor.MAIN_AXIS,r=!1,o=!1;oi(t,Math.PI/4)?(r=!0,o=!0):oi(t,3*Math.PI/4)?(r=!1,o=!0):oi(t,5*Math.PI/4)?(r=!1,o=!1):oi(t,7*Math.PI/4)&&(r=!0,o=!1),"x"===n?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.isMainPositive=r,this.isPositive=o):(this.breadthAxis="y",this.depthAxis="x",this.breadthNorm="h",this.depthNorm="w",this.mainGap="vgap",this.secondaryGap="hgap",this.isMainPositive=o,this.isPositive=r)}},{key:"normalize",value:function(e){var t=this;this.preOrder(e,(function(e){var n={node:e};e.vgap=t.getVGap(n),e.hgap=t.getHGap(n)}))}},{key:"setCoord",value:function(e){this._setMainCoord(e),this._setSecondaryCoord(e)}},{key:"_setMainCoord",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm,o=this.mainGap,a=this.isMainPositive,i=this.isPositive,c=e[n],l=e[r],u=[];this.preOrderByGroupWithoutSelf(e,{initInfo:function(){return{smin:0}},beforecallback:function(e,i){var u,s=t.getAxisNorm(i,n,r).norm,d=i[o],f=i[s];c=u=a?c+l+d:c-f-d,l=f,t.setNodeCoord(i,n,u)},enterGroup:function(e){e.smin=a?c:c+l},exitGroup:function(e,t,n,r,o,a){var i=e.nowGroup,c=o[e.childrenLength+e.groupIndex];u.unshift({smin:e.smin,depth:a,siblings:o,nowGroup:i,abstractNode:c})},aftercallback:function(e,r,o,s,d,f,h,p){if(!r.children||0===r.children.length||r.isSubTree)for(;u.length>0;){var m=u[0],y=m.nowGroup,v=m.siblings,g=m.smin,x=m.depth,w=m.abstractNode;if(!t.deeperAllLast(x,h,p))break;u.shift();var k=a?c+l:c,E=t.makeAbstractBreadthOffset(n,a,i,y,v,w,g,k),O=b()(E,3);O[0];var C=O[1],A=O[2];c=a?g:A,l=C}}})}},{key:"_setSecondaryCoord",value:function(e){var t=this,n=this.depthAxis,r=this.depthNorm,o=this.secondaryGap,a=this.isPositive,i=a?1:-1;this.preOrderWithOutSelf(e,(function(e,c){var l,u=t.getAxisNorm(e,n,r).norm,s=e[o];if(!e.abstract){var d=(l=a?c[n]+c[r]/2+s:c[n]+c[r]/2-e[u]-s)+(i+1)/2*e[u];e.maxDepth=d,t.updateParentMaxDepth(e,d,a),t.setNodeCoord(e,n,l)}})),this.postOrderByGroupWithoutSelf(e,{initInfo:function(){return{maxDepth:void 0}},callback:function(e,t){var n=t.maxDepth,r=void 0===n?0:n,o=e.nowGroupData;e.nowGroup&&(e.nowGroupData=o?a?Math.max(o,r):Math.min(o,r):r)},exitGroup:function(e,o,c,l,u){var s=e.childrenLength,d=e.groupIndex,f=e.nowGroupData,h=void 0===f?0:f,p=u[s+d],m=t.getAxisNorm(p,n,r).norm,y=a?h+i*t.getAGap():h+i*t.getAGap()-p[m];t.setNodeCoord(p,n,y);var v=y+(i+1)/2*p[m];t.updateParentMaxDepth(p,v,a)}})}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(o){var a=o.children;if(e!==o&&t.beforeInsert(o),a&&!o.collapsed){var i=o[n]+o[r]/2;a.sort((function(e,t){return Math.abs(e[n]+e[r]-i)-Math.abs(t[n]+t[r]-i)}))}}))}},{key:"getHGap",value:function(e){return 16}},{key:"getVGap",value:function(e){var t=e.node,n=t.parent;return n&&t===n.children[0]&&-1===t.upSignY?24:8}}]),n}();c()(Yp,"className","Indent"),c()(Yp,"VAILD_DIRECTION_ANGLES",[Math.PI/4,3*Math.PI/4,5*Math.PI/4,7*Math.PI/4]),c()(Yp,"QUADRANTS",4),c()(Yp,"MAIN_AXIS","y");var Hp=function(e){S()(n,Gp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"depthAxis",void 0),c()(A()(e),"depthNorm",void 0),c()(A()(e),"breadthGap",void 0),c()(A()(e),"depthGap",void 0),c()(A()(e),"breadthAxis",void 0),c()(A()(e),"breadthNorm",void 0),c()(A()(e),"isVertical",!1),c()(A()(e),"isPositive",void 0),e}return v()(n,[{key:"setKeys",value:function(e){var t=e.directionAngle,n=oi(t,Math.PI/2)||oi(t,3*Math.PI/2);n?(this.breadthAxis="x",this.breadthNorm="w",this.breadthGap="hgap",this.depthAxis="y",this.depthNorm="h",this.depthGap="vgap"):(this.breadthAxis="y",this.breadthNorm="h",this.breadthGap="vgap",this.depthAxis="x",this.depthNorm="w",this.depthGap="hgap"),oi(t,0)||oi(t,Math.PI/2)?this.isPositive=!0:this.isPositive=!1,this.isVertical=n}},{key:"normalize",value:function(e){var t=this,n=this.isVertical;this.preOrderWithOutSelf(e,(function(e,t){e.ancestors=[t].concat(t.ancestors||[])})),this.preOrder(e,(function(e){var r={node:e,isVertical:n};e.vgap=t.getVGap(r),e.hgap=t.getHGap(r)}))}},{key:"setCoord",value:function(e){this._setDepth(e),this._setBreadth(e)}},{key:"_setDepth",value:function(e){var t=this,n=this.depthAxis,r=this.depthNorm,o=this.depthGap,a=this.isPositive,i=a?1:-1;this.preOrderWithOutSelf(e,(function(e,c){var l=t.getAxisNorm(e,n,r).norm;if(!e.abstract){var u,s=e[o],d=(u=a?c[n]+c[r]+s:c[n]-e[l]-s)+(i+1)/2*e[l];e.maxDepth=d,t.updateParentMaxDepth(e,d,a),t.setNodeCoord(e,n,u)}})),this.postOrderByGroupWithoutSelf(e,{initInfo:function(){return{maxDepth:void 0}},callback:function(e,t){var n=t.maxDepth,r=void 0===n?0:n,o=e.nowGroupData;e.nowGroup&&(e.nowGroupData=o?a?Math.max(o,r):Math.min(o,r):r)},exitGroup:function(e,o,c,l,u){var s=e.childrenLength,d=e.groupIndex,f=e.nowGroupData,h=void 0===f?0:f,p=u[s+d],m=t.getAxisNorm(p,n,r).norm,y=a?h+i*t.getAGap():h+i*t.getAGap()-p[m];t.setNodeCoord(p,n,y);var v=y+(i+1)/2*p[m];t.updateParentMaxDepth(p,v,a)}})}},{key:"_setBreadth",value:function(e){var t,n=this,r=this.breadthAxis,o=this.breadthNorm,a=this.breadthGap,i=this.isVertical,c=this.isPositive,l=e.x,u=e.y;this.postOrderByGroupWithoutSelf(e,{initInfo:function(e,t,n,r,o){return{smin:0,emax:0}},beforecallback:function(e,c,l,u,s){var d,f,h,p=n.getAxisNorm(c,r,o),m=p.axis,y=p.norm,v=c.children,g=void 0===v?[]:v,b=c.abstract;if(void 0===t)f=0;else if(0===g.length||c.collapsed||c.isSubTree){if(b)return;var x=n.getBreadthGap(c,t);f=t.maxBreadth+x}else{f=n.getBreadthByChildren({children:g.filter((function(e){return!e.abstract})),breadthAxis:r,node:c,breadthNorm:o,norm:y,isVertical:null!=i&&i}),c.minBreadth=Math.min(c.minBreadth,f);var w=l.children[l.children.indexOf(c)-1];if(w){var k=w.maxBreadth+w[a]-c.minBreadth;k>0&&(h=k)}}n.setNodeCoord(c,r,f),h&&(i?n.move(c,h,0):n.move(c,0,h),c.maxBreadth+=h);var E=c[m]+c[y];c.maxBreadth=Math.max(E,c.maxBreadth||0);var O,C=c[m];c.minBreadth=Math.min(C,null!==(d=c.minBreadth)&&void 0!==d?d:1/0),0===u&&(l.minBreadth=Math.min(C,c.minBreadth,null!==(O=l.minBreadth)&&void 0!==O?O:1/0))},enterGroup:function(e,t,n,r,o){e.smin=t.minBreadth},exitGroup:function(e,t,o,a,i){e.emax=t.maxBreadth;var l=e.childrenLength,u=e.groupIndex,s=e.smin,d=e.emax,f=e.nowGroup,h=i[l+u],p=n.makeAbstractBreadthOffset(r,!0,c,f,i,h,s,d),m=b()(p,3);m[0],m[1];var y=m[2];t.maxBreadth=y},aftercallback:function(e,n,r,o,a){var i;t=n,o===e.childrenLength-1&&(r.maxBreadth=r.maxBreadth=Math.max(t.maxBreadth,null!==(i=r.maxBreadth)&&void 0!==i?i:-1/0))}}),e[r]=this.getBreadthByChildren({children:e.children.filter((function(e){return!e.abstract})),breadthAxis:r,node:e,breadthNorm:o,norm:o,isVertical:i}),i?this.move(e,l-e.x,0):this.move(e,0,u-e.y)}},{key:"getBreadthGap",value:function(e,t){var n,r,o=this.breadthGap;if(e.parent===t.parent)return t[o];e.depth<t.depth?(n=t,r=e):(n=e,r=t);for(var a=n.depth-r.depth,i=0;i<r.ancestors.length;i++){var c=i+a;if(r.ancestors[i]===n.ancestors[c])return n.ancestors[c-1][o]}}},{key:"getBreadthByChildren",value:function(e){var t=e.children,n=e.breadthAxis,r=e.node,o=e.breadthNorm,a=e.isVertical,i=t.length,c=this.getPureAxisNormValue(t[0],n,o),l=this.getPureAxisNormValue(t[i-1],n,o),u=this.getPureAxisNormValue(r,n,o);if(!a&&t[0].border&&r.border){if("line"===t[0].border.shape&&"line"===r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue)/2-u.normValue;if("line"===t[0].border.shape&&"line"!==r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue-u.normValue)/2;if("line"!==t[0].border.shape&&"line"===r.border.shape&&t[0]===t[i-1])return c.coord+c.normValue/2-u.normValue}return(c.coord+l.coord+l.normValue-u.normValue)/2}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(o){var a=o.children;if(e!==o&&t.beforeInsert(o),a&&!o.collapsed){var i=o[n]+o[r]/2;a.sort((function(e,t){return Math.abs(e[n]+e[r]-i)-Math.abs(t[n]+t[r]-i)}))}}))}},{key:"getHGap",value:function(e){var t=e.isVertical,n=e.node.depth;return t?1===n?48:24:n>1?48:64}},{key:"getVGap",value:function(e){var t,r=e.isVertical,o=e.node,a=o.depth,i=o.border;return i?(r?t=64:1===a?t=24:(t=2===a?10:8,"line"!==i.shape&&(t*=2)),t):N()(M()(n.prototype),"getVGap",this).call(this)}}]),n}();function Vp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Hp,"className","Standard"),c()(Hp,"VAILD_DIRECTION_ANGLES",[0,Math.PI/2,Math.PI,3*Math.PI/2]),c()(Hp,"QUADRANTS",2);var Up=function(e){S()(n,Gp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r)),c()(A()(e),"breadthAxis","x"),c()(A()(e),"depthAxis","y"),c()(A()(e),"breadthNorm","w"),c()(A()(e),"depthNorm","h"),c()(A()(e),"mainGap","hgap"),c()(A()(e),"secondaryGap","vgap"),c()(A()(e),"secondaryDownSign","downSignY"),c()(A()(e),"isMainPositive",!0),c()(A()(e),"hgap1",40),c()(A()(e),"hgap2",32),c()(A()(e),"vgap1",0),c()(A()(e),"vgap2",0),c()(A()(e),"compact",!1),e}return v()(n,[{key:"getAlign",value:function(e){return e.node.cell.getTimelineLayoutAlign()}},{key:"normalize",value:function(e){var t=this;this.preOrder(e,(function(e){var n={node:e};e.align=t.getAlign(n)}))}},{key:"setKeys",value:function(e){var t=e.directionAngle;oi(t,0)?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!0):oi(t,Math.PI)&&(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!1)}},{key:"setCoord",value:function(e){this._setMainCoord(e),this._setSecondaryCoord(e)}},{key:"_setMainCoord",value:function(e){var t=this,n=this.secondaryDownSign,r=this.breadthAxis,o=this.breadthNorm,a=this.mainGap,i=this.isMainPositive,c=this.compact,l="".concat(a,"1"),u="".concat(a,"2"),s=i?1:-1,d=e[r];i&&(d+=e[o]);var f=d,h=d,p=d,m=[];this.preOrderByGroupWithoutSelf(e,{initInfo:function(e,t,n,r,o,a,i,c){return{smin:0}},beforecallback:function(e,a,m,y,v,g,b,x){var w,k=t.getAxisNorm(a,r,o).norm,E=p-f,O=p-h;-1===a[n]&&c?(s*E>0?(w=t[l],d=p):(w=t[u],d=f),i?(f=(d+=w)+a[k],p=d+a[o]):(d=d-w-a[k],f=d,p=d+(a[k]-a[o]))):(s*O>0?(w=t[l],d=p):(w=t[u],d=h),i?(h=(d+=w)+a[k],p=d+a[o]):(d=d-w-a[k],h=d,p=d+(a[k]-a[o]))),t.setNodeCoord(a,r,d)},enterGroup:function(e,n){var a=t.getAxisNorm(n,r,o).norm;e.smin=i?d:d+n[a]},exitGroup:function(e,t,n,r,o,a){var i=e.nowGroup,c=o[e.childrenLength+e.groupIndex];m.unshift({smin:e.smin,depth:a,siblings:o,nowGroup:i,abstractNode:c})},aftercallback:function(e,n,o,a,c,l,u,s){if(!n.children||0===n.children.length||n.isSubTree)for(;m.length>0;){var d=m[0],f=d.nowGroup,y=d.siblings,v=d.smin,g=d.depth,x=d.abstractNode;if(!t.deeperAllLast(g,u,s))break;m.shift();var w=x.downDirection,k=(void 0===w?[0,1]:w)[1]>=0,E=h,O=t.makeAbstractBreadthOffset(r,i,k,f,y,x,v,E),C=b()(O,3),A=C[0];C[1];var P=C[2];h=P,p+=A}}})}},{key:"_setSecondaryCoord",value:function(e){var t,n,r=this,o=this.depthAxis,a=this.depthNorm,i=e.children,c=void 0===i?[]:i,l=o.toUpperCase(),u=this["move".concat(l)].bind(this);c.forEach((function(r,i){var l=0===i?e:c[i-1],s=r.align;if(!r.abstract){"b"===s[0]?t=l[o]+l[a]:"c"===s[0]&&(t=l[o]+l[a]/2),"c"===s[1]?n=function(e){return t-e[a]/2}:"b"===s[1]&&(n=function(e){return t-e[a]});var d=n(r)-r[o];u(r,d)}})),this.preOrderByGroupWithoutSelf(e,{initInfo:function(){return{}},callback:function(e,t,n,i,c){var l=e.nowGroupData,u=e.nowGroup,s=c[e.childrenLength+e.groupIndex].downDirection,d=(void 0===s?[0,1]:s)[1]>=0,f=r.getAxisNorm(t,o,a),h=f.norm,p=f.axis;if(u){var m=d?t[p]+t[h]:t[p];e.nowGroupData=l?d?Math.max(l,m):Math.min(l,m):m}},exitGroup:function(e,t,n,i,c){var l=e.childrenLength,u=e.groupIndex,s=e.nowGroupData,d=void 0===s?0:s,f=c[l+u],h=f.downDirection,p=(void 0===h?[0,1]:h)[1]>=0,m=p?1:-1,y=r.getAxisNorm(f,o,a).norm,v=p?d+m*r.getAGap():d+m*r.getAGap()-f[y];r.setNodeCoord(f,o,v)}})}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(o){var a=o.children;if(e!==o&&t.beforeInsert(o),a&&!o.collapsed){var i=o[n]+o[r]/2;a.sort((function(e,t){return Math.abs(e[n]+e[r]-i)-Math.abs(t[n]+t[r]-i)}))}}))}}]),n}();function Wp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Up,"className","Timeline"),c()(Up,"VAILD_DIRECTION_ANGLES",[0,Math.PI]),c()(Up,"QUADRANTS",2);var Xp=function(e){S()(n,us);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({textareaContentStyleSheets:[{query:"self",css:{"letter-spacing":"normal","font-size":"18px","line-height":"1.74","word-break":"break-word",outline:"none",color:"white"}}],defaultFontFamily:'PingFangSC-Medium, "PingFang SC"'},e)),this.initLayoutEngine()}},{key:"minContentWidth",get:function(){return 52}},{key:"canCollapse",value:function(){return!1}},{key:"getPadding",value:function(){var e,t=this.model;if("capsule"===this.border.shape){var n=this._calculateCapsulePadding();e=new Array(4).fill(n)}else e=[6,16,6,16];return t.note&&(e[1]/=2),e}},{key:"_calculateCapsulePadding",value:function(){var e=this.width,t=this.height;return e&&t?Math.min(e,t)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"_createLayoutModel",value:function(){var e=this.cellMap,t=this.model,n=[],r=tn(t,(function(t){var r,o,a,i,c,l,u=e[t.id],s={x:u.x,y:u.y,w:null!==(r=u.width)&&void 0!==r?r:10,h:null!==(o=u.height)&&void 0!==o?o:10,layout:u.layout.type,direction:null!==(a=u.layout.direction)&&void 0!==a?a:[1,0],quadrantConstraint:u.layout.quadrantConstraint,quadrant:null!==(i=u.layout.quadrant)&&void 0!==i?i:1,collapsed:null!==(c=u.collapsed)&&void 0!==c&&c,border:{shape:u.border.shape},cell:u,abstract:null!==(l=u.isAbstract)&&void 0!==l&&l};return t.abstract&&(s.abstract=!0,s.start=t.start,s.end=t.end,s.layout="standard",s.direction=[1,0],s.quadrantConstraint=[1]),"timeline"===s.layout&&n.push(s),s}));return n.forEach((function(e){e.children.forEach((function(t,n){t.abstract||(t.layout&&!Da("timeline",t.layout)||(t.layout="indent",t.direction=[1,1],0===e.direction[1]?t.quadrantConstraint=n%2==0?[4]:[1]:t.quadrantConstraint=n%2==0?[1]:[2]),t.children&&t.children.forEach((function(t){t.layout||(t.layout="standard",t.direction=[1,0],-1===e.direction[0]?t.quadrantConstraint=[2]:t.quadrantConstraint=[1])})))}))})),r}},{key:"canRough",value:function(){return!0}},{key:"initLayoutEngine",value:function(){this.layoutHelper=new Zs({beforeLayoutAdjust:function(e){e.needAfterAdjustedNodes=[],Xt(e,(function(t){"timeline"!==t.parent.layout&&t.collapsed&&(1===t.downSignY?t.h+=24:-1===t.downSignY?(t.h+=24,e.needAfterAdjustedNodes.push({node:t,key:"y",value:24})):1===t.downSignX?t.w+=24:-1===t.downSignX&&(t.w+=24,e.needAfterAdjustedNodes.push({node:t,key:"x",value:24})))}))},afterLayoutAdjust:function(e){e.needAfterAdjustedNodes.forEach((function(e){var t=e.node,n=e.key,r=e.value;t[n]+=r}))},algorithms:{timeline:new Up,standard:new Hp,indent:new Yp}})}},{key:"_layoutPosition",value:function(e){e.forEach((function(e){var t=e.cell;t.x=e.x||0,t.y=e.y||0}))}},{key:"_layoutZIndex",value:function(e){var t=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||e.forEach((function(e,n){var o=e.cell;o.zIndex=n,o!==t&&r.insertBefore(o.graphicGroup,t.graphicGroup)}))}},{key:"_layoutdrectionAngle",value:function(e){e.forEach((function(e){e.cell.upDirection=e.upDirection,e.cell.downDirection=e.downDirection,e.cell.upLayoutType=e.upLayoutType,e.cell.downLayoutType=e.downLayoutType,e.cell.layoutQuadrantConstraint=e.quadrantConstraint||[1],e.cell.downSignX=e.downSignX,e.cell.downSignY=e.downSignY,e.cell.upSignX=e.upSignX,e.cell.upSignY=e.upSignY,e.cell.breadthPositive=e.breadthPositive,e.cell.ad=e.ad,e.cell.ap=e.ap,e.cell.al=e.al}))}},{key:"executeLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.layoutHelper,n=this._createLayoutModel();t.model=n,t.execute();var r=[],o=t.tree;Wt(o,(function(e){r.push(e)})),this._layoutPosition(r,e),this._layoutZIndex(o.zNodes),this._layoutdrectionAngle(r)}},{key:"drawInner",value:function(){this.subcells.forEach((function(e){e.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"destroy",value:function(){this.layoutHelper.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{border:{outer:0,radius:4,shape:"rect",fill:"#596086","stroke-width":2,stroke:"transparent"},textarea:{className:"lake-diagram-mindmap-root"},layout:{type:"standard",direction:[1,0]},treeEdge:{stroke:"#959EA6"},tapered:!1,rainbow:!0,note:{width:20,height:20,padding:[0,8,0,0]}})}}]),n}();c()(Xp,"className","MindmapStem");var Kp={treeEdge:!0,layout:!0,roughFillStyle:!0},Zp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforedraw",(function(t){t&&"remove"!==t.action&&(function(e,t){var n=e.stems.filter((function(e){return e.isMindmap}));n.length>0&&(t.inherit(Kp,n),n.forEach((function(e){e.deepEach((function(t){t!==e&&t.drawInherit()}))})))}(t,e),function(e,t){if("update"===e.action){var n=e.models.filter((function(e){var n=t.find(e.id);return n&&n.isMindmap&&n.isStem}));n.length>0&&n.forEach((function(e){if(void 0!==e.tapered||void 0!==e.rainbow){var n=t.find(e.id);void 0!==e.rainbow&&(!1===e.rainbow?n.forEach((function(e){e.isAbstract||e.updateModel({treeEdge:{stroke:"#959EA6"}})})):n.forEach((function(e,t){e.isAbstract||e.updateModel({treeEdge:{stroke:Rr[t%7]}})})),t.inherit(Kp,[n])),n.deepEachWithoutSelf((function(e){e.drawInner()}))}}))}}(t,e))}))}}]),n}();var Qp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(){var t=e.selector.selections;if(1===t.length&&t[0].isMindmap){var n=t[0];e.viewport.scrollIntoView(n)}}))}}]),n}();var $p=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n=De()((function(){var n=e.selector.selections;1===n.length&&n[0].isMindmap&&n[0].canCollapse()&&!(t=n[0]).model.isPlaceholder&&t.showCollapsedButton()}),16);this.bind(e,"afterselect",(function(){t&&t.hideCollapsedButton(),t=void 0,n()}))}}]),n}();var Jp=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"mindmapcell:mouseenter",(function(e){var t=e.cell;t.isMindmap&&!t.model.isPlaceholder&&t.highlight()})),this.bind(e,"mindmapcell:mouseleave",(function(e){var t=e.cell;t&&t.isMindmap&&t.unHighlight()}))}}]),n}();var em=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;function n(){t&&t.hideCollapsedButton(),t=void 0}this.bind(e,"mindmapcell:mouseenter",(function(n){var r=n.cell;e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing||r.isMindmap&&!r.model.isPlaceholder&&r.canCollapse()&&(r.showCollapsedButton(),t=r)})),this.bind(e,"mindmapcell:mouseleave",(function(r){var o=r.cell,a=r.nativeEvent;if(!(e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing)){var i=e.selector.selections;!o||!o.isMindmap||1===i.length&&(1!==i.length||o.model.id===i[0].model.id)||a.relatedTarget&&a.relatedTarget.closest('[data-lake_mindmap_add_button="true"]')?o&&o.isMindmap&&1===i.length&&o.model.id===i[0].model.id&&(t=void 0):n()}})),this.bind(e,"addbutton:mouseleave",(function(){e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing||n()})),this.bind(e,"aftercommandexecute",(function(e){"Expand"===e.commandName&&n()}))}}]),n}();function tm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var nm=function(){function e(){m()(this,e)}return v()(e,[{key:"createHotArea",value:function(e,t){var n=e.stem;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({child:e.child,stem:n},t)}},{key:"stem",value:function(){}},{key:"child",value:function(){}},{key:"prevSibling",value:function(){}},{key:"nextSibling",value:function(){}},{key:"betweenSibling",value:function(){}}]),e}();var rm=function(e){S()(n,nm);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"stem",value:function(e){var t=e.child,n=e.hotAreas,r=e.postFix,o=t.upDirection,a=Math.sign(o[0]),i=t.children.filter((function(e){return!e.abstract})).length;0===a?(n.push(this.createHotArea(e,{minX:t.minX-50,minY:t.minY-60,maxX:t.maxX+50,maxY:(t.minY+t.maxY)/2,parent:t.id,id:t.id+"2"+r,nth:i,quadrant:2,color:"orange"})),n.push(this.createHotArea(e,{minX:t.minX-50,minY:(t.minY+t.maxY)/2,maxX:t.maxX+50,maxY:t.maxY+60,parent:t.id,id:t.id+"1"+r,nth:i,quadrant:1,color:"pink"}))):(n.push(this.createHotArea(e,{minX:t.minX-50,minY:t.minY-60,maxX:(t.minX+t.maxX)/2,maxY:t.maxY+60,parent:t.id,id:t.id+"2"+r,nth:i,quadrant:2,color:"orange"})),n.push(this.createHotArea(e,{minX:(t.minX+t.maxX)/2,minY:t.minY-60,maxX:t.maxX+50,maxY:t.maxY+60,parent:t.id,id:t.id+"1"+r,nth:i,quadrant:1,color:"pink"})))}},{key:"child",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.postFix,a=e.stem,i=n.upDirection,c=Math.sign(i[0]),l=this.createHotArea(e,{parent:n.id,id:NaN+n.id+o,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push",stem:a});0===c?n.minY>r.minY?Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.maxY,maxY:n.maxY+60}):Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.minY-60,maxY:n.minY}):n.minX>r.minX?Object.assign(l,{minX:n.maxX,minY:n.minY-0,maxX:n.maxX+100,maxY:n.maxY+0}):Object.assign(l,{minX:n.minX-100,minY:n.minY-0,maxX:n.minX,maxY:n.maxY+0}),t.push(l)}},{key:"prevSibling",value:function(e){var t,n,r=e.hotAreas,o=e.child,a=e.parent,i=e.index,c=e.postFix,l=o.upDirection,u=Math.sign(l[0]),s=this.createHotArea(e,{parent:a.id,id:void 0+o.id+a.id+c,quadrant:o.layout.quadrant,color:"yellow",nth:i});if(0===u){var d=1===o.depth&&1===o.layout.quadrant,f=1===o.depth&&2===o.layout.quadrant;Object.assign(s,{minX:(n=o.minX-16,f||d?n-50:n),minY:d?o.minY-50:o.minY,maxX:(o.minX+o.maxX)/2,maxY:f?o.maxY+50:o.maxY})}else{var h=1===o.depth&&1===o.layout.quadrant,p=1===o.depth&&2===o.layout.quadrant;Object.assign(s,{minX:h?o.minX-50:o.minX,minY:(t=o.minY-16,p||h?t-50:t),maxX:p?o.maxX+50:o.maxX,maxY:(o.minY+o.maxY)/2})}r.push(s)}},{key:"nextSibling",value:function(e){var t,n,r=e.hotAreas,o=e.child,a=e.parent,i=e.index,c=e.postFix,l=o.upDirection,u=Math.sign(l[0]),s=this.createHotArea(e,{parent:a.id,id:o.id+void 0+a.id+c,color:"red",nth:i+1,addOrder:"push",quadrant:o.layout.quadrant});if(0===u){var d=1===o.depth&&1===o.layout.quadrant,f=1===o.depth&&2===o.layout.quadrant;Object.assign(s,{minX:(o.minX+o.maxX)/2,minY:d?o.minY-50:o.minY,maxX:(n=o.maxX+16,f||d?n+50:n),maxY:f?o.maxY+50:o.maxY})}else{var h=1===o.depth&&1===o.layout.quadrant,p=1===o.depth&&2===o.layout.quadrant;Object.assign(s,{minX:h?o.minX-50:o.minX,minY:(o.minY+o.maxY)/2,maxX:p?o.maxX+50:o.maxX,maxY:(t=o.maxY+16,p||h?t+50:t)})}r.push(s)}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.next,i=e.postFix,c=n.upDirection,l=Math.sign(c[0]),u=this.createHotArea(e,{parent:r.id,id:n.id+(a?a.id:void 0)+r.id+i,quadrant:n.layout.quadrant,color:"blue",nth:o+1});if(0===l){var s=1===n.depth&&1===n.layout.quadrant,d=1===n.depth&&2===n.layout.quadrant;Object.assign(u,{minX:(n.minX+n.maxX)/2,minY:2===n.layout.quadrant?Math.max(n.minY,a.minY):s?n.minY-50:n.minY,maxX:(a.minX+a.maxX)/2,maxY:1===n.layout.quadrant?Math.min(n.maxY,a.maxY):d?n.maxY+50:n.maxY})}else Object.assign(u,{minX:2===n.layout.quadrant?n.minX:1===n.depth?n.minX-50:n.minX,minY:(n.minY+n.maxY)/2,maxX:1===n.layout.quadrant?n.maxX:1===n.depth?n.maxX+50:n.maxX,maxY:(a.minY+a.maxY)/2});t.push(u)}}]),n}();var om=function(e){S()(n,nm);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"stem",value:function(e){var t=e.child,n=e.hotAreas,r=e.postFix,o=t.upDirection,a=Math.sign(o[0]),i=Math.sign(o[1]),c=this.createHotArea(e,{parent:t.id,id:t.id+"1"+r,nth:0,quadrant:1,color:"pink"});1===a&&1===i?Object.assign(c,{minX:(t.minX+t.maxX)/2,minY:(t.minY+t.maxY)/2,maxX:t.maxX+50,maxY:t.maxY+30}):-1===a&&1===i?Object.assign(c,{minX:t.minX-50,minY:(t.minY+t.maxY)/2,maxX:(t.minX+t.maxX)/2,maxY:t.maxY+30}):-1===a&&-1===i?Object.assign(c,{minX:t.minX-50,minY:t.minY-30,maxX:(t.minX+t.maxX)/2,maxY:(t.minY+t.maxY)/2}):1===a&&-1===i&&Object.assign(c,{minX:(t.minX+t.maxX)/2,minY:t.minY-30,maxX:t.maxX+50,maxY:(t.minY+t.maxY)/2}),n.push(c)}},{key:"child",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.postFix,a=this.createHotArea(e,{parent:n.id,id:NaN+n.id+o,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push"}),i=n.downDirection,c=1===Math.sign(i[1])?32:-32;n.minX>r.minX?Object.assign(a,{minX:n.maxX,minY:n.minY-0+c,maxX:n.maxX+50,maxY:n.maxY+0+c}):Object.assign(a,{minX:n.minX-50,minY:n.minY-0+c,maxX:n.minX,maxY:n.maxY+0+c}),t.push(a)}},{key:"prevSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.postFix,i=n.upDirection,c=Math.sign(i[1]),l=this.createHotArea(e,{parent:r.id,id:void 0+n.id+r.id+a,quadrant:n.layout.quadrant,color:"yellow",nth:o});1===c?Object.assign(l,{minX:n.minX,minY:n.minY-4,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}):Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+4}),t.push(l)}},{key:"nextSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.postFix;if(!(n.children.length>1)||n.collapsed){var i=n.upDirection,c=Math.sign(i[1]),l=this.createHotArea(e,{parent:r.id,id:n.id+void 0+r.id+a,color:"red",nth:o+1,addOrder:"push",quadrant:n.layout.quadrant});1===c?Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+16}):Object.assign(l,{minX:n.minX,minY:n.minY-16,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}),t.push(l)}}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.next,i=e.postFix,c=e.stem,l=this.createHotArea(e,{parent:r.id,id:n.id+(a?a.id:void 0)+r.id+i,color:"blue",nth:o+1,stem:c}),u=(n.minY+n.maxY)/2,s=(a.minY+a.maxY)/2;Object.assign(l,{minX:n.minX,minY:Math.min(u,s),maxX:n.maxX,maxY:Math.max(u,s)}),t.push(l)}}]),n}();var am=function(e){S()(n,nm);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"prevSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.postFix,i=n.upDirection,c=Math.sign(i[0]),l=this.createHotArea(e,{parent:r.id,id:void 0+n.id+r.id+a,quadrant:n.layout.quadrant,color:"yellow",nth:o});1===c?Object.assign(l,{minX:r.maxX,minY:r.minY,maxX:n.minX,maxY:r.maxY}):Object.assign(l,{minX:n.maxX,minY:r.minY,maxX:r.minX,maxY:r.maxY}),t.push(l)}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.next,i=e.postFix,c=e.stem;if(a){var l=n.upDirection,u=Math.sign(l[0]),s=this.createHotArea(e,{parent:r.id,id:n.id+(a?a.id:void 0)+r.id+i,color:"blue",nth:o+1,stem:c});1===u?Object.assign(s,{minX:n.maxX,minY:n.minY,maxX:a.minX,maxY:n.maxY}):Object.assign(s,{minX:a.maxX,minY:n.minY,maxX:n.minX,maxY:n.maxY}),t.push(s)}}},{key:"nextSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,o=e.index,a=e.postFix,i=e.root,c=n.upDirection,l=Math.sign(c[0]),u=this.createHotArea(e,{parent:r.id,id:n.id+void 0+r.id+a,color:"red",nth:o+1,addOrder:"push",quadrant:n.layout.quadrant,root:i});1===l?Object.assign(u,{minX:n.maxX,minY:n.minY,maxX:n.maxX+32,maxY:n.maxY}):Object.assign(u,{minX:n.minX-32,minY:n.minY,maxX:n.minX,maxY:n.maxY}),t.push(u)}}]),n}(),im=ho,cm={standard:new rm,indent:new om,timeline:new am},lm=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m()(this,e),c()(this,"diagram",void 0),c()(this,"drawHotArea",void 0),c()(this,"eventHelper",void 0),c()(this,"hotAreas",void 0),c()(this,"activated",void 0),c()(this,"maxWidth",void 0),c()(this,"maxHeight",void 0),this.diagram=t,this.drawHotArea=n,this.eventHelper=new fl,this.hotAreas=[],this.activated=!1,this._bindEvent()}return v()(e,[{key:"turnOn",value:function(){this.update(),this.activated=!0}},{key:"turnOff",value:function(){this.activated=!1}},{key:"_bindEvent",value:function(){var e=this,t=this.diagram,n=this.drawHotArea,r=this.eventHelper,o=this.activated;r.bind(t,"afterstemcelllayout",(function(t){var n=t.stem;o&&e.update(n)})),n&&r.bind(t,"afterviewportchange",(function(){e.draw()}))}},{key:"update",value:function(e){var t,n=this.diagram,r=this.drawHotArea;if(t=e?[e]:n.getCells().filter((function(e){return e.isStem&&e.isMindmap})),0!==t.length){var o=[],a=t.map((function(e){return u()(e.model)}));a.forEach((function(e){Wt(e,(function(e){var t=n.find(e.id);e.minX=t.x,e.minY=t.y,e.maxX=t.x+t.width,e.maxY=t.y+t.height,e.depth=t.depth,e.layout=t.computedProps.layout,e.visible=t.state.visible,e.collapsed=t.collapsed,e.isStem=t.isStem,e.stem=t.stem.model.id,e.upLayoutType=t.upLayoutType,e.downLayoutType=t.downLayoutType,e.upDirection=t.upDirection,e.downDirection=t.downDirection,e.zIndex=t.zIndex,e.children=e.children&&e.children.filter((function(e){return!e.isPlaceholder}))||[]}))})),a.forEach((function(e){Wt(e,(function(e,t,n){if(!e.isPlaceholder&&e.visible){var r=e.upLayoutType,a=e.downLayoutType,i=e.children,c=t?function(e,t,n){var r=n.children,o=e;if(!n.parent)for(;r[o]&&!ai(r[o].upDirection,t.upDirection);)o++;if(r[o]&&!r[o].abstract&&ai(r[o].upDirection,t.upDirection))return r[o]}(n+1,e,t):null,l=t?function(e,t,n){var r=n.children,o=e;if(!n.parent)for(;r[o]&&!ai(r[o].upDirection,t.upDirection);)o--;if(r[o]&&!r[o].abstract&&ai(r[o].upDirection,t.upDirection))return r[o]}(n-1,e,t):null,u=cm[a],s=cm[r],d={hotAreas:o,child:e,parent:t,next:c,prev:l,index:n,stem:e.stem,postFix:"placeholder"};e.isStem?u.stem(d):(0===i.length&&u.child(d),e.abstract||(l||s.prevSibling(d),c||s.nextSibling(d),c&&s.betweenSibling(d)))}}))})),this.hotAreas=o,this.buildQuadtree(),r&&this.draw()}}},{key:"buildQuadtree",value:function(){var e=yt(),t=this.hotAreas.map((function(e){return[e.minX,e.minY,e.maxX-e.minX,e.maxY-e.minY,e]}));e.addAll(t),this.quadtree=e,this.maxWidth=$t(t,(function(e){return e[2]})),this.maxHeight=$t(t,(function(e){return e[3]}))}},{key:"_search",value:function(e,t){var n=this.quadtree,r=this.maxWidth,o=this.maxHeight,a=[];return n.visit((function(n,i,c,l,u){var s=n.data;return s&&s[0]+s[2]>=e&&s[0]<e&&s[1]+s[3]>=t&&s[1]<t&&a.push(s[4]),i>=e||c>=t||l+r<e||u+o<t})),a.sort((function(e,t){return e.child.zIndex-t.child.zIndex})),a}},{key:"hit",value:function(e){return this._search(e[0],e[1])[0]}},{key:"draw",value:function(){var e=this.diagram.frontRootGroup;e.clear(),this.hotAreas.forEach((function(t){var n=t.minX,r=t.minY,o=t.maxX,a=t.maxY,i=t.color,c=new im({d:Jn(n,r,o-n,a-r),fill:i,opacity:.5,"pointer-events":"none"});e.add(c)}))}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.drawHotArea=void 0,this.eventHelper=void 0}}]),e}();function um(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sm(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function sm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dm=function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",i=t.children,c=void 0===i?[]:i,l=[],u=[],s=[],d=c.length-1;d>=0;d--){var f=c[d],h=f.start,p=void 0===h?0:h,m=f.end,y=void 0===m?0:m,v=f.abstract,g=f.id,x=(c[d].layout||{}).quadrant,w=void 0===x?1:x;if(!v)break;if((void 0===r||r===w)&&!o.includes(g)){var k,E=!1,O=p,C=y,A=0,P=0,S=um(n);try{for(S.s();!(k=S.n()).done;){var j=b()(k.value,2),R=j[0],_=j[1];O=O>=R&&O<R-_?R-_:O,C=C>=R&&C<R-_?R-1:C,("prev"===a?O>R:O>=R)&&(A+=_),("next"===a?C>=R-1:C>=R)&&(P+=_)}}catch(e){S.e(e)}finally{S.f()}if(C>=O){c[d].start=O+A,c[d].end=C+P;var M={start:c[d].start,end:c[d].end};u.push(g),s.push(M)}else E=!0;var L={start:p,end:y,id:g,newStart:c[d].start,newEnd:c[d].end,deleted:E,q:r,index:d};l.push(L)}}return e.update(u,s),l},fm=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=n?-1:1,a=Sl(e,t),i={},c=0,l=Object.keys(a);c<l.length;c++){var u,s=l[c],d=s.split(":"),f=b()(d,2),h=f[0],p=f[1],m=void 0===p?void 0:parseInt(p),y=a[s],v=y.indexes,g=y.abstracts,x=null===(u=e.find(h))||void 0===u?void 0:u.model;if(0!==v.length){v.sort();var w,k=[],E=void 0,O=um(v);try{for(O.s();!(w=O.n()).done;){var C=w.value;if(E){var A=E,P=b()(A,2);C===P[0]+o*P[1]?E[1]+=o:(k.push(E),E=[C,o])}else E=[C,o]}}catch(e){O.e(e)}finally{O.f()}E&&k.push(E);var S=g.map((function(e){return e.id}));i[s]=dm(e,x,k,m,S,r)}else i[s]=[]}return n&&Object.keys(i).forEach((function(n){i[n].forEach((function(n){var r=n.id;n.deleted&&-1===t.indexOf(r)&&e.find(r)&&t.push(r)}))})),i},hm=function(e,t){Object.keys(t).forEach((function(n){var r=n.split(":"),o=b()(r,2),a=o[0];o[1];var i=t[n];e.find(a),function(e,t,n){var r=[],o=[];n.forEach((function(e){var t=e.start,n=e.end,a=e.id,i={start:t,end:n};r.push(a),o.push(i)})),e.update(r,o)}(e,0,i)}))},pm=function(e,t){Object.keys(t).forEach((function(n){var r=n.split(":"),o=b()(r,2),a=o[0];o[1];var i=t[n],c=e.find(a);!function(e,t,n){var r=t.model.children,o=[],a=[];n.forEach((function(e){var t=e.newStart,n=e.newEnd,i=e.index,c=e.id,l=r[i];l.start=t,l.end=n;var u={start:t,end:n};o.push(c),a.push(u)})),e.update(o,a)}(e,c,i)}))},mm=function(e,t){var n=t.map((function(t){return e.find(t)}));if(n.some((function(e){return!e})))throw new Error("can not find the cell");return n},ym=function(e,t,n){var r=e.add(t,n),o=fm(e,t.map((function(e){return e.id})).filter((function(e){return e})));return[r,t,n,o]},vm=function(e,t,n,r,o){hm(e,o),e.remove(n.map((function(e){return e.id})))},gm=function(e,t,n,r,o){return e.add(n,r),pm(e,o),n.map((function(e){return e.id}))},bm=function(e,t){t=t.concat([]);var n=fm(e,t,!0);return[e.remove(t),n]},xm=function(e,t,n){var r=t.deletedModelsInfo,o=[],a=[];return Object.keys(r).forEach((function(e){var t=r[e];"root"!==e&&t.sort((function(e,t){return e.nth-t.nth})),t.forEach((function(t){var n=t.nth,r=t.model,i=-1===n?{}:{nth:n,parent:e};o.push(r),a.push(i)}))})),e.add(o,a),hm(e,n),o.map((function(e){return e.id}))},wm=function(e,t,n){pm(e,n),e.remove(t.eventObj.models.map((function(e){return e.id})))},km=function(e,t,n,r){for(var o=mm(e,t),a=o.map((function(e,t){var r=n[t];return Object.keys(r).reduce((function(e,n){if("children"===n)return e;var a=r[n],i=o[t].model[n];return d()(a)?e[n]=Object.keys(a).reduce((function(e,t){var n=i&&i[t];return e[t]=null==n?null:n,e}),{}):e[n]=null==i?null:i,e}),{})})),i=o.map((function(t){return e.getCellOptions(t)})),c=0;c<n.length;c++)gn(a[c],n[c]);return e.update(o,n,r),[t,n,r,a,i]},Em=function(e,t,n,r,o,a){var i=mm(e,t);return e.update(i,o,a),i},Om=function(e,t,n,r,o,a){var i=mm(e,t);return e.update(i,n,r),i};function Cm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Am(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pm=Ao,Sm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,o,a,i,c,l,s,d,f,h,p,m,y,v=new lm(e);function g(){if(e.viewport.preventDefault(!1),n&&vm.apply(void 0,[e].concat(T()(y))),n){var d=u()(r);d.forEach((function(e){Wt(e,(function(e){delete e.zIndex}))})),n.parent===n.stem&&d.forEach((function(e){var t=n.quadrant||null;e.layout?e.layout.quadrant=t:e.layout={quadrant:t}}));var f=t.map((function(e,t){return{parent:n.parent,nth:n.nth+t}})),g={parent:n.parent,nth:n.nth,quadrant:n.quadrant||1},b=e.find(n.parent);t.forEach((function(e,t){var n=d[t];1===e.depth&&b.depth>0&&n&&n.treeEdge&&n.treeEdge.stroke&&delete n.treeEdge.stroke})),b.isStem&&d.forEach((function(t,n){var r=e.query.appendChildModel(b,n);t.treeEdge?t.treeEdge.stroke||(t.treeEdge.stroke=r.treeEdge.stroke):t.treeEdge={stroke:r.treeEdge.stroke}})),e.command.execute("MindmapMoveNode",{dragCells:t,dragCellModels:r,movedCellsInfo:p,addCellModels:d,addOption:g,addOptions:f,dragCellOptions:l,movedCellsBatch:m})}else r&&xm.apply(void 0,[e].concat(T()(p)));s&&e.delegator.remove(s),s=void 0,t=void 0,r=void 0,n=void 0,o=void 0,a=void 0,l=void 0,i=void 0,c=void 0,h=void 0,e.signal.draggingMindmapCell=!1,v.turnOff()}this.mindmapHotAreaHelper=v,this.bind(e,"mousedown",(function(n){var r=n.target,i=n.clientX,c=n.clientY,l=n.button,u=e.getCell(r);!u||!u.isMindmap||u.isStem||0!==l||u.model.abstract||e.signal.contentEditing||(o=i,a=c,e.selector.selections.length>1&&e.selector.selections.includes(u)?(t=(t=e.selector.selections.concat([])).filter((function(e){return!e.isStem})),(t=e.deduplicate(t)).sort((function(e,t){return e.getNth()-t.getNth()})),h=!0):t=[u])})),this.bind(e,"mousemove",(function(g){if(t&&0!==t.length){if(!r&&Math.abs(o-g.clientX)+Math.abs(a-g.clientY)>10&&!e.signal.contentEditing){e.selector.clear(),r=t.map((function(e){return u()(e.model)})),l=t.map((function(t){return e.getCellOptions(t)}));var x=e.viewport.invertClient([g.clientX,g.clientY]);s=e.delegator.create((function(e){!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=new Pm({x:t-24.5-r,y:n-11+r,height:22,width:49,rx:4,ry:4,fill:"rgba(52, 155, 249, .2)"}),a=new Pm({x:t-24.5+r,y:n-11-r,height:22,width:49,rx:4,ry:4,fill:"rgba(52, 155, 249, .2)"});e.add(o),e.add(a)}(e,x[0],x[1],h?3:0)})),m=Ml(e,t),p=bm(e,t),e.signal.draggingMindmapCell=!0,v.turnOn(),e.viewport.preventDefault(),i=g.clientX,c=g.clientY,e.emit("mindmap:afterdragchildcellstart")}if(s){var w=e.viewport.zoom;d=(g.clientX-i)/w,f=(g.clientY-c)/w,s.translate(d,f)}if(r){var k=e.viewport.invertClient([g.clientX,g.clientY]),E=v.hit(k);n&&(E?n.id!==E.id&&vm.apply(void 0,[e].concat(T()(y))):vm.apply(void 0,[e].concat(T()(y)))),E&&(e.find(E.id)||(y=ym(e,[Am({isPlaceholder:!0,width:32,height:10,border:{shape:"rect",fill:"#C5E3FF"},treeEdge:{stroke:"#C5E3FF"},layout:{quadrant:E.quadrant}},E)],[{parent:E.parent,nth:E.nth}]),b()(y[0],1)[0].toBack())),n=E}}})),this.bind(e,"keydown",(function(e){"Escape"===e.key&&g()})),this.bind(e,"mouseup",(function(){g()})),this.bind(e,"mouseleave",(function(e){var t;null!==(t=e.relatedTarget)&&void 0!==t&&t.closest(".lake-diagram-board-contextual-toolbar-popover")||g()}))}},{key:"unbind",value:function(){this.mindmapHotAreaHelper&&(this.mindmapHotAreaHelper.destroy(),this.mindmapHotAreaHelper=void 0),N()(M()(n.prototype),"unbind",this).call(this)}}]),n}();function jm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add_button",t=new no,n=new ho({fill:"transparent"}),r=new xo({href:Br,width:18,height:18}),o=new Wo,a=new ho({fill:"url(#".concat(o.id,")")});return t.dataset({lake_prevent_click_unselect:!0,lake_mindmap_add_button:!0,testid:e}),n.css({cursor:"default"}),r.css({cursor:"pointer"}),t.add(n),t.add(r),{group:t,background:n,btn:r,tail:a,gradient:o}}function Mm(e){var t=e.x,n=e.y,r=e.width,o=e.height,a=e.collapsedButtonWidth,i=e.group,c=e.background,l=e.btn,u=e.tail,s=e.gradient,d=e.zoom,f=e.verticalAlign,h=void 0===f?"center":f,p=e.tailConfig,m=9/d,y={x:t+r/2,y:n+o/2},v=0,g=o;"bottom"===h&&(v=o/2,g+=m),c.update({d:Jn(t,n,r,g)});var b=y.x,x=y.y+v,w=[1/d,0,0,0,1/d,0,0,0,1];if(k.mat3.translate(w,w,[(b-m)*d,(x-m)*d,1]),l.update({matrix:w,href:Br}),p){var E=p.stroke,O=p.position,C=(10+a/2)/d,A="rgba(255,255,255,0)";i.add(u),"right"===O?(s.update("l(0) 0:".concat(E," 1:").concat(A)),u.update({d:Jn(b+m,x-p["stroke-width"]/2,C,p["stroke-width"])})):"left"===O?(s.update("l(0) 0:".concat(A," 1:").concat(E)),u.update({d:Jn(b-C-m,x-p["stroke-width"]/2,C,p["stroke-width"])})):"bottom"===O?(s.update("l(270) 0:".concat(A," 1:").concat(E)),u.update({d:Jn(b-p["stroke-width"]/2,x+m,p["stroke-width"],C)})):"top"===O&&(s.update("l(270) 0:".concat(E," 1:").concat(A)),u.update({d:Jn(b-p["stroke-width"]/2,x-C-m,p["stroke-width"],C)}))}else u.remove()}var Lm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this)).horizontalElements=_m(),e.verticalElements=_m(),e}return v()(n,[{key:"init",value:function(e){var t,n=this,r=e.frontRootGroup,o=e.defs,a=this.horizontalElements,i=this.verticalElements,c=function(){},l=function(){};function u(){a.group.remove(),i.group.remove(),c=function(){},l=function(){},t=void 0}function s(e){return a.group.rendererElement.contains(e)||i.group.rendererElement.contains(e)}o.add(a.gradient),o.add(i.gradient),this.horizontalElements=a,this.verticalElements=i,this.bind(a.btn,"click",(function(n){n.stopPropagation(),e.selector.select([t]),c(),u()})),this.bind(i.btn,"click",(function(n){n.stopPropagation(),e.selector.select([t]),l(),u()})),this.bind(e,"cell:dragstart",(function(){u()})),[a,i].forEach((function(r){var o=r.group,a=r.btn;n.bind(o,"mouseenter",(function(e){e.stopPropagation(),a.update({href:Ir})})),n.bind(o,"mouseleave",(function(n){n.stopPropagation(),a.update({href:Br}),t&&t.graphicGroup.rendererElement.contains(n.relatedTarget)||s(n.relatedTarget)||(e.emit("addbutton:mouseleave"),u())}))})),this.bind(e,"afterchange",De()((function(){!t||e.find(t.model.id)&&!t.collapsed||u()}),16)),this.bind(e,"mindmapcell:mouseenter",(function(n){var o=n.cell;if(!(e.signal.buttonDragCanvas||e.signal.dragging||e.signal.vertexResizing||!o.isMindmap||o.collapsed)){var u=o.downSignX,s=o.downSignY,d=0!==s,f=e.viewport.zoom,h=38/f,p=o.canCollapse()?8:0,m=o.canCollapse()?-18:2,y=(d||"line"!==o.border.shape?-1:0)/f+m-p,v={x:o.x+o.width-y,y:o.y,width:h,height:o.height,collapsedButtonWidth:p},g={x:o.x+(o.width-h)/2,y:o.y+o.height-y,width:h,height:h,collapsedButtonWidth:p};t=o,a.group.remove(),i.group.remove(),d?(-1===s&&(g.y=o.y-h+y),v.x-=y,g.tailConfig=Rm({position:1===s?"top":"bottom"},e.query.appendChildAddButtonTail(o).treeEdge),l=function(){e.command.execute("MindmapAppendChild")}):(-1===u&&(v.x=o.x-h+y),g.height-=4*y,"line"===o.border.shape&&(v.verticalAlign="bottom"),v.tailConfig=Rm({position:1===u?"left":"right"},e.query.appendChildAddButtonTail(o).treeEdge),c=function(){e.command.execute("MindmapAppendChild")}),d?(r.add(i.group),Mm(Rm(Rm({},g),{},{zoom:f},i))):(r.add(a.group),Mm(Rm(Rm({},v),{},{zoom:f},a)))}})),this.bind(e,"mindmapcell:mouseleave",(function(t){var n=t.nativeEvent;e.signal.buttonDragCanvas||e.signal.dragging||e.signal.vertexResizing||s(n.relatedTarget)||e.elementMap.fullScreenBtn.contains(n.relatedTarget)||u()})),this.bind(e.contentEditor,"beginedit",(function(){u()})),this.bind(e.contentEditor,"change",(function(){u()})),this.bind(e,"afterselect",(function(){(e.selector.selections.length>1||1===e.selector.selections.length&&e.selector.selections[0]!==t)&&u()}))}}]),n}();var Tm=ho,Dm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this)).mask=new Tm({"stroke-width":1,stroke:"#1890FF",fill:"rgba(24, 144, 255, 0.15)"}),e.mask.css({"pointer-events":"none"}),e}return v()(n,[{key:"init",value:function(e){var t=this.mask;t.dataset({lake_prevent_click_unselect:!0});var n=null,r=!0;this.bind(e,"keyup",(function(r){if(n)switch(r.key){case"Delete":case"Backspace":e.command.execute("Update",{id:n,model:{width:null,height:null,image:null}}),t.remove()}})),this.bind(e,"mousedown",(function(t){var n=t.target.closest("image"),o=n&&e.getCell(n);r=!(o&&o.isMindmap&&o.state.selected)})),this.bind(e,"click",(function(o){var a=o.target.closest("image"),i=a&&e.getCell(a);i&&!r?(o.stopPropagation(),i.endEditContent(),e.selector.select([i],!1),function(e,n){var r=["x","y","width","height"].reduce((function(e,t){return e[t]=parseFloat(n.getAttribute(t)),e}),{});t.update({d:Jn(e.x+r.x-1,e.y+r.y-1,r.width+2,r.height+2,1)})}(i,a),e.frontRootGroup.add(t),n=i.model.id,e.tryFocus(),r=!0):o.target!==t.rendererElement&&(n=null,t.remove())})),this.bind(e,"afterselectionchange",(function(){n&&(n=null,t.remove())})),this.bind(e,"mindmap:afterdragchildcellstart",(function(){n&&(n=null,t.remove())}))}}]),n}();function Nm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Im=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,o,a,i,c,l=!1;function u(){l?t&&e.remove(t):(c=Object(F.a)(),e.remove(t),e.command.execute("Add",{model:Bm({id:c,x:t.x+a,y:t.y+i},e.query.insertStemModel())})),n&&n.destroy(),t=void 0,r=void 0,o=void 0,a=void 0,i=void 0,l=!1,n=void 0,e.interaction.changeMode("edit"),c&&(e.selector.clear(),e.selector.select([c]),c=void 0)}this.bind(e,"mousemove",(function(c){if(!n){var l=e.viewport.invertClient([c.clientX,c.clientY]);t=e.add(Bm({x:l[0],y:l[1]},e.query.insertStemModel()))[0],n=e.delegator.create([t]),r=c.clientX,o=c.clientY,t.hide()}n&&(a=(c.clientX-r)/e.viewport.zoom,i=(c.clientY-o)/e.viewport.zoom,n.translate(a,i))})),this.bind(window,"mouseleave",(function(){l=!0,u()})),this.bind(window,"mouseup",(function(t){n&&(e.viewportContainer.contains(t.target)||(l=!0),u())})),this.bind(e,"keydown",(function(e){"Escape"===e.key&&(l=!0,u())}))}}]),n}();var Fm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n),e=t.call(this);var o=document.createElement("div"),a=document.createElement("span");return a.classList.add("lake-icon"),a.classList.add("lake-icon-full-screen"),a.classList.add("lake-prevent-card-activated"),o.appendChild(a),o.style["z-index"]="1033",o.style["border-radius"]="4px",o.style.position="absolute",o.style.width="".concat(20,"px"),o.style.height="".concat(20,"px"),o.style.color="#fff",o.style.cursor="pointer",o.style["box-shadow"]="0px 2px 8px 0px rgba(0, 0, 0, 0.08)",o.style["background-color"]="rgba(0, 0, 0, 0.65)",o.style["text-align"]="center",e.fullScreenBtn=o,e.imageBrowser=Object(r.getImageBrowser)(),e}return v()(n,[{key:"init",value:function(e){var t,n,r=this,o=this.fullScreenBtn,a=this.imageBrowser;e.elementMap.fullScreenBtn=o;var i=function(){o.remove(),n&&r.unbind(n),t=void 0,n=void 0};this.bind(o,"click",(function(){if(t){var e=t.image,n=t.imageElement.rendererElement;a.open([{src:n.getAttribute("data-raw_src"),msrc:n.getAttribute("href"),w:e.naturalWidth,h:e.naturalHeight}],0)}})),this.bind(o,"mouseleave",(function(e){t.imageElement.rendererElement.contains(e.relatedTarget)||i()})),this.bind(e,"mindmapcellimage:mouseenter",(function(a){var c=a.cell;if(!e.signal.cellDragStart){document.body.appendChild(o);var l=c.imageElement.getBoundingClientRect(),u=c.image;t=c,u.width>30&&u.height>30?(o.style.top="".concat(l.top+window.pageYOffset+6,"px"),o.style.left="".concat(l.right+window.pageXOffset-26,"px")):(o.style.top="".concat(l.top+window.pageYOffset-20,"px"),o.style.left="".concat(l.left+window.pageXOffset,"px")),n=r.bind(e,"afterviewportchange",(function(){i()}))}})),this.bind(e,"mindmapcellimage:mouseleave",(function(e){var t=e.nativeEvent;o.contains(t.relatedTarget)||i()})),this.bind(e,"mindmap:afterdragchildcellstart",(function(){i()})),this.bind(e,"cell:dragstart",(function(){i()}))}}]),n}();var qm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(window,"click",(function(t){t.target.closest(".lake-diagram-note")&&e.command.execute("MindmapAttachNote")}))}}]),n}();var zm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector.selections[0],r=t.key,o=["Tab","Insert"],a=["Enter"];if(n&&("timeline"===n.upLayoutType||"standard"===n.upLayoutType&&0===n.upSignX)){var i=o;o=a,a=i}o.includes(r)?(t.preventDefault(),t.altKey?e.command.execute("MindmapAppendParent"):e.command.execute("MindmapAppendChild")):a.includes(r)&&(t.preventDefault(),t.shiftKey?e.command.execute("MindmapInsertStem"):n&&n.isStem?e.command.execute("MindmapAppendChild"):t.altKey?e.command.execute("MindmapPrependSibling"):e.command.execute("MindmapAppendSibling"))}))}}]),n}();var Gm=[["Left","ArrowLeft"],["Right","ArrowRight"],["Up","ArrowUp"],["Down","ArrowDown"]],Ym=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(Gm.reduce((function(e,t){return e.push.apply(e,T()(t)),e}),[]).includes(t.key)){t.preventDefault();var n=e.selector,r=n.selections;if(1===r.length&&r[0].isMindmap){var o,a,i,c,l=(r=r.filter((function(e){return e.isMindmap})))[r.length-1],u=e.getCells().filter((function(e){return e.state.visible&&e.isMindmap})),s=(o=l.upDirection,"0,1"===(o=String(o))||"0,-1"===o),d=!l.isStem&&"timeline"!==l.upLayoutType;if(Gm[1].includes(t.key)){if(d&&l.x<l.parent.x&&!s)return void n.select([l.parent]);i="x",c=!0}else if(Gm[0].includes(t.key)){if(d&&l.x>l.parent.x&&!s)return void n.select([l.parent]);i="x",c=!1}else if(Gm[2].includes(t.key)){if(d&&l.y>l.parent.y&&s)return void n.select([l.parent]);i="y",c=!1}else if(Gm[3].includes(t.key)){if(d&&l.y<l.parent.y&&s)return void n.select([l.parent]);i="y",c=!0}var f="x"===i?"width":"height",h="x"===i?"y":"x",p="x"===i?"height":"width",m=l[h]+l[p]/2,y=l[h]+l[p];(a=(a=(a=c?u.filter((function(e){return l[i]+l[f]<e[i]})):u.filter((function(e){return e[i]+e[f]<l[i]}))).filter((function(e){var t=e[h]+e[p],n=t<l[h],r=e[h]>y,o=e[h]<=l[h]&&t>=y;return!(n||r)||o}))).sort((function(e,t){if(c){if(e[i]!==t[i])return e[i]-t[i]}else if(e[i]+e[f]!==t[i]+t[f])return t[i]+t[f]-(e[i]+e[f]);return Math.min(Math.abs(m-e[h]),Math.abs(m-(e[h]+e[p])))-Math.min(Math.abs(m-t[h]),Math.abs(m-(t[h]+t[p])))})))[0]&&n.select([a[0]])}}}))}}]),n}();var Hm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ja(t)&&["Backspace","Delete"].includes(t.key)&&e.command.execute("MindmapRemoveSingleNode")}))}}]),n}();var Vm=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"m"!==t.key||ja(t)||(t.preventDefault(),e.command.execute("MindmapBeginInsertStem"))}))}}]),n}();var Um=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections,r=t[t.length-1];r.model.collapsed&&(e.update(r,{collapsed:!1}),this.originSelectedCollapsed=!0);var o=r.model.children?r.model.children.filter((function(e){return!e.abstract})).length:0,a={model:{},cellOptions:{parent:r.model.id,nth:o}};xe()(a.model,e.query.appendChildModel(r)),a.model.id=this.id,Object.assign(this,a),this.selectedCellId=r.model.id,r.state.collapsedButtonVisible=!1,N()(M()(n.prototype),"execute",this).call(this),e.contentEditor.beginEdit()}},{key:"forward",value:function(){var e=this.selectedCellId,t=this.diagram;this.originSelectedCollapsed&&t.update(e,{collapsed:!1}),N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.selectedCellId,t=this.diagram;this.originSelectedCollapsed&&t.update(e,{collapsed:!0}),N()(M()(n.prototype),"backward",this).call(this),t.selector.select([e])}}]),n}();c()(Um,"className","MindmapAppendChild"),c()(Um,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap}))}));var Wm=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.diagram,r=this.addType,o=t.selector.selections,a=o[o.length-1],i=a.parent,c={model:{html:"".concat(jr(""))},cellOptions:{parent:i.model.id,nth:r&&"prepend"===r?a.getNth():a.getNth()+e}};i.isStem&&(c.model.layout={quadrant:a.computedProps.layout.quadrant}),xe()(c.model,t.query.appendChildModel(i)),c.model.id=this.id,Object.assign(this,c),this.selectedCellId=a.model.id,N()(M()(n.prototype),"execute",this).call(this),t.contentEditor.beginEdit()}},{key:"backward",value:function(){var e=this.selectedCellId,t=this.diagram;N()(M()(n.prototype),"backward",this).call(this),t.selector.select([e])}}]),n}();c()(Wm,"className","MindmapAddSibling"),c()(Wm,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return!e.isStem&&e.isMindmap&&!e.isAbstract}))}));var Xm=function(e){S()(n,Wm);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}();c()(Xm,"className","MindmapAppendSibling");var Km=function(e){S()(n,Wm);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){N()(M()(n.prototype),"execute",this).call(this,0)}}]),n}();c()(Km,"className","MindmapPrependSibling");var Zm=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"addMovedModelsInfo",void 0),c()(A()(e),"addInfo",void 0),c()(A()(e),"pinLine",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.addOption,t=e.parent,n=e.quadrant,r=e.nth,o=this.diagram,a=this.movedCellsBatch,i=o.find(t),c=i&&i.isStem&&i.isTwoQuadrantLayout?i.getNewQuadIndexByNewRealIndex(r,n):r,l=Ll(a[1],i,n,c),u=b()(l,3),s=u[0],d=u[1],f=u[2];this.pinLine=new kh(o),this.pinLine.cache(f),this.pinLine.pin(),this.addInfo=ym(o,s,d),this.select(this.addInfo[0])}},{key:"forward",value:function(){var e=this.diagram,t=this.movedCellsInfo;wm.apply(void 0,[e].concat(T()(t))),this.pinLine.pin();var n=gm.apply(void 0,[e].concat(T()(this.addInfo)));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.movedCellsInfo;vm.apply(void 0,[e].concat(T()(this.addInfo))),this.pinLine.reset();var n=xm.apply(void 0,[e].concat(T()(t)));this.select(n)}}]),n}();c()(Zm,"className","MindmapMoveNode");var Qm=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.image,r=e.selector.selections,o=r[r.length-1],a=o.model;this.id=a.id,this.model={image:cs(t),width:null,height:null},e.signal.preventUpdateCellContent=!0,o.textareaElement.htmlContainer===e.contentEditor.dom&&(e.contentEditor.execCommand("justifyCenter"),e.contentEditor.updateStartContent(),this.model.html=e.contentEditor.dom.innerHTML),e.signal.preventUpdateCellContent=!1,N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Qm,"className","MindmapAttachImage"),c()(Qm,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t[0].isMindmap}));var $m=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;e.selector.clear(),e.interaction.changeMode("beginAddMindmapStem")}}]),n}();function Jm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()($m,"className","MindmapBeginInsertStem");var ey=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.x,r=this.y;if(this.model=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.query.insertStemModel()),null!=t&&null!=r)Object.assign(this.model,{x:t,y:r});else{var o=e.getCells().filter((function(e){return e.isStem})),a=o[o.length-1];Object.assign(this.model,{x:a.x+20,y:a.y+a.height+20})}N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(ey,"className","MindmapInsertStem");var ty=function(e){S()(n,Fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}();c()(ty,"className","MindmapCreateLink");var ny=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this,t=this.diagram,r=this.image;this.model={type:"mindmap",image:cs(r),html:""};var o=t.viewport.getCenter();this.model.x=o[0]-this.model.image.width/2,this.model.y=o[1]-this.model.image.height/2,N()(M()(n.prototype),"execute",this).call(this),De()((function(){var n=t.selector.selections;1===n.length&&n[0].model.id===e.id&&t.contentEditor.execCommand("justifyCenter")}),16)()}}]),n}();function ry(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(ny,"className","MindmapInsertImage"),c()(ny,"enable",(function(e){return 0===e.selector.selections.length}));var oy=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"info1",void 0),c()(A()(e),"info2",void 0),c()(A()(e),"info3",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.deduplicate(e.selector.selections).sort((function(e,t){return e.getNth()-t.getNth()})),n=t[0],r=Ml(e,t),o=b()(r,2);o[0];var a=o[1],i=t[0].mindmapParent,l=t[0].parent,u=i?n.quadrantNth:void 0,s=n.realQuadrant,d=Object(F.a)(),f={id:d,html:"",children:[]};i?Object.assign(f,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ry(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ry(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.query.appendChildModel(i))):Object.assign(f,{type:"mindmap",x:n.x,y:n.y,layout:n.layout}),this.info1=bm(e,t.map((function(e){return e.model.id})));var h=Ll([f],l,s,u),p=b()(h,2),m=p[0],y=p[1];this.info2=ym(e,m,y);var v=e.find(d),g=Ll(a,v,1),x=b()(g,2),w=x[0],k=x[1];this.info3=ym(e,w,k),e.selector.select(d)}},{key:"forward",value:function(){var e=this.diagram;wm.apply(void 0,[e].concat(T()(this.info1)));var t=gm.apply(void 0,[e].concat(T()(this.info2)));gm.apply(void 0,[e].concat(T()(this.info3))),e.selector.select(t)}},{key:"backward",value:function(){var e=this.diagram;vm.apply(void 0,[e].concat(T()(this.info3))),vm.apply(void 0,[e].concat(T()(this.info2)));var t=xm.apply(void 0,[e].concat(T()(this.info1)));e.selector.select(t)}}]),n}();c()(oy,"className","MindmapAppendParent"),c()(oy,"enable",(function(e){var t=function(e,t){return e=e.filter((function(e){return e.isMindmap})),t.deduplicate(e)}(e.selector.selections,e);return t.length>0&&t.every((function(e){return e.isMindmap&&e.parent===t[0].parent&&!e.isAbstract}))}));var ay=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"info1",void 0),c()(A()(r),"info2",void 0),c()(A()(r),"transBatch",void 0),r.pinLine=new kh(e.diagram),r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.pinLine,n=e.selector.selections[0];this.selfId=n.model.id;var r=n.getChildren(),o=n.parent,a=n.realQuadrant,i=o&&o.isMindmap?n.getNth():void 0,c=(null!=o?o:{}).quadrantTreeLists,l=c?c[a-1].indexOf(i):i,u=Ml(e,r)[1];t.cache([n]),this.info1=bm(e,[this.selfId]),t.pin();var s=Ll(u,o,a,l),d=b()(s,2),f=d[0],h=d[1];this.info2=ym(e,f,h),this.select(this.info2[0])}},{key:"forward",value:function(){var e=this.diagram,t=this.pinLine;wm.apply(void 0,[e].concat(T()(this.info1))),t.pin();var n=gm.apply(void 0,[e].concat(T()(this.info2)));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.selfId,n=this.pinLine;vm.apply(void 0,[e].concat(T()(this.info2))),xm.apply(void 0,[e].concat(T()(this.info1))),n.reset(),this.select(t)}}]),n}();c()(ay,"className","MindmapRemoveSingleNode"),c()(ay,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap&&!e.isAbstract}))}));var iy=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.emit("opennote",{cell:t})}}]),n}();function cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ly(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(iy,"className","MindmapAttachNote"),c()(iy,"isModelChange",!1),c()(iy,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap}))}));var sy=function(e){if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]){var t=e.some((function(e){if(e.isMindmap&&e.mindmapParent&&!e.isAbstract){var t=e.realQuadrant,n=e.mindmapParent,r=n.getChildren(),o=n.quadrantTreeLists,a=r.indexOf(e),i=0===o.length?a:o[t-1].indexOf(a);return r.filter((function(e){return e.model.abstract})).some((function(e){var n=e.model,r=n.start,o=n.end,a=e.realQuadrant;return t===a&&i>=r&&i<=o}))}return!1}));if(t)return!1}return e.every((function(e){return e.isMindmap&&e.mindmapParent&&!e.isAbstract}))},dy=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"originSelectionsCollapsed",{}),c()(A()(e),"selections",void 0),c()(A()(e),"fatherGroup",{}),c()(A()(e),"updateInfo",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this,t=this.diagram,r=t.deduplicate(t.selector.selections),o={model:[],cellOptions:[]},i=[],c=[],l=[];this.selections=r.map((function(e){return e.model.id})),r.forEach((function(t){if(t.mindmapParent){var n=t.mindmapParent,r=n.model,o=r.id,a=r.children.indexOf(t.model),i=a;if(n.layoutQuadrantConstraint&&n.layoutQuadrantConstraint.length>1){var c,l,u=null!==(c=null===(l=t.model.layout)||void 0===l?void 0:l.quadrant)&&void 0!==c?c:1;o+=":"+u,i=n.quadrantTreeLists[u-1].indexOf(a)}var s=e.fatherGroup[o]||{},d=s.start,f=s.end;if(-1===i)throw new Error("水金");e.fatherGroup[o]=void 0===d?{start:i,end:i}:{start:Math.min(i,d),end:Math.max(i,f)}}}));var u,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return uy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uy(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(Object.keys(this.fatherGroup).sort());try{var d=function(){var n=u.value,r=n.split(":"),a=b()(r,2),s=a[0],d=a[1],f=void 0===d?void 0:parseInt(d);if("number"==typeof f&&isNaN(f))throw new Error("new abstract quadrant === nan");var h=e.fatherGroup[n],p=h.start,m=h.end,y=t.find(s);if(y){var v=!0,g=y.model.children.filter((function(e){return!e.abstract})),x=g.length;-1===x&&(x=y.model.children.length);var w=x,k=void 0===f?w:y.quadrantTreeLists[f-1].length;if(p>=k||m>=k||p>m||p<0)return{v:void 0};for(var E=null!=f?f:1;w<y.model.children.length;w++){var O=y.model.children[w],C=O.start,A=O.end,P=O.layout,S=(void 0===P?{}:P).quadrant;if(E===(void 0===f?1:S)){if(p<C)break;if(A>p){v=!1;break}}else if(E<S)break}for(var j=w;j<y.model.children.length;j++){var R=y.model.children[j],_=R.start,M=R.layout.quadrant;if((void 0===f||void 0===M?1:M)===E&&m>=_){v=!1;break}}v&&(y.quadrantTreeLists[E-1].forEach((function(e,t){if(t>=p&&t<=m){var n=g[e];if(!n)return;var r=n.layout,o=(void 0===r?{}:r).quadrant,a=void 0===o?1:o,u=n.id;a!==E&&(i.push(u),c.push({layout:ly(ly({},n.layout),{},{quadrant:E})}),l.push({}))}})),o.model.push({start:p,end:m,abstract:!0,layout:{quadrant:E},border:{shape:"rect",stroke:"#BFBFBF",fill:"transparent","stroke-width":2},treeEdge:{stroke:"#BFBFBF","stroke-width":2},html:jr("概要")}),2===f&&e.fatherGroup[s+":1"]&&w++,o.cellOptions.push({parent:y.model.id,nth:w}))}};for(s.s();!(u=s.n()).done;){var f=d();if("object"===a()(f))return f.v}}catch(e){s.e(e)}finally{s.f()}this.updateInfo=km(t,i,c,l),o.model.forEach((function(e){t.hooks.decorateAddMindmapAbstract.call(e)})),Object.assign(this,o),N()(M()(n.prototype),"execute",this).call(this),t.contentEditor.beginEdit()}},{key:"forward",value:function(){var e=this.diagram,t=this.updateInfo;N()(M()(n.prototype),"forward",this).call(this),Om.apply(void 0,[e].concat(T()(t)))}},{key:"backward",value:function(){var e=this.diagram,t=this.updateInfo;Em.apply(void 0,[e].concat(T()(t))),N()(M()(n.prototype),"backward",this).call(this)}}]),n}();function fy(e,t){return e&&t&&ue()(e).toHex()===ue()(t).toHex()}function hy(e,t){return e.reduce((function(e,t){return"object"===a()(e)?e[t]:e}),t)}function py(e,t,n){var r=e.length;n=u()(n),e.reduce((function(e,t,o){if(o===r-1)return e[t]=n,n;if("object"===a()(e[t]))return e[t];if(void 0===e[t]){var i={};return e[t]=i,i}return{}}),t)}function my(e,t){var n=cl(t.find(e.id).textareaElement.htmlContainer);return e.children&&(n.children=e.children.map((function(e){return my(e,t)}))),n}function yy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=n.children,a=t.split("."),i=hy(a,n),c="none";if(o&&o.length>1)for(var l=0;l<o.length;l++){var u=hy(a,o[l]);if("none"!==c){if(!Fe()(u,c)){c="none";break}}else c=u}return"none"!==c?py(a,e,c):i&&!r&&py(a,e,i),e}c()(dy,"className","MindmapAppendAbstract"),c()(dy,"enable",(function(e){var t=e.deduplicate(e.selector.selections);return sy(t,!0)}));var vy=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),this.diagram=t}return v()(e,[{key:"_getRainBowColors",value:function(){var e,t=this.diagram,n=null==t||null===(e=t.theme)||void 0===e?void 0:e.values.mindmapRainbowTreeEdgeColors,r=Rr;return n&&(r=n),r}},{key:"appendChildAddButtonTail",value:function(e){var t=this._getRainBowColors(),n=e.stem.rainbow;return e.isStem?{treeEdge:{stroke:n?t[e.model.children.length%t.length]:"#959EA6","stroke-width":e.getDefaultStrokeWidth(e.depth+1)}}:{treeEdge:{stroke:e.computedProps.treeEdge.stroke,"stroke-width":e.getDefaultStrokeWidth(e.depth+1)}}}},{key:"appendChildTransitiveCommon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];yy(e,"border.shape",t.model,n),yy(e,"border.stroke",t.model,n),yy(e,"border.fill",t.model,n),yy(e,"border.stroke-width",t.model,n),yy(e,"layout",t.model,!0),yy(e,"treeEdge.stroke-width",t.model,n)}},{key:"appendChildTransitiveTextFormat",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=my(t.model,this.diagram),o={},a=[];yy(o,"fontSize",r,n),yy(o,"color",r,n),o.fontSize&&14!==o.fontSize&&a.push("font-size: ".concat(o.fontSize,"px")),o.color&&!fy(o.color,"rgb(38, 38, 38)")&&a.push("color: ".concat(o.color)),a.length>0&&(e.html='<span style="'.concat(a.join(";"),'">').concat("&#8203;","</span>"))}},{key:"appendChildTreeEdge",value:function(e,t){var n,r,o,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=null!==(n=t.model.children)&&void 0!==n?n:[],l=null===(r=c[0])||void 0===r||null===(o=r.treeEdge)||void 0===o?void 0:o.stroke;if(l&&c.length>1&&c.every((function(e){var t;return fy(null==e||null===(t=e.treeEdge)||void 0===t?void 0:t.stroke,l)})))a=l;else if(t.isStem){var u=t.model.children,s=t.rainbow,d=this._getRainBowColors();a=s?d[(u.length+i)%d.length]:"#959EA6"}a&&py(["treeEdge","stroke"],e,a)}},{key:"appendChildModel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.diagram,r={};return e&&e.isMindmap&&(this.appendChildTransitiveCommon(r,e,e.isStem),this.appendChildTransitiveTextFormat(r,e,e.isStem),this.appendChildTreeEdge(r,e,t)),n.hooks.decorateAddMindmapCellModel.call(r),r}},{key:"insertStemModel",value:function(){var e=this.diagram,t=Object.assign({},_r);return e.hooks.decorateAddMindmapStemModel.call(t),t}},{key:"destroy",value:function(){this.diagram=void 0}}]),e}();c()(vy,"className","Query");var gy=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"aftercommandexecute",(function(n){var r=n.command;if(r instanceof fc){var o=r.changeArguments?r.changeArguments[0]:[],a=fm(t,o.map((function(e){return e.id})).filter((function(e){return e})),!1,r instanceof Xm?"next":r instanceof Km?"prev":"");e.weakMap.set(r,a)}})),this.bind(t,"beforecommandbackward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof fc&&hm(t,o)})),this.bind(t,"aftercommandforward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof fc&&pm(t,o)}))}}]),n}();var by=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof Ch){var o=r.cells||t.selector.selections.concat([]),a=fm(e.diagram,o,!0);r.cells=o,e.weakMap.set(r,a)}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof Ch&&hm(t,o)})),this.bind(t,"beforecommandforward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof Ch&&pm(t,o)}))}}]),n}();var xy=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"beforepaste:lake",(function(t){var n,r=t.body,o=t.options,a=t.extraInfomations,i=t.offset,c=function(e){return"mindmap"===a[e.id].rootType},l=e.selector.selections,s=l[0];1===l.length&&s.isMindmap?(s.collapsed&&e.update(s,{collapsed:null}),n=s):r.forEach((function(e){if(c(e)){var t=a[e.id];delete e.collapsed,Object.keys(_r).forEach((function(t){null==e[t]&&(e[t]=u()(_r[t]))})),e.x="number"==typeof e.x?e.x:t.x,e.y="number"==typeof e.y?e.y:t.y,e.x+=i[0],e.y+=i[1],e.children&&e.children.forEach((function(e){var t=a[e.id];t.treeEdge&&t.treeEdge.stroke&&(e.treeEdge?e.treeEdge.stroke||(e.treeEdge.stroke=t.treeEdge.stroke):e.treeEdge={stroke:t.treeEdge.stroke})}))}}));var d=Ll(r,n,void 0,void 0,c),f=b()(d,2),h=f[0],p=f[1];t.body=h,t.options=o.map((function(e,t){return Object.assign(e,p[t])}))}))}}]),n}();function wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ky(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ey(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cy=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof hc){var o=r.id,a=r.model,i=ar(o instanceof Array?o:[o],a),c=b()(i,2),l=c[0],u=c[1],s=l.map((function(e){return t.find(e)})),d=[[],[],[]];if(l.forEach((function(e,n){var r=t.find(e);if(r&&r.isMindmap&&r.isStem){var o=u[n],a=s[n];if(void 0!==a&&o.layout){var i=o.layout.quadrantConstraint,c=a.layout,l=(void 0===c?{}:c).quadrantConstraint;if(r.isTwoQuadrantLayout&&i&&1===i.length){var f,h,p,m=function(e){var t=[],n=[],r=[],o=-1,a=0;return e.forEach((function(e,i){var c=e.abstract,l=e.layout,u=(void 0===l?{}:l).quadrant,s=void 0===u?1:u,d=e.id,f=e.start,h=void 0===f?0:f,p=e.end,m=void 0===p?0:p;c?2===s&&(t.push(d),n.push({layout:ky(ky({},e.layout),{},{quadrant:1}),start:h+a,end:m+a}),r.push({})):2===s?(-1===o&&(o=i),t.push(d),n.push({layout:ky(ky({},e.layout),{},{quadrant:1})}),r.push({})):(a++,o>=0&&(t.push(d),n.push({layout:ky(ky({},e.layout),{},{quadrant:1})}),r.push({nth:o}),o++))})),[t,n,r]}(r.model.children),y=b()(m,3),v=y[0],g=y[1],x=y[2];(f=d[0]).push.apply(f,T()(v)),(h=d[1]).push.apply(h,T()(g)),(p=d[2]).push.apply(p,T()(x))}else if(l&&1===l.length&&(i&&2===i.length||null===i)){var w,k,E,O=r.model.children.filter((function(e){return!e.abstract})).length,C=Math.ceil(O/2),A=[],P=[],S=[];r.model.children.forEach((function(e,t){var n=e.abstract,r=e.id,o=e.start,a=void 0===o?0:o,i=e.end,c=void 0===i?0:i;if(n){var l=a<C?1:2,u=a<C?a:a-C,s=1===l?c<C?c:C-1:c-C;A.push(r),P.push({layout:Oy(Oy({},e.layout),{},{quadrant:l}),start:u,end:s}),S.push({})}else{var d=t<C?1:2;A.push(r),P.push({layout:Oy(Oy({},e.layout),{},{quadrant:d})}),S.push({})}})),(w=d[0]).push.apply(w,A),(k=d[1]).push.apply(k,P),(E=d[2]).push.apply(E,S)}}}})),d[0].length>0){var f=km.apply(void 0,[t].concat(d));e.weakMap.set(r,f)}}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof hc&&Em.apply(void 0,[t].concat(T()(o)))})),this.bind(t,"beforecommandforward",(function(n){var r=n.command,o=e.weakMap.get(r);o&&r instanceof hc&&Om.apply(void 0,[t].concat(T()(o)))}))}}]),n}(),Ay=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=e.x,o=e.y,a=e.width,i=e.height,c=b()(t,2),l=c[0],u=c[1],s=b()(n,2);return[r+l*a+s[0],o+u*i+s[1]]},Py=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return"x"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x")?[e,t]:[t,e]},Sy=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new no),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new no).css({"pointer-events":"none"})}return v()(e,[{key:"setDragInfo",value:function(e,t,n){this.diagram.contentEditor.unbind();var r=t.cell,o=r.breadthPositive,a=r.abstractCoveredCells,i=r.ad,c=this.diagram.viewport.invertClient([e.clientX,e.clientY]),l=function(e,t){if(e.isAbstract){var n=e.realQuadrant,r=e.parent,o=r.getChildren(),a=r.quadrantTreeLists,i=o.filter((function(e){return e.isAbstract})),c=i.indexOf(e);if(t>0){var l=i[c+1];if(l){var u=l.realQuadrant,s=l.model.start,d=void 0===s?0:s;if(n===u)return o[a[n-1][d-1]]}var f=a[n-1];return o[f[f.length-1]]}if(c>0){var h=i[c-1],p=h.realQuadrant,m=h.model.end,y=void 0===m?0:m;if(n===p)return o[a[n-1][y+1]]}return o[a[n-1][0]]}return e}(r,n),u=-1===n?a[a.length-1]:a[0],s=Ay(u,Py(i,(o*n+1)/2)),d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=e.minX,o=e.minY,a=e.maxX,i=e.maxY;return Ay({x:r,y:o,width:a-r,height:i-o},t,n)}(Ar(l.getAllChildren().concat([l]),(function(e){return e.getKeyShapeBox()})),Py(i,(o*n+1)/2)),f="x"===i?s[0]:s[1],h="x"===i?d[0]:d[1];return{renderInfo:t,boundaryCoord:f>h?[h,f]:[f,h],dragNodeOrder:n,dragCoord:c,dragFromNode:u,dragToNode:l}}},{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t,n,r,o=this,a=this.diagram,i=this.group,c=this.eventHelper;e=e.filter((function(e){return e.isCell&&e.state.visible&&e.isAbstract})),this.clear(),a.frontRootGroup.add(i),this.bind(),this.arr=e.map((function(e,t){var n={fill:"none",stroke:"#3384F5","fill-rule":"nonzero"},r={fill:"none",stroke:"rgba(255,255,255,0)"},o={fill:"none","stroke-linecap":"round"},a=e.abstractCoveredCells,c=e.abstractCoveredCellsWithAllChildren,l=e.ad,u={cell:e,coveredCells:a,coveredCellsWithAllChildren:c,rectStyle:n,handleStyle:r,rectElement:new ho(n),centerBarElements:[new ho(o),new ho(o)],handleElements:[new ho(r),new ho(r)]},s=u.rectElement,d=b()(u.centerBarElements,2),f=d[0],h=d[1],p=b()(u.handleElements,2),m=p[0],y=p[1];return[s,f,h].forEach((function(e){i.add(e)})),[m,y].forEach((function(e,n){i.add(e),e.dataset({lake_prevent_click_unselect:"true",abst_adjust_controller:"".concat(t,"-").concat(n,"-")+l})})),u})),this.draw(),this.arr.forEach((function(e){var n=b()(e.handleElements,2),r=n[0],a=n[1],i=e.cell.breadthPositive;c.bind(r.rendererElement,"mousedown",(function(n){t=o.setDragInfo(n,e,-i)})),c.bind(a.rendererElement,"mousedown",(function(n){t=o.setDragInfo(n,e,i)}))})),c.bind(a,"mousemove",(function(e){if(t)Le()((function(){a.emit("abstadjuststart");var n=a.viewport.invertClient([e.clientX,e.clientY]);t&&(t.dragCoord=n,o.updateShape(t.renderInfo,t))}))();else{var i=e.target.dataset.abst_adjust_controller;if(i){var c=i.split("-"),l=b()(c,3),u=l[0],s=l[1],d=l[2],f=o.arr[u],h=parseInt(s),p=f.centerBarElements[h];p.update({stroke:"rgba(95,159,246)","stroke-width":4}),r&&r!==p&&r.update({stroke:"rgba(129,179,248,0.6)","stroke-width":3}),r=p;var m="x"===d?"ew-resize":"ns-resize";n!==m&&(a.setCursor(m),n=m)}else n?(a.resetCursor(),n=void 0):r&&(r.update({stroke:"rgba(129,179,248,0.6)","stroke-width":3}),r=void 0)}})),c.bind(a,"mouseup",(function(e){if(t){n=void 0,a.resetCursor();var r=a.viewport.invertClient([e.clientX,e.clientY]);t.dragCoord=r;for(var i,c=t,l=c.dragFromNode,u=c.dragToNode,s=c.renderInfo,d=c.dragNodeOrder,f=c.dragCoord,h=b()(c.boundaryCoord,2),p=h[0],m=h[1],y=s.cell,v=y.realQuadrant,g=y.ad,x=y.breadthPositive,w=y.parent,k=w.quadrantTreeLists[v-1],E=l.getNth(),O=u.getNth(),C=k.findIndex((function(e){return e===E})),A=k.findIndex((function(e){return e===O})),P="x"===g?f[0]:f[1],S=Math.max(p,Math.min(P,m)),j=x*d,R=A;(R-C)*d>=0;R-=d){var _=w.getChildren()[k[R]],M=Ay(_);if((S-("x"===g?M[0]:M[1]))*j>0){i=R;break}}t=void 0;var L=y.model,T=L.start,D=L.end;if(void 0!==i&&(1===d&&D!==i||-1===d&&T!==i)){var N=1===d?{end:i}:{start:i};a.command.execute("Update",{id:y.model.id,model:N})}else o.updateShape(s)}}))}},{key:"updateShape",value:function(e,t){var n=e.coveredCellsWithAllChildren,r=e.rectElement,o=e.handleElements,a=e.cell,i=e.centerBarElements,c=a.ad,l=a.breadthPositive,u=c,s="x"===u?"y":"x",d=t?e.coordCache:Ar(n,(function(e){return e.getKeyShapeBox()})),f=d.minX,h=d.minY,p=d.maxX,m=d.maxY,y=!1;if(t){var v=t.dragNodeOrder,g=t.dragCoord,x=b()(t.boundaryCoord,2),w=x[0],k=x[1],E="x"===u?g[0]:g[1];E=Math.max(w,Math.min(E,k));var O=v*l==1;O?"x"===u?p=E:m=E:"x"===u?f=E:h=E,y=O?"max":"min"}else e.coordCache={minX:f,minY:h,maxX:p,maxY:m},y=!1;f-=2,p+=2,h-=2,m+=2;var C="x"===u?[p,h]:[f,m],A="x"===s?[p,h]:[f,m],P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"x",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=n/2,l=r/2,u=c<o?c:o,s=l<o?l:o,d="x"===a?Math.min(n-2*u,i):Math.min(r-2*s,i);return[["M",+e+ +u,t]].concat("x"===a?[["l",n/2-u-d/2,0],["m",d,0],["l",n/2-u-d/2,0]]:[["l",n-2*u,0]],[["a",u,s,0,0,1,u,s]],"y"===a?[["l",0,r/2-s-d/2],["m",0,d],["l",0,r/2-s-d/2]]:[["l",0,r-2*s]],[["a",u,s,0,0,1,-u,s]],"x"===a?[["l",-(n/2-u-d/2),0],["m",-d,0],["l",-(n/2-u-d/2),0]]:[["l",-(n-2*u),0]],[["a",u,s,0,0,1,-u,-s]],"y"===a?[["l",0,-(r/2-s-d/2)],["m",0,-d],["l",0,-(r/2-s-d/2)]]:[["l",0,-(r-2*s)]],[["a",u,s,0,0,1,u,-s]])}(f,h,p-f,m-h,4,s,22);r.update({d:P,"stroke-width":1});var S="x"===u?(h+m)/2-9:(f+p)/2-9,j="min"===y?4:3;i[0].update({d:"x"===u?"M".concat(f,",").concat(S+j/2," L").concat(f,",").concat(S+18-j/2):"M".concat(S+j/2,",").concat(h," L").concat(S+18-j/2,",").concat(h),"stroke-width":j,stroke:"min"===y?"rgba(95,159,246)":"rgba(129,179,248,0.6)"});var R="max"===y?4:3;i[1].update({d:"x"===u?"M".concat(p,",").concat(S+R/2," L").concat(p,",").concat(S+18-R/2):"M".concat(S+R/2,",").concat(m," L").concat(S+18-R/2,",").concat(m),"stroke-width":R,stroke:"max"===y?"rgba(95,159,246)":"rgba(129,179,248,0.6)"}),o[0].update({d:"M".concat(f,",").concat(h," L").concat(A.join(",")),"stroke-width":8}),o[1].update({d:"M".concat(C.join(",")," L").concat(p,",").concat(m),"stroke-width":8})}},{key:"draw",value:function(){var e=this;this.arr.forEach((function(t){e.updateShape(t)}))}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),e}();c()(Sy,"className","AbstractView");var jy=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(t){var n=t.selections;e.abstractView.select(n)}))}}]),n}();var Ry={Cells:[zp,Xp],Extends:[vy,Sy],defaultCursors:{},modes:[{mode:"edit",Behaviours:[Zp,Qp,$p,Sm,Lm,Dm,Fm,qm,em,function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(window,"click",(function(t){var n=t.target;if(null!=n&&n.closest(".lake-diagram-mindmap-icon")){var r=n.getAttribute("lake-mindmap-icon-key"),o=e.getCell(n);o&&r&&(n.dataset.lakeMindmapIconSelected="true",e.emit("changemindmapicon",{key:r,cell:o,nativeEvent:t}),e.selector.selections.length>1&&e.selector.select([o]))}}))}}]),n}(),zm,Ym,Hm,Vm,gy,by,jy,xy,Cy]},{mode:"read",Behaviours:[Zp,$p,Ym,Jp,Fm,qm,em]},{mode:"beginAddMindmapStem",Behaviours:[Zp,Im]}],Commands:[Um,Xm,Zm,Qm,$m,ty,Km,ey,ny,oy,ay,iy,dy]};function _y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var My=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"parent",void 0),c()(A()(r),"offsetY",void 0),r}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.textarea=new es(this),this.render(),this.updateModel(this.model),this.parent.children.push(this)}},{key:"getBBox",value:function(){var e=this.offsetY,t=this.height,n=this.parent.getBBox();return n.y+=e,n.height=t,n.minY=n.y,n.maxY=n.minY+n.height,n}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){return{x:Math.max((this.width-e.width)/2,4),y:(this.height-e.height)/2+(this.offsetY||0)}}},{key:"render",value:function(){var e=ms({name:"rect",x:0,y:0,width:1,height:1});e.update({fill:"transparent"}),this.shapeElement=e,this.graphicGroup.add(e),this.textarea.render(),"edit"===this.diagram.interaction.currentMode&&this.capture(!1,!0)}},{key:"updateModel",value:function(e){var t;N()(M()(n.prototype),"updateModel",this).call(this,e),this.width=(null===(t=this.parent)||void 0===t?void 0:t.width)||0,this.textarea.update()}},{key:"draw",value:function(){this.drawPosition(),this.updateCache()}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.graphicGroup.attr({opacity:e})}},{key:"drawTextRegion",value:function(){var e=this.offsetY,t=this.width,n=this.height,r={width:t,height:n,d:Jn(0,e,t,n)};this.shapeElement.update(r)}},{key:"drawPosition",value:function(){this.drawMatrix(),this.isCacheStale("width","height","offsetY")&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"getOuterWidth",value:function(){return this.width}},{key:"capture",value:function(e,t){t&&N()(M()(n.prototype),"capture",this).call(this,e)}},{key:"updateCache",value:function(){var e=this,t=this.cache;["width","offsetY","height","rotate"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_y(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"destroy",value:function(){N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"16px","min-width":"24px","line-height":"1.45","word-break":"break-word"}}],defaultFontFamily:'SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace',multiSelectHighlight:!1,isStackCell:!0,penetratedKeys:["x","y","width","height","rotate","html","shape","offsetY","id","nth"]})}}]),n}();function Ly(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ty(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ly(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ly(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(My,"className","StackCell");var Dy=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",new no),c()(A()(e),"elements",void 0),e}return v()(n,[{key:"render",value:function(){this.elements=[],sr(this.cell)&&this.cell.clipGroup.add(this.group)}},{key:"renderElements",value:function(){var e=this,t=this.group,n=this.cell,r=n.stencil,o=n.getRoughGraphicOptions();r.scene.forEach((function(n){var r=ms(n,o);n.attr&&r.update(n.attr),t.add(r),e.elements.push(r)}))}},{key:"update",value:function(){var e=this.cell,t=this.elements;e.isCacheStale("shape")&&(t&&t.forEach((function(e){return e.remove()})),this.renderElements())}},{key:"draw",value:function(){var e,t,n=this.cell,r=this.elements,o=n.stroke,a=n.heights,i=Ty({},n.convertStrokeStyle());n.isCacheStale("stroke")&&(i.stroke=o.color,i["stroke-width"]=o.width);for(var c=[a[0]],l=1;l<a.length;l++){var u=a[l];c[l]=c[l-1]+u}r.forEach((function(r,o){if(n.isCacheStale("width","height")){var a=n.stencil,l=n.width;e=l/a.width,t=c[o]/a.scene[o].height}e&&t?r.update(Ty(Ty({},i),{},{d:r.getPath(e,t)})):r.update(i),e=t=void 0}))}}]),n}();function Ny(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var By=function(e){S()(n,ks);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var o=uc[uc.findIndex((function(t){return t.name===e.model.shape}))],a={row:o.row,heights:o.heights};return r=t.call(this,h()(e,a)),c()(A()(r),"children",void 0),r}return v()(n,[{key:"canRough",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"getChildren",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.getRoughGraphicOptions();return ms(this.stencil.outline,e)}}},{key:"updateStencil",value:function(){var e=this,t=this.shape,n=this.stencils,r=t||"process";if(!this.stencil||this.stencil.name!==r){var o=n.find((function(e){return e.name===r}));if(!o)throw new Error("unknown shape ".concat(r));this.stencil=o,this.updateAnchors(),["width","height"].forEach((function(t){null==e[t]&&(e[t]=o[t])})),this.cache={}}}},{key:"updateAnchors",value:function(){for(var e=this.anchors,t=this.stencil,n=function(){var n=e[r],o=t.anchors.find((function(e){return e.name===n.name}));o&&(e[r]=o)},r=0;r<e.length;r++)n()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),N()(M()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"getOutlinePath",value:function(e){var t,n=this.width,r=this.heights,o=this.stencil,a=r.reduce((function(e,t){return e+t}),0);if(o.outline.path)t=o.outline.path(n,a);else{var i=n/o.width,c=a/o.height;t=e.getPath(i,c)}return t}},{key:"render",value:function(){N()(M()(n.prototype),"render",this).call(this);var e=this.model;e.width||(e.width=this.width),e.height||(e.height=this.height)}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0,!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1,!0)}))}},{key:"_drawInner",value:function(){this.isCacheStale("height","width","heights","roughFillStyle")&&(this.subcells.forEach((function(e){return e.draw()})),this.updateCache())}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","height","heights","rotate","fill","stroke","opacity","shape","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ny(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ny(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"executeLayout",value:function(){var e=this,t=this.diagram,n=this.getZIndex(),r=[0],o=T()(this.children),a=t.contentEditor,i=t.rootGroup;o.forEach((function(t,o){t.width=e.width,t.textarea.update();var a=t.textarea.getBBox();e.heights[o]=Math.max(a.height+12,30),t.matrix=e.matrix,t.height=e.heights[o],t.offsetY=r[o],t.opacity=e.opacity,r[o+1]=r[o]+e.heights[o],t.model.zIndex=n+o+1,t.textarea.draw()})),this.height=this.heights.reduce((function(e,t){return e+t}),0),o.sort((function(e,t){return t.model.zIndex-e.model.zIndex})),o.forEach((function(t){a.isBegin||i.insertBefore(e.graphicGroup,t.graphicGroup)})),this._drawInner()}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"draw",value:function(){this.subcells.forEach((function(e){return e.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stencils:uc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},children:[],isStack:!0,resizeRotatePoints:["lc","rc","rotate"],penetratedKeys:["x","y","width","height","rotate","heights","shape"],Subcells:[Dy]})}}]),n}();c()(By,"className","StackStem");var Iy=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.diagram;e.children=[];for(var o=0;o<e.row;o++)e.children.push({html:t[o],id:Object(F.a)(),nth:o});r.hooks.decorateAddStackModel.call(e),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Iy,"className","AddStack");var Fy=function(e){S()(n,Ph);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.diagram;e.children=[];for(var o=0;o<e.row;o++)e.children.push({html:t[o],id:Object(F.a)(),nth:o});r.hooks.decorateAddStackModel.call(e),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Fy,"className","AddStackVertex");var qy={Cells:[My,By],Extends:[],defaultCursors:{},modes:[{mode:"edit",Behaviours:[function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"stack",void 0),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),o=t.getCell(n.target);if(o&&br(o)){var a,i=o;e.stack=i,i.getChildren().forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(a=e)})),i.enter(),a&&(t.selector.select(a),t.contentEditor.beginEdit())}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.stack&&n.findIndex((function(t){var n;return t.model.id===e.stack.model.id||(null===(n=t.parent)||void 0===n?void 0:n.model.id)===e.stack.model.id}))<0&&e.stack.exit()}))}}]),n}()]},{mode:"read",Behaviours:[]}],Commands:[Iy,Fy]};function zy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}rp.registerClipboardProcessor("swimlane",{lake:function(e){var t=e.model,n=e.offset;t.x=(t.x||0)+n[0],t.y=(t.y||0)+n[1],t.contain=[]}});var Yy=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"elements",[]),c()(A()(e),"bc",void 0),c()(A()(e),"lc",void 0),c()(A()(e),"rc",void 0),c()(A()(e),"tc",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new no;for(var t=0;t<4;t++){var n=ms({stroke:"none","stroke-width":1});this.group.add(n),this.elements.push(n)}e.clipGroup.prepend(this.group),this.tc=this.elements[0],this.rc=this.elements[1],this.bc=this.elements[2],this.lc=this.elements[3]}},{key:"update",value:function(){}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("width","height","stroke")){var t=e.width,n=e.height,r=e.convertStrokeStyle();r.stroke="#fff",r["stroke-width"]=2*e.stroke.width,this.tc.update(Gy(Gy({},r),{},{d:Wn(0,0,t,0)})),this.rc.update(Gy(Gy({},r),{},{d:Wn(t,0,t,n)})),this.bc.update(Gy(Gy({},r),{},{d:Wn(t,n,0,n)})),this.lc.update(Gy(Gy({},r),{},{d:Wn(0,n,0,0)}))}}}]),n}();function Hy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Uy=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"horizentalElements",void 0),c()(A()(e),"verticalElements",void 0),c()(A()(e),"length",0),c()(A()(e),"numberWidth",0),c()(A()(e),"numberHeight",0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new no,e.group.add(this.group)}},{key:"init",value:function(){var e=this,t=this.cell,n=t.getRoughGraphicOptions();this.group.clear(),this.horizentalElements=[],this.verticalElements=[],t.widths.forEach((function(){var t=ms({},n);t.dataset({test_tag:"verticalSwimlaneLine"}),e.group.add(t),e.verticalElements.push(t)})),t.heights.forEach((function(){var t=ms({},n);t.dataset({test_tag:"horizentalSwimlaneLine"}),e.group.add(t),e.horizentalElements.push(t)}))}},{key:"update",value:function(){var e,t,n,r,o,a,i,c;this.numberWidth===(null===(e=this.cell.model)||void 0===e||null===(t=e.widths)||void 0===t?void 0:t.length)&&this.numberHeight===(null===(n=this.cell.model)||void 0===n||null===(r=n.heights)||void 0===r?void 0:r.length)||(this.numberWidth=null===(o=this.cell.model)||void 0===o||null===(a=o.widths)||void 0===a?void 0:a.length,this.numberHeight=null===(i=this.cell.model)||void 0===i||null===(c=i.heights)||void 0===c?void 0:c.length)}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("stroke","width","height","widths","heights","roughFillStyle")){this.init();var t=Vy(Vy({},e.convertStrokeStyle()),{},{stroke:e.stroke.color,"stroke-width":e.stroke.width,d:""});this.horizentalElements.forEach((function(n,r){var o=e.heights[r]*e.height;t.d="M0,".concat(o," L").concat(e.width,",").concat(o),n.update(t)})),this.verticalElements.forEach((function(n,r){var o=e.widths[r]*e.width;t.d="M".concat(o,",0 L").concat(o,",").concat(e.height),n.update(t)}))}}}]),n}();var Wy=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"element",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new no,this.element=ms({stroke:"none",fill:"transparent"}),this.group.add(this.element),e.graphicGroup.prepend(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("width","height","widths","heights")){var t={d:""};t.d=e.isVertical?Jn(0,0,e.width,e.height*e.heights[0]):Jn(0,0,e.width*e.widths[0],e.height),this.element.update(t)}}}]),n}();function Xy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ky(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zy=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"clipGroup",new no),c()(A()(r),"clipPathID",Object(F.a)()),c()(A()(r),"group",new no),c()(A()(r),"isSwimlane",!0),c()(A()(r),"stencils",void 0),c()(A()(r),"stencil",void 0),c()(A()(r),"widths",void 0),c()(A()(r),"heights",void 0),c()(A()(r),"children",void 0),c()(A()(r),"contain",void 0),c()(A()(r),"shape",void 0),r}return v()(n,[{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.clipGroup.add(this.group),this.group.capture(!1),this.graphicGroup.prepend(this.clipGroup),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.forEach((function(e){return e.render()})),this.model.contain=this.model.contain||[],this.updateModel(this.model),this.eventDelegation()}},{key:"updateDefaultSize",value:function(){var e=this,t=this.stencil;t&&["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"isVertical",get:function(){return"swimlane-vertical"===this.model.shape}},{key:"getTextBox",value:function(){var e=this.x,t=this.y,n=this.heights,r=this.width,o=this.height;if(this.isVertical){var a={x:e,y:t,width:r,height:n[0]*o};return Ky(Ky({},a),Or(a))}return this.getBBox()}},{key:"containerBBox",get:function(){if(this.isVertical){var e=this.y+this.heights[0]*this.height,t=(1-this.heights[0])*this.height;return{x:this.x,y:e,width:this.width,height:t}}var n=this.x+this.widths[0]*this.width,r=(1-this.widths[0])*this.width;return{x:n,y:this.y,width:r,height:this.height}}},{key:"containerBBoxs",get:function(){var e=this;if(this.isVertical){var t=this.height*this.heights[0];return this.children.map((function(n){return{x:e.x+n.offsetX,y:e.y+t,width:n.width,height:e.height-t}}))}var n=this.width*this.widths[0];return this.children.map((function(t){return{x:e.x+n,y:e.y+t.offsetY,width:e.width-n,height:t.height}}))}},{key:"canUpdateText",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"canRough",value:function(){return!0}},{key:"getOutlinePath",value:function(e){var t=this.width,n=this.height,r=this.stencil;if(this.isCacheStale("width","height","roughFillStyle")){var o;if(r.outline.path)o=r.outline.path(t,n);else{var a=t/r.width,i=n/r.height;o=e.getPath(a,i)}return o}}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1)}))}},{key:"getChildren",value:function(){return this.children}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return ms(e.outline,t)}}},{key:"updateModel",value:function(e){N()(M()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateDefaultSize(),this._updateStencil(),this.updateMatrix(),this.subcells.forEach((function(e){e.update()})),this.getRoughGraphicOptions()?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}},{key:"_updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"swimlane-vertical";if(!this.stencil||this.stencil.name!==n){var r=t.find((function(e){return e.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this.updateDefaultSize(),this.cache={}}}},{key:"_layoutZIndex",value:function(){var e=this,t=this.diagram,n=t.rootGroup;t.contentEditor.isBegin||this.children.forEach((function(t){n.insertBefore(t.graphicGroup,e.graphicGroup)}))}},{key:"executeLayout",value:function(){var e=this;this._layoutZIndex();var t;t="swimlane-vertical"===this.shape?[0].concat(T()(this.widths),[1]):[0].concat(T()(this.heights),[1]),this.children.forEach((function(n,r){n.matrix=e.matrix,"swimlane-vertical"===e.shape?(n.offsetX=t[r]*e.width,n.offsetY=0,n.width=(t[r+1]-t[r])*e.width,n.height=e.height,n.textHeight=e.height*e.heights[0],n.textWidth=n.width):(n.offsetX=0,n.offsetY=t[r]*e.height,n.width=e.width,n.height=(t[r+1]-t[r])*e.height,n.textHeight=n.height,n.textWidth=e.width*e.widths[0]),n.x=e.x+n.offsetX,n.y=e.y+n.offsetY,n.textarea.update(),n.opacity=e.opacity,n.matrix=$a(n.x,n.y,n.width,n.height,0)}))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","widths","height","heights","rotate","shape","stroke","controlPoints","round","opacity","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?Ky({},r):r}))}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(e){e.draw()})),this.subcells.forEach((function(e){return e.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stencils:uc,stroke:{color:"#595959",width:2},rotate:0,children:[],penetratedKeys:["x","y","width","height","widths","heights","shape","htmls","stroke","contain","opacity"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[Uy,xs,Yu,Yy,Wy]})}}]),n}();function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Zy,"className","SwimlaneStem");var Jy=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"textVerticalAlign",void 0),c()(A()(r),"offsetX",0),c()(A()(r),"offsetY",0),c()(A()(r),"textWidth",0),c()(A()(r),"textHeight",0),c()(A()(r),"textRegion",void 0),c()(A()(r),"textarea",void 0),c()(A()(r),"parent",void 0),r}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.textarea=new es(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var e=this.x,t=this.y,n=this.width,r=this.height;return{minX:e,minY:t,maxX:e+n,maxY:t+r,x:e,y:t,width:n,height:r}}},{key:"canRotate",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var e=this.parent,t=ms({name:"rect",x:0,y:0,width:1,height:1,stroke:"none"},null==e?void 0:e.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=t,this.graphicGroup.prepend(t)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(e){N()(M()(n.prototype),"updateModel",this).call(this,e),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.textVerticalAlign,n={x:Math.max((this.textWidth-e.width)/2,4),y:0};return n.y="top"===t?4:"bottom"===t?this.textHeight-e.height:(this.textHeight-e.height)/2,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.textWidth}},{key:"getTextBox",value:function(){var e={x:this.x,y:this.y,width:this.textWidth,height:this.textHeight};return $y($y({},e),Or(e))}},{key:"drawTextRegion",value:function(){var e=this.width,t=this.textHeight,n={width:e,textHeight:t,d:Jn(0,0,this.textWidth,t)};this.textRegion.update(n)}},{key:"updateCache",value:function(e){var t=this,n=this.cache;(e=e||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(e){var r=t[e];n[e]=d()(r)?$y({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.isCacheStale("opacity")&&(e=e||this.opacity,this.graphicGroup.attr({opacity:e}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){un(this.parent.children,this),N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],multiSelectHighlight:!1,isSwimlaneCell:!0,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(Jy,"className","SwimlaneCell");var ev=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.number,o=this.diagram;e.children=[],e.id=e.id||Object(F.a)();for(var a=0;a<r;a++){var i=Object(F.a)();e.children.push({html:t[a],id:i,nth:a})}o.hooks.decorateAddSwimlaneModel.call(e),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(ev,"className","AddSwimlane");var tv=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"set",void 0),c()(A()(e),"swimlaneID",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this,t=this.id,r=this.diagram,o="string"==typeof t?r.find(t):t;this.swimlaneID=o.model.id,this.set=new Set,o.contain.forEach((function(t){var n=r.find(t);if(n){var a=va(n);e.set.has(a.model.id)||r.swimlane.isCellsInSwimlane([a],o)||(e.set.add(a.model.id),r.swimlane.unbind(a,o))}})),N()(M()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e=this;this.set.forEach((function(t){e.diagram.swimlane.unbind(t,e.swimlaneID)})),N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this;this.set.forEach((function(t){e.diagram.swimlane.bind(t,e.swimlaneID)})),N()(M()(n.prototype),"backward",this).call(this)}}]),n}();function nv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return rv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function rv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(tv,"className","UpdateSwimlane"),c()(tv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return vr(e)}))}));var ov=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"originMap",new Map),c()(A()(e),"newMap",new Map),c()(A()(e),"ids",void 0),c()(A()(e),"parentID",void 0),e}return v()(n,[{key:"execute",value:function(){var e,t=this,r=this.id,o=this.parent,a=this.diagram;this.parentID=null==o||null===(e=o.model)||void 0===e?void 0:e.id;var i=r.map((function(e){return"string"==typeof e?t.diagram.find(e):e}));this.ids=r.map((function(e){return e.model.id})),i.forEach((function(e){var n=va(e),r=n.model.id;t.originMap.has(r)||(t.originMap.set(r,n.swimlane),t.newMap.set(r,t.parentID),a.swimlane.unbind(r,n.swimlane),a.swimlane.bind(r,t.parentID))})),N()(M()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e,t=nv(this.originMap);try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),o=r[0],a=r[1],i=this.newMap.get(o);this.diagram.swimlane.unbind(o,a),this.diagram.swimlane.bind(o,i)}}catch(e){t.e(e)}finally{t.f()}N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e,t=nv(this.originMap);try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),o=r[0],a=r[1],i=this.newMap.get(o);this.diagram.swimlane.unbind(o,i),this.diagram.swimlane.bind(o,a)}}catch(e){t.e(e)}finally{t.f()}N()(M()(n.prototype),"backward",this).call(this)}}]),n}();c()(ov,"className","InteractSwimlane");var av=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"swimlaneID",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram.selector.selections[0];this.swimlaneID=e.model.id,this._execute()}},{key:"forward",value:function(){this._execute()}},{key:"backward",value:function(){this._execute()}},{key:"_execute",value:function(){var e=this.diagram.find(this.swimlaneID);if(e&&vr(e)){var t=this.switch(e),n=t.ids,r=t.nmodels;n.unshift(e.model.id);var o={width:e.height,height:e.width,widths:e.heights,heights:e.widths,shape:""};e.isVertical?o.shape="swimlane-horizontal":o.shape="swimlane-vertical",r.unshift(o),this.diagram.update(n,r)}}},{key:"getSwimlaneContainModels",value:function(e){var t=this.diagram,n=[];return Xt(e.model,(function(e){return"group"===e.type||!e.type||(n.push(e),!0)}),(function(e){return"swimlane"===e.type?e.contain.map((function(e){var n;return null===(n=t.find(e))||void 0===n?void 0:n.model})):e.children})),n}},{key:"switch",value:function(e){var t=this.getSwimlaneContainModels(e),n=e.isVertical?-90:90,r=e.center,o=[],a=t.map((function(t){o.push(t.id);var a={};e.isVertical?(a.x=r.x-t.x+r.x,a.y=t.y):(a.x=t.x,a.y=r.y-t.y+r.y);var i=ji(r,n,[{x:a.x,y:a.y,w:0,h:0,r:0}]),c=b()(i,1)[0];a.x=c.x,a.y=c.y;var l=Math.abs(e.width-e.height)/2;return e.width>e.height?(a.x-=l,a.y+=l):(a.x+=l,a.y-=l),a}));return{ids:o,nmodels:a}}}],[{key:"enable",value:function(e){return 1===e.selector.selections.length&&vr(e.selector.selections[0])}}]),n}();c()(av,"className","SwitchSwimlane");var iv=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"swimlaneID",void 0),c()(A()(r),"removeLaneModel",void 0),c()(A()(r),"addLaneModel",void 0),c()(A()(r),"field",void 0),c()(A()(r),"number",void 0),c()(A()(r),"startNumber",void 0),c()(A()(r),"ids",[]),c()(A()(r),"removedChildIDSet",new Set),r.number=e.number,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.number;if(!(t<1||50<t)){var n=e.selector.selections[0];if(gr(n)&&(n=n.parent),n&&vr(n)){this.swimlaneID=n.model.id,this.field="height",n.isVertical&&(this.field="width");var r=n.children.length;if(this.startNumber=r,this.options={model:[],cellOptions:[]},this.processModel(n),t>this.startNumber){for(var o=r;o<t;o++){var a=Object(F.a)();this.ids.push(a),this.options.model.push({html:'<div style="text-align:center;"><span style="font-weight:bold;">Lane '.concat(o+1,"</span></div>"),fill:n.children[r-1].model.fill,id:a,nth:o}),this.options.cellOptions.push({parent:n.model.id,nth:o})}this.addLane(n)}else if(t<r){for(var i=t;i<r;i++){var c=n.children[i],l=c.model,u=l.nth,s=l.id,d=l.html,f=l.fill;this.ids.push(c.model.id),this.options.model.push({html:d,id:s,nth:u,fill:f}),this.options.cellOptions.push({parent:n.model.id,nth:u})}this.removeLane(n),this.unbind(n)}}}}},{key:"forward",value:function(){var e=this,t=this.diagram.find(this.swimlaneID);t&&(this.number>this.startNumber?this.addLane(t):(this.removeLane(t),this.removedChildIDSet.forEach((function(n){e.diagram.swimlane.unbind(n,t)}))))}},{key:"backward",value:function(){var e=this,t=this.diagram.find(this.swimlaneID);t&&(this.number>this.startNumber?this.removeLane(t):(this.addLane(t),this.removedChildIDSet.forEach((function(n){e.diagram.swimlane.bind(n,t)}))))}},{key:"unbind",value:function(e){var t=this;this.diagram.swimlane.updateContain(e).forEach((function(e){t.removedChildIDSet.add(e)}))}},{key:"processModel",value:function(e){var t=this,n=this.field,r=e.children.length;if(this.number>r){var o,a;this.removeLaneModel=(c()(o={},"".concat(n,"s"),e["".concat(n,"s")]),c()(o,n,e[n]),o);var i=[0].concat(T()(e["".concat(n,"s")]),[1]),l=e[n],u=e[n]+150*(this.number-r),s=[];i.forEach((function(e,t){t!==i.length-1&&s.push(l*(i[t+1]-i[t]))}));for(var d=r;d<this.number;d++)s.push(150);var f=[];s.reduce((function(e,t,n){return n>=s.length-1?0:(f.push((e+t)/u),e+t)}),0),this.addLaneModel=(c()(a={},"".concat(n,"s"),f),c()(a,n,u),a)}else if(this.number<r){var h,p;this.addLaneModel=(c()(h={},"".concat(n,"s"),e["".concat(n,"s")]),c()(h,n,e[n]),h);var m=[0].concat(T()(e["".concat(n,"s")]),[1]),y=e[n],v=[];m.forEach((function(e,n){n>=t.number||v.push(y*(m[n+1]-m[n]))}));var g=v.reduce((function(e,n,r){return r>=t.number?e:e+n}),0),b=[];v.reduce((function(e,t,n){return n===v.length-1?0:(b.push((e+t)/g),e+t)}),0),this.removeLaneModel=(c()(p={},"".concat(n,"s"),b),c()(p,n,g),p)}}},{key:"addLane",value:function(e){var t=this.diagram,n=this.field;e["".concat(n,"s")]=this.addLaneModel["".concat(n,"s")],e[n]=this.addLaneModel[n],t.hooks.decorateAddSwimlaneChildModel.call(this.options.model[0]),t.add(this.options.model,this.options.cellOptions),t.update(e,this.addLaneModel)}},{key:"removeLane",value:function(e){var t=this.diagram,n=this.field;this.isRemovedInSelections()&&t.selector.select([]),t.remove(this.ids),e["".concat(n,"s")]=this.removeLaneModel["".concat(n,"s")],e[n]=this.removeLaneModel[n],t.update(e,this.removeLaneModel)}},{key:"isRemovedInSelections",value:function(){var e=this;return this.ids.some((function(t){return e.diagram.selector.selections.find((function(e){return e.model.id===t}))}))}}]),n}();c()(iv,"className","ChangeLaneNumber"),c()(iv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&vr(t[0])||t.every((function(e){return e.swimlane===t[0].swimlane}))}));var cv=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"swimlanes",void 0),c()(this,"group",new no),this.swimlanes=[],t.frontRootGroup.add(this.group)}return v()(e,[{key:"findSwimlane",value:function(e){if(0!==e.length&&!e.some((function(e){return vr(e)}))){for(var t,n=this.getSwimlanes(),r=this.computeRegion(e),o=0;o<n.length;o++){var a=n[o];if(ii(Or(a.containerBBox),r)){t=a;break}}return this.swimlanes=[],t}}},{key:"highlight",value:function(e){var t=this.diagram.connect.getCellConnectStateElement(e);this.group.clear(),this.group.add(t)}},{key:"unhighlight",value:function(){this.group.clear()}},{key:"updateContain",value:function(e){var t=this,n=[],r=this.diagram;return e.model.contain.forEach((function(o){var a=r.find(o);a&&(t.isCellsInSwimlane([a],e)||(r.swimlane.unbind(a,e),n.push(a.model.id)))})),n}},{key:"resetNth",value:function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var n=t.diagram.find(e);n&&n.children.forEach((function(e,t){e.nth=t,e.model.nth=t}))}))}},{key:"isCellsInSwimlane",value:function(e,t){var n=this.diagram,r=e.map((function(e){return n.find(e)})).filter((function(e){return e})),o=this.computeRegion(r),a=n.find(t);return!!a&&ii(Or(a.containerBBox),o)}},{key:"bind",value:function(e,t){var n=this.diagram,r=n.find(e),o=n.find(t);r&&(o&&vr(o)?(r.swimlane=o.model.id,dn(o.model.contain,r.model.id)):r.swimlane=void 0)}},{key:"unbind",value:function(e,t){var n=this.diagram,r=n.find(e),o=t?n.find(t):n.find(null==r?void 0:r.swimlane);o&&vr(o)&&(r?(r.swimlane=void 0,un(o.model.contain,r.model.id)):"string"==typeof e&&un(o.model.contain,e))}},{key:"getSwimlanes",value:function(){return this.swimlanes.length>0?this.swimlanes:this.swimlanes=this.diagram.getCells().filter((function(e){return vr(e)})).sort((function(e,t){return t.getZIndex()-e.getZIndex()}))}},{key:"getCellofSwimlane",value:function(e,t){for(var n=t.containerBBoxs,r=0,o=-1,a=0;a<n.length;a++){var i=n[a],c=Si(i,e);c>r&&(r=c,o=a)}return t.children[o]}},{key:"computeRegion",value:function(e){return Ar(e,(function(e){return ur(e)?e.getPointBox():e.getBBox()}))}},{key:"destroy",value:function(){this.group.remove()}}]),e}();c()(cv,"className","Swimlane");var lv={lake_prevent_click_unselect:"true",swimlane_resize_controller:"true"},uv=function(e){S()(n,rf);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"cell",void 0),c()(A()(r),"horizontals",[]),c()(A()(r),"verticals",[]),c()(A()(r),"swimlaneGroup",new no),c()(A()(r),"swimlane",void 0),r}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.swimlane=vr(e)?e:e.parent,this._init()}},{key:"_init",value:function(){this.swimlane.widths.length===this.verticals.length&&this.swimlane.heights.length===this.horizontals.length||(this.prepareResizeLines(),this.bindEvent())}},{key:"prepareResizeLines",value:function(){var e=this;this.swimlaneGroup.clear(),this.verticals=[],this.horizontals=[],this.swimlane.widths.forEach((function(){var t=ma("vertical",lv);t.visShape.update({stroke:"rgba(255,255,255,0)"}),e.swimlaneGroup.add(t.group),e.verticals.push(t)})),this.swimlane.heights.forEach((function(){var t=ma("horizontal",lv);t.visShape.update({stroke:"rgba(255,255,255,0)"}),e.swimlaneGroup.add(t.group),e.horizontals.push(t)}))}},{key:"update",value:function(){var e=this.swimlane,t=this.diagram;if(e){this._init();var r=1/t.viewport.zoom,o=r,a=8*r;N()(M()(n.prototype),"update",this).call(this),this.verticals.forEach((function(t,n){var r=e.percentage2Canvas([e.widths[n],0]),i=e.percentage2Canvas([e.widths[n],1]);t.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(i.x,",").concat(i.y),"stroke-width":a}),t.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(i.x,",").concat(i.y),"stroke-width":o})})),this.horizontals.forEach((function(t,n){var r=e.percentage2Canvas([0,e.heights[n]]),i=e.percentage2Canvas([1,e.heights[n]]);t.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(i.x,",").concat(i.y),"stroke-width":a}),t.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(i.x,",").concat(i.y),"stroke-width":o})}))}}},{key:"bindEvent",value:function(){var e,t,r,o,a=this,i=this.eventHelper,c=this.diagram,l=this.swimlane;this.eventHelper.unbind();var s={},d={},f=!1;[].concat(T()(this.verticals),T()(this.horizontals)).forEach((function(n,u){i.bind(n.shape,"mouseenter",(function(){n.visShape.update({stroke:"#3384F5"})})),i.bind(n.shape,"mouseleave",(function(){n.visShape.update({stroke:"rgba(255,255,255,0)"})})),i.bind(n.shape,"mousedown",(function(i){c.contentEditor.unbind(),r=n.name,e=l.widths,t=l.heights,o="horizontal"===n.name?u-a.verticals.length:u,s={widths:e,heights:t}}))})),i.bind(c,"mousemove",(function(n){if(r&&e&&t&&void 0!==o){var i,l,s=c.viewport.invertClient([n.clientX,n.clientY]),h=a.swimlane.canvas2percentage(s),p=[0].concat(T()(e),[1]),m=[0].concat(T()(t),[1]);"vertical"===r?(i=p[o],l=p[o+2],d.widths=u()(e),d.widths[o]=Jt(h[0],i,l)):(i=m[o],l=m[o+2],d.heights=u()(t),d.heights[o]=Jt(h[1],i,l)),c.update(a.swimlane,d)}else if(n.target.dataset.swimlane_resize_controller){var y;if("line"===n.target.dataset.type){var v=Qn(n.target.getAttribute("d"));y=xa([v[1][1]-v[0][1],v[1][2]-v[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}f||(f=!0),y&&c.setCursor(y)}else f&&(c.resetCursor(),f=!1)})),i.bind(c,"mouseup",(function(){Object.keys(d).length>0&&(Fe()(d.widths,e)&&Fe()(d.heights,t)||c.command.execute("Update",{id:l,model:d,originModels:[s],select:function(){}})),t=void 0,t=void 0,r=void 0,o=void 0,f=!1,s={},d={}})),N()(M()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.group.add(this.swimlaneGroup),N()(M()(n.prototype),"begin",this).call(this)}}]),n}();c()(uv,"className","SwimlaneResize");var sv=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"swimlane",void 0),c()(A()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),o=t.getCell(n.target);if(o&&vr(o)){var a,i=o;e.swimlane=i,i.children.forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(a=e)})),i.enter(),a&&(t.selector.select(a),t.contentEditor.beginEdit())}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.swimlane&&n.findIndex((function(t){return t===e.swimlane||t.parent===e.swimlane}))<0&&e.swimlane.exit()}))}}]),n}();var dv=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"group",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new no,e.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=[];this.bind(t,"afterselectionchange",(function(t){var r=t.selections.filter((function(e){return vr(e)}));e.group.clear(),n=[],r.forEach((function(t){var r=ms({stroke:"none",fill:"transparent",d:Jn(t.x,t.y,t.width,t.height)});r.css({cursor:"move"}),r.dataset({cellid:t.model.id}),n.push(r),e.group.add(r)}))}));var r=function(){n.forEach((function(e){var n=t.find(e.rendererElement.dataset.cellid);if(n){var r=n.containerBBox,o=r.x,a=r.y,i=r.width,c=r.height;e.update({d:Jn(o,a,i,c)})}}))};this.bind(t,"cell:dragend",(function(){r()})),this.bind(t,"aftervertexresize",(function(){r()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var fv=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"group",void 0),c()(A()(e),"swimlane",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new no,e.backRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"afterselectionchange",(function(t){var n,r,o=t.selections,a=o[0];a&&(vr(a)?r=a:gr(a)&&(r=a.parent),r&&(e.swimlane=r,o.every((function(e){return vr(e)?r===e:!!gr(e)&&r===e.parent}))))?r.swimlaneExtension.show():null===(n=e.swimlane)||void 0===n||n.swimlaneExtension.hide()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var hv=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"group",void 0),c()(A()(e),"swimlane",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new no,e.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"afterimport",(function(){e.getCells().forEach((function(t){if(vr(t)){var n,r=[];null===(n=t.model.contain)||void 0===n||n.forEach((function(n){var o=e.find(n);o?o.swimlane=t.model.id:r.push(n)})),un.apply(void 0,[t.model.contain].concat(r))}}))}))}}]),n}();function pv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return mv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function mv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yv=function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=["Add","AddVertex","AddStack","AddStackVertex"],n=this.diagram;this.bind(n,"aftercommandexecute",(function(r){var o=r.commandName,a=r.command;if(t.includes(o)){var i=new Map,c=Array.isArray(a.model)?a.model:[a.model],l=!1;c.forEach((function(e){var t=n.find(e.id);if(t){var r=va(t);if(!i.has(r.model.id)){var o,a=null===(o=n.swimlane)||void 0===o?void 0:o.findSwimlane([r]);a&&(l=!0,n.swimlane.bind(r,a),i.set(r.model.id,a.model.id))}}})),l&&e.weakMap.set(a,i)}})),this.bind(n,"beforecommandbackward",(function(n){var r=n.command,o=e.weakMap.get(r);if(o&&t.includes(r.commandName)){var a,i=pv(o);try{for(i.s();!(a=i.n()).done;){var c=b()(a.value,2),l=c[0],u=c[1];e.diagram.swimlane.unbind(l,u)}}catch(e){i.e(e)}finally{i.f()}}})),this.bind(n,"aftercommandforward",(function(n){var r=n.command,o=e.weakMap.get(r);if(o&&t.includes(r.commandName)){var a,i=pv(o);try{for(i.s();!(a=i.n()).done;){var c=b()(a.value,2),l=c[0],u=c[1];e.diagram.swimlane.bind(l,u)}}catch(e){i.e(e)}finally{i.f()}}}))}}]),n}();function vv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function gv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bv=v()((function e(){m()(this,e),c()(this,"map",new Map),c()(this,"groupID",void 0),c()(this,"swimlaneID",void 0)}));function xv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return wv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function wv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kv={Cells:[Zy,Jy],Extends:[cv,uv],defaultCursors:{},modes:[{mode:"edit",Behaviours:[fv,sv,dv,hv,yv,function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e,t=this,n=this.diagram;this.bind(n,"beforecommandexecute",(function(r){var o=r.commandName;if("MakeGroup"===o)e=T()(n.selector.selections);else if("Ungroup"===o){var a=new bv,i=!1;n.selector.selections.forEach((function(e){e.swimlane&&(a.map.set(e.model.id,e.swimlane),i=!0)})),i&&(t.weakMap.set(r.command,a),t.unGroupForward(a))}})),this.bind(n,"aftercommandexecute",(function(r){if(e&&"MakeGroup"===r.commandName){var o=new bv,a=o.map,i=!1,c=!1;if(e.some((function(e){return e.swimlane}))&&(i=!0),e.forEach((function(e){vr(e)&&(c=!0),a.set(e.model.id,e.swimlane)})),i&&!c){e.forEach((function(e){n.swimlane.unbind(e,e.swimlane)}));var l=e[0].parent;if(l){o.groupID=l.model.id;var u=n.swimlane.findSwimlane([l]);u&&(n.swimlane.bind(l,u),o.swimlaneID=u.model.id)}e=void 0,t.weakMap.set(r.command,o)}}})),this.bind(n,"aftercommandbackward",(function(e){var r=e.command,o=t.weakMap.get(r);if(o)if("MakeGroup"===r.commandName){n.swimlane.unbind(o.groupID,o.swimlaneID);var a,i=vv(o.map.entries());try{for(i.s();!(a=i.n()).done;){var c=b()(a.value,2),l=c[0],u=c[1];n.swimlane.bind(l,u)}}catch(e){i.e(e)}finally{i.f()}}else if("Ungroup"===r.commandName){var s,d=vv(o.map);try{var f=function(){var e=b()(s.value,2),t=e[0],r=e[1],o=n.find(t),a=n.find(r);o&&a&&(n.swimlane.bind(o,a),o.children.forEach((function(e){n.swimlane.unbind(e,a)})))};for(d.s();!(s=d.n()).done;)f()}catch(e){d.e(e)}finally{d.f()}}})),this.bind(n,"aftercommandforward",(function(e){var r=e.command;if("MakeGroup"===r.commandName){var o=t.weakMap.get(r);if(o){var a=n.find(o.groupID);if(a){var i,c=vv(o.map);try{for(c.s();!(i=c.n()).done;){var l=b()(i.value,1)[0];n.swimlane.unbind(l)}}catch(e){c.e(e)}finally{c.f()}var u=n.swimlane.findSwimlane([a]);u&&n.swimlane.bind(a,u)}}}})),this.bind(n,"beforecommandforward",(function(e){var n=e.command,r=t.weakMap.get(n);r&&"Ungroup"===n.commandName&&t.unGroupForward(r)}))}},{key:"unGroupForward",value:function(e){var t,n=this.diagram,r=vv(e.map);try{var o=function(){var e=b()(t.value,2),r=e[0],o=e[1],a=n.find(r),i=n.find(o);a&&i&&(n.swimlane.unbind(a,i),a.children.forEach((function(e){n.swimlane.isCellsInSwimlane([e],i)&&n.swimlane.bind(e,i)})))};for(r.s();!(t=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}}}]),n}(),function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"weakMap",new WeakMap),c()(A()(e),"DeleteNames",["Delete"]),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"getRecords",value:function(e){return this.weakMap.get(e)}},{key:"check",value:function(e){var t=this.getRecords(e);if(t&&this.DeleteNames.includes(e.commandName))return t}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.commandName,o=n.command;if(e.DeleteNames.includes(r)){var i=o.cells||t.selector.selections,l=i.map((function(e){return t.find(e)}));if(l.some((function(e){return gr(e)}))){var u=new Set,s=new Map;l.forEach((function(e){if(vr(e))u.add(e.model.id);else if(gr(e)){var t,n=e.parent.model.id,r=e.model.id;s.has(n)?null===(t=s.get(n))||void 0===t||t.add(r):s.set(n,new Set([r]))}}));var d={unbindIDs:new Map,newModels:new Map,originModels:new Map};e.weakMap.set(o,d);var f,h=xv(s);try{var p=function(){var e=b()(f.value,2),n=e[0],r=e[1];if(u.has(n))return un.apply(void 0,[i].concat(T()(wt()(Array,T()(r))))),"continue";var o=t.find(n);if(!o)return{v:void 0};if(r.size===o.children.length)un.apply(void 0,[i].concat(T()(wt()(Array,T()(r))))),i.push(n);else{var a,l,s="height";o.isVertical&&(s="width");var h=0,p=[],m=[];o.children.forEach((function(e){r.has(e.model.id)||(h+=e[s],p.push(e[s]))})),p.reduce((function(e,t,n){return n>=p.length-1?e:(m.push((e+t)/h),e+t)}),0),d.originModels.set(o.model.id,(c()(a={},s,o[s]),c()(a,"".concat(s,"s"),o["".concat(s,"s")]),a)),d.newModels.set(o.model.id,(c()(l={},s,h),c()(l,"".concat(s,"s"),m),l)),o["".concat(s,"s")]=m,o[s]=h,d.unbindIDs.set(o.model.id,t.swimlane.updateContain(o))}};for(h.s();!(f=h.n()).done;){var m=p();if("continue"!==m&&"object"===a()(m))return m.v}}catch(e){h.e(e)}finally{h.f()}o.cells=i}}}));var n=function(t){var n,r=e.diagram,o=[],a=[],i=xv(t.newModels);try{var c=function(){var e,i=b()(n.value,2),c=i[0],l=i[1];if(o.push(c),a.push(l),!r.find(c))return"continue";null===(e=t.unbindIDs.get(c))||void 0===e||e.forEach((function(e){r.swimlane.unbind(e,c)}))};for(i.s();!(n=i.n()).done;)c()}catch(e){i.e(e)}finally{i.f()}o.length>0&&(r.update(o,a),r.swimlane.resetNth(o))};this.bind(t,"aftercommandexecute",(function(t){var r=t.command;if(e.check(r)){var o=e.getRecords(r);o&&n(o)}})),this.bind(t,"aftercommandforward",(function(t){var r=t.command;if(e.check(r)){var o=e.getRecords(r);o&&n(o)}})),this.bind(t,"beforecommandbackward",(function(t){var n=t.command,r=e.weakMap.get(n);if(r&&e.DeleteNames.includes(n.commandName)){var o,a=e.diagram,i=[],c=[],l=xv(r.originModels);try{var u=function(){var e,t=b()(o.value,2),n=t[0],l=t[1],u=a.find(n);if(!u)return"continue";null===(e=r.unbindIDs.get(n))||void 0===e||e.forEach((function(e){a.swimlane.bind(e,n)})),Object.assign(u,l),i.push(n),c.push(l)};for(l.s();!(o=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,o=e.weakMap.get(r);if(o&&e.DeleteNames.includes(r.commandName)){var a,i=[],c=[],l=xv(o.originModels);try{for(l.s();!(a=l.n()).done;){var u=b()(a.value,2),s=u[0],d=u[1];t.find(s)&&(i.push(s),c.push(d))}}catch(e){l.e(e)}finally{l.f()}i.length>0&&(t.update(i,c),t.swimlane.resetNth(i))}}))}}]),n}()]},{mode:"read",Behaviours:[]}],Commands:[iv,ev,tv,ov,av]};function Ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ov(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ev(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cv=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"elements",[]),e}return v()(n,[{key:"render",value:function(){this.group=new no,this.cell.clipGroup.add(this.group)}},{key:"init",value:function(){var e=this,t=this.cell;switch(this.elements=[],this.group.clear(),this.cell.shape){case"pyramid":t.info.forEach((function(n,r){if(r!==t.info.length-1)for(var o=1;o<=n;o++)e.createElement()}));break;case"segmented pyramid":for(var n=2;n<=t.otherInfo.rows;n++)for(var r=1;r<n;r++)this.createElement({fill:"transparent"});break;case"stage":t.info.forEach((function(t,n){e.createElement({fill:"transparent"})}));break;case"architecture":for(var o=t.info.reduce((function(e,t){return e+t}),0),a=0;a<o;a++)this.createElement({fill:"transparent"})}}},{key:"createElement",value:function(){var e=ms(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},this.cell.getRoughGraphicOptions());this.group.add(e),this.elements.push(e)}},{key:"update",value:function(){this.cell.isCacheStale("htmls")&&this.init()}},{key:"draw",value:function(){var e=this,t=this.cell;if(t.isCacheStale("stroke","width","height","htmls","roughFillStyle")){this.init();var n=Ov(Ov({},t.convertStrokeStyle()),{},{stroke:t.stroke.color,"stroke-width":t.stroke.width,d:""});if("architecture"!==t.shape)if("segmented pyramid"!==t.shape){var r=0,o=t.info.length;t.info.forEach((function(a,i){if("pyramid"===t.shape){if(i===o-1)return;for(var c=1;c<=a;c++)if(1===c){var l=(i+1)/o,u=(1-(i+1)/o)*(t.width/2),s=t.width-u,d=l*t.height;n.d="M".concat(u,",").concat(d," L").concat(s,",").concat(d),e.elements[r++].update(n)}}else if("stage"===t.shape){var f=i/o,h=t.width*f;n.d="M".concat(h-25,",",0," L").concat(h,",").concat(t.height/2," L").concat(h-25,",").concat(t.height),e.elements[r++].update(n)}}))}else for(var a=t.otherInfo.rows,i=0,c=2;c<=t.otherInfo.rows;c++)for(var l=(c-1)/a,u=1-l,s=l*t.height,d=u*(t.width/2),f=t.width-d,h=c/a,p=1-h,m=h*t.height,y=p*(t.width/2),v=c-1,g=(f-d)/v,b=(t.width-y-y)/(v+1),x=0;x<v;x++){var w=this.elements[i++],k=d+x*g,E=k+g,O=y+(x+1)*b;n.d="M".concat(k,",").concat(s," L").concat(E,",").concat(s," L").concat(O,",").concat(m," Z"),w.update(n)}else{var C=0,A=t.info.length,P=(t.height-10*(A+1))/A;t.info.forEach((function(r,o){for(var a=r,i=(t.width-10*(a+1))/a,c=0;c<r;c++){var l=10+(i+10)*c,u=10+(P+10)*o;n.d=ei(i,P,4,l,u),e.elements[C++].update(n)}}))}}}}]),n}();function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Pv=function(e){S()(n,Fu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"group",void 0),c()(A()(e),"shapeElement",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new no;this.group=t,e.backGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.group,n=e.createOutlineShapeElement();n&&(t.clear(),t.add(n),this.shapeElement=n)}},{key:"draw",value:function(){var e=this.cell,t=this.shapeElement,n=e.stroke,r=e.fill;if(n){var o={},a=e.getOutlinePath(t);a&&(o.d=a),e.isCacheStale("stroke","roughFillStyle")&&Object.assign(o,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Av(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stroke:"none"},e.convertStrokeStyle())),o.fill=r.color,t.update(o)}}}]),n}();function Sv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var jv=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"isDsl",!0),c()(A()(e),"stencils",void 0),c()(A()(e),"stencil",void 0),c()(A()(e),"info",void 0),c()(A()(e),"clipGroup",new no),c()(A()(e),"clipPathID",Object(F.a)()),c()(A()(e),"backGroup",new no),c()(A()(e),"group",new no),c()(A()(e),"children",void 0),c()(A()(e),"shape",void 0),e}return v()(n,[{key:"init",value:function(e){var t=this;N()(M()(n.prototype),"init",this).call(this,e),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.graphicGroup.prepend(this.clipGroup),"architecture"===e.model.shape&&(this.graphicGroup.prepend(this.backGroup),this.Subcells.push(Pv)),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.forEach((function(e){return e.render()})),this.updateModel(this.model)}},{key:"getOutlinePath",value:function(e){var t,n=this.width,r=this.height,o=this.stencil;if(o.outline.path)t=o.outline.path(n,r);else{var a=n/o.width,i=r/o.height;t=e.getPath(a,i)}return t}},{key:"canUpdateText",value:function(){return!0}},{key:"canRotate",value:function(){return!1}},{key:"canRough",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return ms(e.outline,t)}}},{key:"canConnect",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){var e;return null===(e=this.subcells.find((function(e){return e instanceof xs})))||void 0===e?void 0:e.shapeElement}},{key:"updateModel",value:function(e){N()(M()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),this.parse(),this.updateMatrix(),this.subcells.forEach((function(e){return e.update()}))}},{key:"parse",value:function(){var e,t,n=null===(e=(t=this.stencil).parse)||void 0===e?void 0:e.call(t,this.htmls);this.info=null==n?void 0:n.info,this.otherInfo=null==n?void 0:n.otherInfo}},{key:"updateDefaultSize",value:function(){var e=this,t=this.stencil;t&&["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"pyramid";if(!this.stencil||this.stencil.name!==n){var r,o,a,i=t.find((function(e){return e.name===n}));if(!i)throw new Error("unknown shape ".concat(n));this.stencil=i,this.updateDefaultSize(),this.htmls=null!==(r=this.htmls)&&void 0!==r?r:i.htmls,this.model.width=null!==(o=this.model.width)&&void 0!==o?o:i.width,this.model.height=null!==(a=this.model.height)&&void 0!==a?a:i.height,this.cache={}}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1)}))}},{key:"layoutZIndex",value:function(){var e,t=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||this.children.forEach((function(e){r.insertBefore(e.graphicGroup,t.graphicGroup)})),"architecture"===this.shape&&(this.backGroup.update({matrix:this.matrix}),r.insertBefore(this.backGroup,null!==(e=this.children[0].graphicGroup)&&void 0!==e?e:this.graphicGroup))}},{key:"executeLayout",value:function(){var e=this;if(0!==this.children.length){this.layoutZIndex();var t=this.info,n=0,r=t.length;if("architecture"===this.shape){var o=this.info.length,a=(this.height-10*(o+1))/o;this.info.forEach((function(t,r){for(var o=t,i=(e.width-10*(o+1))/o,c=0;c<t;c++){var l=10+(i+10)*c,u=10+(a+10)*r,s=e.children[n++];if(!s)return;s.offsetX=l,s.offsetY=u,s.width=i,s.height=a,s.matrix=e.matrix,s.opacity=e.opacity,s.textWidth=s.width,s.textHeight=s.height,s.x=s.offsetX,s.y=s.offsetY,s.textarea.update()}}))}if("segmented pyramid"!==this.shape)t.forEach((function(t,o){if("pyramid"===e.shape)for(var a=r,i=(o+1)/a,c=e.width*i,l=e.height/a,u=(e.width-c)/2,s=o/a*e.height,d=c/t,f=0;f<t;f++){var h=e.children[n++];h.offsetX=u+d*f,h.offsetY=s,h.width=d,h.height=l,h.matrix=e.matrix,h.opacity=e.opacity,h.textWidth=h.width,h.textHeight=h.height,h.x=h.offsetX,h.y=h.offsetY,h.textarea.update()}else if("stage"===e.shape){var p=e.children[n++],m=e.width/r,y=o/r;p.offsetX=y*e.width,p.offsetY=0,p.width=m,p.height=e.height,p.matrix=e.matrix,p.opacity=e.opacity,p.textWidth=p.width,p.textHeight=p.height,p.x=p.offsetX,p.y=p.offsetY,p.textarea.update()}}));else for(var i=this.height/this.otherInfo.rows,c=this.width/this.otherInfo.rows,l=1;l<=this.otherInfo.rows;l++)for(var u=(1-l/this.otherInfo.rows)*(this.width/2),s=(l-1)*i,d=c/2,f=1;f<=2*l-1;f++){var h=this.children[n++];if(!h)return;h.offsetX=u+(f-1)*d,h.offsetY=s,h.width=c,h.height=i,h.matrix=this.matrix,h.opacity=this.opacity,h.textWidth=h.width,h.textHeight=h.height,h.x=h.offsetX,h.y=h.offsetY,h.textarea.update()}}}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(e){e.draw()})),this.drawOpacity(),this.drawPosition(),this.subcells.forEach((function(e){return e.draw()})),this.updateCache()}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["matrix","shape","htmls","stroke","roughFillStyle","width","height","opacity","fill"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"destroy",value:function(){var e;null===(e=this.backGroup)||void 0===e||e.destroy(),N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{stencils:uc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},rotate:0,children:[],penetratedKeys:["shape","htmls","stroke","opacity","x","y","width","height","rotate","fill"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[xs,Cv,Yu]})}}]),n}();function Rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(jv,"className","DslStem");var _v=function(e){S()(n,Gu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(A()(r),"isDslCell",!0),c()(A()(r),"textVerticalAlign",void 0),c()(A()(r),"offsetX",0),c()(A()(r),"offsetY",0),c()(A()(r),"textWidth",0),c()(A()(r),"textHeight",0),c()(A()(r),"textRegion",void 0),c()(A()(r),"textarea",void 0),c()(A()(r),"parent",void 0),r}return v()(n,[{key:"init",value:function(e){N()(M()(n.prototype),"init",this).call(this,e),this.graphicGroup.update({"clip-path":"url(#".concat(this.parent.clipPathID,")")}),this.textarea=new es(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var e=this.offsetY,t=this.height,n=this.width,r=this.offsetX,o=this.parent.getBBox();return o.height=t,o.width=n,o.x+=r,o.minX=o.x,o.maxX=o.minX+o.width,o.y+=e,o.minY=o.y,o.maxY=o.minY+o.height,o}},{key:"canRotate",value:function(){return!1}},{key:"canUpdateText",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var e=this.parent,t=ms({name:"path",x:0,y:0,width:1,height:1,stroke:"none"},null==e?void 0:e.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=t,this.graphicGroup.prepend(t)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(e){N()(M()(n.prototype),"updateModel",this).call(this,e),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.textVerticalAlign,n={x:Math.max((this.textWidth-e.width)/2,4)+this.offsetX,y:0};if(n.y="top"===t?4:"bottom"===t?this.textHeight-e.height:(this.textHeight-e.height)/2,"pyramid"===this.parent.shape)0===this.nth&&(n.y+=this.textHeight/6);else if("segmented pyramid"===this.parent.shape){var r=Math.ceil(Math.sqrt(this.nth+1)),o=r*r-(2*r-1)+1;(this.nth+1-o)%2==0?n.y+=this.textHeight/6:n.y-=this.textHeight/6}else"stage"===this.parent.shape&&0!==this.nth&&(n.x-=12.5);return n.y+=this.offsetY,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.width}},{key:"getTextBox",value:function(){var e=this.x,t=this.y,n=this.textWidth,r=this.textHeight;return{x:e,y:t,width:n,height:r,minX:e,minY:t,maxX:e+n,maxY:t+r}}},{key:"drawTextRegion",value:function(){var e=this.width,t=this.textHeight,n=this.textWidth,r=this.offsetX,o=this.offsetY,a="";switch(this.parent.shape){case"pyramid":a=Jn(r,o,n,t);break;case"segmented pyramid":var i=Math.ceil(Math.sqrt(this.nth+1)),c=i*i-(2*i-1)+1;a=Gn((this.nth+1-c)%2==0?[["M",this.offsetX+this.width/2,this.y],["L",this.offsetX+this.width,this.y+this.height],["L",this.offsetX,this.y+this.height],["Z"]]:[["M",this.offsetX,this.y],["L",this.offsetX+this.width,this.y],["L",this.offsetX+this.width/2,this.y+this.height],["Z"]]);break;case"stage":var l=r-25;a=Gn([["M",l,0],["L",l+n,0],["L",r+n,t/2],["L",l+n,t],["L",l,t],["L",r,t/2],["Z"]]);break;case"architecture":a=Gn(ei(this.width,this.height,4,this.x,this.y));break;default:a=""}var u={width:e,height:t,d:a};this.textRegion.update(u)}},{key:"updateCache",value:function(e){var t=this,n=this.cache;(e=e||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(e){var r=t[e];n[e]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.isCacheStale("opacity")&&(e=e||this.opacity,this.graphicGroup.attr({opacity:e}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){un(this.parent.children,this),N()(M()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Xa(N()(M()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums","text-align":"center",margin:0}}],multiSelectHighlight:!1,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(_v,"className","DslCell");var Mv=function(e){S()(n,fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.diagram,r=this.models;e.id=e.id||Object(F.a)(),r.forEach((function(e,t){var n=Object(F.a)();e.id=n,e.nth=t})),e.children=r,t.hooks.decorateAddDslModel.call(e),N()(M()(n.prototype),"execute",this).call(this)}}]),n}();c()(Mv,"className","AddDsl");var Lv=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"queue",!1),e}return v()(n,[{key:"execute",value:function(){this.queue=!1;var e=this.diagram,t=e.selector.selections[0];t=fr(t)?t.parent:t,e.emit("opendsleditor",{cell:t}),[t].concat(T()(t.getChildren())).forEach((function(e){return e.hide()})),e.vertexRotateResize.hide()}}]),n}();function Tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Lv,"className","OpenDslEditNote"),c()(Lv,"isModelChange",!1),c()(Lv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return dr(e)||fr(e)}))}));var Nv=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"oldHtmls",void 0),c()(A()(e),"oldIds",void 0),c()(A()(e),"newIds",[]),c()(A()(e),"newHtmls",void 0),c()(A()(e),"dslId",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.dsl,t=this.htmls;this.dslId=e.model.id,this.oldHtmls=e.htmls,this.oldIds=e.children.map((function(e){return e.model.id})),this.newHtmls=t,this.forward()}},{key:"forward",value:function(){this.updateHtml(this.newHtmls,0===this.newIds.length?void 0:this.newIds)}},{key:"backward",value:function(){this.updateHtml(this.oldHtmls,this.oldIds)}},{key:"updateHtml",value:function(e,t){var n,r,o=this;t||(this.newIds=[]);var a=this.diagram,i=a.find(this.dslId),c=null===(n=(r=i.stencil).parse)||void 0===n?void 0:n.call(r,e),l=i.children.map((function(e){return[e.fill,e.textVerticalAlign]})),u=l[l.length-1][0],s=l[l.length-1][1];a.remove(i.model.children.map((function(e){return e.id})));var d=null==c?void 0:c.models.map((function(e,n){var r;return t?r=t[n]:(r=Object(F.a)(),o.newIds.push(r)),Dv(Dv({},e),{},{id:r,nth:n,fill:n<l.length?l[n][0]:u,textVerticalAlign:n<l.length?l[n][1]:s})})),f=d.map((function(e,t){return{parent:i.model.id,nth:t}}));a.update(i,{htmls:e}),a.hooks.decorateAddDslChildModel.call(d[0]),a.add(d,f)}}]),n}();c()(Nv,"className","UpdateDslHtml");var Bv={Cells:[jv,_v],Extends:[],Commands:[Mv,Lv,Nv],modes:[{mode:"edit",Behaviours:[function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"dsl",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),o=t.getCell(n.target);if(o&&dr(o)){var a,i=o;e.dsl=i,i.children.forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(a=e)})),i.enter(),a&&t.selector.select(a)}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.dsl&&n.findIndex((function(t){return t===e.dsl||t.parent===e.dsl}))<0&&e.dsl.exit()}))}}]),n}(),function(e){S()(n,Zl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),c()(A()(e),"diagram",void 0),c()(A()(e),"dsl",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram,t=function(e){return"ContentCommand"===(null==e?void 0:e.commandName)&&e.id.every((function(e){return fr(e)}))},n=function(t,n){var r=t[0].parent;if("architecture"===r.shape){var o=[];r.htmls.forEach((function(e){o.push.apply(o,T()(e))})),t.forEach((function(e,t){o[e.nth]=n[t]}));var a=[],i=0;return r.info.forEach((function(e){for(var t=[],n=0;n<e;n++)t.push(o[i++]);a.push(t)})),void e.update(r,{htmls:a})}var c=r.htmls;t.forEach((function(e,t){c[e.nth]=n[t]})),e.update(r,{htmls:c})};this.bind(e,"aftercommandexecute",(function(e){var r=e.command;t(r)&&n(r.id,r.endHTML)})),this.bind(e,"aftercommandforward",(function(e){var r=e.command;t(r)&&n(r.id,r.endHTML)})),this.bind(e,"aftercommandbackward",(function(e){var r=e.command;t(r)&&n(r.id,r.startHTML)}))}}]),n}()]}]},Iv={roughFillStyle:"hachure",defaultContentStyle:{"font-family":"shouxie"}},Fv={default:{roughFillStyle:null},hachure:{roughFillStyle:"hachure"},"cross-hatch":{roughFillStyle:"cross-hatch"},solid:{roughFillStyle:"solid"}};function qv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gv(e){return Object.values(e).every((function(e){return null===e}))?{roughFillStyle:null,defaultContentStyle:{"font-family":null}}:zv(zv({},Iv),e)}function Yv(e,t,n){Vi(e,"roughFillStyle",Gv(t).roughFillStyle,n)}function Hv(e,t,n){var r=Gv(t);(Ki(e)||$i(e)||Zi(e)||Qi(e)||Xi(e))&&(Vi(e,"roughFillStyle",r.roughFillStyle,n),Vi(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n))}function Vv(e,t,n){var r=Gv(t);Vi(e,"roughFillStyle",r.roughFillStyle,n),Vi(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function Uv(e,t,n){var r=Gv(t);Vi(e,"roughFillStyle",r.roughFillStyle,n),Vi(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function Wv(e,t,n){e.forEach((function(e){Wt(e,(function(e){Ki(e)||$i(e)||Zi(e)||Qi(e)||Xi(e)?Hv(e,t,n):function(e){return!!e.type&&"pen"===e.type}(e)?Yv(e,t,n):Ui(e)?Vv(e,t,n):function(e){return!!e.type&&"mindmap"===e.type}(e)&&Uv(e,t,n)}))}))}function Xv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Kv=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),c()(this,"name","default"),c()(this,"destroyed",!1),this.diagram=t,this.bindEvent(),this.tabHook()}return v()(e,[{key:"tabHook",value:function(){var e=this,t=this.diagram.hooks;t.forceDecorateImportModels.tap("rough",(function(t){Wv(t,Fv[e.name],!0)})),t.decorateImportModels.tap("rough",(function(t){Wv(t,Fv[e.name])})),t.decorateAddPenModel.tap("rough",(function(t){Yv(t,Fv[e.name])})),t.decorateAddVertexModel.tap("rough",(function(t){Hv(t,Fv[e.name])})),t.decorateAddLineModel.tap("rough",(function(t){Vv(t,Fv[e.name])})),t.decorateAddMindmapStemModel.tap("rough",(function(t){Uv(t,Fv[e.name])}))}},{key:"bindEvent",value:function(){var e=this,t=this.diagram;t.on("beforeimport",(function(){var n,r=t.head,o=(null==r||null===(n=r.rough)||void 0===n?void 0:n.name)||"default";o&&e.setRough(o)})),t.on("beforeexporter",(function(){t.head.rough={name:e.name}}))}},{key:"setRough",value:function(e){var t=Fv[e];if(t){var n=this.diagram.getCells().filter((function(e){return e.isStem&&(null==e?void 0:e.canRough())})).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.model.id},Gv(t))}));return this.name=e,n}}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();c()(Kv,"className","Rough");var Zv=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram.theme;this.originColor=e.values.canvasBackgroundColor,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.color;e.theme.setTheme({canvasBackgroundColor:t})}},{key:"backward",value:function(){var e=this.diagram,t=this.originColor;e.theme.setTheme({canvasBackgroundColor:t})}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Zv,"className","SetCanvasBackgroundColor");var Qv=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,r=e.rough,o=r.name,a=r.setRough(t),i=r.name;a&&(this.id=a.map((function(e){return e.id})),this.model=a,this.beforeName=o,this.afterName=i,this.autoSelect=!1,N()(M()(n.prototype),"execute",this).call(this))}},{key:"forward",value:function(){var e=this.diagram,t=this.afterName,r=e.rough;t&&r.setRough(t),N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.diagram,t=this.beforeName,r=e.rough;t&&r.setRough(t),N()(M()(n.prototype),"backward",this).call(this)}}]),n}();c()(Qv,"className","SetRough");var $v=function(e){S()(n,hc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,r=e.theme,o=u()(r.values),a=r.setTheme(t),i=u()(r.values);a&&(this.id=a.map((function(e){return e.id})),this.model=a,this.beforeValues=o,this.afterValues=i,this.autoSelect=!1,N()(M()(n.prototype),"execute",this).call(this),e.emit("afterThemeChange",t))}},{key:"forward",value:function(){var e=this.diagram,t=this.afterValues,r=e.theme;t&&(r.setTheme(t),e.emit("afterThemeChange",t.themeName)),N()(M()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.diagram,t=this.beforeValues,r=e.theme;t&&(r.setTheme(t),e.emit("afterThemeChange",t.themeName)),N()(M()(n.prototype),"backward",this).call(this)}}],[{key:"enable",value:function(){return!0}}]),n}();function Jv(e,t){var n,r=t.stackFill,o=t.stackStroke,a=t.fontColor;Vi(e,"fill.color",r),Vi(e,"stroke.color",o),null===(n=e.children)||void 0===n||n.forEach((function(e){Vi(e,"defaultContentStyle.color",a)}))}function eg(e,t){var n=t.swimlaneHeadFill,r=t.fontColor;Vi(e,"fill.color",n),Vi(e,"defaultContentStyle.color",r)}function tg(e,t){var n,r=t.swimlaneStroke;null===(n=e.children)||void 0===n||n.forEach((function(e){eg(e,t)})),Vi(e,"stroke.color",r)}function ng(e,t){var n,r=t.dslStroke,o=t.dslFill;null===(n=e.children)||void 0===n||n.forEach((function(e){eg(e,t)})),Vi(e,"fill.color",o),Vi(e,"stroke.color",r)}c()($v,"className","SetTheme");var rg=["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],og=["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],ag=["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],ig=["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],cg=["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],lg=["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],ug={default:{themeName:"default",swatches:hg(rg),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#585A5A",lineStroke:"#585A5A",mindmapRainbowTreeEdgeColors:rg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#585A5A",dslStroke:"#585A5A",dslFill:"#FFFFFF",stackFill:"#FFFFFF",stackStroke:"#585A5A",specialUMLFill:"#FFFFFF",specialUMLStroke:"#585A5A",drawColor:"#585A5A"},dark:{themeName:"dark",swatches:hg(og),canvasBackgroundColor:"#141414",fontColor:"#EFF0F0",geometryFill:"#141414",geometryStroke:"#BEC0BF",lineStroke:"#BEC0BF",mindmapRainbowTreeEdgeColors:og,mindmapSingleTreeEdgeStroke:"#848484",mindmapStemFill:"#262626",mindmapStemStroke:"rgb(255, 255, 255, 0)",mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#141414",swimlaneStroke:"#BEC0BF",dslStroke:"#BEC0BF",dslFill:"#141414",stackFill:"#141414",stackStroke:"#BEC0BF",specialUMLFill:"#141414",specialUMLStroke:"#BEC0BF",drawColor:"#BEC0BF"},colorful_kano:{themeName:"colorful_kano",swatches:hg(ag),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#00AEBF",lineStroke:"#00AEBF",mindmapRainbowTreeEdgeColors:ag,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#00AEBF",stackFill:"#FFFFFF",dslStroke:"#00AEBF",dslFill:"#FFFFFF",stackStroke:"#00AEBF",specialUMLFill:"#FFFFFF",specialUMLStroke:"#00AEBF",drawColor:"#00AEBF"},van_cogh_starry_sky:{themeName:"van_cogh_starry_sky",swatches:hg(ig.concat(["#0B1822"])),canvasBackgroundColor:"#0B1822",fontColor:"#EFF0F0",geometryFill:"#0B1822",geometryStroke:"#149EC1",lineStroke:"#149EC1",mindmapRainbowTreeEdgeColors:ig,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#262626",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#0B1822",swimlaneStroke:"#149EC1",stackFill:"#0B1822",stackStroke:"#149EC1",dslStroke:"#149EC1",dslFill:"#0B1822",specialUMLFill:"#0B1822",specialUMLStroke:"#149EC1",drawColor:"#149EC1"},iris:{themeName:"iris",swatches:hg(cg),canvasBackgroundColor:"#F3F3F6",fontColor:"#262626",geometryFill:"#CFDDE8",geometryStroke:"#88ABC5",lineStroke:"#88ABC5",mindmapRainbowTreeEdgeColors:cg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#CFDDE8",swimlaneStroke:"#88ABC5",dslStroke:"#88ABC5",dslFill:"#CFDDE8",stackFill:"#CFDDE8",stackStroke:"#88ABC5",specialUMLFill:"#CFDDE8",specialUMLStroke:"#88ABC5",drawColor:"#88ABC5"},wuxia_qingqiu:{themeName:"wuxia_qingqiu",swatches:hg(lg),canvasBackgroundColor:"#FBF7EF",fontColor:"#585A5A",geometryFill:"#F7F0D7",geometryStroke:"#D6B235",lineStroke:"#D6B235",mindmapRainbowTreeEdgeColors:lg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#F7F0D7",swimlaneStroke:"#D6B235",dslStroke:"#D6B235",dslFill:"#F7F0D7",stackFill:"#F7F0D7",stackStroke:"#D6B235",specialUMLFill:"#F7F0D7",specialUMLStroke:"#D6B235",drawColor:"#D6B235"}},sg=["finish"],dg=["start","fork"];function fg(e){var t=[];return[[[0,0,0,1],[.4,.8,1]],[[255,255,255,1],[.7,.4,.2]]].forEach((function(n){var r=b()(n,2),o=r[0];r[1].forEach((function(n){var r,a,i,c,l,u,s,d,f,h=new ue.a(e).toRgb(),p=(r=h.r,a=h.g,i=h.b,c=n,l=o[0],u=o[1],s=o[2],d=o[3],"rgb(".concat((r*c+l*d*(1-c))/(f=1-(1-c)*(1-d)),", ").concat((a*c+u*d*(1-c))/f,", ").concat((i*c+s*d*(1-c))/f,")"));t.push(p)}))})),t.reverse()}function hg(e){return[{title:"主题配色",palettes:["transparent",{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]}].concat(T()(e.map((function(e){return{standard:e,gradient:fg(e)}}))))},{title:"默认配色",palettes:[{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]},{standard:"#FDE6D3",gradient:["#FDE6D3","#F8B881","#F38F39","#ED740C","#C75C00","#663000"]},{standard:"#F9EFCD",gradient:["#F9EFCD","#F5D480","#F3BB2F","#ECAA04","#C99103","#664900"]},{standard:"#D9DFFC",gradient:["#D9DFFC","#96A7FD","#4861E0","#2F4BDA","#213BC0","#101E60"]},{standard:"#FBDFEF",gradient:["#FBDFEF","#F297CC","#E746A4","#D22D8D","#AE146E","#5C0036"]},{standard:"#CEF5F7",gradient:["#CEF5F7","#5ED3D9","#1DC0C9","#01B2BC","#07787E","#004347"]},{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#DF2A3F",gradient:["#FBE4E7","#F1A2AB","#E4495B","#DF2A3F","#AD1A2B","#70000D"]},{standard:"#FBDE28",gradient:["#FBF5CB","#FCE75A","#FBDE28","#EDCE02","#A58F04","#665800"]},{standard:"#117CEE",gradient:["#D9EAFC","#81BBF8","#2F8EF4","#117CEE","#0C68CA","#00346B"]},{standard:"#601BDE",gradient:["#E6DCF9","#BA9BF2","#7E45E8","#601BDE","#4C16B1","#270070"]},{standard:"#74B602",gradient:["#E8F7CF","#C1E77E","#8CCF17","#74B602","#5C8D07","#2A4200"]}]}]}function pg(e){var t,n=null==e||null===(t=e.stencil)||void 0===t?void 0:t.name;return yr(e)&&n&&-1!==dg.indexOf(n)}function mg(e){var t,n=null==e||null===(t=e.stencil)||void 0===t?void 0:t.name;return yr(e)&&n&&-1!==sg.indexOf(n)}function yg(e,t){return e.map((function(e,n){return e+t[n]}))}function vg(e,t){return e instanceof Array?e.map((function(e){return e*t})):e*t}function gg(e){return[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16)]}function bg(e){var t=e.map((function(e){var t=e/255;return 100*(t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)})),n=[(.4124*t[0]+.3576*t[1]+.1805*t[2])/95.047,(.2126*t[0]+.7152*t[1]+.0722*t[2])/100,(.0193*t[0]+.1192*t[1]+.9505*t[2])/108.883].map((function(e){return e>.008856?Math.pow(e,1/3):7.787*e+16/116}));return[116*n[1]-16,500*(n[0]-n[1]),200*(n[1]-n[2])]}function xg(e,t){return e.reduce((function(e,n,r){return e+Math.pow(n-t[r],2)}),0)}function wg(e,t){return Math.pow(Math.abs(Math.atan2(e[0],e[1])-Math.atan2(t[0],t[1])),2)}function kg(e){switch(e){case"lab":return wg;case"hct":return xg;default:throw new Error("Unsupported color space")}}function Eg(e,t){var n;return(n=e<26?5:e<51?4:e<63?3:e<74?2:e<85?1:0)<=2&&"dark"===t&&(n=5-n),n>=4&&"light"===t&&(n=5-n),n}function Og(e,t,n,r,o){var a=kg(o),i=!1,c=n||100,l=e.length,u=e[0].length,s=[],d=[],f=new Array(l).fill(-1),h=new Array(l).fill(0);if("rand"===r)for(var p,m=0;s.length<t;)-1===f[p=Math.floor(Math.random()*l)]&&(s[m++]=e[p],f[p]=0);for("kspp"===r&&s.push.apply(s,T()(function(e,t,n){var r=[],o=e.length,a=kg(n),i=Math.floor(Math.random()*o);for(r.push(e[i]);r.length<t;){for(var c=[],l=[],u=r.length,s=0,d=0;d<o;d++){for(var f=1/0,h=0;h<u;h++){var p=a(e[d],r[h]);p<=f&&(f=p)}c[d]=f}for(var m=0;m<o;m++)s+=c[m];for(var y=0;y<o;y++)l[y]=c[y]/s;for(var v=Math.random(),g=0,b=-1,x=0;x<o;x++)if((g+=l[x])>=v){b=x;break}r.push(e[b])}return r}(e,t,o)));!i&&c-- >0;){for(var y=void 0,v=void 0,g=void 0,b=0;b<l;b++){y=1/0,v=-1;for(var x=0;x<t;x++)(g=a(e[b],s[x]))<=y&&(y=g,v=x);f[b]=v,h[v]++}for(var w=0;w<t;w++)d[w]=s[w],s[w]=new Array(u).fill(0);for(var k=0;k<l;k++)s[f[k]]=yg(s[f[k]],e[k]);for(var E=0;E<t;E++)s[E]=vg(s[E],1/h[E]);i=!0;for(var O=0;O<t;O++)if(a(d[O],s[O])>1e-4){i=!1;break}for(var C=0;C<t;C++)h[C]=0}return{centroids:s,idxs:f}}function Cg(e,t,n,r){if(1===e.length)return 0;var o=function(e,t,n){for(var r=kg(n),o=0,a=0;a<e.length;a++)o+=r(t,e[a]);return o/e.length}(e,n,r),a=function(e,t,n){for(var r=kg(n),o=0,a=0;a<e.length;a++)o+=r(t,e[a]);return o/e.length}(t,n,r);return(a-o)/Math.max(o,a)}function Ag(e,t,n,r){for(var o=0,a=0,i=function(e){for(var t,n=1/0,r=-1,o=[],a=0;a<e.length;a++){for(var i=0;i<e.length;i++)a!==i&&(t=xg(e[a],e[i]))<=n&&(n=t,r=i);o[a]=r}return o}(e),c=0;c<e.length;c++){for(var l=[],u=[],s=0;s<t.length;s++)n[s]===c&&l.push(t[s]),n[s]===i[c]&&u.push(t[s]);for(var d=0;d<l.length;d++)o+=Cg(l,u,l[d],r),a++}return o/a}function Pg(e,t,n,r,o,a){for(var i,c,l,u=-1/0,s=-1,d=t;d<=n;d++)c=(i=Og(e,d,r,o,a)).idxs,(l=Ag(i.centroids,e,c,a))>u&&(u=l,s=d);return s}var Sg=function(){function e(){var t=this;m()(this,e),c()(this,"residualColors",void 0),c()(this,"paletteColors",void 0),c()(this,"colorHues",void 0),c()(this,"residualColorSetting",void 0),c()(this,"paletteColorSetting",void 0),c()(this,"colorHueSetting",void 0);var n={default:{palette:["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#585A5A"]},dark:{palette:["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#141414","#BEC0BF"]},colorful_kano:{palette:["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#00AEBF"]},van_cogh_starry_sky:{palette:["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#0B1822","#149EC1"]},iris:{palette:["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#CFDDE8","#88ABC5"]},wuxia_qingqiu:{palette:["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#F7F0D7","#D6B235"]}};this.residualColorSetting={},this.paletteColorSetting={},this.colorHueSetting={},this.residualColors=Object.entries(n).reduce((function(e,n,r){var o=b()(n,2),a=o[0],i=o[1].residual.map((function(e){return e.toLowerCase()}));return t.residualColorSetting[a]={idx:0===r?0:e.length,len:i.length},e.concat(i)}),[]),this.paletteColors=Object.entries(n).reduce((function(e,n,r){var o=b()(n,2),a=o[0],i=o[1],c=T()(i.palette.reduce((function(e,t){var n=fg(t).map((function(e){return ue()(e).toHexString()}));return e.concat.apply(e,T()(n))}),[]));return t.paletteColorSetting[a]={idx:0===r?0:e.length,len:c.length},e.concat(c)}),[]),this.colorHues=Object.entries(n).reduce((function(e,n,r){var o=b()(n,2),a=o[0],i=o[1].palette.map((function(e){return e.toLowerCase()}));return t.colorHueSetting[a]={idx:0===r?0:e.length,len:i.length},e.concat(i)}),[])}return v()(e,[{key:"getResidualColors",value:function(){return this.residualColors}},{key:"getPaletteColors",value:function(){return this.paletteColors}},{key:"getColorHues",value:function(){return this.colorHues}},{key:"isClusterable",value:function(e){var t=e.toLowerCase();return!this.paletteColors.includes(t)&&!this.residualColors.includes(t)}},{key:"isPaletteMapping",value:function(e){return this.paletteColors.includes(e.toLowerCase())}},{key:"indexMapping",value:function(e,t,n){return(e+n)%t}},{key:"adjustLuminanceLevel",value:function(e,t){var n=e;return e<=2&&"dark"===t&&(n=5-e),e>=4&&"light"===t&&(n=5-e),n}},{key:"getResidualColorIndex",value:function(e,t,n){var r=this.residualColorSetting[e].idx,o=this.residualColorSetting[t].idx,a=this.residualColors.indexOf(n);Object.entries(this.residualColorSetting).forEach((function(e){var t=b()(e,2);t[0];var n=t[1];a>=n.idx&&a<n.idx+n.len&&(r=n.idx)}));var i=o>=r?o-r:o+(this.residualColors.length-r);return this.indexMapping(a,this.residualColors.length,i)}},{key:"getPaletteColorIndex",value:function(e,t,n,r){var o=this.paletteColorSetting[e].idx,a=this.paletteColorSetting[t].idx,i=this.paletteColors.indexOf(n);Object.entries(this.paletteColorSetting).forEach((function(e){var t=b()(e,2);t[0];var n=t[1];i>=n.idx&&i<n.idx+n.len&&(o=n.idx)}));var c=a>=o?a-o:a+(this.paletteColors.length-o),l=this.getColorHueIndexByPaletteColorIndex(i),u=this.adjustLuminanceLevel(i%6,r),s=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(l,u);return this.indexMapping(s,this.paletteColors.length,c)}},{key:"getColorHueIndexByPaletteColorIndex",value:function(e){return Math.floor(e/6)}},{key:"getPaletteColorIndexByColorHueIndexAndLuminanceLevel",value:function(e,t){return 6*e+t}},{key:"getMappedColors",value:function(e,t,n,r){var o=this,a={};return n.forEach((function(n){a[n]||(o.isPaletteMapping(n)?a[n]=o.paletteColors[o.getPaletteColorIndex(e,t,n,r)]:a[n]=o.residualColors[o.getResidualColorIndex(e,t,n)])})),a}},{key:"getMappedColorsFromClusteredColors",value:function(e,t){for(var n,r,o,a=Object.values(t).map((function(e){return e[0]})),i={},c=Object.values(t).map((function(e){return e[1]})),l=Object.keys(t),u=this.colorHueSetting[e].idx,s=this.colorHueSetting[e].len,d=0;d<a.length;d++)n=a[d]%s+u,o=c[d],r=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(n,o),i[l[d]]=this.paletteColors[r];return i}},{key:"destroy",value:function(){this.colorHues=[],this.paletteColors=[],this.residualColors=[]}}]),e}(),jg=function(){function e(t){m()(this,e),c()(this,"name","default"),c()(this,"values",u()(ug.default)),c()(this,"themes",ug),c()(this,"palette",new Sg),c()(this,"destroyed",!1),c()(this,"diagram",void 0),this.diagram=t,this.bindEvent(),this.tapHook()}return v()(e,[{key:"tapHook",value:function(){var e=this,t=this.diagram.hooks;t.decorateAddVertexModel.tap("theme",(function(t){Ki(t)?function(e,t){var n=t.geometryFill,r=t.geometryStroke,o=t.fontColor;Vi(e,"fill.color",n),Vi(e,"stroke.color",r),Vi(e,"defaultContentStyle.color",o)}(t,e.values):$i(t)?function(e,t){Vi(e,"defaultContentStyle.color",t.fontColor)}(t,e.values):Zi(t)?Jv(t,e.values):Qi(t)?tg(t,e.values):Xi(t)&&ng(t,e.values)})),t.decorateAddStackModel.tap("theme",(function(t){Jv(t,e.values)})),t.decorateAddMindmapAbstract.tap("theme",(function(t){!function(e,t){var n=t.mindmapAbstractStroke,r=t.fontColor;Vi(e,"treeEdge.stroke",n),Vi(e,"border.stroke",n),Vi(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddMindmapStemModel.tap("theme",(function(t){!function(e,t){var n=t.mindmapStemFill,r=t.fontColor;Vi(e,"border.fill",n),Vi(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddMindmapCellModel.tap("theme",(function(t){!function(e,t){Vi(e,"defaultContentStyle.color",t.fontColor)}(t,e.values)})),t.decorateAddLineModel.tap("theme",(function(t){!function(e,t){var n=t.lineStroke,r=t.fontColor;Vi(e,"stroke.color",n),Vi(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddSwimlaneModel.tap("theme",(function(t){tg(t,e.values)})),t.decorateAddSwimlaneChildModel.tap("theme",(function(t){eg(t,e.values)})),t.decorateNonMindmapCellModels.tap("theme",(function(t,n){e.setNonMindmapCells(t,n)})),t.decorateAddDslModel.tap("theme",(function(t){ng(t,e.values)})),t.decorateAddDslChildModel.tap("theme",(function(t){!function(e,t){var n=t.dslFill,r=t.fontColor;Vi(e,"fill.color",n),Vi(e,"defaultContentStyle.color",r)}(t,e.values)}))}},{key:"bindEvent",value:function(){var e=this,t=this.diagram;t.on("beforeimport",(function(){var n,r=t.head,o=(null==r||null===(n=r.theme)||void 0===n?void 0:n.name)||"default";o&&e.setTheme(o)})),t.on("beforeexporter",(function(){t.head.theme={name:e.name}}))}},{key:"setThemeName",value:function(e){this.values.themeName=e}},{key:"setNonMindmapCells",value:function(e,t){var n=this;if(e.length){var r=this.diagram,o=!1,a=[],i=[];e.forEach((function(e){var t=e.color;i.push(t),n.palette.isClusterable(t)&&(o=!0)}));var l,u=["default","colorful_kano","iris","wuxia_qingqiu"].includes(this.name)?"light":"dark";if(o){var s=function(e,t){for(var n,r=e.map(gg).map(bg),o=r.map((function(e){return e[0]})),a=r.map((function(e){return e.slice(1)})),i=Array.from(new Set(e)).length,c={},l=Pg(a,1,i,100,"kspp","lab"),u=-1/0,s=0;s<5;s++)c[n=Pg(a,1,i,100,"kspp","lab")]?c[n]++:c[n]=1;Object.entries(c).forEach((function(e){var t=b()(e,2),n=t[0],r=t[1];r>u&&(u=r,l=Number(n))}));for(var d=Og(a,l,100,"kspp","lab").idxs.reduce((function(n,r,a){return n[e[a]]=[r,Eg(o[a],t)],n}),{}),f=Object.values(d).map((function(e){return e[0]})),h=0,p={},m=0;m<f.length;m++)p[f[m]]||(p[f[m]]=h,h++);return Object.keys(d).forEach((function(e,t){d[e][0]=p[f[t]]})),d}(i,u);l=this.palette.getMappedColorsFromClusteredColors(this.name,s)}else l=this.palette.getMappedColors(t,this.name,i,u);e.forEach((function(e){var t=e.alpha,n=e.color,r=e.id,o=e.type,i=ue()(l[n]).toRgb(),u=i.r,s=i.g,d=i.b,f="rgba(".concat(u,", ").concat(s,", ").concat(d,", ").concat(t,")");a.push(c()({id:r},o,{color:f}))})),r.update(a.map((function(e){return e.id})),a)}}},{key:"setStackFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return br(e)}));return this.values.stackFill=e,t.map((function(t){return{id:t.id,fill:{color:e}}}))}},{key:"setStackStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return br(e)}));return this.values.stackStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setDslFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return fr(e)}));return this.values.dslFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setDslStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return dr(e)}));return this.values.dslStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setSwimlaneHeadFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return gr(e)}));return this.values.swimlaneHeadFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setSwimlaneStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return vr(e)}));return this.values.swimlaneStroke=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setMindmapAbstractStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return mr(e)&&e.isAbstract}));return this.values.mindmapAbstractStroke=e,t.map((function(t){return{id:t.model.id,border:{stroke:e},treeEdge:{stroke:e}}}))}},{key:"setMindmapStemStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return mr(e)&&e.isStem}));return this.values.mindmapStemStroke=e,t.map((function(t){return{id:t.model.id,border:{stroke:e}}}))}},{key:"setMindmapStemFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return mr(e)&&e.isStem}));return this.values.mindmapStemFill=e,t.map((function(t){return{id:t.model.id,border:{fill:e}}}))}},{key:"setFontColor",value:function(e){var t=this.diagram,n=t.getCells().filter((function(e){return e.textareaElement})),r=n.map((function(e){return e.textareaElement.htmlContainer}));return t.contentEditor.batchEdit(r,"foreColor",e),this.values.fontColor=e,n.map((function(t,n){return{id:t.model.id,html:r[n].innerHTML,defaultContentStyle:{color:e}}}))}},{key:"setGeometryFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return yr(e)&&!pg(e)}));return this.values.geometryFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setGeometryStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return yr(e)&&!mg(e)}));return this.values.geometryStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setLineStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return ur(e)}));return this.values.lineStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setMindmapRainbowTreeEdgeColors",value:function(e){var t=[];return this.diagram.getCells().filter((function(e){return mr(e)&&!e.isStem&&e.stem.rainbow})).forEach((function(n){n.depth===n.stem.depth+1?t.push({id:n.model.id,treeEdge:{stroke:e[n.getNth()%e.length]}}):t.push({id:n.model.id,treeEdge:{stroke:null}})})),this.values.mindmapRainbowTreeEdgeColors=e,t}},{key:"setCanvasBackgroundColor",value:function(e){this.diagram.canvas.css({"background-color":e}),this.values.canvasBackgroundColor=e}},{key:"setSpecialUMLFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return pg(e)}));return this.values.specialUMLFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setSpecialUMLStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return mg(e)}));return this.values.specialUMLStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"deleteMindmapAttrs",value:function(){return this.diagram.getCells().filter((function(e){return mr(e)&&!e.isStem})).map((function(e){return{id:e.model.id,border:{fill:null,stroke:null,"stroke-width":null}}}))}},{key:"setSwatches",value:function(e){this.values.swatches=e}},{key:"setDrawColor",value:function(e){var t=this.diagram;t.settings.freehand&&(t.settings.freehand.stroke=e),this.values.drawColor=e}},{key:"register",value:function(e,t){this.themes[e]=t}},{key:"getTheme",value:function(e){return e=e||this.name,u()(this.themes[e])}},{key:"setTheme",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.themes,a=this.diagram,i=[],c=[];return"string"==typeof e?(Object.keys(o).includes(e)&&(c=u()(o[e])),this.name=e):d()(e)&&(c=e,this.name=e.themeName),Object.keys(c).forEach((function(e){var t=c[e];switch(e){case"mindmapAbstractStroke":var r;"string"==typeof t&&(r=i).push.apply(r,T()(n.setMindmapAbstractStroke(t)));break;case"stackStroke":var o;"string"==typeof t&&(o=i).push.apply(o,T()(n.setStackStroke(t)));break;case"stackFill":var a;"string"==typeof t&&(a=i).push.apply(a,T()(n.setStackFill(t)));break;case"swimlaneHeadFill":var l;"string"==typeof t&&(l=i).push.apply(l,T()(n.setSwimlaneHeadFill(t)));break;case"swimlaneStroke":var u;"string"==typeof t&&(u=i).push.apply(u,T()(n.setSwimlaneStroke(t)));break;case"dslStroke":var s;"string"==typeof t&&(s=i).push.apply(s,T()(n.setDslStroke(t)));break;case"dslFill":var d;"string"==typeof t&&(d=i).push.apply(d,T()(n.setDslFill(t)));break;case"fontColor":var f;"string"==typeof t&&(f=i).push.apply(f,T()(n.setFontColor(t)));break;case"geometryFill":var h;"string"==typeof t&&(h=i).push.apply(h,T()(n.setGeometryFill(t)));break;case"geometryStroke":var p;"string"==typeof t&&(p=i).push.apply(p,T()(n.setGeometryStroke(t)));break;case"lineStroke":var m;"string"==typeof t&&(m=i).push.apply(m,T()(n.setLineStroke(t)));break;case"mindmapStemStroke":var y;"string"==typeof t&&(y=i).push.apply(y,T()(n.setMindmapStemStroke(t)));break;case"mindmapStemFill":var v;"string"==typeof t&&(v=i).push.apply(v,T()(n.setMindmapStemFill(t)));break;case"mindmapRainbowTreeEdgeColors":var g;Array.isArray(t)&&(g=i).push.apply(g,T()(n.setMindmapRainbowTreeEdgeColors(t)));break;case"canvasBackgroundColor":"string"==typeof t&&n.setCanvasBackgroundColor(t);break;case"specialUMLFill":var b;"string"==typeof t&&(b=i).push.apply(b,T()(n.setSpecialUMLFill(t)));break;case"specialUMLStroke":var x;"string"==typeof t&&(x=i).push.apply(x,T()(n.setSpecialUMLStroke(t)));break;case"swatches":t&&n.setSwatches(t);break;case"drawColor":"string"==typeof t&&n.setDrawColor(t);break;case"themeName":"string"==typeof t&&n.setThemeName(t)}})),(t=i).push.apply(t,T()(this.deleteMindmapAttrs())),i=function(e){var t={};return e.forEach((function(e){var n=e.id;if(n){var r=t[n];r?xe()(r,e):t[n]=u()(e)}})),Object.keys(t).map((function(e){return t[e]}))}(i=i.filter((function(e){return"string"==typeof e.id}))),r&&a.update(i.map((function(e){return e.id})),i),i}},{key:"destroy",value:function(){this.palette.destroy(),this.destroyed=!0}}]),e}();c()(jg,"className","Theme");var Rg=function(){var e={};return Array.from(arguments).forEach((function(t){Object.keys(t).forEach((function(n){var r=t[n];d()(r)?e[n]?Object.assign(e[n],r):e[n]=Object.assign({},r):Array.isArray(r)?e[n]?e[n]=[].concat(e[n],r):e[n]=[].concat(r):e[n]=r}))})),e}({Extends:[jg,Kv],Commands:[$v,Qv,Zv]},lp,Ry,qy,kv,Tp,Bv),_g=Object.freeze({__proto__:null,Board:Rg});Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar-dropdown .ant-btn:after {\n  display: none;\n}\n.lake-diagram-toolbar-dropdown .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button {\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  display: flex;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: 30px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon:before {\n  content: '';\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown-menu .lake-icon {\n  font-size: 16px;\n}\n");var Mg=["mode"];function Lg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lg(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dg(e){return e.overlay?e.overlay:Ct.a.createElement(Dt.a,{onClick:e.onSelect,className:jt()("lake-diagram-toolbar-dropdown-menu",e.menuClassName)},e.data.map((function(e){return Ct.a.createElement(Dt.a.Item,{key:e.key},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}))})))}function Ng(e){var t=e.command,n=e.name;return Ct.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Dg(Tg(Tg({},e),{},{onSelect:function(n){var r=n.key;e.onSelect?e.onSelect({key:r}):e.execCommand(t,{key:r})}}))},Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}))))}function Bg(e){var t=e.name,n=e.command,r=e.defaultKey,o=e.data,a=Object(Ot.useState)(r),i=b()(a,2),c=i[0],l=i[1],u=o.find((function(e){return e.key===c}));return Ct.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Ct.a.createElement(Tt.a.Button,{onClick:function(){e.onClick?e.onClick({key:c}):e.execCommand(n,{key:c})},overlay:Dg(Tg(Tg({},e),{},{onSelect:function(t){var n=t.key;l(n),e.onSelect&&e.onSelect({key:n})}})),icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}),"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon||u.icon)})))}function Ig(e){var t=e.mode,n=Lt()(e,Mg);return"button"===t?Ct.a.createElement(Bg,n):Ct.a.createElement(Ng,n)}function Fg(e){var t=e.name,n=e.icon,r=e.accept,o=e.disabled,a=e.title,i=e.onChange,c=Object(Ot.useRef)();return Ct.a.createElement("div",{className:"lake-diagram-toolbar-command","data-testid":t},Ct.a.createElement(Rt.a,{disabled:o||!a,placement:"bottom",title:Ct.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},a&&Ct.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},a))},Ct.a.createElement(_t.a,{className:"lake-diagram-toolbar-upload",onClick:function(){return c.current.click()},disabled:o},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Ct.a.createElement("input",{type:"file",accept:r,onChange:i,ref:c}))))}function qg(e){var t=e.name,n=e.title,r=e.hotkey,o=e.icon,a=e.label,i=e.command,c=e.disabled,l=e.active,u=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{});return Ct.a.createElement("div",Et()({className:"lake-diagram-toolbar-command","data-testid":t},u),Ct.a.createElement(Rt.a,{disabled:c||!(n||r),placement:"bottom",title:Ct.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},n&&Ct.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},n),r&&Ct.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-hotkey"},r))},Ct.a.createElement(_t.a,{onClick:function(t){t.stopPropagation(),e.onClick?e.onClick():e.execCommand(i)},disabled:c,className:jt()({"lake-button-active":l}),"data-testid":"".concat(t,"-button")},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(o)}),a&&Ct.a.createElement("span",{className:"lake-diagram-toolbar-command-label"},a))))}function zg(e){switch(e.type){case"separator":return Ct.a.createElement("div",{className:"lake-diagram-toolbar-separator"});case"dropdown":return Ct.a.createElement(Ig,e);case"upload":return Ct.a.createElement(Fg,e);default:return Ct.a.createElement(qg,e)}}function Gg(e){var t=e.commands,n=e.extra,r=e.execCommand;return Ct.a.createElement("div",{className:jt()("lake-diagram-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-toolbar-title"},e.title),Ct.a.createElement("div",{className:"lake-diagram-toolbar-body"},t.map((function(e,t){return Ct.a.createElement(zg,Et()({key:"".concat(e.name||e.type,"-").concat(t),execCommand:r},e))}))),Ct.a.createElement("div",{className:"lake-diagram-toolbar-extra"},n))}Dg.propTypes={data:Pt.a.array,overlay:Pt.a.node,onSelect:Pt.a.func,menuClassName:Pt.a.string},Ng.propTypes={command:Pt.a.string,name:Pt.a.string,icon:Pt.a.string,onSelect:Pt.a.func,execCommand:Pt.a.func},Bg.propTypes={command:Pt.a.string,name:Pt.a.string,defaultKey:Pt.a.string,title:Pt.a.string,data:Pt.a.array,icon:Pt.a.string,onClick:Pt.a.func,onSelect:Pt.a.func,execCommand:Pt.a.func},Ig.propTypes={mode:Pt.a.string},Ut(".lake-diagram-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),Fg.propTypes={name:Pt.a.string,icon:Pt.a.string,accept:Pt.a.string,disabled:Pt.a.bool,title:Pt.a.string,onChange:Pt.a.func},qg.defaultProps={disabled:!0},qg.propTypes={disabled:Pt.a.bool,name:Pt.a.string,title:Pt.a.string,hotkey:Pt.a.string,type:Pt.a.string,icon:Pt.a.string,label:Pt.a.string,command:Pt.a.string,onClick:Pt.a.func,execCommand:Pt.a.func,active:Pt.a.bool},zg.propTypes={type:Pt.a.string},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 38px;\n  border: solid var(--yq-border-primary);\n  border-width: 1px 0;\n  padding-left: 16px;\n  padding-right: 12px;\n  background: var(--yq-bg-secondary);\n}\n.lake-diagram-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-toolbar-separator {\n  width: 1px;\n  height: 100%;\n  margin: 0 4px;\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 8px;\n  height: 32px;\n  min-width: 32px;\n  margin-left: 4px;\n  margin-right: 4px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-toolbar-command .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-toolbar-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 16px;\n}\n.lake-diagram-toolbar-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-toolbar-command-label {\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-toolbar-tooltip {\n  text-align: center;\n}\n.lake-diagram-toolbar-tooltip-hotkey {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n"),Gg.defaultProps={commands:[],toggleProperties:function(){},domContainer:null},Gg.propTypes={className:Pt.a.string,commands:Pt.a.array,domContainer:Pt.a.object,title:Pt.a.node,extra:Pt.a.node,execCommand:Pt.a.func},Gg.Control=zg,Ut("/* stylelint-disable */\n.lake-diagram-link-editor {\n  max-width: 398px;\n  display: inline-block;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  box-shadow: rgba(216, 218, 217, 0.5) 0px 1px 3px;\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-link-editor .lake-link-invalid-link {\n  color: var(--yq-red-6);\n}\n.lake-diagram-link-editor p {\n  margin-top: 0;\n  margin-bottom: 14px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  margin: 0 2px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  width: 1px;\n  height: 14px;\n  border-left: 1px solid var(--yq-border-primary);\n  margin: 0 1px;\n  margin-top: 5px;\n  vertical-align: top;\n}\n.lake-diagram-link-editor .lake-icon {\n  color: #8590a6;\n  font-size: 16px;\n}\n.lake-diagram-link-editor-preview {\n  line-height: 16px;\n  padding: 6px 8px;\n  vertical-align: middle;\n  white-space: nowrap;\n}\n.lake-diagram-link-editor-preview * {\n  display: inline-block;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button {\n  color: var(--yq-text-body);\n  margin: 0px 0px 0px 8px;\n  padding: 4px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button:hover {\n  background: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container {\n  color: var(--yq-blue-5);\n  height: 16px;\n  padding: 0 6px;\n  min-width: 180px;\n  max-width: 292px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-decoration: none;\n  line-height: 12px;\n  font-size: 14px;\n  letter-spacing: 1.2px;\n  vertical-align: middle;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-empty {\n  height: 16px;\n  padding: 0 6px;\n  min-width: 146px;\n  max-width: 292px;\n  line-height: 20px;\n  font-size: 14px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container:hover {\n  cursor: pointer;\n}\n.lake-diagram-link-editor-edit {\n  width: 365px;\n  padding: 16px 12px;\n  padding-bottom: 4px;\n}\n");var Yg={"zh-cn":{text:"文本",link:"链接",editLink:"编辑链接",addDescription:"添加描述",linkAddress:"链接地址",deleteLink:"删除链接",confirm:"确定",pleaseInputLink:"请输入链接",emptyLink:"空链接",pleaseEnterCorrectLink:"请输入正确的链接",selectedContent:"多行文字被选中，暂不支持修改文本"},en:{text:"Text",link:"Link",editLink:"Edit link",addDescription:"Add a description",linkAddress:"Link address",deleteLink:"Delete link",confirm:"Confirm",pleaseInputLink:"Please input link address",emptyLink:"Empty link",pleaseEnterCorrectLink:"Please enter the correct link",selectedContent:"Selected in the document"}};Yg["en-us"]=Yg.en;var Hg=function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var o=(r=t.call(this,e)).props,a=o.lang,i=o.target;return r.locale=Yg[a],r.nativeEvents=[],r.rect=i.getBoundingClientRect(),r.link=i.getAttribute("href"),r.isMultiLink=i.length>1,r.state={invalidLink:r.isInvalidLink(r.link)},r.preventScrollCancel=!1,r}return v()(n,[{key:"adjustPosition",value:function(){var e=this.container,t=this.props.target,n=e.getBoundingClientRect(),r=e.offsetParent.getBoundingClientRect(),o=t.getBoundingClientRect(),a=o.bottom+4-r.top,i=o.left-r.left;r.top+a+n.height>window.innerHeight-20&&(a-=n.height-4),n.right>window.innerWidth-20?i=window.innerWidth-n.width-4:i<20&&(i=20),e.style.top="".concat(a,"px"),e.style.left="".concat(i,"px")}},{key:"componentDidMount",value:function(){this.bindNativeEvents(),this.adjustPosition()}},{key:"componentDidUpdate",value:function(){this.adjustPosition()}},{key:"componentWillUnmount",value:function(){this.removeNativeEvents()}},{key:"bindNativeEvents",value:function(){var e=this,t=this.container,n=!1;this.addNativeEvent(window,"scroll",(function(t){!0!==e.preventScrollCancel?t.target.className&&-1!==t.target.className.indexOf("lake-link")||e.cancel():t.preventDefault()}),!0),this.addNativeEvent(window,"resize",(function(){e.cancel()}),!0),this.addNativeEvent(window,"mousedown",(function(e){var r=e.target;t.contains(r)||(n=!0)}),!0),this.addNativeEvent(window,"mouseup",(function(r){var o=r.target;n&&!t.contains(o)&&e.cancel(),n=!1}))}},{key:"cancel",value:function(){var e=this.props,t=e.onCancel,n=e.target;t({link:n&&n.getAttribute("href")})}},{key:"addNativeEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,n,r),this.nativeEvents.push({dom:e,name:t,callback:n,useCapture:r})}},{key:"removeNativeEvents",value:function(){this.nativeEvents.forEach((function(e){var t=e.dom,n=e.name,r=e.callback,o=e.useCapture;t.removeEventListener(n,r,o)})),this.nativeEvents=[]}},{key:"confirm",value:function(){var e=this.props.onConfirm,t=this.state.invalidLink,n=this.getText(),r=this.getLink();t||e(n,r)}},{key:"renderPreview",value:function(){var e,t=this.props,n=t.onDeleteLink,r=t.shouldTargetBlank,o=t.onSwitchToEdit,a=t.dataset,i=this.getLink(),c=this.locale,l=i||c.emptyLink;return e=i?r(i)?Ct.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(i),target:"_blank"},l):Ct.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(i)},l):Ct.a.createElement("span",{className:"lake-diagram-link-editor-link-empty"},l),Ct.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-preview"},Ct.a.createElement("span",{className:"lake-icon lake-icon-link"}),e,Ct.a.createElement("span",{className:"lake-diagram-link-editor-slash"}),Ct.a.createElement(Rt.a,{title:c.editLink},Ct.a.createElement("a",Et()({},a,{className:"lake-icon lake-icon-edit lake-diagram-link-editor-button",onClick:function(){o()}}))),Ct.a.createElement(Rt.a,{title:c.deleteLink},Ct.a.createElement("a",Et()({},a,{className:"lake-icon lake-icon-unlink lake-diagram-link-editor-button",onClick:n}))))}},{key:"isInvalidLink",value:function(e){return function(e){return!e||e&&!e.match(/^[\x00-\x7F]/)||e.startsWith("javascript:")}(e)}},{key:"renderEditorContent",value:function(){var e=this,t=this.props.dataset,n=this.state.invalidLink,r=this.getText(),o=this.getLink(),a=this.locale;return Ct.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-edit",onKeyDown:function(t){var n=t.key,r=e.state.invalidLink;"Enter"!==n||r||e.confirm(),"Escape"===n&&e.cancel()}},Ct.a.createElement("p",null,a.text),Ct.a.createElement("p",null,Ct.a.createElement(Nt.a,{className:"lake-link-text-input",defaultValue:this.isMultiLink?a.selectedContent:r,ref:function(t){e.textInputDom=t},placeholder:a.addDescription,disabled:this.isMultiLink,onChange:function(t){e.text=t.target.value}})),Ct.a.createElement("p",null,a.link),Ct.a.createElement("p",null,Ct.a.createElement(Nt.a,{className:"lake-link-link-input",defaultValue:o,ref:function(t){e.preventScrollCancel=!0,t&&t.focus(),e.linkInputDom=t,setTimeout((function(){e.preventScrollCancel=!1}),32)},placeholder:a.linkAddress,onChange:function(t){e.link=t.target.value,e.setState({invalidLink:e.isInvalidLink(e.link)})}})),n&&""!==o?Ct.a.createElement("p",{className:"lake-link-invalid-link"},a.pleaseEnterCorrectLink):"",Ct.a.createElement("p",null,Ct.a.createElement(_t.a,Et()({},t,{className:"lake-link-confirm-button",onClick:function(){e.confirm()},disabled:!this.link||n}),a.confirm)))}},{key:"getLink",value:function(){var e=this.props.getLink;return this.link&&e(this.link)||""}},{key:"getText",value:function(){var e=this.props.target;return this.isMultiLink?"":this.text||e.textContent}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.type,o=n.className,a=n.dataset;return e="edit"===r?this.renderEditorContent():this.renderPreview(),Ct.a.createElement("div",Et()({},a,{className:o,ref:function(e){t.container=e},style:{top:"0px",position:"absolute",zIndex:"1400"}}),e)}}]),n}(Ct.a.Component);function Vg(e){var t=window.location,n=(t.origin+t.pathname.replace("/edit","")).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp("^".concat(n,"#"));return e=e.replace(r,"#").trim(),/^(\w+\.)+\w+(\/|$)/.test(e)&&(e="https://"+e),e}function Ug(e){var t=e.diagram,n=Object(Ot.useState)(null),r=b()(n,2),o=r[0],a=r[1],i=Object(Ot.useState)("preview"),c=b()(i,2),l=c[0],u=c[1];return Object(Ot.useEffect)((function(){function e(e,t){a(e),u(t)}function n(t){var n=t.result,r=t.target,o=t.name;n&&"createLink"===o&&e(r,"edit")}function r(){a(null)}var o=De()((function(){var n=t.contentEditor.getRange();if(n){var r=t.contentEditor.closest(n.commonAncestorContainer,"a");r?e(r,"preview"):a(null)}}),16);return t.contentEditor.on("execcommand",n),t.contentEditor.on("endedit",r),t.contentEditor.on("selectionchange",o),function(){t.contentEditor.off("execcommand",n),t.contentEditor.off("endedit",r),t.contentEditor.off("selectionchange",o)}}),[t]),o?Ct.a.createElement(Hg,{dataset:{"data-lake_prevent_click_unselect":!0},target:o,type:l,lang:Sr.locale,getLink:Vg,onConfirm:function(e,n){o.textContent=e,o.setAttribute("href",n),setTimeout((function(){if(o&&t.viewportContainer.contains(o)){var e=window.getSelection(),n=document.createRange();n.selectNode(o),n.collapse(),e.removeAllRanges(),e.addRange(n)}}),16),a(null)},onSwitchToEdit:function(){u("edit")},onCancel:function(){a(null)},onDeleteLink:function(){o.removeAttribute("href"),function(e){for(var t=e.firstChild;t;){var n=t.nextSibling;e.parentNode.insertBefore(t,e),t=n}e.parentNode.removeChild(e)}(o),a(null)},shouldTargetBlank:function(){return!0}}):Ct.a.createElement("div",null)}Hg.defaultProps={dataset:{},className:null,type:"preview",lang:"zh-cn",onDeleteLink:function(){},onSwitchToEdit:function(){},onConfirm:function(){},onCancel:function(){},shouldTargetBlank:function(){},getLink:function(e){return e}},Hg.propTypes={dataset:Pt.a.object,className:Pt.a.string,target:Pt.a.object,type:Pt.a.string,lang:Pt.a.string,onDeleteLink:Pt.a.func,onSwitchToEdit:Pt.a.func,onConfirm:Pt.a.func,onCancel:Pt.a.func,shouldTargetBlank:Pt.a.func,getLink:Pt.a.func},Ut(""),Ug.defaultProps={diagram:null},Ug.propTypes={diagram:Pt.a.object.isRequired};var Wg=Nf(),Xg=function(e){var t=e.shapeSelect,n=e.groups,r=e.basicWithSwimlane,o=e.diagram;e.popoverVisible;var a=e.pen,i=Object(Ot.useRef)(),c=Object(Ot.useState)(""),l=b()(c,2),u=l[0];return l[1],t||(t=Object(Ot.useMemo)((function(){return new Qf({groups:n,basicWithSwimlane:r})}),T()(n))),Object(Ot.useEffect)((function(){var n,r=Wg?8.5:0,c=new xo({href:Wg?"https://gw.alipayobjects.com/zos/bmw-prod/d9d2b1a7-fe9b-41f9-8450-a9aacab3b014.svg":"https://gw.alipayobjects.com/zos/bmw-prod/ab304cc5-55d8-4bfc-a551-b884d0b88824.svg",matrix:[1,0,0,0,1,0,r,r,1]}),l=new Ao({x:0,y:0,width:32,height:32,rx:4,fill:Wg?"#141414":"#fff"}),u=new no({matrix:[1,0,0,0,1,0,172,4,1]});u.add(new Mo({title:"矢量绘图"})),u.add(l),u.add(c),u.dataset({test_id:"pen"}),u.css({cursor:"pointer"});var s=function(e){l.attr({fill:Bf("hover")})},d=function(e){l.attr({fill:Wg?"#141414":"#fff"})},f=function(t){var n,r;o.penDrawInteract.clearCache(),null==o||null===(n=o.interaction)||void 0===n||n.changeMode("pen"),null===(r=e.hide)||void 0===r||r.call(e)};u.on("mouseover",s),u.on("mouseleave",d),u.on("click",f),a&&t.add(u),i.current.appendChild(t.rendererElement),i.current.setAttribute("height",t.height),null===(n=i.current)||void 0===n||n.setAttribute("width",t.width);var h=function(e){var t,n=e.height;null===(t=i.current)||void 0===t||t.setAttribute("height",n)};return t.on("update:height",h),function(){t.off("update:height",h),u.off("mouseover",s),u.off("mouseleave",d),u.off("click",f),u.destroy()}}),[t]),Object(Ot.useEffect)((function(){function n(t){var n=t.shape,r=t.group,o=t.category,a=t.attr;e.onSelect({key:n,group:r,category:o,attr:a})}return t.on("shape:select",n),function(){t.off("shape:select",n)}}),[e.onSelect]),Ct.a.createElement("svg",{viewBox:u,className:jt()(e.className,"lake-prevent-card-activated"),"data-lake_prevent_click_unselect":"true",ref:i,onClick:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)},"data-testid":"shape-overlay"})};Xg.propTypes={groups:Pt.a.array,onSelect:Pt.a.func,onClick:Pt.a.func,className:Pt.a.string,shapeSelect:Pt.a.object,basicWithSwimlane:Pt.a.bool,diagram:Pt.a.object,pen:Pt.a.bool,popoverVisible:Pt.a.bool},Ut('.lake-diagram-toolbar-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  max-width: 220px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs {\n  height: 40px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab-btn {\n  font-weight: 400;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab .ant-tabs-tab-active {\n  font-weight: 500;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-nav {\n  padding-left: 12px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-operations,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-operations {\n  width: auto !important;\n  padding: 0 !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-more,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-more {\n  padding: 0;\n  margin-left: 8px !important;\n  margin-right: 8px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-ink-bar {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-container {\n  overflow: scroll;\n  display: flex;\n  justify-content: center;\n  max-height: 218px;\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n[data-kumuhana="pouli"] .lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.3);\n}\n');var Kg=["groups","popoverVisible"];function Zg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Qg=Bt.a.TabPane;function $g(e){var t=e.groups,n=e.popoverVisible,r=Lt()(e,Kg),o=Object(Ot.useRef)(),a=Object(Ot.useMemo)((function(){var e=new Qf(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zg(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({groups:t,containerHeight:218,backgroundColor:"transparent"},r)),n=t.map((function(t){return e.getOffset(t)}));return{shapeSelect:e,offsets:n}}),T()(t)),i=a.shapeSelect,l=a.offsets,u=Object(Ot.useState)(t[0]),s=b()(u,2),d=s[0],f=s[1],h=Object(Ot.useRef)();return Object(Ot.useEffect)((function(){var e,n=Le()((function(e){for(var n=e.target.scrollTop,r=l.length-1;r>=0&&!(n>l[r]-32);r--);f((function(e){return e!==t[r]?t[r]:e}))}),16);return null===(e=o.current)||void 0===e||e.addEventListener("scroll",n),function(){var e;return null===(e=o.current)||void 0===e?void 0:e.removeEventListener("scroll",n)}}),[]),Object(Ot.useEffect)((function(){var e;Array.from(null===(e=h.current)||void 0===e?void 0:e.querySelectorAll(".ant-tabs-tab")).forEach((function(e,t){0!==t&&(e.style.marginLeft="16px")}))}),[]),Ct.a.createElement("div",{className:"lake-diagram-toolbar-shape-select-container",ref:h},Ct.a.createElement(Bt.a,{tabBarStyle:{width:"100%",padding:"0 8px",height:"40px",color:"#8c8c8c",fontSize:"14px"},animated:{inkBar:!0,tabPane:!0},onChange:function(e){var t;return null===(t=o.current)||void 0===t?void 0:t.scrollTo(0,i.getOffset(e))},activeKey:d,onTabClick:function(e){f(e)}},t.map((function(e){return Ct.a.createElement(Qg,{tab:Zf[e].title,key:e})}))),Ct.a.createElement("div",{ref:o,className:"lake-diagram-toolbar-shape-container"},Ct.a.createElement(Xg,Et()({groups:t,shapeSelect:i,popoverVisible:n},r))))}$g.propTypes={groups:Pt.a.array,popoverVisible:Pt.a.bool},Ut("/* stylelint-disable */\n.lake-zoom-tool {\n  padding: 0 5px;\n  width: auto;\n  height: 25px;\n  border: 1px solid var(--yq-border-primary);\n  box-shadow: 0px 2px 4px rgba(231, 233, 232, 0.5);\n  color: var(--yq-yuque-grey-3);\n  background: var(--yq-yuque-grey-6);\n  position: absolute;\n  top: 16px;\n  right: 28px;\n  border-radius: 6px;\n  font-size: 14px;\n  line-height: 24px;\n  letter-spacing: 0.05em;\n  outline-style: none;\n  word-wrap: break-word;\n}\n.lake-zoom-tool .ant-dropdown {\n  left: -2.5px;\n}\n.lake-zoom-tool ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu {\n  width: 86px;\n  background: var(--yq-yuque-grey-8);\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-zoom-tool .ant-dropdown-menu-item:hover {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-zoom-tool .ant-dropdown-menu-item {\n  color: var(--yq-white);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-zoom-tool .lake-icon {\n  margin: 3.5px;\n  margin-top: 2px;\n  font-size: 14px;\n  width: 14px;\n  height: 14px;\n}\n.lake-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: top;\n  line-height: 23px;\n}\n.lake-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-zoom-tool .lake-zoom-tool-dropdown:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool:hover {\n  background: var(--yq-yuque-grey-8);\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n");var Jg=function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_setZoom",value:function(e){var t=this.props,n=t.onChange,r=t.minZoom,o=t.maxZoom;e<r&&(e=r),e>o&&(e=o),n(e)}},{key:"_clickZoomIn",value:function(){var e=this.props,t=e.zoomStep,n=e.zoom;this._setZoom(n+t)}},{key:"_clickZoomOut",value:function(){var e=this.props,t=e.zoomStep,n=e.zoom;this._setZoom(n-t)}},{key:"render",value:function(){var e=this,t=this.props.zoom,n=Ct.a.createElement(Dt.a,{className:"lake-zoom-tool-menu",onClick:function(t){var n=t.item;e._setZoom(n.props.value)}},Ct.a.createElement(Dt.a.Item,{value:"resetView"},jr("回到中心")),Ct.a.createElement(Dt.a.Item,{value:.2},"20%"),Ct.a.createElement(Dt.a.Item,{value:.5},"50%"),Ct.a.createElement(Dt.a.Item,{value:1},"100%"),Ct.a.createElement(Dt.a.Item,{value:2},"200%"),Ct.a.createElement(Dt.a.Item,{value:4},"400%"),Ct.a.createElement(Dt.a.Item,{value:"autoFit"},jr("适应画布")));return Ct.a.createElement("div",{className:"lake-zoom-tool",ref:function(t){e.zoomToolDOM=t}},Ct.a.createElement("span",{className:"lake-icon lake-icon-zoom-out",onClick:this._clickZoomOut.bind(this)}),Ct.a.createElement(Tt.a,{className:"lake-zoom-tool-dropdown",overlay:n,placement:"bottomCenter",trigger:["click"],getPopupContainer:function(){return e.zoomToolDOM}},Ct.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*t)+"%")),Ct.a.createElement("span",{className:"lake-icon lake-icon-zoom-in",onClick:this._clickZoomIn.bind(this)}))}}]),n}(Ct.a.Component);function eb(e){var t=e.diagram,n=Object(Ot.useState)(null),r=b()(n,2),o=r[0],a=r[1];return Object(Ot.useEffect)((function(){if(t){a(t.viewport.zoom);var e=De()((function(){a(t.viewport.zoom)}),32);return t.on("afterviewportchange",e),function(){t.off("afterviewportchange",e)}}}),[o,t]),t?Ct.a.createElement(Jg,{zoom:o,onChange:function(e){"autoFit"===e?t.viewport.autoFit():"resetView"===e?t.viewport.focusFirstRoot():t.viewport.setViewport(e)}}):Ct.a.createElement("div",null)}Jg.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},Jg.propTypes={zoom:Pt.a.number,onChange:Pt.a.func,minZoom:Pt.a.number,maxZoom:Pt.a.number,zoomStep:Pt.a.number},eb.propTypes={diagram:Pt.a.object};var tb=function(e){return Ot.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{className:["larkui-icon","larkui-icon-review-arrow-down",e.className].filter(Boolean).join(" ")}),Ot.createElement("defs",null,Ot.createElement("path",{id:"3742204692a",d:"M0 0h256v256H0z"})),Ot.createElement("g",{fill:"none",fillRule:"evenodd"},Ot.createElement("mask",{id:"3742204692b",fill:"#fff"},Ot.createElement("use",{xlinkHref:"#3742204692a"})),Ot.createElement("path",{d:"M181.1 118.925 135 165.096a9.889 9.889 0 0 1-14 0l-46.1-46.17c-3.866-3.873-3.866-10.15 0-14.022a9.892 9.892 0 0 1 7-2.904h92.2c5.468 0 9.9 4.439 9.9 9.915a9.922 9.922 0 0 1-2.9 7.01Z",fill:"currentColor",fillRule:"nonzero",mask:"url(#3742204692b)"})))},nb=function(e){return Ot.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-review-arrow-right",e.className].filter(Boolean).join(" ")}),Ot.createElement("path",{d:"m115.925 74.9 46.171 46.1a9.889 9.889 0 0 1 0 14l-46.17 46.1c-3.873 3.866-10.15 3.866-14.022 0a9.892 9.892 0 0 1-2.904-7V81.9c0-5.468 4.439-9.9 9.915-9.9a9.922 9.922 0 0 1 7.01 2.9Z",fill:"currentColor",fillRule:"nonzero"}))},rb=function(e){return Ot.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-help-search",e.className].filter(Boolean).join(" ")}),Ot.createElement("path",{d:"M114 20c51.362 0 93 41.638 93 93 0 21.782-7.489 41.816-20.032 57.666l45.82 46.277c4.275 4.317 4.24 11.282-.077 15.556-4.317 4.275-11.281 4.24-15.556-.077l-45.774-46.23C155.576 198.602 135.652 206 114 206c-51.362 0-93-41.638-93-93s41.638-93 93-93Zm0 20c-40.317 0-73 32.683-73 73s32.683 73 73 73 73-32.683 73-73-32.683-73-73-73Z",fill:"currentColor",fillRule:"nonzero"}))};function ob(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}Ut("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n/**\n * lake/editor 的卡片容器实现方式会导致文档样式影响卡片编辑器样式\n */\n.lake-diagram-panel-properties ~ div .ant-dropdown-menu-item {\n  margin-left: 0;\n  list-style-type: none;\n}\n.lake-diagram-panel-properties {\n  background-color: var(--yq-bg-secondary);\n  border-left: 1px solid var(--yq-border-primary);\n  height: 100%;\n  width: 100%;\n  min-width: 212px;\n  max-width: 286px;\n  cursor: default;\n  user-select: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header {\n  margin-top: 8px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header .ant-collapse-header {\n  display: none;\n}\n.lake-diagram-panel-properties .lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav {\n  width: 100%;\n  margin-bottom: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list {\n  width: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: 1;\n  margin: 0 2px;\n  display: inline-block;\n  text-align: center;\n  border: none;\n  color: var(--yq-text-caption);\n  border-radius: 0;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab:hover {\n  color: var(--yq-text-primary);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn {\n  color: var(--yq-text-primary);\n  font-weight: 400;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-content-holder {\n  overflow: auto;\n  height: calc(100% - 38px);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs-bar {\n  margin: 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse {\n  border: none;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header {\n  padding: 0 16px;\n  margin: 8px 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header .larkui-icon {\n  padding: 0;\n  margin-right: 8px;\n  top: 6px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item {\n  padding-top: 8px;\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content {\n  border: none;\n  background: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content .ant-collapse-content-box {\n  margin: 0px 16px;\n  padding: 0px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child .ant-collapse-content-box {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty {\n  height: 100%;\n  position: relative;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  margin: auto;\n  padding-bottom: 96px;\n  width: 200px;\n  height: 140px;\n  text-align: center;\n  color: var(--yq-text-disable);\n  line-height: 24px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper p {\n  margin-bottom: 0;\n}\n.lake-diagram-control {\n  margin-bottom: 8px;\n}\n.lake-diagram-control.disabled .lake-diagram-control-title {\n  color: var(--yq-text-caption);\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  border-color: var(--yq-border-primary);\n  background: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra > svg {\n  display: none;\n}\n.lake-diagram-control-title {\n  color: var(--yq-text-body);\n  letter-spacing: 0;\n}\n.lake-diagram-control-head {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-diagram-control-extra {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 92px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n.lake-diagram-control-extra > svg {\n  display: block;\n}\n.lake-diagram-control-body .ant-checkbox + span {\n  letter-spacing: 0;\n}\n.lake-diagram-panel-head {\n  border-bottom: 1px solid var(--yq-border-primary);\n  margin-bottom: 12px;\n  padding-bottom: 4px;\n}\n.lake-diagram-panel-head-title {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  font-weight: 500;\n}\n");var ab=Bt.a.TabPane;function ib(e,t){var n="object"===a()(e)?e:c()({},e,t),r={},o=function(e){e.split(".").reduce((function(t,r,o,a){return t[r]=o+1===a.length?n[e]:{}}),r)};for(var i in n)o(i);return r}function cb(e){var t,n,r=e.diagram,o=e.menus,a=e.tabs,i=e.emptyImg,l=e.className,u=Object(Ot.useState)(e.selections||r.selector.selections.concat([])),s=b()(u,2),d=s[0],f=s[1],h=Object(Ot.useState)(null),p=b()(h,2),m=p[0],y=p[1],v=function(e,t,n){var r={},o=[];return e.forEach((function(e,t){var n=e.name,o=e.key;r[o]={name:n,menus:[],index:t,key:o}})),t.forEach((function(e){e.condition(n)&&(r[e.tabKey].menus.push(e),o.push(e.name))})),Object.values(r).filter((function(e){return e.menus.length>0})).sort((function(e,t){return e.index-t.index}))}(a,o,d);function g(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;if("function"==typeof t)return t(),void f(T()(d));if(e.onChange)return e.onChange(ib(t,n),o);if(o.every((function(e){return e.isGroup}))){var a,i=[],c=[],l=[],u=ib(t,n);return u.hasOwnProperty("width")?a="lc":u.hasOwnProperty("height")&&(a="tc"),o.forEach((function(e){var t=kd(e),n=b()(t,3),r=n[0],o=n[1],s=n[2],d=gd(u,{x:e.x,y:e.y,w:e.width,h:e.height,r:0},o);l.push.apply(l,T()(Ed(d,r,a))),c.push.apply(c,T()(r)),i.push.apply(i,T()(s))})),r.command.execute("Update",{id:c,model:l,originModels:i,autoSelect:!1}),void f(T()(d))}r.command.execute("Update",{id:o,model:ib(t,n),autoSelect:!1}),f(T()(d))}return Object(Ot.useEffect)((function(){Array.isArray(e.selections)&&f(e.selections)}),[e.selections]),Object(Ot.useEffect)((function(){if(r){var e=De()((function(e){e&&y(e),f(r.selector.selections.concat([]))}),32),t=function(){e()};return r.on("afterselect",t),function(){r.off("afterselect",t)}}}),[r,m]),Ct.a.createElement("div",{className:jt()("lake-diagram-panel lake-diagram-panel-properties",l),"data-lake_prevent_click_unselect":"true"},v.length>0?(t=o.map((function(e){return e.name})),n=v.map((function(e){return e.key})),Ct.a.createElement("div",{className:"lake-diagram-panel-body"},Ct.a.createElement(Bt.a,{type:"card",activeKey:m&&-1!==n.indexOf(m)?m:d.length>0&&d.every((function(e){return e.isText}))?"text":v[0].key,onChange:function(e){y(e)}},v.map((function(e){var n=e.name,o=e.menus,a=e.key;return Ct.a.createElement(ab,{tab:n,key:a},Ct.a.createElement(It.a,{defaultActiveKey:t,expandIcon:function(e){return e.isActive?Ct.a.createElement(tb,{style:{color:"#595959"}}):Ct.a.createElement(nb,{style:{color:"#595959"}})}},o.map((function(e){return Ct.a.createElement(It.a.Panel,{header:e.name,key:e.name,className:!0===e.hideHeader?"lake-diagram-panel-menu-hide-header":""},e.controls.map((function(e,t){return e.display&&!e.display(d)?null:Ct.a.createElement(e.Control,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ob(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ob(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({key:t,path:e.path,title:e.title,selections:d,diagram:r,onChange:g},e.props))})))}))))}))))):Ct.a.createElement("div",{className:"lake-diagram-panel-body lake-diagram-panel-body-empty"},Ct.a.createElement("div",{className:"lake-diagram-background-wrapper"},Ct.a.createElement("img",{src:i}),Ct.a.createElement("p",null,jr("点击选中元素")),Ct.a.createElement("p",null,jr("可设置颜色、布局、文字等样式")))))}function lb(e){var t=e.title,n=e.extra,r=e.children,o=e.disabled,a=e.onMouseDown,i=jt()("lake-diagram-control",e.className,{disabled:o});return Ct.a.createElement("div",{className:i,onMouseDown:a},t&&Ct.a.createElement("div",{className:"lake-diagram-control-head"},Ct.a.createElement("div",{className:"lake-diagram-control-title"},t),n&&Ct.a.createElement("div",{className:"lake-diagram-control-extra"},n)),r&&Ct.a.createElement("div",{className:"lake-diagram-control-body"},r))}function ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ub(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ub(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function db(e){var t=e.zoom;e=sb(sb({},e),{},{zoomToolDOM:null});var n=function(t){var n=e,r=n.onChange,o=n.minZoom,a=n.maxZoom;t<o&&(t=o),t>a&&(t=a),r(t)},r=Ct.a.createElement(Dt.a,{className:"lake-zoom-tool-menu",onClick:function(e){var t=e.item;n(t.props.value)}},[{value:.2,title:"20%"},{value:.5,title:"50%"},{value:.75,title:"75%"},{value:1,title:"100%"},{value:1.5,title:"150%"},{value:2,title:"200%"},{value:3,title:"300%"},{value:4,title:"400%"}].map((function(e,t){return Ct.a.createElement(Dt.a.Item,{key:t,value:e.value},e.title)})));return Ct.a.createElement("div",{className:"lake-board-zoom-tool",ref:function(t){e.zoomToolDOM=t}},Ct.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-out",onClick:function(){var t=e,r=t.zoomStep,o=t.zoom;n(o-r)}}),Ct.a.createElement(Tt.a,{overlayClassName:"lake-board-zoom-tool-dropdown-overlay ne-ignore-pointer-events",overlay:r,placement:"bottomCenter",trigger:["click"]},Ct.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*t)+"%")),Ct.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-in",onClick:function(){var t=e,r=t.zoomStep,o=t.zoom;n(o+r)}}))}function fb(e){var t=e.diagram,n=Object(Ot.useState)(null),r=b()(n,2),o=r[0],a=r[1];return Object(Ot.useEffect)((function(){if(t){a(t.viewport.zoom);var e=De()((function(){a(t.viewport.zoom)}),32);return t.on("afterviewportchange",e),function(){t.off("afterviewportchange",e)}}}),[o,t]),t?Ct.a.createElement(db,{zoom:o,onChange:function(e){"autoFit"===e?t.viewport.autoFit():"resetView"===e?t.viewport.focusFirstRoot():t.viewport.setViewport(e)}}):Ct.a.createElement("div",null)}function hb(e){var t=e.onClose;return Ct.a.createElement(Ht.a,{className:"lake-board-iconfont-copyright-notice",title:jr("素材版权说明"),visible:!0,centered:!0,onCancel:t,zIndex:3e3,footer:null},Ct.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-description"},jr("所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。")),Ct.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-links"},Ct.a.createElement("a",{href:"https://mos.m.taobao.com/iconfont-legal-agreement?spm=a313x.7781069.0.0"},"法律声明"),Ct.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/pg3x76"},"更多说明"),Ct.a.createElement(_t.a,{type:"primary",onClick:t},"我知道了")))}function pb(){var e=Object(Ot.useState)(!1),t=b()(e,2),n=t[0],r=t[1],o=Nf()?"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*7X8oSpr2xkkAAAAAAAAAAAAADvuFAQ/original":"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*U6yhS4Ir_VwAAAAAAAAAAAAADvuFAQ/original";return Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-header"},Ct.a.createElement("img",{onClick:function(){window.open("https://www.iconfont.cn/","_blank")},className:"lake-board-iconfont-searcher-header-icon",src:o}),Ct.a.createElement("a",{className:"lake-board-iconfont-searcher-header-copyright",target:"_blank",href:"https://www.yuque.com/yuque/wknab3/pg3x76"}),n&&Ct.a.createElement(hb,{onClose:function(){r(!1)}}))}function mb(){return Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-container","data-testid":"lake-board-iconfont-searcher-offline"},Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-image"}),Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-tips"},jr("暂时无法从 iconfont 获取资源")))}function yb(){return Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-container","data-testid":"lake-board-iconfont-searcher-empty"},Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-image"}),Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-tips"},jr("搜索结果为空")))}cb.defaultProps={diagram:null,menus:null,tabs:null,emptyImg:"",className:""},cb.propTypes={diagram:Pt.a.object,menus:Pt.a.array,tabs:Pt.a.array,emptyImg:Pt.a.string,selections:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func,className:Pt.a.string},Ut("/* stylelint-disable */\n.lake-diagram-control .lake-diagram-control-extra .ant-input-number {\n  border: none;\n}\n.lake-diagram-control .lake-diagram-control-extra .lake-diagram-dropdown-input {\n  border: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  background-color: var(--yq-bg-secondary);\n}\n.lake-diagram-control.disabled .ant-input-number.ant-input-number-disabled {\n  background-color: var(--yq-bg-secondary);\n}\n"),Object.assign(lb,{get:function(e,t,n){var r=n;if(e.length>0)if((r=e.map((function(e){return t.split(".").reduce((function(e,t){return e?e.isCell&&e.get(t)||e[t]:e}),e)}))).every((function(e){return e===r[0]})))r=r[0];else{if(!r.every((function(e){return"number"==typeof e})))return"multiValue";r.sort(),r=r[r.length-1]}return r}}),lb.propTypes={title:Pt.a.string,extra:Pt.a.object,children:Pt.a.node,className:Pt.a.string,disabled:Pt.a.bool,onMouseDown:Pt.a.func},cb.Control=lb,Ut(".lake-board-zoom-tool-dropdown-overlay {\n  padding-top: 6px;\n  min-width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu {\n  width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu {\n  border-radius: 5px;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu .ant-dropdown-menu-item {\n  color: var(--yq-black);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-board-zoom-tool {\n  display: flex;\n  align-items: center;\n  height: 100%;\n  padding: 0 4px;\n}\n.lake-board-zoom-tool .lake-icon {\n  color: var(--yq-text-primary);\n  margin-left: 2px;\n  margin-right: 2px;\n  font-size: 14px;\n  line-height: 18px;\n  width: 18px;\n  height: 18px;\n}\n.lake-board-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-board-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: middle;\n  width: 40px;\n  line-height: 25px;\n}\n.lake-board-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n"),db.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},db.propTypes={zoom:Pt.a.number,onChange:Pt.a.func,minZoom:Pt.a.number,maxZoom:Pt.a.number,zoomStep:Pt.a.number,zoomToolDOM:Pt.a.element},fb.propTypes={diagram:Pt.a.object},Ut("/* stylelint-disable */\n.lake-board-iconfont-copyright-notice .ant-modal-close {\n  top: -8px;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header {\n  padding-top: 12px;\n  padding-bottom: 0px;\n  border-bottom: none;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header .ant-modal-title {\n  font-size: 14px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-description {\n  color: var(--yq-text-body);\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links {\n  margin-top: 24px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a:first-child {\n  padding-right: 8px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links button {\n  float: right;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a ~ a {\n  border-left: 1px solid var(--yq-border-primary);\n  padding: 0 8px;\n}\n"),Ut('/* stylelint-disable */\n.lake-board-iconfont-searcher-header {\n  height: 44px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 0 16px;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-icon {\n  cursor: pointer;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/c50d07f1-891a-4dea-84f7-0c08fd92bc6a.svg);\n}\n[data-kumuhana="pouli"] .lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  filter: invert(100%);\n}\n'),Ut("/* stylelint-disable */\n.lake-board-iconfont-searcher-offline-container {\n  height: 256px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-image {\n  width: 70px;\n  height: 59px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/82cfa582-d999-4c73-bfbe-5b9945af9726.svg);\n  background-position: center;\n  margin-top: 48px;\n  margin-bottom: 24px;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),Ut("/* stylelint-disable */\n.lake-board-iconfont-searcher-empty-container {\n  height: 212px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-image {\n  width: 100px;\n  height: 68px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/80736e19-e03c-44c7-9223-1d67449e98cf.svg);\n  background-position: center;\n  margin-top: 40px;\n  margin-bottom: 15px;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),Ut("/* stylelint-disable */\n.lake-board-iconfont-searcher-container {\n  width: 230px;\n  height: 300px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content {\n  border-top: 1px solid var(--yq-border-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-search-input-container {\n  width: calc(100% - 16px);\n  margin: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list {\n  height: 200px;\n  display: flex;\n  flex-wrap: wrap;\n  align-content: flex-start;\n  overflow: auto;\n  margin-left: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container {\n  display: inline-block;\n  margin-right: 4px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container .lake-board-iconfont-searcher-content-list-item-img {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  margin: 8px;\n  background-repeat: no-repeat;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n");var vb={};function gb(e){var t=function(e){var t=e.diagram,n=e.onSelect,r=Object(Ot.useState)([]),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)(!0),l=b()(c,2),u=l[0],s=l[1];function d(){return(d=de()(he.a.mark((function t(n,r){var o,a,c,l,u,s,d,f,h;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=vb.data,a=vb.keyword,c=vb.count,l=vb.page,u=e.boardWebProxy,o&&l&&a&&null!=u&&u.iconfont&&c){t.next=4;break}return t.abrupt("return");case 4:if(!((s=(null==o?void 0:o.length)||0)>=c)){t.next=7;break}return t.abrupt("return");case 7:if(!(s/6*32-r<=1.5*n)){t.next=14;break}return d=l+1,t.next=12,u.iconfont.search({keyword:a,page_size:100,page:d});case 12:(f=t.sent)&&(h=o.concat(f.data),i(h),vb.data=h,vb.page=d);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=de()(he.a.mark((function t(n){var r,o,a;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.boardWebProxy).iconfont){t.next=13;break}return o=1,t.next=5,r.iconfont.search({keyword:n,page_size:100,page:o});case 5:if(!(a=t.sent)){t.next=13;break}return i(a.data),vb.page=o,vb.count=a.count,vb.data=a.data,vb.keyword=n,t.abrupt("return");case 13:i([]);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return(p=de()(he.a.mark((function e(r){var o,a,i,c,l;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.svg,a=hl(o),e.next=4,Oa(a);case 4:return i=e.sent,e.next=7,fetch(a).then((function(e){return e.blob()}));case 7:c=e.sent,l=new File([c],"iconfont.svg",{type:"image/svg+xml"}),t.command.execute("BeginInsertImage",{model:{image:{src:a,naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight},width:32,height:32},files:[l]}),n&&n();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=de()(he.a.mark((function e(){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("");case 2:s(!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=De()(f,200);return Object(Ot.useEffect)((function(){t&&function(){m.apply(this,arguments)}()}),[t]),{state:{data:a,loading:u},onSearch:function(e){Object.assign(vb,{data:void 0,keyword:void 0,count:void 0,page:void 0}),y(e)},onItemClick:function(e){return p.apply(this,arguments)},onListScroll:De()((function(e,t){return d.apply(this,arguments)}),200)}}(e);return Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-container"},Ct.a.createElement(pb,null),function(e){var t,n=e.state,r=n.data,o=n.loading;return r?(o||(t=Array.isArray(r)&&0===r.length?Ct.a.createElement(yb,null):function(e){var t=e.state.data;return Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list",onScroll:function(t){e.onListScroll(t.target.offsetHeight,t.target.scrollTop)}},Array.isArray(t)&&t.map((function(t,n){var r=t.svg;return Ct.a.createElement("div",{"data-testid":"lake-board-iconfont-searcher-content-list-item-".concat(n),onClick:function(){null==e||e.onItemClick(t)},key:n,className:"lake-board-iconfont-searcher-content-list-item-container"},Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list-item-img",style:{backgroundImage:"url(".concat(hl(r),")")}}))})))}(e)),Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-content"},Ct.a.createElement("div",{className:"lake-board-iconfont-searcher-search-input-container","data-testid":"lake-board-iconfont-searcher-search-input-container"},Ct.a.createElement(Nt.a,{onCompositionEnd:function(t){e.onSearch(t.target.value)},placeholder:jr("请搜索"),maxLength:50,prefix:Ct.a.createElement(rb,null),onInput:function(t){t.nativeEvent.isComposing||e.onSearch(t.target.value)}})),t)):Ct.a.createElement(mb,null)}(t))}Ut("/* stylelint-disable */\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header {\n  padding: 10px 16px;\n  padding-bottom: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-board-theme-picker-header-title {\n  font-size: 14px;\n  color: var(--yq-text-primary);\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert {\n  margin-left: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert:hover {\n  cursor: pointer;\n}\n.lake-board-theme-picker-header-help-tips {\n  font-size: 14px;\n  max-width: 212px;\n}\n"),Ut("/* stylelint-disable */\n.lake-board-theme-picker-container {\n  width: 230px;\n  overflow: auto;\n  padding: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-content: flex-start;\n  padding-bottom: 6px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container {\n  border-radius: 4px;\n  outline: 1px solid #d8d8d8;\n  width: 98px;\n  height: 64px;\n  margin-bottom: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-title {\n  font-size: 14px;\n  width: 82px;\n  height: 18px;\n  margin: 4px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-cover {\n  background-position: center;\n  background-repeat: no-repeat;\n  width: 86px;\n  height: 18px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container.lake-board-theme-picker-item-container-selected {\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:hover {\n  cursor: pointer;\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:nth-child(odd) {\n  margin-right: 10px;\n}\n");var bb=jr("未命名"),xb=[{cover:"https://gw.alipayobjects.com/zos/bmw-prod/1b30aa39-33a1-4d27-b4c7-9e1e0b5ac1f1.svg",theme:"default",backgroundColor:"white",titleFontColor:"#262626",title:jr("浅色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/ce15e90d-b07e-4da5-9dce-3f7b126c6015.svg",theme:"dark",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:jr("暗色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/db33a600-59c1-4ec2-b0e6-ad9b6953194c.svg",theme:"colorful_kano",backgroundColor:"white",titleFontColor:"#262626",title:jr("多彩卡诺")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/59d288e4-280f-48d1-9940-a3e0ba0e5ce7.svg",theme:"van_cogh_starry_sky",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:jr("星空")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/a3c840a3-63a0-4d11-9dca-de8cdb3572eb.svg",theme:"iris",backgroundColor:"#F3F3F6",titleFontColor:"#163866",title:jr("鸢尾花")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/60a05954-c6d0-41ab-8899-3e63f09c63c8.svg",theme:"wuxia_qingqiu",backgroundColor:"#FAF5EC",titleFontColor:"#5B4E26",title:jr("巫峡清秋")}];function wb(e){var t=u()(xb);return t.forEach((function(t){t.cover=t.cover||"https://gw.alipayobjects.com/zos/bmw-prod/9ad1c2ce-f565-421b-a867-fb9c5ef1206b.svg",t.title=t.title||bb,t.theme===e&&(t.selected=!0)})),t}function kb(e){var t=e.className,n=function(e){var t,n=e.diagram,r=e.data,o=e.sourceTheme,a=Object(Ot.useState)(wb((null==n||null===(t=n.theme)||void 0===t?void 0:t.name)||"default")),i=b()(a,2),c=i[0],l=i[1];function u(e){var t=e.commandName;["SetTheme","Undo","Redo"].includes(t)&&l(wb(n.theme.name))}return Object(Ot.useEffect)((function(){if(n)return n.on("aftercommandexecute",u),function(){n.off("aftercommandexecute",u)}}),[n]),{onItemClick:function(e){n&&n.command.execute("SetTheme",{name:e.theme}),n&&n.hooks.decorateNonMindmapCellModels.call(r,o)},state:{items:c}}}(e),r=n.state.items;return Ct.a.createElement("div",{className:jt()("lake-board-theme-picker-container",t)},r.map((function(e,t){var r=e.cover,o=e.title,a=e.selected,i=e.backgroundColor,c=e.titleFontColor,l=a?"lake-board-theme-picker-item-container-selected":null,u={},s={};return i&&(u.backgroundColor=i),c&&(s.color=c),Ct.a.createElement("div",{className:jt()("lake-board-theme-picker-item-container",l),key:t,style:u,onClick:function(){n.onItemClick(e)}},Ct.a.createElement("div",{className:"lake-board-theme-picker-item-title",style:s},o),Ct.a.createElement("div",{className:"lake-board-theme-picker-item-cover",style:{backgroundImage:"url(".concat(r,")")}}))})))}function Eb(e){var t=ue()(e).toRgb(),n=t.r,r=t.g,o=t.b;return t.a,ue()("rgb(".concat(n,", ").concat(r,", ").concat(o,")")).toHexString()}function Ob(e){var t=function(e){var t=e.diagram,n=e.popoverVisible,r=Object(Ot.useState)([]),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)("default"),l=b()(c,2),u=l[0],s=l[1];return Object(Ot.useEffect)((function(){!function(){if(!t.destroyed&&n){var e=t.getCells().filter((function(e){return yr(e)||ur(e)||br(e)||xr(e)||vr(e)||gr(e)||kr(e)||dr(e)||fr(e)})),r=[];e.forEach((function(e){e.fill&&"transparent"!==e.fill.color&&"rgba(0,0,0,0)"!==e.fill.color&&r.push({id:e.model.id,type:"fill",color:Eb(e.fill.color),alpha:ue()(e.fill.color).getAlpha()}),e.stroke&&"transparent"!==e.stroke.color&&"rgba(0,0,0,0)"!==e.stroke.color&&r.push({id:e.model.id,type:"stroke",color:Eb(e.stroke.color),alpha:ue()(e.stroke.color).getAlpha()})})),i(r),s(t.theme.name)}}()}),[t,n]),{state:{data:a,sourceTheme:u}}}(e).state;return Ct.a.createElement("div",{className:jt()("lake-board-toolbard-theme-picker-outer-container")},Ct.a.createElement("div",{className:jt()("lake-board-theme-picker-header")},Ct.a.createElement("span",{className:jt()("lake-board-theme-picker-header-title")},jr("主题配色")),Ct.a.createElement(Rt.a,{title:Ct.a.createElement("div",{className:jt()("lake-board-theme-picker-header-help-tips")},jr("切换主题时会对画布上已有图形生效，  \n          ⌘/Ctrl+Z 可撤销")),open:!0})),Ct.a.createElement(kb,Et()({},e,t)))}function Cb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}Ut("/* stylelint-disable */\n.lake-board-rough-setting-container {\n  padding: 10px 16px;\n  padding-bottom: 0px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title {\n  font-size: 14px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title .lake-icon-question {\n  color: inherit;\n}\n.lake-board-rough-setting-container .lake-diagam-rough-setting-switch {\n  float: right;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas {\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas:hover {\n  cursor: pointer;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas.lake-diagram-rough-setting-fill-style-selected {\n  border: 1px solid var(--yq-blue-6);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container.disable canvas:hover {\n  cursor: not-allowed;\n}\n");var Ab=["hachure","cross-hatch","solid"];function Pb(e){return"default"!==(null==e?void 0:e.rough.name)}function Sb(e){var t=e.diagram,n=Object(Ot.useState)(Pb(t)),r=b()(n,2),o=r[0],a=r[1],i=Object(Ot.useState)(null==t?void 0:t.rough.name),l=b()(i,2),u=l[0],s=l[1],d=Object(Ot.useRef)(null);function f(e){["SetRough","Undo","Redo"].includes(e.commandName)&&(a(Pb(t)),s(null==t?void 0:t.rough.name))}return Object(Ot.useEffect)((function(){if(t)return t.on("aftercommandexecute",f),function(){t.off("aftercommandexecute",f)}}),[t]),Object(Ot.useEffect)((function(){var e=d.current;if(e){!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(e);var n=Nf()?Ur:Vr;Ab.forEach((function(r){var a={fillStyle:r};"solid"===r?(a.roughness=0,a.fill=o?n.roughIconSolidfill:n.roughIconSolidDisablefill):"hachure"===r?a.fill=o?n.roughIconHachurefill:n.roughIconHachureDisablefill:"cross-hatch"===r&&(a.fill=o?n.roughIconCrossHatchfill:n.roughIconCrossHatchDisablefill);var i=function(e){var t=document.createElement("canvas"),n=ge.a.canvas(t);return t.width=122,t.height=40,t.style.width="".concat(61,"px"),t.style.height="".concat(20,"px"),n.rectangle(0,0,122,40,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({seed:20,stroke:"none",hachureGap:12},e)),t}(a);u===r&&o&&i.classList.add("lake-diagram-rough-setting-fill-style-selected"),o&&i.addEventListener("click",(function(){(null==t?void 0:t.rough.name)!==r&&t.command.execute("SetRough",{name:r})})),e.appendChild(i)}))}}),[d,u,o]),Ct.a.createElement("div",{className:jt()("lake-board-rough-setting-container")},Ct.a.createElement("p",{className:jt()("lake-board-rough-setting-open-switch-container")},Ct.a.createElement("span",{className:"lake-board-rough-setting-title"},jr("手绘风格")," ",Ct.a.createElement("a",{className:jt()("lake-icon","lake-icon-question"),href:"https://www.yuque.com/yuque/wknab3/nu8ptz",target:"_blank"})),Ct.a.createElement(Vt.a,{size:"small",checked:!!o,onChange:function(e){var n;n=e?"default"!==u?u:"hachure":"default",t.command.execute("SetRough",{name:n})},className:"lake-diagam-rough-setting-switch"})),Ct.a.createElement("div",{ref:d,className:jt()("lake-board-rough-setting-fill-style-container",{disable:!o})}))}var jb=r.FileUtils.isImage;function Rb(e,t){var n=Array.from(e.nativeEvent.target.files).filter((function(e){return jb(e)}));n[0]&&t.emit("importimage",{files:n,from:"uploadButton"})}function _b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_b(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lb(e){return e.overlay?e.overlay({onSelect:e.onSelect,setPopoverVisible:e.setPopoverVisible,popoverVisible:e.popoverVisible}):Ct.a.createElement(Dt.a,{onClick:e.onSelect,className:jt()("lake-diagram-board-toolbar-menu",e.menuClassName)},e.data.map((function(e){return Ct.a.createElement(Dt.a.Item,{key:e.key,style:{marginTop:"2px"}},Ct.a.createElement("div",{className:"lake-icon lake-icon-".concat(e.icon)}))})))}function Tb(e){var t=e.name,n=e.icon,r=e.tooltipPlacement,o=e.popoverPlacement,a=e.defaultKey,i=e.data,c=e.titleTag,l=e.shouldClickUpdateOverlay,u=e.className,s=Object(Ot.useState)(a),d=b()(s,2),f=d[0],h=d[1],p=i&&i.find((function(e){return e.key===f})),m=Object(Ot.useState)(!1),y=b()(m,2),v=y[0],g=y[1],x=Object(Ot.useState)(!1),w=b()(x,2),k=w[0],E=w[1];function O(t){var n=t.key;h(n),E(!1),e.onSelect&&e.onSelect({key:n})}function C(){return Lb(Mb(Mb({},e),{},{onSelect:O,setPopoverVisible:E,popoverVisible:k}))}var A=Object(Ot.useState)(C()),P=b()(A,2),S=P[0],j=P[1];return Object(Ot.useEffect)((function(){j(C())}),[k]),Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-command"},Ct.a.createElement(Ft.a,{overlayClassName:"lake-diagram-board-toolbar-popover",content:S,trigger:"click",placement:"".concat(o),visible:k,onVisibleChange:function(){return E(!k)}},Ct.a.createElement(Rt.a,{visible:v,placement:r,overlayClassName:jt()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===r}),title:c},Ct.a.createElement(_t.a,{className:u,"data-testid":t,onClick:function(){g(!1),E(!k),l&&j(C()),e.onClick&&e.onClick({key:f,popoverVisible:k})},onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},function(e){return"string"==typeof e?Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e||p.icon)}):e}(n)))))}function Db(e){var t=e.name,n=e.icon,r=e.accept,o=e.disabled,a=e.title,i=e.tooltipPlacement,c=e.onChange,l=e.titleTag,u=Object(Ot.useRef)();return Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-command","data-testid":t},Ct.a.createElement(Rt.a,{disabled:o||!a,placement:i,title:l,overlayClassName:jt()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===i})},Ct.a.createElement(_t.a,{className:"lake-diagram-board-toolbar-upload",onClick:function(){u.current.value="",u.current.click()},disabled:o},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Ct.a.createElement("input",{type:"file",accept:r,onChange:c,ref:u}))))}function Nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ib(e){var t=e.name,n=e.titleTag,r=e.title,o=e.hotkey,a=e.label,i=e.tooltipPlacement,c=e.disabled,l=e.diagram,u=e.defaultKey,s=e.active,d=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{}),f="string"==typeof e.icon?Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}):e.icon;return Ct.a.createElement("div",Et()({className:"lake-diagram-board-toolbar-command","data-testid":t},d),Ct.a.createElement(Rt.a,{disabled:c||!(r||o),placement:i,title:n,overlayClassName:jt()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===i})},Ct.a.createElement(_t.a,{onClick:function(t){t.stopPropagation(),e.onClick?e.onClick({key:u}):e.execCommand&&e.execCommand(l)},disabled:c,className:jt()({"lake-button-active":s})},f,a&&Ct.a.createElement("span",{className:"lake-diagram-board-toolbar-command-label"},a))))}function Fb(e){var t=e.speratorAlignment,n=e.tooltipPlacement,r=e.title,o=e.hotkey,a=e.diagram,i=e.className,c=e.disabled,l=e.active;c="function"==typeof c?c(a):c,l="function"==typeof l?l(a):l;var u=Bb(Bb({},e),{},{disabled:c,active:l,className:i}),s="bottom"===n?Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r),o&&Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-hotkey"},o)):Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r,o&&Ct.a.createElement("span",{className:"lake-diagram-board-toolbar-popover-shortcut"},o)));switch(e.type){case"separator":return Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-".concat(t,"-separator")});case"popover":return Ct.a.createElement(Tb,Et()({},u,{titleTag:s}));case"upload":return Ct.a.createElement(Db,Et()({},u,{titleTag:s}));case"custom":return e.component;default:return Ct.a.createElement(Ib,Et()({},u,{titleTag:s}))}}function qb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ut("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-board-toolbar-popover .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n  border-radius: 3px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-board-toolbar-menu.ant-menu {\n  width: 38px;\n  padding-top: 3px;\n  padding-bottom: 3px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item {\n  padding: 0 5px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  width: 28px;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 28px;\n  line-height: 32px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item-selected {\n  background-color: transparent;\n}\n"),Lb.propTypes={data:Pt.a.array,overlay:Pt.a.node,onSelect:Pt.a.func,menuClassName:Pt.a.string},Tb.defaultProps={popoverPlacement:"rightTop"},Tb.propTypes={command:Pt.a.string,name:Pt.a.string,icon:Pt.a.oneOfType([Pt.a.string,Pt.a.element]),overlay:Pt.a.func,onSelect:Pt.a.func,onClick:Pt.a.func,execCommand:Pt.a.func,defaultKey:Pt.a.string,data:Pt.a.array,tooltipPlacement:Pt.a.string,popoverPlacement:Pt.a.string,diagram:Pt.a.object,titleTag:Pt.a.object,shouldClickUpdateOverlay:Pt.a.bool,className:Pt.a.string},Ut(".lake-diagram-board-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-board-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),Db.propTypes={name:Pt.a.string,icon:Pt.a.string,accept:Pt.a.string,disabled:Pt.a.bool,title:Pt.a.string,onChange:Pt.a.func,diagram:Pt.a.object,tooltipPlacement:Pt.a.string,titleTag:Pt.a.object},Ut(".lake-diagram-board-toolbar-tooltip-overlay .ant-tooltip-content {\n  padding-left: 4px;\n}\n"),Ib.propTypes={disabled:Pt.a.bool,active:Pt.a.bool,name:Pt.a.string,title:Pt.a.string,hotkey:Pt.a.string,titleTag:Pt.a.object,type:Pt.a.string,icon:Pt.a.oneOfType([Pt.a.string,Pt.a.object]),label:Pt.a.string,command:Pt.a.string,onClick:Pt.a.func,execCommand:Pt.a.func,diagram:Pt.a.object,tooltipPlacement:Pt.a.string,defaultKey:Pt.a.string},Fb.propTypes={type:Pt.a.string,component:Pt.a.object,speratorAlignment:Pt.a.string,tooltipPlacement:Pt.a.string,title:Pt.a.string,hotkey:Pt.a.string,disabled:Pt.a.oneOfType([Pt.a.bool,Pt.a.func]),active:Pt.a.oneOfType([Pt.a.bool,Pt.a.func]),diagram:Pt.a.object,className:Pt.a.string},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-side-toolbar:empty {\n  display: none;\n}\n.lake-diagram-board-top-toolbar {\n  position: absolute;\n  top: 10px;\n  left: 0;\n  right: 0;\n  z-index: 1;\n  padding-left: 8px;\n  padding-right: 16px;\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  pointer-events: none;\n}\n.lake-diagram-board-top-toolbar > div {\n  pointer-events: auto;\n}\n.lake-diagram-board-top-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 8px;\n  margin-right: 8px;\n  height: 100%;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-top-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-left {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-board-toolbar-right {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-board-side-toolbar {\n  position: absolute;\n  width: 40px;\n  left: 16px;\n  height: 100%;\n  z-index: 1;\n  display: flex;\n  align-content: center;\n  pointer-events: none;\n}\n.lake-diagram-board-side-toolbar-body {\n  display: flex;\n  align-items: center;\n  flex-flow: column;\n  margin: auto;\n  pointer-events: initial;\n  padding: 4px 0;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-side-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-vertical-separator {\n  width: 1px;\n  height: 60%;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-horizontal-separator {\n  height: 1px;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  width: calc(100% - 16px);\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-horizontal-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-command .ant-btn {\n  border: none;\n  padding: 0 5px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  width: 32px;\n  margin-left: 3px;\n  margin-right: 3px;\n  color: var(--yq-text-primary);\n  vertical-align: middle;\n  border-radius: 6px;\n  background-color: transparent;\n}\n.lake-diagram-board-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn:hover,\n.lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-board-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-board-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn .lake-icon {\n  font-size: 18px;\n  margin: 0;\n}\n.lake-diagram-board-toolbar-command .lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-command-label {\n  font-size: 12px;\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-board-toolbar-tooltip {\n  text-align: center;\n  font-size: 12px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey {\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n.lake-diagram-board-toolbar-popover-shortcut {\n  font-size: 12px;\n  color: #d8dad9;\n  padding-left: 4px;\n}\n");var Gb="top-left",Yb="top-right",Hb="left-middle";function Vb(e){var t=e.items,n=e.tooltipPlacement,r=e.className,o=e.diagram;return Ct.a.createElement("div",{className:r},t.map((function(t,r){return Ct.a.createElement(Fb,Et()({key:"".concat(t.name||t.type,"-").concat(r),execCommand:t.execCommand,tooltipPlacement:n,diagram:o},t,e,{className:t.className}))})))}function Ub(e){var t=e.items,n={placement:Gb,tooltipPlacement:"bottom",speratorAlignment:"vertical",className:"lake-diagram-board-top-toolbar-body"},r=function(n){return(r=n.placement,t.reduce((function(e,t){return t.align===r&&e.push(t.subItems),e}),[])).map((function(t,r){return Ct.a.createElement(Vb,{key:r,items:t,tooltipPlacement:n.tooltipPlacement,speratorAlignment:n.speratorAlignment,className:n.className,diagram:e.diagram})}));var r};return Ct.a.createElement(Ct.a.Fragment,null,Ct.a.createElement("div",{className:jt()("lake-diagram-board-top-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-left"},r(n)),Ct.a.createElement("div",{className:"lake-diagram-board-toolbar-right"},r(zb(zb({},n),{},{placement:Yb})))),Ct.a.createElement("div",{className:jt()("lake-diagram-board-side-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},r(zb(zb({},n),{},{placement:Hb,tooltipPlacement:"right",speratorAlignment:"horizontal",className:"lake-diagram-board-side-toolbar-body"}))))}Vb.defaultProps={items:[]},Vb.propTypes={items:Pt.a.array,tooltipPlacement:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object},Ub.defaultProps={items:[]},Ub.propTypes={className:Pt.a.string,items:Pt.a.array,execCommand:Pt.a.func,diagram:Pt.a.object},Ub.Control=Fb,Ut(".ne-embed-icon {\n  display: inline-flex;\n  width: 16px;\n  height: 16px;\n}\n");var Wb=function(e){S()(n,Ot.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var o=M()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_isLowContrast",value:function(e){var t=ue()(e).toRgb();return.3*t.r+.59*t.g+.11*t.b>=248}},{key:"_isTransparent",value:function(e){return!e||"transparent"===e||"rgba(255,255,255,0)"===e.replace(/ /g,"")||"rgba(0,0,0,0)"===e.replace(/ /g,"")}},{key:"requireStroke",value:function(e){return this._isTransparent(e)||this._isLowContrast(e)}},{key:"render",value:function(){return this._getIcon()}},{key:"_getIcon",value:function(){var e,t=this.props,n=t.type,r=t.fill,o=t.stroke,a=t.strokeWidth,i=t.pen;if(this._isTransparent(r))return Ct.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ct.a.createElement("defs",null,Ct.a.createElement("pattern",{id:"rect",viewBox:"0,0,8,8",width:"35%",height:"35%"},Ct.a.createElement("rect",{id:"矩形",fill:"#FAFAFA",x:"0",y:"0",width:"4",height:"4"}),Ct.a.createElement("rect",{id:"矩形备份-21",fill:"#FAFAFA",x:"4",y:"4",width:"4",height:"4"}),Ct.a.createElement("rect",{id:"矩形备份-20",fill:"#D9D9D9",x:"4",y:"0",width:"4",height:"4"}),Ct.a.createElement("rect",{id:"矩形备份-22",fill:"#D9D9D9",x:"0",y:"4",width:"4",height:"4"}))),Ct.a.createElement("circle",{cx:"8",cy:"8",r:"8",fill:"url(#rect)"}));if("stroke-color"===n&&this._isTransparent(o))return Ct.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ct.a.createElement("title",null,"透明环"),Ct.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"0.5",fill:"none",fillRule:"evenodd"},Ct.a.createElement("g",{id:"透明环",transform:"translate(-0.000000, 0.000000)"},Ct.a.createElement("path",{d:"M8,0 C12.418278,0 16,3.581722 16,8 C16,12.418278 12.418278,16 8,16 C3.581722,16 0,12.418278 0,8 C0,3.581722 3.581722,0 8,0 Z M8,3 C5.23857625,3 3,5.23857625 3,8 C3,10.7614237 5.23857625,13 8,13 C10.7614237,13 13,10.7614237 13,8 C13,5.23857625 10.7614237,3 8,3 Z",id:"形状",fill:"#FAFAFA"}),Ct.a.createElement("path",{d:"M8,13 L8,12.999 L8,16 C6.91549955,16 5.88140117,15.7842031 4.93830231,15.3932066 L6.08631593,12.6207031 C6.67578581,12.8651081 7.32214006,13 8,13 Z M11.5247537,11.5462815 L13.6458509,13.6678364 C12.905585,14.4052487 12.0216994,14.9985887 11.0398062,15.4022444 L9.89058451,12.6302127 C10.5062584,12.3785637 11.0605479,12.0076869 11.5247537,11.5462815 Z M4.48114009,11.5521301 L2.36015992,13.6738177 C1.61882513,12.9368948 1.02109994,12.0556625 0.612650477,11.075787 L3.38472128,9.92671467 C3.64106728,10.5400536 4.01611047,11.091429 4.48114009,11.5521301 Z M16,7.999 C16,9.08450045 15.7842031,10.1185988 15.3932066,11.0616977 L12.6207031,9.91368407 C12.8651081,9.32421419 13,8.67785994 13,8 L16,7.999 Z M3,8 L2.999,8 L4.45652404e-11,8 C4.45652404e-11,6.91549955 0.215796936,5.88140117 0.606793361,4.93830231 L3.37929685,6.08631593 C3.13489185,6.67578581 3,7.32214006 3,8 Z M13.6398401,2.32618229 C14.3811749,3.06310522 14.9789001,3.94433749 15.3873495,4.92421296 L12.6152787,6.07328533 C12.3589327,5.45994637 11.9838895,4.90857096 11.5188599,4.44786988 L13.6398401,2.32618229 Z M8,9.09494702e-13 C9.0848864,9.09494702e-13 10.1193348,0.215950555 11.0627045,0.607210861 L9.91368407,3.37929685 C9.32421419,3.13489185 8.67785994,3 8,3 L7.999,9.09494702e-13 L8,9.09494702e-13 Z M2.37521442,2.31125673 C2.36817981,2.31821274 2.36115804,2.32518171 2.35414914,2.33216359 C2.47280694,2.21398682 2.594547,2.10004476 2.71975554,1.98995348 L2.91043586,1.82748893 C3.08291716,1.68509277 3.26177813,1.54957175 3.44628096,1.42161318 L3.44587689,1.42189343 C3.64121394,1.28642097 3.84244471,1.15967042 4.04944431,1.04189047 L4.04893797,1.04217859 L4.35587152,0.876283146 L4.35587152,0.876283146 L4.67022901,0.723755702 L4.96019384,0.597755619 L6.10941549,3.36978734 L6.08230453,3.38096211 C6.01729624,3.40798236 5.95298109,3.43633501 5.88939319,3.46598597 L6.10941549,3.36978734 C6.00994969,3.41044274 5.91208604,3.45421002 5.81594555,3.50096817 C5.67093771,3.57146782 5.52925326,3.64913643 5.39194239,3.73324727 C5.36336599,3.75074884 5.33464738,3.76874189 5.30612657,3.78701662 C5.2498994,3.8230481 5.19464208,3.86003397 5.14017772,3.89807688 C5.13087827,3.90457251 5.12161081,3.91109266 5.11236658,3.91764341 C5.0411436,3.96811355 4.9712726,4.02042159 4.90284866,4.07448042 C4.89157281,4.08338639 4.8797933,4.09277659 4.86805733,4.10221872 C4.81544399,4.14455883 4.76415727,4.18754838 4.71376093,4.2315324 C4.69109675,4.25131063 4.66840717,4.2714759 4.64590384,4.29184316 L4.61016998,4.32449924 L4.61016998,4.32449924 L4.47532075,4.45364446 L4.47532075,4.45364446 L2.35414914,2.33216359 L2.359,2.326 L2.36467214,2.32170046 L2.361,2.325 Z",id:"形状结合",fill:"#D9D9D9"}))));var c=this._isLowContrast(o)?"#e8e8e8":o;switch(n){case"t-font-color":e=function(e){return Ct.a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18"},Ct.a.createElement("title",null,"color-font"),Ct.a.createElement("desc",null,"Created with Sketch."),Ct.a.createElement("g",{id:"color-font",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Ct.a.createElement("rect",{fill:e,id:"Rectangle-55",stroke:"none",strokeWidth:"1",x:"2",y:"13.75",width:"12",height:"1.5",rx:"0.125"}),Ct.a.createElement("path",{d:"M5.29102819,11.25 L3.96365715,11.25 C3.87952002,11.25 3.8113134,11.1817934 3.8113134,11.0976562 C3.8113134,11.08076 3.81412419,11.0639814 3.81963067,11.0480076 L7.0756112,1.60269506 C7.09679504,1.5412426 7.15463644,1.5 7.21963767,1.5 L8.81868806,1.5 C8.883726,1.5 8.94159158,1.54128846 8.96274706,1.60278951 L12.2118,11.048102 C12.239168,11.1276636 12.1968568,11.2143472 12.1172952,11.2417152 C12.1013495,11.2472004 12.0846037,11.25 12.067741,11.25 L10.6761419,11.25 C10.6099165,11.25 10.5512771,11.2072154 10.531066,11.1441494 L9.69970662,8.55 L6.27433466,8.55 L5.43599205,11.1444975 C5.41567115,11.2073865 5.35711879,11.25 5.29102819,11.25 Z M8.02635163,3.18571429 L7.96199183,3.18571429 L6.63904023,7.30714286 L9.33500105,7.30714286 L8.02635163,3.18571429 Z",id:"A",fill:"#595959"})))}(r);break;case"t-bg-color":e=function(e,t){return Ct.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ct.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Ct.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/背景色",transform:"translate(-5.000000, -6.000000)"},Ct.a.createElement("g",{id:"编组-9",transform:"translate(-1.000000, 0.000000)"},Ct.a.createElement("mask",{id:"mask-2",fill:"black"},Ct.a.createElement("use",{xlinkHref:"#path-1"})),Ct.a.createElement("circle",{fill:e,stroke:t,strokeWidth:"1",cx:"14",cy:"14",r:"7.5"})))))}(r,o);break;case"stroke-color":e=function(e,t){return Ct.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ct.a.createElement("title",null,"编组 10"),Ct.a.createElement("g",{id:"控件",stroke:"none",fill:"none",fillRule:"evenodd"},Ct.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/描边",transform:"translate(-6.000000, -8.000000)"},Ct.a.createElement("g",{id:"编组-10",transform:"translate(6.000000, 8.000000)"},Ct.a.createElement("circle",{id:"椭圆形",stroke:t,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"3"})),Ct.a.createElement("g",{id:"编组-11",transform:"translate(6.000000, 8.000000)"},Ct.a.createElement("circle",{id:"椭圆形2",stroke:e,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"1"})))))}(o,c);break;case"properties-cb-trans":e=Ct.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"context-cb-trans":e=Ct.a.createElement("svg",{width:"30",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("path",{d:"M0 30L30 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"freehand-stroke":e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="#b3b3b3";return"pencil"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pencil")?Ct.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("path",{d:"M16.2475842,16.3512937 L16.0279135,16.3959976 L15.8755758,16.4439378 L15.8755758,16.4439378 L15.6885047,16.5214086 L15.5037725,16.6091468 L15.1502378,16.7917247 L14.1582912,17.3270847 C12.5308696,18.169164 11.3207925,18.3244874 10.2613836,17.253022 C9.07268531,16.050796 9.45279022,14.0280592 11.1264226,11.012497 L11.4449119,10.4532344 C11.5557853,10.2631412 11.6713488,10.0693629 11.7915409,9.87186119 L12.1659422,9.26814722 C12.4768539,8.77557644 13.1282051,8.62831267 13.6207759,8.93922439 C14.1133467,9.2501361 14.2606104,9.90148735 13.9496987,10.3940581 L13.606469,10.9483066 L13.2933472,11.4749154 L13.1478871,11.7277362 L13.1478871,11.7277362 L12.8787892,12.2121732 L12.7549996,12.4436944 L12.7549996,12.4436944 L12.5285601,12.8851048 C12.422311,13.0985518 12.3264419,13.3010641 12.2406117,13.492428 L12.0822349,13.8602279 C12.0580359,13.9190293 12.034927,13.9765762 12.0128956,14.0328607 L11.8935358,14.3553545 C11.626955,15.1233988 11.5971181,15.6038285 11.7613521,15.7699316 C11.9337328,15.944274 12.2587181,15.9156574 13.0191883,15.5396003 L13.3553885,15.3660406 L14.0683854,14.9777715 L14.5588768,14.7208035 L14.5588768,14.7208035 L14.8283108,14.5909996 C14.9959703,14.5142859 15.1424127,14.4562192 15.283892,14.4108156 L15.4944206,14.3514596 L15.6411755,14.3193385 L15.6411755,14.3193385 L15.8229221,14.288223 L15.8229221,14.288223 C16.0206409,14.257605 16.2316784,14.2449705 16.3867188,14.2421875 C16.9895921,14.2313658 17.5330764,14.5999486 17.8897979,15.0602489 C18.5859881,15.7413305 18.8037075,17.0609002 18.528112,18.9499392 C18.2631318,20.7662161 19.8942188,21.4062736 22.0220888,20.5801796 C22.4202909,20.4255872 22.8684194,20.6230719 23.0230117,21.0212741 C23.1776041,21.4194762 22.9801193,21.8676047 22.5819172,22.022197 C19.586905,23.1849381 16.6409228,22.0776091 16.9718374,18.9302877 L17.056926,18.2825549 L17.0985526,17.8865412 C17.1398894,17.4151216 17.1382613,17.0537588 17.0932478,16.7824691 C16.9205623,16.4164746 16.7376596,16.3526922 16.3718084,16.3487976 L16.2475842,16.3512937 L16.2475842,16.3512937 Z",stroke:Nf()?t:"#000",strokeWidth:e/3.3,fill:Nf()?t:"#000"})):Ct.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("defs",null,Ct.a.createElement("linearGradient",{x1:"6.80751023%",y1:"2.11021409%",x2:"93.1924898%",y2:"100%",id:"linearGradient-1"},Ct.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"0%"}),Ct.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"11.7862402%"}),Ct.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"89.2893774%"}),Ct.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"100%"}))),Ct.a.createElement("g",{id:"马克笔笔触",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinejoin:"round"},Ct.a.createElement("line",{x1:"12",y1:"11",x2:"20.8528558",y2:"20.5249844",id:"路径-3",stroke:Nf()?t:"url(#linearGradient-1)",strokeWidth:e})))}(a,i);break;default:e=null}return Ct.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:this.props.onClick},e)}}]),n}();c()(Wb,"propTypes",{className:Pt.a.string,type:Pt.a.string.isRequired,fill:Pt.a.string,stroke:Pt.a.string,onClick:Pt.a.func,strokeWidth:Pt.a.number,pen:Pt.a.string}),c()(Wb,"defaultProps",{fill:"red"}),Ut("/* stylelint-disable */\n.lake-diagram-color-pick-v2-container {\n  z-index: 1050;\n}\n.lake-diagram-color-pick-v2-container .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-color-pick-v2-overlay {\n  z-index: 1051;\n}\n");var Xb=function(e){var t,n=e.color,o=e.defaultColor,a=e.disabled,i=e.onClear,c=e.diagram,l=e.transSVG,u=e.onSelect,s=c&&(null==c||null===(t=c.theme)||void 0===t?void 0:t.values.swatches);return Ct.a.createElement(Ft.a,{overlayClassName:"lake-prevent-card-activated lake-diagram-color-pick-v2-container lake-diagram-prevent-mouse-select",disabled:a,trigger:["click"],destroyTooltipOnHide:!0,content:Ct.a.createElement(r.ColorPickerV2,{overlayClassName:"lake-diagram-color-pick-v2-overlay lake-prevent-card-activated lake-diagram-prevent-mouse-select",defaultColor:o,currentColor:n,onSelect:u,onClear:i,swatches:s}),placement:"topRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},!n||function(e){return!e||"transparent"===e||"rgba(255,255,255,0)"===e.replace(/ /g,"")||"rgba(0,0,0,0)"===e.replace(/ /g,"")}(n)?l||Ct.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"})):e.children)};Ut(".lake-diagram-toolbar-free-hand-container {\n  display: flex;\n  flex-direction: column;\n  align-content: center;\n  margin: auto;\n  background: var(--yq-bg-primary);\n  border-radius: 3px;\n  box-shadow: 0 1px 2px -2px #00000014, 0 2px 6px 0 #0000000a, 0 4px 8px 1px #00000005;\n  border: 1px solid var(--yq-border-primary);\n  pointer-events: initial;\n  padding: 4px 4px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row {\n  width: 32px;\n  height: 32px;\n  border-radius: 3px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-diagram-toolbar-free-hand-stroke-width {\n  width: 32px;\n  height: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-icon {\n  font-size: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row:hover {\n  background-color: var(--yq-border-primary);\n}\n"),Ut(".lake-diagram-toolbar-free-hand-stroke-container .lake-diagram-toolbar-free-hand-stroke-slider {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 160px;\n}\n");var Kb=function(e){var t=e.strokeWidth,n=e.setStrokeWidth,r="lake-diagram-toolbar-free-hand-stroke";return Ct.a.createElement("div",{className:"".concat(r,"-container")},Ct.a.createElement("div",null,jr("粗细")),Ct.a.createElement("div",{className:"".concat(r,"-slider")},Ct.a.createElement(Yt.a,{style:{width:125},min:1,max:10,step:1,value:t,onChange:function(e){n(e)}}),Ct.a.createElement("div",null,t)))},Zb=function(e){var t=e.diagram,n=e.boardWebProxy,r=Object(Ot.useState)("pencil"),o=b()(r,2),a=o[0],i=o[1],l=Object(Ot.useState)("#595959"),u=b()(l,2),s=u[0],d=u[1],f=Object(Ot.useRef)(null),h=Object(Ot.useState)(2),p=b()(h,2),m=p[0],y=p[1],v=Object(Ot.useState)(!1),g=b()(v,2),x=g[0],w=g[1],k=function(e){"pencil"!==e&&"mark-pencil"!==e||(t.settings.freehand.shape=e),i(e)},E=function(e){t.settings.freehand.stroke=e,d(e)},O=function(e){t.settings.freehand.strokeWidth=e,y(e)};Object(Ot.useEffect)((function(){var e,r=function(e){var r=e.target;if(null!=r&&r.classList.contains("lake-icon-board-toolbar-pencil"))t.interaction.changeMode("free-hand"),k("pencil"),O(2),E("#595959");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-mark-pencil"))t.interaction.changeMode("free-hand"),k("mark-pencil"),O(8),E("#DFB85D");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-eraser")){var o,a;t.interaction.changeMode("eraser"),null==n||null===(o=n.spm)||void 0===o||null===(a=o.click)||void 0===a||a.call(o,"a385.b4693.c121188.d251469"),k("eraser")}};return null===(e=f.current)||void 0===e||e.addEventListener("click",r),function(){var e;return null===(e=f.current)||void 0===e?void 0:e.removeEventListener("click",r)}}),[]);var C="lake-diagram-toolbar-free-hand",A=function(e){E(e)};return Ct.a.createElement("div",{ref:f,className:"".concat(C,"-container")},Ct.a.createElement("div",{className:jt()("".concat(C,"-row"),c()({},"".concat(C,"-selected"),"pencil"===a))},Ct.a.createElement(Rt.a,{placement:"right",title:jr("铅笔")},Ct.a.createElement("span",{className:jt()("lake-icon","lake-icon-board-toolbar-pencil")}))),Ct.a.createElement("div",{className:jt()("".concat(C,"-row"),c()({},"".concat(C,"-selected"),"mark-pencil"===a))},Ct.a.createElement(Rt.a,{placement:"right",title:jr("马克笔")},Ct.a.createElement("span",{"data-testid":"free-hand-mark",className:jt()("lake-icon","lake-icon-board-toolbar-mark-pencil")}))),Ct.a.createElement("div",{className:jt()("".concat(C,"-row"),c()({},"".concat(C,"-selected"),"eraser"===a))},Ct.a.createElement(Rt.a,{placement:"right",title:jr("橡皮")},Ct.a.createElement("span",{"data-testid":"free-hand-eraser",className:jt()("lake-icon","lake-icon-board-toolbar-eraser")}))),"eraser"!==a&&Ct.a.createElement(Ct.a.Fragment,null,Ct.a.createElement("div",{className:"".concat(C,"-row")},Ct.a.createElement(Ft.a,{trigger:"click",visible:x,onVisibleChange:function(e){w(e)},content:Ct.a.createElement(Kb,{strokeWidth:m,setStrokeWidth:O}),placement:"rightTop"},Ct.a.createElement("div",{className:"".concat(C,"-stroke-width")},Ct.a.createElement(Rt.a,{placement:"right",title:jr("粗细")},Ct.a.createElement("div",null,Ct.a.createElement(Wb,{type:"freehand-stroke",strokeWidth:m,pen:a,onClick:function(){return w(!x)}})))))),Ct.a.createElement("div",{className:"".concat(C,"-row")},Ct.a.createElement(Xb,{color:s,defaultColor:"#595959",onSelect:A,onClear:function(){return A("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ct.a.createElement(Wb,{type:"context-cb-trans"})},Ct.a.createElement(Rt.a,{placement:"right",title:jr("颜色")},Ct.a.createElement("div",null,Ct.a.createElement(Wb,{type:"t-bg-color",fill:s})))))))},Qb={basic:"a385.b4693.c111722.d231218",flowchart:"a385.b4693.c111722.d231226",UML:"a385.b4693.c111722.d231225",ER:"a385.b4693.c111722.d231227",swimlane:"a385.b4693.c111722.d231186",DSL:{pyramid:"ca33306.da22351","segmented pyramid":"ca33306.da22352",stage:"ca33306.da22353",architecture:"ca33306.da22354"}};function $b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$b(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ex(e){var t=e.diagram,n=e.mini,r=e.onProperties,o=e.onSave,a=Object(Ot.useState)([]),i=b()(a,2),c=i[0],l=i[1];return Object(Ot.useEffect)((function(){if(t){var n=function(){var t=function(e){var t=e.focusMode,n=e.mini,r=e.readOnly,o=e.showProperties,a=e.boardWebProxy;return function(e){var t=e.diagram,n=e.mini,r=e.boardWebProxy;return[{align:"top-left",subItems:[{name:"save",type:"button",title:jr("保存"),hotkey:pe.ua.macos?"⌘+S":"Ctrl+S",noMini:!0,noReadOnly:!0,icon:"board-save",disabled:!1,execCommand:function(){return e.onSave&&e.onSave()}},{type:"separator",noMini:!0,noReadOnly:!0},{name:"undo",type:"button",title:jr("撤销"),hotkey:pe.ua.macos?"⌘+Z":"Ctrl+Z",icon:"board-undo",noMini:!0,noReadOnly:!0,disabled:function(e){return!e.command.enable("Undo")},execCommand:function(e){return e.command.execute("Undo")}},{name:"redo",title:jr("重做"),hotkey:pe.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"board-redo",noMini:!0,noReadOnly:!0,disabled:function(e){return!e.command.enable("Redo")},execCommand:function(e){return e.command.execute("Redo")}}],focusHidden:!0},{align:"top-right",subItems:[{name:"hand",type:"button",title:jr("拖拽"),noReadOnly:!0,hotkey:"Space",icon:"board-hand",active:function(e){return"dragCanvas"===e.interaction.currentMode},disabled:function(e){return!e.command.enable("ButtonDragCanvas")},execCommand:function(e){return e.command.execute("ButtonDragCanvas")}},{type:"separator",noReadOnly:!0},{name:"fitViewport",type:"button",title:jr("适应画布"),hotkey:pe.ua.macos?"⌘+Shift+=":"Ctrl+Shift+=",icon:"board-viewport-autofit",disabled:function(){return!1},execCommand:function(e){return e.command.execute("FitViewport")}},{type:"separator",noReadOnly:!0},{type:"custom",component:Ct.a.createElement(fb,{diagram:t}),show:function(){return!(n&&pe.ua.mobile)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"theme",type:"popover",title:jr("更换主题"),noReadOnly:!0,popoverPlacement:"bottomRight",icon:"board-toolbar-theme",overlay:function(e){var n=e.popoverVisible;return Ct.a.createElement("div",{className:"lake-board-toolbar-theme-setting"},Ct.a.createElement(Sb,{diagram:t}),Ct.a.createElement(Ob,{diagram:t,popoverVisible:n}))}},{name:"properties",type:"button",title:jr("打开设置"),noReadOnly:!0,icon:"board-setting",disabled:function(){return!1},execCommand:function(){e.onProperties&&e.onProperties()},noMini:!0}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:jr("隐藏工具栏"),hotkey:pe.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!0,icon:"board-toolbar-hide",disabled:!1,execCommand:function(){return e.setFocusMode&&e.setFocusMode(!0)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:jr("展开工具栏"),hotkey:pe.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!0,icon:"board-toolbar-show",disabled:!1,execCommand:function(){return e.setFocusMode&&e.setFocusMode(!1)}}],focusHidden:!1},{align:"left-middle",subItems:[{type:"button",name:"material",title:jr("素材库"),noReadOnly:!0,icon:Ct.a.createElement("span",{className:"lake-board-toolbar-material-icon",style:{backgroundImage:Nf()?"url(https://gw.alipayobjects.com/zos/bmw-prod/b0db2f07-dfa1-4ae8-86bc-baa44c9e42b1.svg)":"url(https://gw.alipayobjects.com/zos/bmw-prod/4bdfc4e6-e50c-493b-a809-33016c1f95e2.svg)"}}),execCommand:function(){null==e||e.onMaterialMaximize()}},{name:"iconfont",title:jr("插入 Iconfont"),type:"popover",noReadOnly:!0,icon:"board-iconfont",overlay:function(n){var r=n.setPopoverVisible;return Ct.a.createElement(gb,{diagram:t,boardWebProxy:null==e?void 0:e.boardWebProxy,onSelect:function(){r(!1)}})}},{type:"separator",noReadOnly:!0},{name:"hand",type:"button",title:"".concat(jr("选择")," V"),noReadOnly:!0,icon:"board-toolbar-select",active:function(e){return"edit"===e.interaction.currentMode},execCommand:function(e){"edit"!==e.interaction.currentMode&&e.interaction.changeMode("edit")}},{type:"popover",name:"free-hand",title:jr("画笔"),className:"free-hand"===t.interaction.currentMode||"eraser"===t.interaction.currentMode?"lake-diagram-toolbar-selected":"",icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-board-toolbar-free-hand"}),noReadOnly:!0,overlay:function(){return Ct.a.createElement(Zb,{diagram:t,boardWebProxy:r})},execCommand:function(e){return e.interaction.changeMode("free-hand")},onClick:function(){t.interaction.changeMode("free-hand")}},{type:"button",name:"pen",title:jr("矢量绘图"),active:function(e){return"pen"===e.interaction.currentMode},icon:Ct.a.createElement("span",{"data-testid":"toolbar-pen",className:"lake-icon lake-icon-board-toolbar-pen"}),noReadOnly:!0,execCommand:function(e){var t;e.penDrawInteract.clearCache(),null===(t=e.interaction)||void 0===t||t.changeMode("pen")}},{type:"button",name:"insertText",title:jr("文本"),noReadOnly:!0,hotkey:"T",icon:"board-insert-text",disabled:function(e){return!e.command.enable("BeginInsertText")},execCommand:function(e){return e.command.execute("BeginInsertText")}},{name:"board:insertShape",title:jr("图形"),hotkey:"S",type:"popover",noReadOnly:!0,icon:"board-insert-shape",execCommand:function(e){return e.command.execute("BeginInsertGeometry")},overlay:function(e){var n=e.onSelect,r=e.setPopoverVisible,o=e.popoverVisible;return Ct.a.createElement($g,{diagram:t,basicWithSwimlane:!0,groups:["basic","flowchart","DSL","UML","ER"],onSelect:function(r){var o,a=r.key,i=r.attr;n({key:a}),function(e,t){if(e){var n=uc.find((function(e){return e.name===t}));if(n)if("DSL"===n.category){var r=Qb[n.category];e.click(r[t])}else e.click(Qb[n.category],{shape:t})}}(null==e||null===(o=e.boardWebProxy)||void 0===o?void 0:o.spm,a),t.command.execute("BeginInsertGeometry",{shape:a,attr:i})},hide:function(){r(!1)},popoverVisible:o})}},{type:"popover",name:"insertEdge",title:jr("连线"),hotkey:pe.ua.macos?"⌘+L":"Ctrl+L",defaultKey:"straight-line-arrow",icon:"board-straight-line-arrow",noReadOnly:!0,disabled:function(e){return!e.command.enable("BeginInsertLine")},data:[{key:"straight-line-arrow",icon:"board-straight-line-arrow"},{key:"curve-line-arrow",icon:"board-curve-line-arrow"},{key:"elbow-line-arrow",icon:"board-elbow-line-arrow"}],onClick:function(){t.selector.clear(),t.command.execute("BeginInsertLine",t.settings.line)},onSelect:function(e){var n=e.key.split("-"),r=b()(n,3),o=r[0],a=r[2];t.command.execute("BeginInsertLine",{shape:o,marker:a})}},{type:"button",name:"insertMindmap",title:jr("思维导图"),hotkey:"M",icon:"board-mind",noReadOnly:!0,disabled:function(e){return!e.command.enable("MindmapBeginInsertStem")},execCommand:function(e){return e.command.execute("MindmapBeginInsertStem")}},{type:"separator",noReadOnly:!0},{name:"insertImage",title:jr("图片"),type:"upload",icon:"board-upload-image",noReadOnly:!0,accept:pe.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(","),disabled:!1,onChange:function(e){Rb(e,t)}}],focusHidden:!0}]}(e).map((function(e){if(t===e.focusHidden)return null;var i=e.subItems.filter((function(e){return e.show instanceof Function?e.show():(!n||!e.noMini)&&(!(!n&&e.noMaxim)&&((!r||!e.noReadOnly)&&(("properties"!==e.name||!o)&&(!!("material"!==e.name||null!=a&&a.material)&&!("iconfont"===e.name&&(null==a||!a.iconfont||null!=a&&null!==(t=a.iconfont)&&void 0!==t&&t.disable))))));var t}));return i.length>0?Jb(Jb({},e),{},{subItems:i}):null})).filter((function(e){return e}))}(e);l(t)};n();var r=function(e){e.isModelChange&&n()};return t.on("aftercommandexecute",r),t.on("aftermodechange",n),function(){t.off("aftercommandexecute",r),t.off("aftermodechange",n)}}return function(){return!1}}),[t,n,r,o]),Ct.a.createElement(Ub,{diagram:t,items:c,className:"lake-diagram-board-toolbar"})}function tx(e){var t=e.icon,n=e.title,r=e.hotkey;return Ct.a.createElement("div",null,t,n,r&&Ct.a.createElement("span",{className:"lake-context-menu-hotkey"},r))}function nx(e){var t=e.title,n=e.hotkey,r=e.accept,o=e.icon,a=e.onChange,i=Object(Ot.useRef)();return Ct.a.createElement("div",{className:"lake-board-context-menu-upload-item-content",onClick:function(e){e.stopPropagation(),i.current.click()}},o,t,n&&Ct.a.createElement("span",{className:"lake-context-menu-hotkey"},n),Ct.a.createElement("input",{type:"file",accept:r,onChange:a,ref:i}))}function rx(e,t){var n=e.disabled,r=e.title,o=e.key,a=e.hotkey,i=e.type,c=e.accept,l=e.onChange;if(e.data)return Ct.a.createElement(Dt.a.SubMenu,{key:o,title:r,disabled:n,popupClassName:"lake-context-submenu lake-prevent-card-activated lake-diagram-dialog-popover lake-diagram-prevent-mouse-select"},e.data.map(rx));if("separator"===i)return Ct.a.createElement(Dt.a.Divider,{key:o+"_"+t});var u,s="string"==typeof e.icon?Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}):e.icon;return u="upload"===i?Ct.a.createElement(nx,{icon:s,title:r,hotkey:a,accept:c,onChange:l}):Ct.a.createElement(tx,{icon:s,title:r,hotkey:a}),Ct.a.createElement(Dt.a.Item,{key:o,className:"ant-menu-item",disabled:n},u)}function ox(e){var t=e.coord,n=e.overlayClassName,r=e.diagram,o=e.onClose,a=Object(Ot.useState)(null),i=b()(a,2),c=i[0],l=i[1],u=Object(Ot.useRef)();if(Object(Ot.useEffect)((function(){if(t){var e=u.current.offsetParent.getBoundingClientRect();l([t[0]-e.x,t[1]-e.y])}else l(null)}),[t]),Object(Ot.useEffect)((function(){function e(){o()}function t(t){t.target.closest(".lake-diagram-dialog-popover")||e()}function n(){e()}return window.addEventListener("mousedown",t),window.addEventListener("scroll",e,{passive:!0}),r.on("afterviewportchange",n),function(){window.removeEventListener("mousedown",t),window.removeEventListener("scroll",e),r.off("afterviewportchange",n)}}),[r,o]),c){var s="lake-diagram-dialog-popover lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Ct.a.createElement(Ft.a,Et()({},e,{getPopupContainer:function(){return e.getPopupContainer?e.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||document.body},visible:!0,overlayClassName:n?n+" "+s:s}),Ct.a.createElement("div",{ref:u,style:{position:"absolute",left:"".concat(c[0],"px"),top:"".concat(c[1],"px"),pointerEvents:"none",width:"0px",height:"0px"}}))}return Ct.a.createElement("span",{ref:u})}function ax(e){var t=e.getMenuData,n=e.diagram,r=e.boardWebProxy,o=Object(Ot.useState)(e.coord),a=b()(o,2),i=a[0],c=a[1],l=Object(Ot.useState)(t()),u=b()(l,2),s=u[0],d=u[1],f=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{});Object(Ot.useEffect)((function(){function e(e){d(t()),c([e.clientX,e.clientY])}return n.on("contextmenu",e),function(){n.off("contextmenu",e)}}),[n]);var h=Ct.a.createElement("div",Et()({},f,{className:jt()("lake-context-menu",e.className)}),Ct.a.createElement(Dt.a,{className:"lake-context-submenu",onMouseDown:function(e){e.preventDefault()},onClick:function(t){var r=n.viewport.invertClient(i);e.onClick({key:t.key,canvasPoint:r}),c(null)},selectable:!1},s.map(rx)));return Ct.a.createElement(ox,{placement:"rightTop",content:h,visible:!0,overlayClassName:"lake-diagram-context-menu-popover ne-ignore-pointer-events",diagram:n,coord:i,onClose:function(){c(null)},boardWebProxy:r})}Ut("/* stylelint-disable */\n.lake-board-toolbar-material-icon {\n  width: 24px;\n  height: 24px;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.ant-btn > span.lake-board-toolbar-material-icon {\n  display: block;\n}\n.lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-board-toolbar-theme-setting {\n  border-radius: 8px;\n  background: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),ex.defaultProps={mini:!1,readOnly:!1,diagram:null,showProperties:!0,boardWebProxy:{},onProperties:function(){return!1},onSave:function(){return!1},onMaterialUse:function(){return!1},onMaterialMore:function(){return!1},onMaterialMaximize:function(){return!1}},ex.propTypes={mini:Pt.a.bool,readOnly:Pt.a.bool,diagram:Pt.a.object,showProperties:Pt.a.bool,onProperties:Pt.a.func,onSave:Pt.a.func,focusMode:Pt.a.bool,setFocusMode:Pt.a.func,boardWebProxy:Pt.a.object,onMaterialMore:Pt.a.func,onMaterialUse:Pt.a.func,onMaterialMaximize:Pt.a.func},tx.propTypes={title:Pt.a.string,hotkey:Pt.a.string,icon:Pt.a.node},Ut(".lake-board-context-menu-upload-item-content input {\n  display: none;\n}\n"),nx.propTypes={title:Pt.a.string,hotkey:Pt.a.string,icon:Pt.a.oneOf([Pt.a.string,Pt.a.node]),data:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func,accept:Pt.a.string},rx.propTypes={title:Pt.a.string,key:Pt.a.string,hotkey:Pt.a.string,type:Pt.a.string,disabled:Pt.a.bool,icon:Pt.a.oneOf([Pt.a.string,Pt.a.node]),data:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func,accept:Pt.a.string},Ut("/* stylelint-disable */\n.lake-diagram-dialog-popover .ant-popover-inner-content {\n  padding: 0;\n}\n"),ox.defaultProps={coord:null,diagram:null,onClose:function(){}},ox.propTypes={coord:Pt.a.array,diagram:Pt.a.object,onClose:Pt.a.func,overlayClassName:Pt.a.string,getPopupContainer:Pt.a.object},Ut("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-context-menu-popover {\n  z-index: 1033;\n}\n.lake-diagram-context-menu-popover .ant-popover-arrow {\n  display: none;\n}\n.lake-context-menu {\n  z-index: 13;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.13);\n}\n.lake-context-menu,\n.lake-context-submenu {\n  list-style-type: none !important;\n}\n.lake-context-menu li,\n.lake-context-submenu li {\n  margin-left: 0 !important;\n}\n.lake-context-menu .ant-menu,\n.lake-context-submenu .ant-menu {\n  border-radius: 2px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-context-menu .ant-menu .ant-menu-submenu,\n.lake-context-submenu .ant-menu .ant-menu-submenu,\n.lake-context-menu .ant-menu .ant-menu-item,\n.lake-context-submenu .ant-menu .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  min-width: 164px;\n}\n.lake-context-menu .ant-menu .ant-menu-item-active,\n.lake-context-submenu .ant-menu .ant-menu-item-active,\n.lake-context-menu .ant-menu .ant-menu-submenu-active,\n.lake-context-submenu .ant-menu .ant-menu-submenu-active {\n  background: var(--yq-bg-tertiary);\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-title,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-title {\n  height: auto;\n  line-height: inherit;\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after {\n  width: 5px;\n  height: 1px;\n  background-image: linear-gradient(90deg, var(--yq-yuque-grey-900), var(--yq-yuque-grey-900));\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-item,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-item {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-submenu,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-submenu {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-sub,\n.lake-context-submenu .ant-menu.ant-menu-sub {\n  width: auto;\n}\n.lake-context-menu .ant-menu.ant-menu-sub > li,\n.lake-context-submenu .ant-menu.ant-menu-sub > li {\n  width: auto;\n}\n.lake-context-menu .lake-icon,\n.lake-context-submenu .lake-icon {\n  display: inline-block;\n  margin-right: 0.25em;\n}\n.lake-context-menu-hotkey {\n  float: right;\n  color: var(--yq-text-caption);\n  margin-left: 16px;\n}\n"),ax.defaultProps={},ax.propTypes={className:Pt.a.string,coord:Pt.a.object,data:Pt.a.arrayOf(Pt.a.object),onClick:Pt.a.func,diagram:Pt.a.object,getMenuData:Pt.a.func,boardWebProxy:Pt.a.object};var ix=[{key:"Align",title:jr("对齐"),data:[{key:"AlignLeft",icon:"align-left",title:jr("左对齐"),hotkey:"Option+←"},{key:"AlignHCenter",icon:"align-h-center",title:jr("左右居中"),hotkey:"Option+H"},{key:"AlignRight",icon:"align-right",title:jr("右对齐"),hotkey:"Option+→"},{key:"DistributeHorizontally",icon:"distribute-horizontally",title:jr("水平均分")},{type:"separator"},{key:"AlignTop",icon:"align-top",title:jr("顶对齐"),hotkey:"Option+↑"},{key:"AlignVCenter",icon:"align-v-center",title:jr("上下居中"),hotkey:"Option+V"},{key:"AlignBottom",icon:"align-bottom",title:jr("底对齐"),hotkey:"Option+↓"},{key:"DistributeVertically",icon:"distribute-vertically",title:jr("垂直均分")}]},{key:"ZIndex",title:jr("层级"),data:[{key:"ToFront",title:jr("置顶"),hotkey:"⌘+]"},{key:"ToBack",title:jr("置底"),hotkey:"⌘+["},{key:"Forward",title:jr("上移一层"),hotkey:"\t⌘+Option+]"},{key:"Backward",title:jr("下移一层"),hotkey:"⌘+Option+["}]},{key:"AttachToVertex",title:jr("插入"),data:[{key:"AttachLink",title:jr("链接"),hotkey:"⌘+K"}]},{key:"MindmapAppendAbstract",title:jr("添加概要")},{key:"AttachToMindmapCell",title:jr("插入"),data:[{key:"MindmapAppendChild",title:jr("子级"),hotkey:"Tab"},{key:"MindmapAppendParent",title:jr("父级"),hotkey:"Option+Tab"},{key:"MindmapAppendSibling",title:jr("同级"),hotkey:"Enter"},{key:"separator",type:"separator"},{key:"AttachLink",title:jr("链接"),hotkey:"⌘+K"},{key:"MindmapAttachImage",title:jr("图片"),type:"upload",accept:pe.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(",")},{key:"MindmapAttachNote",title:jr("备注")}]},{key:"Cut",title:jr("剪切"),hotkey:"⌘+X"},{key:"Copy",title:jr("复制"),hotkey:"⌘+C"},{key:"CopyOtherFormat",title:jr("复制为其它格式"),data:[{key:"CopyDoc",title:jr("语雀文档")},{key:"CopyTable",title:jr("语雀表格")}]},{key:"Paste",title:jr("粘贴"),hotkey:"⌘+V"},{key:"Collapse",title:jr("折叠"),hotkey:"⌘+/"},{key:"Expand",title:jr("展开"),hotkey:"⌘+/"},{key:"MindmapAppendParent",title:jr("插入父级"),hotkey:"Option+Tab"},{key:"MindmapInsertStem",title:jr("添加思维导图"),hotkey:"M"},{key:"MindmapAppendSibling",title:jr("插入同级"),hotkey:"Enter"},{key:"MindmapAppendChild",title:jr("插入子级"),hotkey:"Tab"},{key:"ActualSize",title:jr("实际尺寸"),hotkey:"⌘+0"},{key:"FitViewport",title:jr("适应画布"),hotkey:"⌘+Shift+="},{key:"Delete",title:jr("删除"),hotkey:"Delete"},{key:"MindmapRemoveSingleNode",title:jr("删除单个节点"),hotkey:"⌘+Delete"},{key:"BeginInsertLine",title:jr("添加连线"),hotkey:"⌘+L"},{key:"BeginEditContent",title:jr("编辑文本")},{key:"separator",type:"separator"},{key:"InsertText",title:jr("添加文字"),hotkey:"T"},{key:"InsertGeometry",title:jr("添加图形"),hotkey:"S"},{key:"MakeGroup",title:jr("成组"),hotkey:"⌘+G"},{key:"Ungroup",title:jr("取消成组"),hotkey:"⌘+Shift+G"},{key:"AddMaterialLib",title:jr("添加到素材库")},{key:"SaveImage",title:jr("另存为图片")}],cx={};function lx(e,t){cx[e]=t}function ux(e){return cx[e]}function sx(e){return dx.apply(this,arguments)}function dx(){return(dx=de()(he.a.mark((function e(t){var n,r,o,a,i,c,l;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.arrayBuffer();case 3:return n=e.sent,e.next=6,crypto.subtle.digest("SHA-256",n);case 6:return r=e.sent,o=Array.from(new Uint8Array(r)),a=o.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(0),e.next=16,t.arrayBuffer();case 16:return i=e.sent,c=Array.from(new Uint8Array(i)),l=c.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",l.length>100&&l.substring(l.length-100,l.length));case 20:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function fx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function px(e,t){return e.every((function(t){return e.includes(t.stem)}))?t.deduplicate(e).filter((function(e){return e.isStem})):[]}function mx(e,t,n){return yx.apply(this,arguments)}function yx(){return(yx=de()(he.a.mark((function e(t,n,r){var o,a,i,c,l,u,s,d,f,h;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.destroyed){e.next=2;break}return e.abrupt("return");case 2:return t=px(t,n),o=t.reduce((function(e,t){return t.deepEach((function(t){e.push(t)})),e}),[]),e.next=6,n.exporter.blob("png",{cells:o,width:220});case 6:if(a=e.sent){e.next=10;break}return we.a.warn(jr("导出素材图片失败")),e.abrupt("return",!1);case 10:return i=Object(F.a)(),we.a.loading({content:jr("上传素材中"),key:i,duration:0}),c=Array.from(new Set(t.map((function(e){var t,n,r;return e.isImage&&(null===(t=e.model)||void 0===t||null===(n=t.image)||void 0===n||null===(r=n.uploadInfo)||void 0===r?void 0:r.hash)})))),l=c.map((function(e){var t;return null===(t=ux(e))||void 0===t?void 0:t.imageCdnPromise})),e.next=16,Promise.all(l);case 16:return u=new File([a],"lake_board_material.jpeg"),e.next=19,r.uploader.image(u);case 19:if(s=e.sent,we.a.destroy(i),s){e.next=24;break}return we.a.warn(jr("上传素材图片失败")),e.abrupt("return",!1);case 24:return d=n.exporter.json(t),f=Ar(o),e.next=28,r.material.create({cover:s,diagramData:d,graphicsBBox:hx(hx({},f),{},{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY})});case 28:return h=e.sent,e.abrupt("return",h);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}window.___lakeDiagramUploadFileHashMap=cx;var bx=ix.reduce((function(e,t){var n;return e[t.key]=t,t.hotkey&&(t.hotkey=(n=t.hotkey,pe.ua.macos?n:n.replace(/⌘/g,"Ctrl").replace(/Option/g,"Alt"))),e}),{});function xx(e,t){var n=e.key;e.disabled=!!t.command.find(n)&&!t.command.enable(n),"MindmapAttachImage"===n&&(e.onChange=function(e){Rb(e,t)})}function wx(e,t){return(e=e.filter((function(e){return null!=e}))).map((function(e,n){var r=gx(gx({},u()(bx[e])),{},{disabled:!!t.command.find(e)&&!t.command.enable(e)});return xx(r,t),r.data&&r.data.forEach((function(e){xx(e,t)})),"separator"===e&&(r.key=e+"-"+n),r}))}function kx(e){return e.command.enable("Expand")?["Expand"]:["Collapse"]}function Ex(e){var t=[],n=e.filter((function(e){return e.isStem}));return n.length>1&&t.push("Align"),n.length>0&&t.push("ZIndex"),t.length>0?t.push("separator"):t=null,t}function Ox(e){var t=[];return e.filter((function(e){return e.isStem})).length>1?(t.push("MakeGroup"),t.push("separator")):t=null,t}function Cx(e,t,n){var r=px(e,t),o=[];return e.length>0&&o.push("SaveImage"),n&&r.length>0&&!function(e){for(var t=e.reduce((function(e,t){return t.deepEach((function(t){e.push(t)})),e}),[]),n=t.reduce((function(e,t){return e[t.model.id]=t,e}),{}),r=t.filter((function(e){return e.isLine})),o=0;o<r.length;o++){var a,i,c,l,u=r[o],s=null===(a=u.model)||void 0===a||null===(i=a.target)||void 0===i?void 0:i.id,d=null===(c=u.model)||void 0===c||null===(l=c.source)||void 0===l?void 0:l.id;if(s&&!n[s]||d&&!n[d])return!0}return!1}(r)&&o.push("AddMaterialLib"),o.length>0?(o.push("separator"),o):null}function Ax(){return(Ax=de()(he.a.mark((function e(t,n,r,o){var a,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mx(t,n,r);case 2:(a=e.sent)&&((i=r.spm)&&i.click("b4693.c107432.d223055",{material_id:null==a?void 0:a.id}),o&&o(null==a?void 0:a.id));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Px(e){try{_c("copy",e),we.a.success(jr("复制成功"))}catch(e){we.a.error(jr("复制失败"))}}function Sx(e){var t=e.diagram,n=e.boardWebProxy,r=e.onAddMaterial,o=!(null==n||!n.material);return Ct.a.createElement(ax,{diagram:t,getMenuData:function(){return function(e,t){var n=t.materialLibEnable;return"read"===e.interaction.currentMode?function(e){var t=e.selector.selections,n=["ActualSize","FitViewport"];return t.length>0&&t.every((function(e){return e.isMindmap}))&&(n=["Copy"].concat(kx(e)).concat(["separator"]).concat(n)),wx(n,e)}(e):function(e,t){var n=e.selector.selections,r=[];return 0===n.length?r=["InsertText","InsertGeometry","BeginInsertLine","MindmapInsertStem","separator","Paste","separator","ActualSize","FitViewport"]:n.every((function(e){return e.isMindmap}))?(1===n.length&&(r=["AttachToMindmapCell","separator"]),sy(n,!0)&&r.push("MindmapAppendAbstract","separator"),r=r.concat(kx(e)).concat(["separator","Cut","Copy","CopyOtherFormat","Paste","separator"]).concat(Cx(n,e,t)).concat(Ex(n)).concat(Ox(n)).concat(["Delete","MindmapRemoveSingleNode"])):n.every((function(e){return e.isVertex}))?(1!==n.length||n[0].isImage||(r=["AttachToVertex","separator"]),r=r.concat(["Cut","Copy","Paste","separator"]).concat(Cx(n,e,t)).concat(Ex(n)).concat(Ox(n)).concat(["Delete"])):r=n.every((function(e){return e.isGroup}))?r.concat(["Cut","Copy","Paste","separator"]).concat(Cx(n,e,t)).concat(Ex(n)).concat(Ox(n)).concat(["Ungroup","separator"]).concat(["Delete"]):["Cut","Copy","Paste","separator"].concat(Cx(n,e,t)).concat(Ex(n)).concat(Ox(n)).concat(["Delete"]),wx(r,e)}(e,n)}(t,{materialLibEnable:o})},boardWebProxy:n,onClick:function(e){var o=e.key,a=e.canvasPoint;t.tryFocus();var i=t.selector.selections;switch(o){case"Cut":!function(e){try{_c("cut",e),we.a.success(jr("剪切成功"))}catch(e){we.a.error(jr("剪切失败"))}}(t);break;case"Copy":Px(t);break;case"CopyDoc":t.settings.copyType="doc",Px(t),t.settings.copyType="default";break;case"CopyTable":t.settings.copyType="table",Px(t),t.settings.copyType="default";break;case"Paste":!function(e,t){try{_c("paste",e,t)}catch(e){we.a.error(jr("粘贴失败"))}}(t,a);break;case"MindmapInsertStem":t.command.execute("MindmapInsertStem",{x:a[0],y:a[1]});break;case"InsertText":t.command.execute("InsertText",{x:a[0],y:a[1]});break;case"InsertGeometry":t.command.execute("InsertGeometry",{x:a[0],y:a[1]});break;case"AddMaterialLib":!function(e,t,n,r){Ax.apply(this,arguments)}(i,t,n,r);break;case"SaveImage":!function(e,t){t.exporter.download("png",{cells:Pc(e,t)})}(i,t);break;default:if(o)try{"MindmapAppendAbstract"===o&&n&&n.spm&&n.spm.click("b4693.c116586.d241682",{"right-click(MindmapAppendAbstract)":1}),t.command.execute(o)}catch(e){throw new Error("unknown command ".concat(o))}}t.tryFocus()}})}function jx(e){var t=e.diagram;return Ct.a.createElement("div",{className:"lake-diagram-properties-alignment"},Ct.a.createElement(qt.a.Group,{onChange:function(e){t.command.execute(e.target.value)},value:null},Ct.a.createElement(qt.a.Button,{value:"AlignLeft",disabled:!t.command.enable("AlignLeft")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-left"})),Ct.a.createElement(qt.a.Button,{value:"AlignHCenter",disabled:!t.command.enable("AlignHCenter")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-h-center"})),Ct.a.createElement(qt.a.Button,{value:"AlignRight",disabled:!t.command.enable("AlignRight")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-right"})),Ct.a.createElement(qt.a.Button,{value:"AlignTop",disabled:!t.command.enable("AlignTop")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-top"})),Ct.a.createElement(qt.a.Button,{value:"AlignVCenter",disabled:!t.command.enable("AlignVCenter")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-v-center"})),Ct.a.createElement(qt.a.Button,{value:"AlignBottom",disabled:!t.command.enable("AlignBottom")},Ct.a.createElement("span",{className:"lake-icon lake-icon-align-bottom"}))))}function Rx(e){var t=e.selections,n=e.diagram,r=t.filter((function(e){return e.canArrange()})).length<3;return Ct.a.createElement("div",{className:"lake-diagram-properties-distribute"},Ct.a.createElement(qt.a.Group,{onChange:function(e){n.command.execute(e.target.value)},value:null},Ct.a.createElement(qt.a.Button,{value:"DistributeHorizontally",disabled:r},Ct.a.createElement("span",{className:"lake-icon lake-icon-horizontally"})),Ct.a.createElement(qt.a.Button,{value:"DistributeVertically",disabled:r},Ct.a.createElement("span",{className:"lake-icon lake-icon-vertically"}))),Ct.a.createElement("div",{className:"lake-diagram-properties-distribute-label-group"},Ct.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},jr("水平均分")),Ct.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},jr("垂直均分"))))}function _x(e){var t=e.diagram,n=e.selections,r=t.getCells(),o=n.some((function(e){return e.locked}))||1===n.length&&n[0].getZIndex()===r.length-1,a=n.some((function(e){return e.locked}))||1===n.length&&0===n[0].getZIndex();function i(r){e.onChange((function(){t.command.execute(r.target.value,{cells:n})}))}return Ct.a.createElement("div",{className:"lake-diagram-properties-z-index"},Ct.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Ct.a.createElement(qt.a.Group,{onChange:i,value:null},Ct.a.createElement(Rt.a,{title:jr("置顶")},Ct.a.createElement(qt.a.Button,{value:"ToFront",disabled:o},Ct.a.createElement("span",{className:"lake-icon lake-icon-to-front"}))),Ct.a.createElement(Rt.a,{title:jr("置底")},Ct.a.createElement(qt.a.Button,{value:"ToBack",disabled:a},Ct.a.createElement("span",{className:"lake-icon lake-icon-to-back"}))))),Ct.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Ct.a.createElement(qt.a.Group,{onChange:i,value:null},Ct.a.createElement(Rt.a,{title:jr("上移")},Ct.a.createElement(qt.a.Button,{value:"Forward",disabled:o},Ct.a.createElement("span",{className:"lake-icon lake-icon-forward"}))),Ct.a.createElement(Rt.a,{title:jr("下移")},Ct.a.createElement(qt.a.Button,{value:"Backward",disabled:a},Ct.a.createElement("span",{className:"lake-icon lake-icon-backward"}))))))}function Mx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tx(e){var t=e,n=t.onBlur,r=t.onPressEnter,o=t.onStep,a=t.value,i=Object(Ot.useState)(null),c=b()(i,2),l=c[0],u=c[1];return e=Lx(Lx({},e),{},{value:"number"==typeof l?l:a,onChange:function(e){u(e)},onBlur:function(e){u(null),n&&n(e)},onPressEnter:function(e){u(null),r&&r(e)},onStep:function(e){u(null),o&&o(e)}}),Tx.propTypes={value:Pt.a.number,onStep:Pt.a.func,onBlur:Pt.a.func,onPressEnter:Pt.a.func},Ct.a.createElement(zt.a,e)}function Dx(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r={width:jr("宽"),height:jr("高")};function o(t,n){n>=1&&e.onChange(t,n)}return Ct.a.createElement(lb,{className:"lake-diagram-size-control",disabled:n},Object.keys(r).map((function(e){return Ct.a.createElement("div",{className:"lake-diagram-size-control-".concat(e),key:e},r[e],Ct.a.createElement(Tx,{disabled:n,min:1,max:2560,value:Math.round(lb.get(t,e)),onBlur:function(t){return o(e,parseFloat(t.target.value))},onPressEnter:function(t){return o(e,parseFloat(t.target.value))},onStep:function(t){return o(e,t)}}))})))}function Nx(e){var t=e.path,n=e.selections,r=0===n.length||n.some((function(e){return e.locked}));return Ct.a.createElement(lb,{className:"lake-diagram-ratio-control",disabled:r},Ct.a.createElement(Gt.a,{disabled:r,checked:lb.get(n,t),onChange:function(n){e.onChange(t,n.target.checked)}},jr("保持宽高比")))}function Bx(e){var t=e.selections,n=e.onChange,r=0===t.length||t.some((function(e){return e.locked}));return Ct.a.createElement(lb,{className:"lake-diagram-reset-size-control",disabled:r},Ct.a.createElement(_t.a,{disabled:r,onClick:function(){var e=t[0];e.isImage?n({width:e.image.naturalWidth,height:e.image.naturalHeight}):e.isVertex&&n({width:e.stencil.width,height:e.stencil.height})}},jr("原始大小")))}function Ix(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked}));function r(t,n){e.onChange(t,n)}return Ct.a.createElement(lb,{className:"lake-diagram-position-control",disabled:n},["x","y"].map((function(e){return Ct.a.createElement("div",{className:"lake-diagram-position-control-".concat(e),key:e},e.toUpperCase(),Ct.a.createElement(Tx,{disabled:n,value:Math.round(lb.get(t,e)),onBlur:function(t){return r(e,parseFloat(t.target.value))},onPressEnter:function(t){return r(e,parseFloat(t.target.value))},onStep:function(t){return r(e,t)}}))})))}function Fx(e){return""===e?e:"".concat(Math.round(e),"°")}function qx(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("°","");return""===e?e:parseInt(e,10)%360||0}function zx(e){var t=e.selections,n=0===t.length||t.some((function(e){return null==e.rotate}))||t.some((function(e){return e.locked}));function r(t){isFinite(t)&&e.onChange("rotate",t)}function o(e){var t=e.target.value.replace("°","");t<-180||t>180||r(parseFloat(t))}return Ct.a.createElement(lb,{className:"lake-diagram-rotate-control",disabled:n},jr("角度"),Ct.a.createElement(Tx,{disabled:n,min:-180,max:180,formatter:Fx,parser:qx,value:lb.get(t,"rotate"),onBlur:o,onPressEnter:o,onStep:r}))}function Gx(e){var t=e.selections,n=[],r=[];t.forEach((function(e){n.push(e.width,e.height),r.push(e.round)}));var o;o=r.every((function(e){return e===r[0]}))?r[0]:jr("多个值");var a=Math.min.apply(Math,n)/2,i=Le()((function(t){t=parseInt(t),isFinite(t)&&e.onChange("round",Jt(t,0,a))}),16);function c(e){i(e.target.value)}return Object(Ot.useEffect)((function(){return function(){return i.cancel()}})),Ct.a.createElement(lb,{className:"lake-diagram-opacity-control"},Ct.a.createElement(Yt.a,{min:0,max:a,step:1,tooltipVisible:!1,value:o,onChange:i}),Ct.a.createElement(Tx,{min:0,max:a,step:1,value:o,formatter:function(e){return Math.floor(Jt(e,0,a))},onBlur:c,onPressEnter:c,onStep:i}))}Sx.defaultProps={boardWebProxy:null,onAddMaterial:null},Sx.propTypes={diagram:Pt.a.object,boardWebProxy:Pt.a.object,onAddMaterial:Pt.a.func},Ut(".lake-diagram-properties-alignment {\n  margin-top: 8px;\n  margin-bottom: 16px;\n}\n.lake-diagram-properties-alignment .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-alignment .ant-radio-group label {\n  flex-grow: 1;\n  padding: 0;\n  text-align: center;\n}\n"),jx.defaultProps={},jx.propTypes={diagram:Pt.a.object.isRequired,selections:Pt.a.arrayOf(Pt.a.object).isRequired},jx.key="AlignControl",Ut(".lake-diagram-properties-distribute {\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-distribute .ant-radio-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute .ant-radio-button-wrapper {\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-distribute-label-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n"),Rx.propTypes={selections:Pt.a.arrayOf(Pt.a.object),diagram:Pt.a.object},Ut(".lake-diagram-properties-z-index {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-z-index .ant-radio-button-wrapper {\n  padding: 0 14px;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group {\n  width: calc(50% - 4px);\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group label {\n  text-align: center;\n  flex-grow: 1;\n  flex-shrink: 1;\n}\n"),_x.defaultProps={onChange:function(){}},_x.propTypes={onChange:Pt.a.func.isRequired,diagram:Pt.a.object.isRequired,selections:Pt.a.arrayOf(Pt.a.object).isRequired},_x.key="ZIndexControl",Ut(".lake-diagram-size-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-size-control-width,\n.lake-diagram-size-control-height {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-size-control-width .ant-input-number,\n.lake-diagram-size-control-height .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),Dx.propTypes={selections:Pt.a.array,onChange:Pt.a.func},Nx.defaultProps={path:"constraints.proportion"},Nx.propTypes={path:Pt.a.string,selections:Pt.a.array,onChange:Pt.a.func},Ut(".lake-diagram-reset-size-control .lake-diagram-control-body {\n  margin-top: 12px;\n}\n.lake-diagram-reset-size-control .ant-btn {\n  width: 100%;\n}\n"),Bx.propTypes={selections:Pt.a.array,onChange:Pt.a.func},Ut(".lake-diagram-position-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-position-control-x,\n.lake-diagram-position-control-y {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-position-control-x .ant-input-number,\n.lake-diagram-position-control-y .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),Ix.propTypes={selections:Pt.a.array,onChange:Pt.a.func},Ut(".lake-diagram-rotate-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n"),zx.propTypes={selections:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func},Ut(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n"),Gx.propTypes={selections:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func};var Yx=[{name:jr("排列"),hideHeader:!0,tabKey:"arrangement",condition:function(e){return e.length>0&&e.some((function(e){return e.isStem}))},controls:[{Control:jx},{Control:Rx},{Control:_x}]},{name:jr("位置"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return(e.isVertex&&e.isStem||e.isGroup)&&!Er(e)}))},controls:[{Control:Ix,display:function(e){return e.every((function(e){return e.isGroup}))||e.every((function(e){return!e.isGroup}))}}]},{name:jr("大小"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry&&e.isStem||e.isGroup}))},controls:[{Control:Dx,display:function(e){return e.every((function(e){return e.isGroup}))||e.every((function(e){return!e.isGroup}))}},{Control:Nx,display:function(e){return!e.some((function(e){return e.isGroup}))}},{Control:Bx,display:function(e){return!e.some((function(e){return e.isGroup}))}}]},{name:jr("圆角半径"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry&&e.canRound()}))},controls:[{Control:Gx}]},{name:jr("旋转"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.canRotate()&&!Er(e)}))},controls:[{Control:zx}]}];function Hx(e){var t=e.path,n=e.title,r=e.diagram,o=e.selections.filter((function(e){return e.canFill()})),a=0===o.length||o.some((function(e){return e.locked})),i=lb.get(o,t),c="multiValue"===i?"#FFFFFF":i;function l(n){e.onChange(t,n,su(o))}return Ct.a.createElement(lb,{disabled:a,title:n,extra:Ct.a.createElement(Xb,{disabled:a,color:c,defaultColor:e.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Ct.a.createElement("div",{className:jt()("lake-diagram-fill",{"lake-diagam-multi-properties-selection":"multiValue"===i}),style:"multiValue"===i?void 0:{backgroundColor:c}}))})}function Vx(e){var t=e.path,n=e.title,r=e.diagram,o=e.selections.filter((function(e){return e.canStroke()})),a=function(e,t){return lb.get(e,t)||(e.length>0&&!e[0].isStem?lb.get(e,"treeEdge.stroke"):void 0)}(o,t)||"rgba(0, 0, 0, 0)",i=0===o.length||o.some((function(e){return e.locked})),c="multiValue"===a?"#FFFFFF":a;function l(n){e.onChange(t,n,o)}return Ct.a.createElement(lb,{disabled:i,title:n||jr("颜色"),extra:Ct.a.createElement(Xb,{disabled:i,color:c,defaultColor:e.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Ct.a.createElement("div",{className:jt()("lake-diagram-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===a}),style:"multiValue"===a?void 0:{backgroundColor:c}}))})}function Ux(e){var t=e.selections,n=e.path,r=0===t.length||t.some((function(e){return e.locked})),o=t.filter((function(e){return e.canStrokeWidth()})),a=lb.get(o,n);function i(t){var r=Math.min(Math.max(t,1),10);r!==a&&e.onChange(n,r,o)}function c(e){i(parseFloat(e.target.value))}return Ct.a.createElement(lb,{className:"lake-diagram-stroke-width-control",disabled:r,title:jr("粗细"),extra:Ct.a.createElement(Tx,{disabled:r,min:1,max:10,value:a,onBlur:c,onPressEnter:c,onStep:i})})}Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-fill {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-fill {\n  display: none;\n}\n"),Hx.defaultProps={defaultColor:"transparent",title:jr("填充颜色"),onChange:function(){}},Hx.propTypes={defaultColor:Pt.a.string,selections:Pt.a.arrayOf(Pt.a.object).isRequired,path:Pt.a.string.isRequired,title:Pt.a.string,onChange:Pt.a.func.isRequired,diagram:Pt.a.object},Hx.key="FillControl",Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.disabled .lake-diagram-stroke {\n  display: none;\n}\n.lake-diagram-stroke {\n  border: 4px solid var(--yq-white);\n  height: 30px;\n}\n"),Vx.defaultProps={defaultColor:"transparent",onChange:function(){}},Vx.propTypes={defaultColor:Pt.a.string,selections:Pt.a.arrayOf(Pt.a.object).isRequired,path:Pt.a.string.isRequired,onChange:Pt.a.func.isRequired,title:Pt.a.string,diagram:Pt.a.object},Vx.key="StrokeControl",Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),Ux.defaultProps={onChange:function(){}},Ux.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,path:Pt.a.string.isRequired,onChange:Pt.a.func.isRequired},Ux.key="StrokeWidthControl",Ut(".lake-diagram-stroke-style-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-stroke-style-selected {\n  line-height: 0;\n}\n.lake-diagram-stroke-style-selected .lake-diagram-stroke-style-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-stroke-style-selected .lake-properties-stroke-style-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-stroke-style-selected .lake-diagram-properties-stroke-style {\n  width: 100%;\n  height: 100%;\n}\n");var Wx={none:"https://gw.alipayobjects.com/zos/bmw-prod/5e3dbea7-f3c3-418f-91de-cfbcb825343c.svg",dash:"https://gw.alipayobjects.com/zos/bmw-prod/3d7118e9-1bac-465d-acb9-cc0766ece25e.svg"};function Xx(e){var t=e.selections,n=e.path,r=0===t.length||t.some((function(e){return e.locked})),o=t.filter((function(e){return e.canStrokeStyle()})),a=lb.get(o,n);return Ct.a.createElement(lb,{className:"lake-diagram-properties-stroke-style",disabled:r,title:jr("样式"),extra:Ct.a.createElement(Tt.a,{disabled:r,trigger:["click"],overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var r=t.key;e.onChange(n,"none"===r?null:r,o)}},Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-none",key:"none",style:{backgroundImage:"url(".concat(Wx.none,")")}}),Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-dash",key:"dash",style:{backgroundImage:"url(".concat(Wx.dash,")")}})),placement:"bottomRight"},Ct.a.createElement("div",{className:"lake-diagram-stroke-style-selected"},Ct.a.createElement("span",{className:"lake-diagram-stroke-style-item lake-diagram-stroke-style-selected-item",style:{backgroundImage:"url(".concat(Wx[a||"none"],")")}}),Ct.a.createElement(tb,{className:"lake-properties-stroke-style-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}function Kx(e){return""===e?e:"".concat(Math.round(100*e),"%")}function Zx(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("%","");return""===e?e:Math.min(Math.max(parseFloat(e)/100||0,0),1)}function Qx(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r=parseFloat(lb.get(t,"opacity"))||1,o=Le()((function(t){isFinite(t)&&e.onChange("opacity",t)}),16);function a(e){o(Zx(e.target.value))}return Object(Ot.useEffect)((function(){return function(){return o.cancel()}})),Ct.a.createElement(lb,{className:"lake-diagram-opacity-control",disabled:n},Ct.a.createElement(Yt.a,{disabled:n,min:0,max:1,step:.01,tooltipVisible:!1,value:r,onChange:o}),Ct.a.createElement(Tx,{disabled:n,min:0,max:1,step:.01,value:r,formatter:Kx,parser:Zx,onBlur:a,onPressEnter:a,onStep:o}))}function $x(e){var t=Object(Ot.useRef)(),n=e.width,r=e.height,o=e.shape,a=o&&uc.find((function(e){return e.name===o}));return Object(Ot.useEffect)((function(){if(t.current&&a){var e=new Uf({stencil:a,width:n,height:r,noFill:!0,stroke:Bf("text"),fill:"transparent"}).rendererElement;Array.from(t.current.children,(function(e){return e.remove()})),t.current.appendChild(e)}}),[t,n,r,a]),a?Ct.a.createElement("svg",{ref:t,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}function Jx(e){var t,n=e.selections,r=0===n.length,o=n.filter((function(e){return e.isGeometry})),a=lb.get(o,e.path),i=(null===(t=uc[uc.findIndex((function(e){return e.name===a}))])||void 0===t?void 0:t.category)||"basic";return Ct.a.createElement(lb,{className:"lake-diagram-geometry-shape-control",disabled:r,title:jr("形状"),extra:Ct.a.createElement(Tt.a,{disabled:r,overlay:Ct.a.createElement("div",{className:"lake-diagram-properties-shape-select-container"},Ct.a.createElement(Xg,{onSelect:function(t){var n=t.key;e.onChange(e.path,n,o)},groups:[i]})),placement:"bottomRight",trigger:["click"]},Ct.a.createElement(_t.a,null,Ct.a.createElement("div",{className:jt()("lake-diagram-geometry-shape-current",{"multi-geometry-selection":"multiValue"===a})},Ct.a.createElement($x,{shape:a,width:32,height:32}))))})}Xx.defaultProps={onChange:function(){},path:"stroke.style"},Xx.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired,path:Pt.a.string.isRequired},Xx.key="StrokeStyleControl",Ut(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n"),Qx.propTypes={selections:Pt.a.arrayOf(Pt.a.object),onChange:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra .ant-btn {\n  background: none;\n  border: none;\n  height: 32px;\n  width: 100%;\n  padding: 0;\n}\n.lake-diagram-geometry-shape-control .multi-geometry-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-geometry-shape-control .lake-diagram-geometry-shape-current {\n  width: 100%;\n  min-height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-properties-shape-select-container {\n  background-color: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),$x.propTypes={width:Pt.a.number,height:Pt.a.number,shape:Pt.a.string},Jx.defaultProps={path:"shape",groups:["basic","flowchart"],onChange:function(){}},Jx.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,path:Pt.a.string.isRequired,groups:Pt.a.array,onChange:Pt.a.func.isRequired},Jx.key="GeometryShapeControl";var ew=[{name:jr("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry||kr(e)}))},controls:[{path:"shape",Control:Jx,display:function(e){return e.every((function(e){return"UML"!==e.category&&!Er(e)}))}},{path:"fill.color",Control:Hx}]},{name:jr("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry||Er(e)}))},controls:[{path:"stroke.color",Control:Vx},{path:"stroke.width",Control:Ux},{display:function(e){return e.every((function(e){return!wr(e)}))},Control:Xx}]},{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return(e.isGeometry||kr(e))&&null!=e.opacity}))},controls:[{Control:Qx}]}],tw=[{name:jr("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack}))},controls:[{path:"fill.color",Control:Hx}]},{name:jr("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack}))},controls:[{path:"stroke.color",Control:Vx},{path:"stroke.width",Control:Ux},{Control:Xx}]},{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack&&null!=e.opacity}))},controls:[{Control:Qx}]}];function nw(e){var t=e.selections,n=e.diagram,r=t.filter((function(e){return e.isMindmap})),o=Ma(r,lb),a=Object(Ot.useState)(!1),i=b()(a,2),c=i[0],l=i[1],u=r.map((function(e){return e.upDirection}));r.map((function(e){return e.upLayoutType}));var s=_a.filter((function(e){if(r.every((function(e){return e.isStem})))return!0;var n=e.key.split("-")[0],o=t.some((function(e){var t=e.upLayoutType,r=e.isAbstract;return Da(t,n,r)})),a=!e.directions.every((function(e){return u.every((function(t){return Ta(t,e)}))}));return!o&&!a}));function d(e){0!==s.length&&l(e)}return Ct.a.createElement(lb,{className:"lake-diagram-layout-control",title:jr("结构"),disabled:0===s.length,extra:Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(Ct.a.Fragment,null,s.map((function(t){var a=t.key;return Ct.a.createElement("div",{key:a,"data-lake_prevent_click_unselect":"true",className:jt()("lake-diagram-layout-thumb",{selected:a===o}),onClick:function(){d(!c),function(t){e.onChange("layout",La(t),r),n&&n.selector.select(r)}(a)}},Ct.a.createElement("div",{className:a}))}))),overlayClassName:"lake-diagram-layout-dropdown",placement:"bottomRight",onClick:function(){d(!c)},visible:c,onVisibleChange:function(e){d(e)},trigger:["click"]},Ct.a.createElement("div",{className:jt()("lake-diagram-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===o})},Ct.a.createElement("div",{className:"lake-diagram-layout-thumb"},Ct.a.createElement("div",{className:o}))))})}function rw(e){var t=e.selections,n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1],i=0===t.length;return Object(Ot.useEffect)((function(){var e=lb.get(t,"model.width");a("multiValue"===e?"multiValue":null!=e)}),[t]),Ct.a.createElement(lb,{disabled:i},Ct.a.createElement(Gt.a,{disabled:i,indeterminate:"multiValue"===o,checked:!!o,onChange:function(n){var r=n.target.checked?lb.get(t,"width"):null;a(n.target.checked),e.onChange({width:r,height:null})},"data-testid":"checkbox-node-width"},jr("手动设置节点尺寸")))}Ut("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.lake-diagram-layout-control .lake-diagram-control-extra {\n  padding: 0;\n  justify-content: space-around;\n}\n.lake-diagram-layout-dropdown {\n  width: 168px;\n  border-radius: 4px;\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n  flex-wrap: wrap;\n  background: var(--yq-bg-primary);\n  justify-content: initial;\n  padding: 8px 11px;\n}\n.lake-diagram-layout-dropdown.ant-dropdown-hidden {\n  display: none;\n}\n.lake-diagram-layout-thumb {\n  width: 48px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n}\n.lake-diagram-layout-thumb > div {\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n  width: 100%;\n  height: 100%;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb > div {\n  filter: invert(100%);\n}\n.lake-diagram-layout-thumb > .indent-bl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/bc67f2b4-b84a-4b09-970f-92bc893cdc1a.svg);\n}\n.lake-diagram-layout-thumb > .indent-br {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/103fb753-229b-4717-9e49-356f013b3309.svg);\n}\n.lake-diagram-layout-thumb > .indent-tr {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/15763057-474a-4b44-a999-3058a5328e9a.svg);\n}\n.lake-diagram-layout-thumb > .indent-tl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/44546c1d-75f7-4839-a198-6f7d4049798f.svg);\n}\n.lake-diagram-layout-thumb > .standard-t {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f2060601-21d5-4882-8159-01a1fa4c241a.svg);\n}\n.lake-diagram-layout-thumb > .standard-b {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f9e3e9f4-638c-46bb-ba35-9d9bf5a87f41.svg);\n}\n.lake-diagram-layout-thumb > .standard-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f7687207-ddcc-4e07-abfa-a9985f86e70a.svg);\n}\n.lake-diagram-layout-thumb > .standard-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/af8bdfa5-f0ae-446b-836e-1d0340d2f5c6.svg);\n}\n.lake-diagram-layout-thumb > .standard-h {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/069fa8cc-c99f-4d1b-98a5-371367ace0e5.svg);\n}\n.lake-diagram-layout-thumb > .timeline-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/56c34bb7-b888-4103-bc03-3124cd7b99a3.svg);\n}\n.lake-diagram-layout-thumb > .timeline-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/23f1801a-504c-4254-a5d2-f33fcee86de7.svg);\n}\n.lake-diagram-layout-thumb:hover,\n.lake-diagram-layout-thumb.selected {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background-color: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb.selected {\n  background-color: rgba(255, 255, 255, 0.12);\n}\n.lake-diagram-layout-current {\n  background: var(--yq-bg-primary);\n  width: 100%;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n"),nw.defaultProps={onChange:function(){}},nw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired,diagram:Pt.a.object},nw.key="LayoutControl",rw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},rw.key="NodeWidthControl",Ut("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-border-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-border-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-border-shape-selected .lake-diagram-border-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-border-shape-selected .lake-properties-border-shape-dropdown-icon {\n  width: 10x;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-border-shape-selected .lake-diagram-properties-border-shape {\n  width: 100%;\n  height: 100%;\n}\n");var ow=["line","rect","capsule"],aw={none:"https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg",line:"https://gw.alipayobjects.com/zos/bmw-prod/6ffe619f-04e8-48c7-af45-5f0f3cf2c4a1.svg",rect:"https://gw.alipayobjects.com/zos/bmw-prod/7b0ba540-6360-430b-a960-90c928ca037c.svg",capsule:"https://gw.alipayobjects.com/zos/bmw-prod/3818284f-32e3-44cb-875c-1b722074ddaa.svg"};function iw(e){var t=e.selections,n=lb.get(t,"border.shape","line")||null,r=t.length>0&&t.some((function(e){return e.isStem})),o=t.length>0&&t.some((function(e){return e.isAbstract})),a=r||o?ow.filter((function(e){return"line"!==e})):ow,i=a.find((function(e){return e===n}))?n:"",c=0===t.length;return Ct.a.createElement(lb,{className:"lake-diagram-properties-border-shape",disabled:c,title:jr("节点形状"),extra:Ct.a.createElement(Tt.a,{disabled:c,trigger:["click"],overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,onClick:function(n){var r=n.key;e.onChange("border.shape",r,t)}},a.map((function(e){return Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-border-shape-item","test-id":"lake-diagram-border-shape-item-".concat(e),key:e,style:{backgroundImage:"url(".concat(aw[e],")")}})}))),placement:"bottomRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},Ct.a.createElement("div",{className:"lake-diagram-border-shape-selected"},Ct.a.createElement("span",{className:"lake-diagram-border-shape-item lake-diagram-border-shape-selected-item",style:{backgroundImage:"url(".concat(aw[i||"none"],")")}}),Ct.a.createElement(tb,{className:"lake-properties-border-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}function cw(e){var t=e.selections.filter((function(e){return e.canStroke()&&e.isMindmap})),n=0===t.length,r=lb.get(t,"border.stroke-width");function o(n){var o=Math.min(Math.max(n,1),10);o!==r&&e.onChange("border.stroke-width",o,t)}function a(e){o(parseFloat(e.target.value))}return Ct.a.createElement(lb,{className:"lake-diagram-border-stroke-width-control",disabled:n,title:jr("边框粗细"),extra:Ct.a.createElement(Tx,{disabled:n,min:1,max:10,value:r,onBlur:a,onPressEnter:a,onStep:o})})}function lw(e){var t=an(e.selections.map((function(e){return e.stem}))),n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1];return Object(Ot.useEffect)((function(){a(lb.get(t,"rainbow"))}),[t]),Ct.a.createElement(lb,null,Ct.a.createElement(Gt.a,{indeterminate:"multiValue"===o,checked:!!o,onChange:function(n){var r=n.target.checked;a(r),e.onChange("rainbow",r,t)}},jr("彩虹分支")))}function uw(e){var t=an(e.selections.map((function(e){return e.stem}))),n=lb.get(t,"tapered");return Ct.a.createElement(lb,null,Ct.a.createElement(Gt.a,{indeterminate:"multiValue"===n,checked:!!n,onChange:function(n){var r=n.target.checked;e.onChange("tapered",r,t)}},jr("分支线条宽度逐渐变细")))}function sw(e){var t=e.selections,n=e.onChange,r=an(t.map((function(e){return e.stem}))),o=lb.get(r,"treeEdge.shape",null);o="multiValue"===o?null:void 0===o?"curve":o;var a=0===t.length;return Ct.a.createElement(lb,{className:"lake-diagram-properties-edge-shape",disabled:a,title:jr("分支类型"),extra:Ct.a.createElement(qt.a.Group,{disabled:a,value:o,onChange:function(e){var t="curve"===e.target.value?null:e.target.value;n("treeEdge.shape",t,r)}},Ct.a.createElement(qt.a.Button,{value:"curve"},Ct.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"})),Ct.a.createElement(qt.a.Button,{value:"polyline"},Ct.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"})))})}function dw(e){var t=e.selections,n=e.diagram,r=lb.get(t,"treeEdge.stroke","#A287E1"),o="multiValue"===r?"#FFFFFF":r;return Ct.a.createElement(lb,{disabled:0===t.length,title:jr("分支颜色"),extra:Ct.a.createElement(Xb,{disabled:0===t.length,color:o,onSelect:function(t){e.onChange("treeEdge.stroke",t)},diagram:n},Ct.a.createElement("div",{className:jt()("lake-diagram-tree-edge-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Ct.a.createElement("svg",{width:"64",viewBox:"0 0 64 12",xmlns:"http://www.w3.org/2000/svg"},Ct.a.createElement("path",{d:"M64 2c-27.42 0-35.012 8-64 8",stroke:"multiValue"===r?"none":r,strokeWidth:"4",fill:"none",fillRule:"evenodd"}))))})}function fw(e){var t=e.selections.filter((function(e){return e.isMindmap&&!e.isStem})),n=0===t.length,r=lb.get(t,"treeEdge.stroke-width");function o(n){var o=Math.min(Math.max(n,1),5);"number"==typeof o&&o!==r&&e.onChange("treeEdge.stroke-width",o,t)}function a(e){o(parseFloat(e.target.value))}return Ct.a.createElement(lb,{className:"lake-diagram-tree-edge-stroke-width-control",disabled:n,title:jr("分支粗细"),extra:Ct.a.createElement(Tx,{disabled:n,min:1,max:5,value:r,onBlur:a,onPressEnter:a,onStep:o})})}iw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},iw.key="BorderShapeControl",Ut("/* stylelint-disable */\n.lake-diagram-border-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),cw.defaultProps={onChange:function(){}},cw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},cw.key="BorderStrokeWidthControl",lw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func},lw.key="TreeEdgeRainbowControl",uw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func},uw.key="TreeEdgeTaperedControl",Ut(".lake-diagram-properties-edge-shape .lake-diagram-control-extra {\n  border: none;\n}\n.lake-diagram-properties-edge-shape .lake-diagram-control-extra button {\n  padding: 0 13px;\n}\n"),sw.defaultProps={onChange:function(){}},sw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},sw.key="TreeEdgeShapeControl",Ut(".lake-diagram-tree-edge-stroke {\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n"),dw.defaultProps={onChange:function(){}},dw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired,diagram:Pt.a.object},dw.key="TreeEdgeStrokeControl",Ut("/* stylelint-disable */\n"),fw.defaultProps={onChange:function(){}},fw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},fw.key="TreeEdgeStrokeWidthControl";var hw=[{name:jr("布局"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap}))},controls:[{Control:nw}]},{name:jr("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap}))},controls:[{Control:iw},{path:"border.fill",Control:Hx},{path:"border.stroke",title:jr("边框颜色"),Control:Vx},{Control:cw},{Control:rw}]},{name:jr("分支"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap&&e.isStem}))},controls:[{Control:lw},{Control:uw},{Control:sw}]},{name:jr("分支"),tabKey:"style",condition:function(e){return e.length>0&&!e.every((function(e){return e.isStem}))&&e.every((function(e){return e.isMindmap&&!e.isStem}))},controls:[{Control:dw},{Control:fw},{Control:sw},{Control:lw},{Control:uw}]}];Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-dropdown-input {\n  position: relative;\n  overflow: hidden;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  transition: border-color 0.3s;\n}\n.lake-diagram-dropdown-input:hover {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-dropdown-input-focus {\n  border-color: var(--yq-yuque-green-500);\n  box-shadow: 0 0 0 2px rgba(11, 208, 125, 0.2);\n  outline: none;\n}\n.lake-diagram-dropdown-input .ant-input {\n  padding-right: 24px;\n  border: none;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger {\n  position: absolute;\n  top: -1px;\n  right: -1px;\n  padding: 0;\n  border-width: 0 0 0 1px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  width: 24px;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon {\n  position: absolute;\n  right: 8px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  border: 4px solid;\n  border-color: var(--yq-yuque-grey-7) transparent transparent transparent;\n  box-sizing: border-box;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon::before {\n  content: ' ';\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger:hover {\n  background: var(--yq-bg-tertiary);\n  border-color: var(--yq-border-primary);\n}\n");var pw=["disabled"];function mw(e){var t=e.disabled,n=Lt()(e,pw),r=Object(Ot.useState)(e.value),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)(!1),l=b()(c,2),u=l[0],s=l[1];return Object(Ot.useEffect)((function(){i(e.value)}),[e.value]),Ct.a.createElement("div",{className:jt()("lake-diagram-dropdown-input",{"lake-diagram-dropdown-input-focus":u})},Ct.a.createElement(Nt.a,{disabled:t,value:a,onFocus:function(){s(!0)},onBlur:function(t){parseInt(t.target.value,10)>0&&e.onChange(t),s(!1)},onChange:function(e){i(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&parseInt(t.target.value,10)>0&&(e.onChange(t),t.target.select())}}),Ct.a.createElement(Tt.a,Et()({disabled:t},n),Ct.a.createElement(_t.a,null,Ct.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}))))}function yw(e){var t=e.selections,n=e.diagram,r=0===t.length||t.some((function(e){return e.locked})),o=Object(Ot.useState)({}),a=b()(o,2),i=a[0],c=a[1],l=n.contentEditorPlus,u=i.fontSize,s=i.color,d=i.bold,f=i.italic,h=i.strikethrough,p=i.underline;return Object(Ot.useEffect)((function(){function e(e){var t=e.query;c(t)}return l.emitQueryChange(),n&&l.on("querychange",e),function(){l.off("querychange",e)}}),[n]),Ct.a.createElement(lb,{disabled:r,className:"text-format-control"},Ct.a.createElement("div",{className:"text-format-li",style:{display:"flex",justifyContent:"space-between"}},Ct.a.createElement("span",{style:{display:"flex",flexWrap:"nowrap"}},Ct.a.createElement(_t.a,{disabled:r,className:jt()("bisu-btn",{active:d}),onClick:function(){return l.execCommand("bold")}},Ct.a.createElement("span",{className:"lake-icon lake-icon-bold"})),Ct.a.createElement(_t.a,{disabled:r,className:jt()("bisu-btn",{active:f}),onClick:function(){return l.execCommand("italic")}},Ct.a.createElement("span",{className:"lake-icon lake-icon-italic"})),Ct.a.createElement(_t.a,{disabled:r,className:jt()("bisu-btn",{active:h}),onClick:function(){return l.execCommand("strikethrough")}},Ct.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})),Ct.a.createElement(_t.a,{disabled:r,className:jt()("bisu-btn",{active:p}),onClick:function(){return l.execCommand("underline")}},Ct.a.createElement("span",{className:"lake-icon lake-icon-underline"})))),Ct.a.createElement("div",{className:"text-format-li text-format-font-color"},jr("字号"),Ct.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Ct.a.createElement(mw,{disabled:r,trigger:["click"],value:u,onChange:function(e){return l.execCommand("fontSize",parseInt(e.target.value))},overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none text-format-font-size-menu",selectedKeys:[u&&u.toString()],onClick:function(e){var t=e.key;return l.execCommand("fontSize",parseInt(t))}},[12,14,16,18,22,24,32,36,48,64,92].map((function(e){return Ct.a.createElement(Dt.a.Item,{key:e},e===u&&Ct.a.createElement("span",{className:"lake-icon lake-icon-success"}),e,"px")}))),placement:"bottomRight"}))),Ct.a.createElement("div",{className:"text-format-li text-format-font-color"},jr("文本颜色"),Ct.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Ct.a.createElement(Xb,{disabled:r,color:s,defaultColor:e.defaultColor,onSelect:De()((function(e){return l.execCommand("foreColor",e)}),16),diagram:n},Ct.a.createElement("div",{className:"lake-diagram-font-color",style:{backgroundColor:s}})))))}mw.propTypes={value:Pt.a.oneOfType([Pt.a.string,Pt.a.number]),disabled:Pt.a.bool,onChange:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-format-control .text-format-font-color {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.text-format-control .text-format-li {\n  margin-bottom: 16px;\n}\n.text-format-control .text-format-li:last-child {\n  margin-bottom: 0;\n}\n.text-format-control .lake-diagram-control-extra {\n  display: inline-block;\n  vertical-align: bottom;\n  margin-left: 8px;\n}\n.text-format-control .lake-diagram-font-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 30px;\n}\n.text-format-control.disabled .lake-diagram-font-color {\n  display: none;\n}\n.text-format-control .control-body {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.text-format-control .bisu-btn {\n  padding: 0;\n  text-align: center;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n}\n.text-format-control .bisu-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.text-format-control .bisu-btn.active {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-control-extra.lake-diagrm-font-color-control-extra {\n  width: auto;\n  flex: auto;\n  max-width: 90px;\n}\n.text-format-font-size {\n  max-width: 90px;\n  display: inline-block;\n  flex: auto;\n  height: 32px;\n  line-height: 30px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 0 8px;\n  font-size: 14px;\n  font-weight: 400;\n}\n.text-format-font-size[disabled] {\n  color: var(--yq-text-caption);\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-font-size .lake-icon-arrow-down {\n  width: 8px;\n  height: 8px;\n  float: right;\n  margin-top: 12px;\n  background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA4IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Mi41ICg2NzQ2OSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPkdyb3VwIENvcHkgNjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuNDUiPg0KICAgICAgICA8ZyBpZD0idG9vbGJhciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyOC4wMDAwMDAsIC0xOC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJwYXJhZ3JhcGgtc3R5bGUiPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyNi4wMDAwMDAsIDQuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC1Db3B5LTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMi4wMDAwMDAsIDEyLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjgiIGhlaWdodD0iOCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTAuNTk2MDkzNzUsMi41NTcwMzEyNSBMMy43NDUzMTI1LDYuMzc4MTI1IEMzLjg3NzM0Mzc1LDYuNTI1NzgxMjUgNC4xMDg1OTM3NSw2LjUyNTc4MTI1IDQuMjQwNjI1LDYuMzc4MTI1IEw3LjQwNTQ2ODc1LDIuNTU3MDMxMjUgQzcuNTk2MDkzNzUsMi4zNDI5Njg3NSA3LjQ0NDUzMTI1LDIuMDAzOTA2MjUgNy4xNTc4MTI1LDIuMDAzOTA2MjUgTDAuODQ0NTMxMjUsMi4wMDM5MDYyNSBDMC41NTcwMzEyNSwyLjAwMzkwNjI1IDAuNDA0Njg3NSwyLjM0Mjk2ODc1IDAuNTk2MDkzNzUsMi41NTcwMzEyNSBaIiBpZD0iU2hhcGUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPg0KICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+) no-repeat;\n}\n.text-format-font-size .lake-icon-arrow-down::before {\n  display: none;\n}\n.text-format-font-size-menu {\n  min-width: 104px;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n.text-format-color {\n  margin-top: 8px;\n  width: 92px;\n  height: 32px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 4px;\n}\n.text-format-color-indicator {\n  width: 100%;\n  height: 100%;\n}\n.text-format-color[disabled] {\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-color[disabled]-indicator {\n  display: none;\n}\n"),yw.defaultProps={defaultColor:"rgb(38, 38, 38)"},yw.propTypes={defaultColor:Pt.a.string,selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired,diagram:Pt.a.object.isRequired},yw.key="TextBasicFormat",Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-h-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n");var vw={left:"justifyLeft",center:"justifyCenter",right:"justifyRight",justify:"justifyFull"};function gw(e){var t=e.selections,n=e.diagram,r=0===t.length||t.some((function(e){return e.locked})),o=Object(Ot.useState)({}),a=b()(o,2),i=a[0],c=a[1],l=n.contentEditorPlus,u=i.textAlign;return Object(Ot.useEffect)((function(){function e(e){var t=e.query;c(t)}return l.emitQueryChange(),n&&l.on("querychange",e),function(){l.off("querychange",e)}}),[n]),Ct.a.createElement(lb,{disabled:r,className:"text-format-control"},Ct.a.createElement(qt.a.Group,{className:"text-format-li properties-text-format-text-h-align",disabled:r,defaultValue:vw.left,value:vw[u]},Ct.a.createElement(qt.a.Button,{value:vw.left,onClick:function(){return l.execCommand(vw.left)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-left"})),Ct.a.createElement(qt.a.Button,{value:vw.center,onClick:function(){return l.execCommand(vw.center)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-center"})),Ct.a.createElement(qt.a.Button,{value:vw.right,onClick:function(){return l.execCommand(vw.right)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-right"})),Ct.a.createElement(qt.a.Button,{value:vw.justify,onClick:function(){return l.execCommand(vw.justify)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-justify"}))))}function bw(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r=lb.get(t,"textVerticalAlign");return Yr.includes(r)||(r="middle"),Ct.a.createElement(lb,{disabled:n,className:"text-format-control"},Ct.a.createElement(qt.a.Group,{className:"text-format-li properties-text-format-text-v-align",disabled:n,defaultValue:"middle",value:r},Gr.map((function(n){var r=n.key,o=n.icon;return Ct.a.createElement(qt.a.Button,{key:r,value:r,onClick:function(){return function(n){e.onChange("textVerticalAlign",n,su(t))}(r)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(o)}))}))))}function xw(e){var t=e.diagram;return Ct.a.createElement(_t.a,{block:!0,onClick:function(){t.command.execute("AttachLink")}},jr("添加链接"))}gw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,diagram:Pt.a.object.isRequired},gw.key="TextHAlign",Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-v-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n"),bw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,diagram:Pt.a.object.isRequired,onChange:Pt.a.func.isRequired},bw.key="TextVAlign",xw.propTypes={diagram:Pt.a.object.isRequired},xw.key="TextLink";var ww=[{name:jr("基础格式"),hideHeader:!0,tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canUpdateText()}))},controls:[{Control:yw}]},{name:jr("对齐方式"),tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canUpdateText()}))},controls:[{Control:gw},{Control:bw,display:function(e){return e.some((function(e){return e.canTextVerticalAlign()}))}}]},{name:jr("链接"),tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canText()&&!fr(e)}))},controls:[{Control:xw}]}];function kw(e){var t=e.selections,n=e.diagram,r=0===t.length,o=t.filter((function(e){return e.isLine})),a={source:jr("起点"),target:jr("终点")},i=Object.keys(a).map((function(t){var n,a="".concat(t,".marker"),i=lb.get(o,a)||"none";return Ct.a.createElement("div",{className:"lake-diagram-line-arrow-control-".concat(t),key:t},Ct.a.createElement(Tt.a,{disabled:r,trigger:["click"],overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var n=t.key;e.onChange(a,"none"===n?null:n,o)},style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Fs.map((function(e){return Ct.a.createElement(Dt.a.Item,{className:jt()("lake-diagram-line-endpoint-item",{active:e===i}),"test-id":"lake-diagram-line-endpoint-item-".concat(e),key:e,style:{textAlign:"center"}},Ct.a.createElement("span",{className:jt()("lake-icon lake-icon-contextual-".concat(e),{source:"source"===t})}))}))),placement:"bottomRight"},Ct.a.createElement("div",{className:jt()("lake-diagram-line-arrow-selected")},Ct.a.createElement("span",{className:jt()("lake-diagram-line-arrow-selected-item","lake-icon",(n={"lake-diagam-multi-properties-selection":"multiValue"===i},c()(n,"lake-icon-contextual-".concat(i),i),c()(n,"source","source"===t),n))}),Ct.a.createElement(tb,{className:"lake-properties-line-arrow-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}}))))}));return i.splice(1,0,Ct.a.createElement("span",{key:"lake-icon-contextual-line-swap-endpoint",onClick:function(){n.command.execute("LineSwapEndpoint",{autoSelect:!0})},style:{fontSize:"14px",cursor:"pointer"},className:"lake-icon lake-icon-contextual-line-swap-endpoint"})),Ct.a.createElement(lb,{className:"lake-diagram-line-arrow-control",disabled:r},i)}Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-line-arrow-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 16px;\n}\n.lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.lake-diagram-line-endpoint-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-endpoint-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-arrow-selected {\n  line-height: 0;\n}\n.lake-diagram-line-arrow-selected .lake-diagram-line-arrow-selected-item {\n  width: 32px;\n  height: 32px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.lake-diagram-line-arrow-selected .lake-properties-line-arrow-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-arrow-selected .lake-diagram-properties-line-arrow {\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-line-arrow-control-source,\n.lake-diagram-line-arrow-control-target {\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-line-arrow-control-source .lake-diagram-line-arrow-selected,\n.lake-diagram-line-arrow-control-target .lake-diagram-line-arrow-selected {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n"),kw.defaultProps={onChange:function(){}},kw.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired,diagram:Pt.a.object},kw.key="LineArrowControl",Ut('.lake-diagram-line-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n  text-align: center;\n}\n.lake-diagram-line-shape-item > img {\n  margin: auto;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-item > img {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected .lake-properties-line-shape-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-shape-selected .lake-diagram-properties-line-shape {\n  width: 100%;\n  height: 100%;\n}\n');var Ew={none:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",straight:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",curve:"https://gw.alipayobjects.com/zos/bmw-prod/e683ab4e-70b3-4bcf-8eb1-ad843acf2add.svg",elbow:"https://gw.alipayobjects.com/zos/bmw-prod/96671966-3f77-469f-afa7-40ff402dc773.svg"};function Ow(e){var t=e.selections,n=0===t.length,r=t.filter((function(e){return e.isLine})),o=lb.get(r,"shape");return Ct.a.createElement(lb,{className:"lake-diagram-properties-line-shape",disabled:n,title:jr("类型"),extra:Ct.a.createElement(Tt.a,{disabled:n,trigger:["click"],overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var n=t.key;e.onChange("shape","none"===n?null:n,r)}},Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-none",key:"none"},Ct.a.createElement("img",{src:Ew.none,alt:jr("直线")})),Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-curve",key:"curve"},Ct.a.createElement("img",{src:Ew.curve,alt:jr("曲线")})),Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-elbow",key:"elbow"},Ct.a.createElement("img",{src:Ew.elbow,alt:jr("折线")}))),placement:"bottomRight"},Ct.a.createElement("div",{className:"lake-diagram-line-shape-selected"},Ct.a.createElement("span",{className:"lake-diagram-line-shape-item lake-diagram-line-shape-selected-item",style:{backgroundImage:"url(".concat(Ew[o||"none"],")")}}),Ct.a.createElement(tb,{className:"lake-properties-line-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}Ow.defaultProps={onChange:function(){}},Ow.propTypes={selections:Pt.a.arrayOf(Pt.a.object).isRequired,onChange:Pt.a.func.isRequired},Ow.key="LineShapeControl";var Cw=[{name:jr("线条"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:Ow},{path:"stroke.color",Control:Vx},{path:"stroke.width",Control:Ux},{Control:Xx}]},{name:jr("端点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:kw}]},{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:Qx}]}],Aw=[{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isImage&&null!=e.opacity}))},controls:[{Control:Qx}]}],Pw=function(e){var t,n=e.diagram;n.selector.selections.length>0&&(t=n.selector.selections[0]);var r,o=0;t&&(gr(t)&&(t=t.parent),o=(null===(r=t.children)||void 0===r?void 0:r.length)||0);var a=Object(Ot.useState)(o),i=b()(a,2),c=i[0],l=i[1];function u(e){ze()(e)&&(e=Jt(e,1,50))!==o&&(n.command.execute("ChangeLaneNumber",{number:e}),l(e))}return Ct.a.createElement(Tx,{min:1,max:50,value:c,onBlur:function(){},onPressEnter:function(e){u(Number(e.target.value))},onStep:u})},Sw=function(e){var t=e.title,n=e.diagram;return Ct.a.createElement(lb,{title:t,extra:Ct.a.createElement(Pw,{diagram:n})})};Sw.defaultProps={title:jr("泳道数"),onChange:function(){}},Sw.propTypes={title:Pt.a.string,diagram:Pt.a.object},Sw.key="LaneNumberControl";var jw=[{name:jr("泳道"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return vr(e)}))},controls:[{display:function(e){return 1===e.length&&vr(e[0])},Control:Sw},{path:"fill.color",Control:Hx}]},{name:jr("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return vr(e)}))},controls:[{path:"stroke.color",Control:Vx},{path:"stroke.width",Control:Ux},{Control:Xx}]},{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return vr(e)}))},controls:[{Control:Qx}]}];function Rw(e){if(e.length<1)return!1;var t=e[0],n=gr(t)?t.parent:void 0;return!!n&&e.every((function(e){return e.parent===n}))}var _w=[{name:jr("泳道"),tabKey:"style",condition:function(e){return Rw(e)},controls:[{display:function(e){return Rw(e)},Control:Sw},{path:"fill.color",Control:Hx}]}],Mw=[{name:jr("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return dr(e)}))},controls:[{path:"fill.color",Control:Hx}]},{name:jr("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return dr(e)}))},controls:[{path:"stroke.color",Control:Vx},{path:"stroke.width",Control:Ux},{Control:Xx}]},{name:jr("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return dr(e)}))},controls:[{Control:Qx}]},{name:jr("编辑"),tabKey:"style",condition:function(e){return 1===e.length&&e.every((function(e){return dr(e)}))},controls:[{Control:function(e){var t=e.diagram;return Ct.a.createElement(_t.a,{block:!0,onClick:function(){t.command.execute("OpenDslEditNote")}},jr("编辑"))}}]}];Ut(".lake-diagram-properties-viewport .lake-diagram-control-extra {\n  display: inline-block;\n  width: auto;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected-name {\n  display: inline-block;\n  padding-left: 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 30px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-icon {\n  padding: 0 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-properties-viewport-dropdown-icon {\n  padding: 0 8px;\n}\n");var Lw={WYSIWYG:{name:jr("与编辑一致"),icon:"viewport-option-WYSIWYG"},adapt:{name:jr("自动适配"),icon:"viewport-option-WYSIWYG"}};function Tw(e){var t=e.onChange,n=e.viewportOption,r=Lw[n]||Lw.adapt;return Ct.a.createElement(lb,{className:"lake-diagram-properties-viewport",title:jr("默认窗口"),extra:Ct.a.createElement(Tt.a,{trigger:["click"],overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,onClick:function(e){var n=e.key;t(n)}},Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-properties-viewport-item",key:"WYSIWYG"},Lw.WYSIWYG.name),Ct.a.createElement(Dt.a.Item,{className:"lake-diagram-properties-viewport-item",key:"adapt"},Lw.adapt.name)),placement:"bottomRight"},Ct.a.createElement("div",{className:"lake-diagram-properties-viewport-selected"},Ct.a.createElement("span",{className:"lake-diagram-properties-viewport-selected-name"},r.name),Ct.a.createElement(tb,{className:"lake-properties-viewport-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}Tw.defaultProps={viewportOption:"adapt",onChange:function(){}},Tw.propTypes={viewportOption:Pt.a.string,onChange:Pt.a.func.isRequired},Tw.key="ViewportControl",Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-canvas-background-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-canvas-background-color {\n  display: none;\n}\n"),jr("画布颜色"),Pt.a.string,Pt.a.object,Ut("/* stylelint-disable */\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container {\n  width: 100%;\n  padding: 12px 1px;\n  box-shadow: none;\n}\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container .lake-board-theme-picker-item-container {\n  width: 118px;\n  height: 86px;\n}\n");var Dw={Control:Tw,props:{}},Nw=[{name:jr("阅读页配置"),tabKey:"global",condition:function(e){return 0===e.length},controls:[Dw]}];function Bw(e){var t=e.diagram,n=e.onClose;Object.assign(Dw.props,e.viewportOptionProps);var r={tabs:[{name:jr("样式"),key:"style"},{name:jr("文本"),key:"text"},{name:jr("排列"),key:"arrangement"},{name:jr("全局"),key:"global"}],className:"lake-diagram-properties-board",menus:[].concat(Nw).concat(Yx).concat(ew).concat(tw).concat(jw).concat(_w).concat(Mw).concat(ww).concat(hw).concat(Cw).concat(Aw),diagram:t,emptyImg:"https://gw.alipayobjects.com/zos/bmw-prod/209ef531-e33b-4e55-8273-5b56b6df44be.svg"};return Ct.a.createElement("div",{className:"lake-diagram-properties-board-wrapper","data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-properties-board-header"},Ct.a.createElement("span",{className:"lake-diagram-properties-board-header-title"},jr("设置")),Ct.a.createElement("span",{className:"lake-diagram-properties-board-header-close-button",onClick:n})),Ct.a.createElement("div",{className:"lake-diagram-properties-body-wrapper"},Ct.a.createElement(cb,r)))}Ut(".lake-diagram-properties-board-wrapper {\n  height: 100%;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-body-wrapper {\n  height: calc(100% - 40px);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-left: 1px solid var(--yq-border-primary);\n  border-bottom: 1px solid var(--yq-border-primary);\n  padding: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-title {\n  margin: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button {\n  margin-right: 8px;\n  width: 16px;\n  height: 16px;\n  display: block;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3a5cc682-0502-44f1-80cf-4a8de2d89e1e.svg);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button:hover {\n  cursor: pointer;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board {\n  background-color: var(--yq-white);\n  top: 0;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .ant-radio-button-wrapper {\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: inherit;\n  padding: 8px 0;\n  margin: 0 16px;\n  border-bottom: 2px solid rgba(0, 0, 0, 0);\n  animation: none;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active {\n  border-bottom: 2px solid black;\n}\n"),Bw.defaultProps={diagram:null,onClose:function(){},menus:[],viewportOptionProps:{}},Bw.propTypes={diagram:Pt.a.object,onClose:Pt.a.func,menus:Pt.a.array,viewportOptionProps:Pt.a.object};var Iw=function(e){var t=e.name,n=e.diagram,r=e.selections,o=0===r.length||r.some((function(e){return e.locked})),a=Object(Ot.useState)({}),i=b()(a,2),c=i[0],l=i[1],u=n.contentEditorPlus,s=c.bold;return Object(Ot.useEffect)((function(){function e(e){var t=e.query;l(t)}return n&&(u.on("querychange",e),u.emitQueryChange()),function(){u.off("querychange",e)}}),[n]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:o,placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-bold"}),className:jt()({active:s}),onClick:function(e){e.stopPropagation(),u.execCommand("bold")}})))};Iw.propTypes={title:Pt.a.string,selections:Pt.a.array,name:Pt.a.string,execCommand:Pt.a.func,diagram:Pt.a.object};var Fw=function(e){var t=e.name,n=e.diagram,r=e.title,o=e.disabled;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:o,placement:"top",title:r},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-link"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("CreateLink")}})))};Fw.propTypes={title:Pt.a.string,name:Pt.a.string,execCommand:Pt.a.func,diagram:Pt.a.object,disabled:Pt.a.oneOfType([Pt.a.bool,Pt.a.func])};var qw=function(e){var t=e.name,n=e.title,r=e.diagram;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:!1,placement:"top",title:n},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-dsl-edit"}),onClick:function(){r.command.execute("OpenDslEditNote")}})))},zw=function(e){var t=e.name,n=e.onProperties,r=e.title;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:!1,placement:"top",title:r},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-board-properties"}),onClick:n})))};zw.defaultProps={onProperties:function(){}},zw.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,onProperties:Pt.a.func},Ut(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var Gw=function(e){var t,n=e.name,r=e.diagram,o=Object(Ot.useState)({}),a=b()(o,2),i=a[0],c=a[1],l=r.contentEditorPlus;r&&(null==r||null===(t=r.theme)||void 0===t||t.values.palette),Object(Ot.useEffect)((function(){function e(e){var t=e.query;c(t)}return r&&(l.on("querychange",e),l.emitQueryChange()),function(){l.off("querychange",e)}}),[r]);var u="#"+ue()(i.color).toHex().toUpperCase(),s=Object(Ot.useState)(u||"rgb(38, 38, 38)"),d=b()(s,2),f=d[0],h=d[1],p=Object(Ot.useState)(!1),m=b()(p,2);function y(e){h(e),l.execCommand("foreColor",e)}return m[0],m[1],Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Xb,{color:f,defaultColor:e.defaultColor,onSelect:y,onClear:function(){return y("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement("span",{style:{marginTop:"5px"}},Ct.a.createElement(Wb,{type:"t-font-color",fill:u})))},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement("span",{style:{marginTop:"5px"}},Ct.a.createElement(Wb,{type:"t-font-color",fill:u}))))))};Gw.defaultProps={defaultColor:"transparent"},Gw.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,currColor:Pt.a.string,defaultColor:Pt.a.string},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var Yw=function(e){return Ct.a.createElement(Dt.a,{className:jt()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-h-align",e.menuClassName),onSelect:e.onSelect,"data-lake_prevent_click_unselect":"true"},e.data.map((function(t){return Ct.a.createElement(Dt.a.Item,{key:t.key},Ct.a.createElement("span",{className:jt()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":t.key===e.currIcon})}),Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon," lake-diagram-dropdown-item")}),Ct.a.createElement("span",{className:"lake-diagram-dropdown-item"},t.title))})))},Hw=[{key:"left",icon:"left",title:"左对齐"},{key:"center",icon:"center",title:"居中对齐"},{key:"right",icon:"right",title:"右对齐"},{key:"justify",icon:"justify",title:"两端对齐"}],Vw=Hw.map((function(e){return e.key}));Yw.propTypes={title:Pt.a.string,menuClassName:Pt.a.string,data:Pt.a.array,onSelect:Pt.a.func,currIcon:Pt.a.string};var Uw=function(e){var t=e.name,n=e.diagram,r=n.contentEditorPlus,o=Object(Ot.useState)({}),a=b()(o,2),i=a[0],c=a[1],l=Object(Ot.useState)(!1),u=b()(l,2),s=u[0],d=u[1],f=i.textAlign;return Vw.includes(f)||(f="center"),Object(Ot.useEffect)((function(){function e(e){var t=e.query;c(t)}return n&&(r.on("querychange",e),r.emitQueryChange()),function(){r.off("querychange",e)}}),[n]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(Yw,{data:Hw,onSelect:function(e){!function(e){if("justify"===e)r.execCommand("justifyFull");else r.execCommand("justify".concat(e&&e[0].toUpperCase()+e.slice(1)))}(e.key),d(!1)},currIcon:f}),placement:"bottomCenter",trigger:"click",visible:s,onVisibleChange:function(e){d(e)}},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t,onClick:function(){return d(!0)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(f)})))))};Uw.defaultProps={defaultAlign:"center"},Uw.propTypes={title:Pt.a.string,data:Pt.a.array,name:Pt.a.string,diagram:Pt.a.object,defaultAlign:Pt.a.string},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n.contextual-text-size-font-size-menu {\n  min-width: 104px;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n");var Ww=function(e){var t=e.name,n=e.diagram,r=Object(Ot.useState)({}),o=b()(r,2),a=o[0],i=o[1],c=n.contentEditorPlus,l=a.fontSize;return Object(Ot.useEffect)((function(){function e(e){var t=e.query;i(t)}return n&&(c.on("querychange",e),c.emitQueryChange()),function(){c.off("querychange",e)}}),[n]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:["click"],value:l,onChange:function(e){return c.execCommand("fontSize",parseInt(e.target.value))},overlay:Ct.a.createElement(Dt.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none contextual-text-size-font-size-menu",selectedKeys:[l&&l.toString()],onClick:function(e){var t=e.key;return c.execCommand("fontSize",parseInt(t))}},[12,14,15,16,18,22,24,32,36,48,64,92].map((function(e){return Ct.a.createElement(Dt.a.Item,{key:e},e===l&&Ct.a.createElement("span",{className:"lake-icon lake-icon-success"}),e,"px")}))),placement:"bottomCenter"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"text-msg"}," ",l?"".concat(l,"px"):e.defaultFontSize," ")))))};Ww.defaultProps={defaultFontSize:"14px"},Ww.propTypes={title:Pt.a.string,data:Pt.a.array,name:Pt.a.string,selections:Pt.a.array,diagram:Pt.a.object,defaultFontSize:Pt.a.string},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var Xw=function(e){return Ct.a.createElement(Dt.a,{className:jt()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-v-align",e.menuClassName),onSelect:e.onSelect,"data-lake_prevent_click_unselect":"true"},e.data.map((function(t){return Ct.a.createElement(Dt.a.Item,{key:t.key},Ct.a.createElement("span",{className:jt()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":t.key===e.currIcon})}),Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon," lake-diagram-dropdown-item")}),Ct.a.createElement("span",{className:"lake-diagram-dropdown-item"},t.title))})))};Xw.propTypes={title:Pt.a.string,menuClassName:Pt.a.string,data:Pt.a.array,onSelect:Pt.a.func,currIcon:Pt.a.string};var Kw=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)(!1),o=b()(r,2),a=o[0],i=o[1],c=e.get(n,"textVerticalAlign");return Yr.includes(c)||(c="middle"),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{disabled:!0,overlay:Ct.a.createElement(Xw,{data:Gr,onSelect:function(t){!function(t){e.execCommand("textVerticalAlign",t,su(n))}(t.key),i(!1)},currIcon:c}),placement:"bottomCenter",trigger:"click",visible:a,onVisibleChange:function(e){i(e)}},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t,onClick:function(){return i(!0)}},Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(c)})))))};Kw.defaultProps={defaultAlign:"middle"},Kw.propTypes={title:Pt.a.string,data:Pt.a.array,name:Pt.a.string,selections:Pt.a.array,defaultAlign:Pt.a.string,execCommand:Pt.a.func.isRequired,get:Pt.a.func.isRequired},Ut(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var Zw=function(e){var t,n=e.name,r=e.diagram,o=e.selections,a=o.every((function(e){return e.isMindmap})),i=Object(Ot.useState)(e.defaultColor),c=b()(i,2),l=c[0],u=c[1],s=Object(Ot.useState)(!1),d=b()(s,2);d[0],d[1];var f=Object(Ot.useState)(null),h=b()(f,2),p=h[0],m=h[1];r&&(null==r||null===(t=r.theme)||void 0===t||t.values.palette);var y=function(e){var t=ue()(e).toRgb();return.3*t.r+.59*t.g+.11*t.b>=248},v=function(t){u(t),a?e.execCommand("border.fill",t,o):e.execCommand("fill.color",t,su(o)),y(t)?m("#e8e8e8"):m(null)};return Object(Ot.useEffect)((function(){if(o&&o.length>0){var t=a?"border.fill":"fill.color",n=e.get(o,t),r="multiValue"===n?"#FFFFFF":n;u(r),y(r)?m("#e8e8e8"):m(null)}return function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Xb,{color:l,defaultColor:e.defaultColor,onSelect:v,onClear:function(){return v("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement(Wb,{type:"t-bg-color",fill:l,stroke:p}))},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement(Wb,{type:"t-bg-color",fill:l,stroke:p})))))};function Qw(e){var t=Object(Ot.useRef)(),n=e.width,r=e.height,o=e.shape,a=o&&uc.find((function(e){return e.name===o}));return Object(Ot.useEffect)((function(){if(t.current&&a){var e=new Uf({stencil:a,width:n,height:r,noFill:!0,stroke:Bf("text"),fill:"transparent"}).rendererElement;Array.from(t.current.children,(function(e){return e.remove()})),t.current.appendChild(e)}}),[t,n,r,a]),a?Ct.a.createElement("svg",{ref:t,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}Zw.defaultProps={defaultColor:"transparent"},Zw.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,currColor:Pt.a.string,defaultColor:Pt.a.string,execCommand:Pt.a.func,get:Pt.a.func,disabled:Pt.a.oneOfType([Pt.a.bool,Pt.a.func])},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-shape-current {\n  width: 100%;\n  height: 32px;\n  min-width: 34px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagrm-contexual-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n}\n"),Qw.propTypes={width:Pt.a.number,height:Pt.a.number,shape:Pt.a.string};var $w=function(e){var t,n=e.name,r=e.selections,o=e.get(r,"shape"),a=(null===(t=uc[uc.findIndex((function(e){return e.name===o}))])||void 0===t?void 0:t.category)||"basic";return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement("div",{className:"lake-diagrm-contexual-shape-select-container"},Ct.a.createElement(Xg,{onSelect:function(t){var n=t.key;e.execCommand("shape",n,r)},groups:[a]})),key:e.key,placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":n},Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-shape-current",{"lake-diagam-multi-properties-selection":"multiValue"===o})},Ct.a.createElement(Qw,{shape:o,width:30,height:30}))))))};function Jw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ek(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jw(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}$w.propTypes={title:Pt.a.string,command:Pt.a.string,name:Pt.a.string,onSelect:Pt.a.func,key:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,execCommand:Pt.a.func,get:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-stroke-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-stroke-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-stroke-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var tk=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,o=e.setStrokeProps,a=Object(Ot.useState)(r.style?"dash":"none"),i=b()(a,2),c=i[0],l=i[1],u=function(t){if((t=Number(t))>=1&&t<=10){var a=Math.min(Math.max(t,1),10);a!==r.width&&(o(ek(ek({},r),{},{width:a})),e.execCommand("stroke.width",a,n))}},s=function(t){e.onSelect&&e.onSelect(t)},d=function(t){e.execCommand("stroke.style",t,n)};return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-stroke-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},n.every((function(e){return!wr(e)}))&&Ct.a.createElement(Ct.a.Fragment,null,Ct.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:jt()("geo-btn",{active:"none"===c}),onClick:function(e){e.preventDefault(),l("none"),d(null)}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:jt()("geo-btn",{active:"dash"===c}),onClick:function(e){e.preventDefault(),l("dash"),d("dash")}})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"})),Ct.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-control"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-inner"},Ct.a.createElement(Tx,{min:1,max:10,value:r.width,onInput:u,onStep:u}))),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-color"},Ct.a.createElement(Xb,{color:r.color,defaultColor:e.defaultColor,onSelect:s,onClear:function(){return s("rgba(0, 0, 0, 0)")},transSVG:Ct.a.createElement(Wb,{type:"context-cb-trans"}),diagram:t},Ct.a.createElement("div",{className:jt()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};tk.propTypes={title:Pt.a.string,colorBadge:Pt.a.object,name:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,onSelect:Pt.a.func,defaultColor:Pt.a.string,strokeProps:Pt.a.object,selections:Pt.a.array,setStrokeProps:Pt.a.func,execCommand:Pt.a.func};var nk=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)({}),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)(!1),l=b()(c,2),u=l[0],s=l[1];return Object(Ot.useEffect)((function(){return n&&n.length>0&&i(n[0].stroke),function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{visible:u,onVisibleChange:function(e){s(e)},overlay:Ct.a.createElement(tk,Et()({setStrokeProps:i,strokeProps:a,onSelect:function(t){i(ek(ek({},a),{},{color:t})),e.execCommand("stroke.color",t,n)}},e)),placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement(Wb,{type:"stroke-color",stroke:a.color})))))};nk.defaultProps={defaultColor:"transparent"},nk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,currColor:Pt.a.string,defaultColor:Pt.a.string,execCommand:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-geometry-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var rk=function(e){var t=e.diagram,n=Object(Ot.useState)({}),r=b()(n,2),o=r[0],a=r[1],i=t.contentEditorPlus;Object(Ot.useEffect)((function(){function e(e){var t=e.query;a(t)}return t&&(i.on("querychange",e),i.emitQueryChange()),function(){i.off("querychange",e)}}),[t]);var c=o.bold,l=o.italic,u=o.strikethrough,s=o.underline;return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-geometry-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(_t.a,{className:jt()({active:c}),icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return i.execCommand("bold")}}),Ct.a.createElement(_t.a,{className:jt()({active:l}),onClick:function(){return i.execCommand("italic")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ct.a.createElement(_t.a,{className:jt()({active:u}),onClick:function(){return i.execCommand("strikethrough")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ct.a.createElement(_t.a,{className:jt()({active:s}),onClick:function(){return i.execCommand("underline")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(Ww,Et()({},e,{textStyle:o,title:jr("字号")})),Ct.a.createElement(Gw,Et()({},e,{textStyle:o,title:jr("字色")})),Ct.a.createElement(Uw,Et()({},e,{textStyle:o,title:jr("水平对齐")})),Ct.a.createElement(Kw,Et()({},e,{title:jr("竖直对齐")}))))};rk.defaultProps={defaultColor:"transparent"},rk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,className:Pt.a.string};var ok=function(e){var t=e.name,n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:"click",visible:o,onVisibleChange:function(e){a(e)},overlay:Ct.a.createElement(rk,e)},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};ok.defaultProps={defaultColor:"transparent"},ok.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-toolbar-dropdown .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::before {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::after {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-diagram-dropdown-item {\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item {\n  min-width: 32px;\n  height: 32px;\n  padding: 0 6px;\n  border-radius: 3px;\n  text-align: center;\n  line-height: 32px;\n  margin: 0 2px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item-selected {\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var ak=function(e){var t=e.onSelect,n=e.source,r=e.marker;return Ct.a.createElement(Dt.a,{className:jt()("lake-diagram-contextual-toolbar-dropdown-menu"),"data-lake_prevent_click_unselect":"true",onSelect:t,style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Fs.map((function(e){return Ct.a.createElement(Dt.a.Item,{key:e,className:jt()({active:e===r})},Ct.a.createElement("span",{className:jt()("lake-icon lake-icon-contextual-".concat(e," lake-diagram-dropdown-item"),{source:n})}))})))};ak.propTypes={source:Pt.a.bool,title:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,onSelect:Pt.a.func,marker:Pt.a.string};var ik=function(e){var t=e.name,n=e.selections,r=e.type,o=Object(Ot.useState)(null),a=b()(o,2),i=a[0],c=a[1],l=Object(Ot.useState)(e.defaultIcon),u=b()(l,2),s=u[0],d=u[1],f=Object(Ot.useState)(!1),h=b()(f,2),p=h[0],m=h[1];return Object(Ot.useEffect)((function(){if(n&&n.length>0){var e=n[0][r];e.marker?c(e.marker):c("none"),Fs.filter((function(t){return t===e.marker})).forEach((function(e){return d("contextual-".concat(e))}))}return function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(ak,Et()({onSelect:function(t){var o=t.key;e.execCommand("".concat(r,".marker"),"none"===o?null:o,n),c(o),Fs.filter((function(e){return e===o})).forEach((function(e){return d("contextual-".concat(e))})),m(!1)},marker:i,source:"source"===r,trigger:"click"},e)),placement:"bottomCenter",trigger:"click",visible:p,onVisibleChange:function(e){m(e)}},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t,onClick:function(){return m(!0)}},Ct.a.createElement("span",{className:jt()("lake-icon lake-icon-".concat(s),{source:"source"===r})})))))};function ck(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ck(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ck(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ik.defaultProps={defaultIcon:"contextual-stroke-none"},ik.propTypes={type:Pt.a.string,title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,defaultIcon:Pt.a.string,execCommand:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn .lake-icon {\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-line-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-line-width-control .lake-diagram-board-contextual-line-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-line-width-control .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-line-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var uk=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,o=e.setStrokeProps,a=Object(Ot.useState)(r.style?"dash":"none"),i=b()(a,2),c=i[0],l=i[1],u=function(t){if((t=Number(t))>=1&&t<=10){var a=Math.min(Math.max(t,1),10);a!==r.width&&(o(lk(lk({},r),{},{width:a})),e.execCommand("stroke.width",a,n))}},s=function(t){e.onSelect&&e.onSelect(t)},d=function(t){e.execCommand("stroke.style",t,n)},f=function(t){e.execCommand("shape",t,n)};return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-line-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-straight-line"}),className:jt()({active:"straight"===e.currShape}),onClick:function(t){t.preventDefault(),f("straight"),e.setCurrShape("straight")}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-curve-line"}),target:"dash",className:jt()({active:"curve"===e.currShape}),onClick:function(t){t.preventDefault(),f("curve"),e.setCurrShape("curve")}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-elbow-line"}),target:"dash",className:jt()({active:"elbow"===e.currShape}),onClick:function(t){t.preventDefault(),f("elbow"),e.setCurrShape("elbow")}})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:jt()({active:"none"===c}),onClick:function(e){e.preventDefault(),l("none"),d(null)}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:jt()({active:"dash"===c}),onClick:function(e){e.preventDefault(),l("dash"),d("dash")}})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-control"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-inner"},Ct.a.createElement(Tx,{min:1,max:10,value:r.width,onStep:u,onInput:u}))),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-line-color"},Ct.a.createElement(Xb,{color:r.color,defaultColor:e.defaultColor,onSelect:s,onClear:function(){return s("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ct.a.createElement(Wb,{type:"context-cb-trans"})},Ct.a.createElement("div",{className:jt()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};uk.propTypes={title:Pt.a.string,colorBadge:Pt.a.object,name:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,onSelect:Pt.a.func,defaultColor:Pt.a.string,strokeProps:Pt.a.object,selections:Pt.a.array,setStrokeProps:Pt.a.func,currShape:Pt.a.string,setCurrShape:Pt.a.func,execCommand:Pt.a.func};var sk=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)({}),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)(e.defaultShape),l=b()(c,2),u=l[0],s=l[1];return Object(Ot.useEffect)((function(){return n&&n.length>0&&(i(n[0].stroke),s(n[0].shape)),function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(uk,Et()({setStrokeProps:i,strokeProps:a,onSelect:function(t){i(lk(lk({},a),{},{color:t})),e.execCommand("stroke.color",t,n)},currShape:u,setCurrShape:s},e)),placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-".concat(u,"-line")})))))};sk.defaultProps={defaultShape:"straight"},sk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,defaultShape:Pt.a.string,execCommand:Pt.a.func};var dk=function(e){var t=e.title,n=e.name,r=e.diagram;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command","data-lake_prevent_click_unselect":"true"},Ct.a.createElement(Rt.a,{placement:"top",title:t},Ct.a.createElement(_t.a,{"data-testid":n,onClick:function(){r.command.execute("LineSwapEndpoint",{autoSelect:!1})}},Ct.a.createElement("span",{className:jt()("lake-icon lake-icon-".concat(n))}))))};Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var fk=function(e){var t=e.diagram,n=Object(Ot.useState)({}),r=b()(n,2),o=r[0],a=r[1],i=t.contentEditorPlus;Object(Ot.useEffect)((function(){function e(e){var t=e.query;a(t)}return t&&(i.on("querychange",e),i.emitQueryChange()),function(){i.off("querychange",e)}}),[t]);var c=o.bold,l=o.italic,u=o.strikethrough,s=o.underline;return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-line-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(_t.a,{className:jt()({active:c}),icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return i.execCommand("bold")}}),Ct.a.createElement(_t.a,{className:jt()({active:l}),onClick:function(){return i.execCommand("italic")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ct.a.createElement(_t.a,{className:jt()({active:u}),onClick:function(){return i.execCommand("strikethrough")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ct.a.createElement(_t.a,{className:jt()({active:s}),onClick:function(){return i.execCommand("underline")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(Ww,Et()({},e,{textStyle:o,title:jr("字号")})),Ct.a.createElement(Gw,Et()({},e,{textStyle:o,title:jr("字色")})),Ct.a.createElement(Uw,Et()({},e,{textStyle:o,title:jr("水平对齐")}))))};fk.defaultProps={defaultColor:"transparent"},fk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,className:Pt.a.string};var hk=function(e){var t=e.name,n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:"click",visible:o,onVisibleChange:function(e){a(e)},overlay:Ct.a.createElement(fk,e)},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};hk.defaultProps={defaultColor:"transparent"},hk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array};var pk=function(e){var t=e.name,n=e.title,r=e.diagram,o=e.boardWebProxy;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:!1,placement:"top",title:n},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-abstract"}),onClick:function(){o&&o.spm&&o.spm.click("b4693.c116586.d241682",{"toolbar(MindmapAppendAbstract)":1}),r.command.execute("MindmapAppendAbstract")}})))};pk.defaultProps={onProperties:function(){}},pk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,onProperties:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-layout-current {\n  width: 100%;\n  height: 30px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-contextual-command {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-contextual-command > * {\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-mindmap-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-left: 3px;\n  margin-right: 3px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .lake-diagram-contextual-mindmap-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-mindmap-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-mindmap-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var mk=function(e){var t=e.layouts,n=e.selectedKey,r=e.setVisible,o=e.visible;return Ct.a.createElement("div",{className:"lake-diagram-layout-dropdown","data-lake_prevent_click_unselect":"true"},t.map((function(t){var a=t.key;return Ct.a.createElement("div",{key:a,"data-lake_prevent_click_unselect":"true",className:jt()("lake-diagram-layout-thumb",a,{selected:a===n}),onClick:function(){r(!o),e.onSelect(a)}},Ct.a.createElement("div",{className:a}))})))};mk.propTypes={title:Pt.a.string,diagram:Pt.a.object,layouts:Pt.a.array,selectedKey:Pt.a.string,setVisible:Pt.a.func,onSelect:Pt.a.func,visible:Pt.a.bool};var yk=function(e){var t=e.name,n=e.selections.filter((function(e){return e.isMindmap})),r=Ma(n,lb),o=n.map((function(e){return e.upDirection}));n.map((function(e){return e.upLayoutType}));var a=Object(Ot.useState)(!1),i=b()(a,2),c=i[0],l=i[1],u=_a.filter((function(e){if(n.every((function(e){return e.isStem})))return!0;var t=e.key.split("-")[0],r=n.some((function(e){var n=e.upLayoutType,r=e.isAbstract;return Da(n,t,r)})),a=!e.directions.every((function(e){return o.every((function(t){return Ta(t,e)}))}));return!r&&!a}));function s(e){0!==u.length&&l(e)}return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(mk,Et()({setVisible:s,selectedKey:r,layouts:u,onSelect:function(t){e.execCommand("layout",La(t),n)},visible:c},e)),placement:"bottomCenter",onClick:function(){return s(!c)},visible:c,onVisibleChange:function(e){return s(e)},trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-layout-current"),"data-testid":t},Ct.a.createElement("div",{className:jt()("lake-diagram-layout-thumb",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Ct.a.createElement("div",{className:r}))))))};yk.defaultProps={selections:[]},yk.propTypes={title:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,execCommand:Pt.a.func,name:Pt.a.string};var vk=function(e){var t=function(t){e.execCommand("border.shape",t,e.selections),e.setShape(t)},n=e.diagram.selector.selections.every((function(e){return!e.isAbstract}));return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},n?Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-mindmap-line"}),className:jt()("mindmap-btn",{active:"line"===e.shape}),onClick:function(e){e.preventDefault(),t("line")}}):null,Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-mindmap-rect"}),className:jt()("mindmap-btn",{active:"rect"===e.shape}),onClick:function(e){e.preventDefault(),t("rect")}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-mindmap-capsule"}),className:jt()("mindmap-btn",{active:"capsule"===e.shape}),onClick:function(e){e.preventDefault(),t("capsule")}})))};vk.propTypes={title:Pt.a.string,className:Pt.a.string,borderProps:Pt.a.object,selections:Pt.a.array,execCommand:Pt.a.func,shape:Pt.a.string,setShape:Pt.a.func,isLine:Pt.a.bool};var gk=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)(e.get(n,"border.shape","line")||null),o=b()(r,2),a=o[0],i=o[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{overlay:Ct.a.createElement(vk,Et()({shape:a,isLine:"line"===a,setShape:i},e)),placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===a})},Ct.a.createElement("span",{className:"lake-icon lake-icon-mindmap-".concat(a)}))))))};function bk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bk(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}gk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,defaultShape:Pt.a.string,get:Pt.a.func};var wk=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,o=e.setStrokeProps,a=function(t){var a=Math.min(Math.max(t,1),10);a!==r.strokeWidth&&(o(xk(xk({},r),{},{strokeWidth:a})),e.execCommand("border.stroke-width",a,n))},i=function(e){a(e.target.value)},c=function(t){e.onSelect&&e.onSelect(t)};return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Ct.a.createElement(Tx,{min:1,max:10,value:r.strokeWidth,onBlur:i,onPressEnter:i,onStep:a}))),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Ct.a.createElement(Xb,{color:r.strokeColor,defaultColor:e.defaultColor,onSelect:c,onClear:function(){return c("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ct.a.createElement(Wb,{type:"context-cb-trans"})},Ct.a.createElement(Rt.a,{placement:"top",title:jr("边框颜色")},Ct.a.createElement("div",{className:jt()("lake-diagram-stroke"),style:{backgroundColor:r.strokeColor}}))))))};wk.propTypes={title:Pt.a.string,colorBadge:Pt.a.object,name:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,onSelect:Pt.a.func,defaultColor:Pt.a.string,strokeProps:Pt.a.object,selections:Pt.a.array,setStrokeProps:Pt.a.func,execCommand:Pt.a.func};var kk=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)({}),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)(!1),l=b()(c,2),u=l[0],s=l[1],d=Object(Ot.useState)(!0),f=b()(d,2),h=f[0],p=f[1];return Object(Ot.useEffect)((function(){if(n&&n.length>0){var t=n.filter((function(e){return e.canStroke()&&e.isMindmap})),r=e.get(t,"border.stroke-width"),o=e.get(n,"border.shape","line")||null,a=e.get(n,"border.stroke","transparent")||null;i({strokeWidth:r,shape:o,strokeColor:a}),p("line"===o)}return function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{visible:u,onVisibleChange:function(e){s(e)},overlay:Ct.a.createElement(wk,Et()({setStrokeProps:i,strokeProps:a,onSelect:function(t){i(xk(xk({},a),{},{strokeColor:t})),e.execCommand("border.stroke",t,n)},isLine:h},e)),placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement(Wb,{type:"stroke-color",stroke:a.strokeColor})))))};kk.defaultProps={defaultColor:"transparent"},kk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,currColor:Pt.a.string,defaultColor:Pt.a.string,get:Pt.a.func,execCommand:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-mindmap-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Ek=function(e){var t=e.diagram,n=Object(Ot.useState)({}),r=b()(n,2),o=r[0],a=r[1],i=t.contentEditorPlus;Object(Ot.useEffect)((function(){function e(e){var t=e.query;a(t)}return t&&(i.on("querychange",e),i.emitQueryChange()),function(){i.off("querychange",e)}}),[t]);var c=o.bold,l=o.italic,u=o.strikethrough,s=o.underline;return Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-mindmap-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(_t.a,{className:jt()({active:c}),icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return i.execCommand("bold")}}),Ct.a.createElement(_t.a,{className:jt()({active:l}),onClick:function(){return i.execCommand("italic")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ct.a.createElement(_t.a,{className:jt()({active:u}),onClick:function(){return i.execCommand("strikethrough")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ct.a.createElement(_t.a,{className:jt()({active:s}),onClick:function(){return i.execCommand("underline")},icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ct.a.createElement(Ww,Et()({},e,{textStyle:o,title:jr("字号")})),Ct.a.createElement(Gw,Et()({},e,{textStyle:o,title:jr("字色")})),Ct.a.createElement(Uw,Et()({},e,{textStyle:o,title:jr("水平对齐")}))))};Ek.defaultProps={defaultColor:"transparent"},Ek.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,className:Pt.a.string};var Ok=function(e){var t=e.name,n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:"click",visible:o,onVisibleChange:function(e){a(e)},overlay:Ct.a.createElement(Ek,e)},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};function Ck(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ak(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ck(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ck(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ok.defaultProps={defaultColor:"transparent"},Ok.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array};var Pk=function(e){var t=e.diagram,n=e.selections,r=e.treeEdgeProps,o=e.setTreeEdgeProps,a=e.containRoot,i=an(n.map((function(e){return e.stem}))),c=Object(Ot.useState)(""),l=b()(c,2),u=l[0],s=l[1],d=function(t){var a=Math.min(Math.max(t,1),5);a!==r.width&&(o(Ak(Ak({},r),{},{"stroke-width":a})),e.execCommand("treeEdge.stroke-width",a,n))},f=function(e){d(e.target.value)},h=function(t){e.onSelect&&e.onSelect(t)},p=function(t){e.execCommand("treeEdge.shape",t,i),e.setTreeRootProps({shape:t?"polyline":"none"})};return Object(Ot.useEffect)((function(){return i.length>0&&s(i[0].treeEdge.shape||"none"),function(){}}),[]),Ct.a.createElement("div",{className:jt()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ct.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"}),className:jt()("mindmap-btn",{active:"none"===u}),onClick:function(e){e.preventDefault(),s("none"),p(null)}}),Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"}),target:"dash",className:jt()("mindmap-btn",{active:"polyline"===u}),onClick:function(e){e.preventDefault(),s("polyline"),p("polyline")}})),!a&&Ct.a.createElement(Ct.a.Fragment,null,Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ct.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Ct.a.createElement(Tx,{min:1,max:5,value:r["stroke-width"]||e.defaultStrokeWidth,onBlur:f,onPressEnter:f,onStep:d}))),Ct.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Ct.a.createElement(Xb,{color:r.stroke,defaultColor:e.defaultColor,onSelect:h,onClear:function(){return h("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ct.a.createElement(Wb,{type:"context-cb-trans"})},Ct.a.createElement("div",{className:jt()("lake-diagram-stroke"),style:{backgroundColor:r.stroke}}))))))};Pk.defaultProps={defaultStrokeWidth:3},Pk.propTypes={title:Pt.a.string,colorBadge:Pt.a.object,containRoot:Pt.a.bool,name:Pt.a.string,className:Pt.a.string,diagram:Pt.a.object,onSelect:Pt.a.func,defaultColor:Pt.a.string,treeEdgeProps:Pt.a.object,selections:Pt.a.array,setTreeEdgeProps:Pt.a.func,defaultStrokeWidth:Pt.a.number,execCommand:Pt.a.func,setTreeRootProps:Pt.a.func};var Sk=function(e){var t=e.name,n=e.selections,r=Object(Ot.useState)({}),o=b()(r,2),a=o[0],i=o[1],c=Object(Ot.useState)({}),l=b()(c,2),u=l[0],s=l[1],d=Object(Ot.useState)(!1),f=b()(d,2),h=f[0],p=f[1],m=n.some((function(e){return e.isStem}));return Object(Ot.useEffect)((function(){if(n&&n.length>0){var e=n[0];i(e.treeEdge),s(e.stem.treeEdge)}return function(){}}),[]),Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{visible:h,onVisibleChange:function(e){p(e)},overlay:Ct.a.createElement(Pk,Et()({setTreeEdgeProps:i,setTreeRootProps:s,treeEdgeProps:a,onSelect:function(t){i(Ak(Ak({},a),{},{stroke:t})),e.execCommand("treeEdge.stroke",t,n)},containRoot:m},e)),placement:"bottomCenter",trigger:"click"},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-".concat(u.shape?u.shape:"none")})))))};Sk.defaultProps={defaultColor:"transparent"},Sk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object,selections:Pt.a.array,currColor:Pt.a.string,defaultColor:Pt.a.string,execCommand:Pt.a.func},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-align-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-align-dropdown p {\n  margin-bottom: 0;\n}\n");var jk=function(e){var t=e.diagram;function n(e,n,r){return t.command.enable(e)&&Ct.a.createElement(Rt.a,{title:r},Ct.a.createElement(_t.a,{icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),onClick:function(){return t.command.execute(e)}}))}return Ct.a.createElement("div",{className:"lake-diagram-contextual-align-dropdown","data-lake_prevent_click_unselect":"true"},Ct.a.createElement("p",null,n("AlignLeft","align-left",jr("左对齐")),n("AlignHCenter","align-h-center",jr("左右居中")),n("AlignRight","align-right",jr("右对齐")),n("DistributeHorizontally","distribute-horizontally",jr("水平均分"))),Ct.a.createElement("p",null,n("AlignTop","align-top",jr("顶对齐")),n("AlignVCenter","align-v-center",jr("上下居中")),n("AlignBottom","align-bottom",jr("底对齐")),n("DistributeVertically","distribute-vertically",jr("垂直均分"))))};jk.defaultProps={diagram:null},jk.propTypes={diagram:Pt.a.object};var Rk=function(e){var t=e.name,n=Object(Ot.useState)(!1),r=b()(n,2),o=r[0],a=r[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:"click",visible:o,onVisibleChange:function(e){a(e)},overlay:Ct.a.createElement(jk,e)},Ct.a.createElement(Rt.a,{placement:"top",title:e.title},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-align"})))))};Rk.defaultProps={title:"",name:"",diagram:null},Rk.propTypes={title:Pt.a.string,name:Pt.a.string,diagram:Pt.a.object};var _k=function(e){var t=e.name,n=e.diagram,r=e.title,o=e.disabled;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:o,placement:"top",title:r},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-group"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("MakeGroup")}})))};_k.propTypes={title:Pt.a.string,name:Pt.a.string,execCommand:Pt.a.func,diagram:Pt.a.object,disabled:Pt.a.oneOfType([Pt.a.bool,Pt.a.func])};var Mk=function(e){var t=e.name,n=e.diagram,r=e.title,o=e.disabled;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{disabled:o,placement:"top",title:r},Ct.a.createElement(_t.a,{"data-testid":t,icon:Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-ungroup"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("Ungroup")}})))};Mk.propTypes={title:Pt.a.string,name:Pt.a.string,execCommand:Pt.a.func,diagram:Pt.a.object,disabled:Pt.a.oneOfType([Pt.a.bool,Pt.a.func])};var Lk=function(e){var t=e.diagram,n=e.title,r=e.name;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command"},Ct.a.createElement(Rt.a,{placement:"top",title:jr(n)},Ct.a.createElement(_t.a,{"data-testid":r,onClick:function(e){e.preventDefault(),e.stopPropagation(),t.command.execute("Delete",{cells:t.deduplicate(t.selector.selections).map((function(e){return e.model.id}))})}},Ct.a.createElement("span",{className:"lake-icon lake-icon-delete-lane"}))))},Tk=function(e){var t=e.diagram,n=e.title;return Ct.a.createElement("div",{className:"lake-diagram-contextual-command",style:{width:"72px"}},Ct.a.createElement(Rt.a,{placement:"top",title:jr(n)},Ct.a.createElement(Pw,{diagram:t})))};function Dk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dk(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-table {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 16px 10px 0 10px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-mindmap-icons-table .icon-title {\n  margin-bottom: 6px;\n  margin-left: 4px;\n}\n.lake-diagram-mindmap-icons-table .icons-container {\n  margin-bottom: 22px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px;\n  height: 26px;\n  width: 26px;\n  margin: 0 4px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: inline-block;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .lake-button-active {\n  background-color: var(--yq-yuque-grey-4);\n}\n.lake-diagram-mindmap-icons-table .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Bk=function(e){var t=e.diagram,n=e.className,r=Object(Ot.useMemo)((function(){return Mr.map((function(e,r){var o=Tr[r];return Ct.a.createElement("div",{key:e},Ct.a.createElement("div",{className:jt()("icon-title",n)},Lr[r]),Ct.a.createElement("div",{className:jt()("icons-container",n)},Pe()(o).map((function(n){return Ct.a.createElement("img",{className:"icon-btn",key:e+n,src:Nr(e,n),id:"insert-icon-".concat(e,"-").concat(n),onClick:function(){var r=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:r.map((function(t){return{icons:Nk(Nk({},t.model.icons||{}),{},c()({},e,n))}})),notSelect:!0})}})}))))}))}),[]);return Ct.a.createElement("div",{className:jt()("lake-diagram-mindmap-icons-table",n),"data-lake_prevent_click_unselect":"true"},r)},Ik=function(e){var t=e.name,n=e.title,r=Object(Ot.useState)(!1),o=b()(r,2),a=o[0],i=o[1];return Ct.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ct.a.createElement(Tt.a,{trigger:"click",visible:a,onVisibleChange:function(e){i(e)},overlay:Ct.a.createElement(Bk,e)},Ct.a.createElement(Rt.a,{placement:"top",title:n},Ct.a.createElement(_t.a,{"data-testid":t},Ct.a.createElement("span",{className:"lake-icon lake-icon-contextual-mindmap-icon"})))))},Fk={name:"properties",type:"custom",custom:zw,title:jr("打开设置"),noMini:!0},qk=function(e){return{type:"separator",noMini:e}},zk=function(e){var t=e&&1!==e.length?[]:[qk(),{name:"add-link",type:"custom",custom:Fw,title:jr("插入链接"),hotkey:pe.ua.macos?"⌘+K":"Ctrl+K"}];return[{name:"contextual-text-size",type:"custom",custom:Ww,title:jr("字号"),disabled:!1},qk(),{name:"contextual-text-color",type:"custom",title:jr("字色"),disabled:!1,custom:Gw},{name:"contextual-text-h-alignment",title:jr("水平对齐"),type:"custom",custom:Uw,disabled:!1},{name:"contextual-text-v-alignment",title:jr("竖直对齐"),type:"custom",custom:Kw,disabled:function(e){return!e.selector.selections.some((function(e){return e.canTextVerticalAlign()}))}},{name:"contextual-text-bold",type:"custom",custom:Iw,title:jr("加粗"),disabled:!1}].concat(t,[qk(!0),Fk])},Gk=function(){return[{name:"arrangement",type:"custom",custom:Rk,title:jr("排列"),disabled:function(e){return e.selector.selections.filter((function(e){return!e.isLine||e.isLine&&!e.source.id&&!e.target.id})).length<2}},{name:"group",type:"custom",custom:_k,title:jr("成组")},qk(!0)]};function Yk(e){var t=e.coord,n=e.overlayClassName,r=Object(Ot.useRef)();if(t){var o="lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Ct.a.createElement(Ft.a,Et()({},e,{getPopupContainer:function(){return e.getPopupContainer?e.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||e.diagram.container},visible:!0,overlayClassName:n?"".concat(n," ").concat(o):o,"data-lake_prevent_click_unselect":!0}),Ct.a.createElement("div",{ref:r,"data-lake_prevent_click_unselect":"true",style:{position:"absolute",left:"".concat(t[0],"px"),top:"".concat(t[1]-16,"px"),pointerEvents:"none",width:"".concat(e.width,"px"),height:"".concat(e.height+32,"px")}}))}return Ct.a.createElement("span",{ref:r})}Yk.defaultProps={coord:null,diagram:null,onClose:function(){}},Yk.propTypes={coord:Pt.a.array,diagram:Pt.a.object,onClose:Pt.a.func,overlayClassName:Pt.a.string,getPopupContainer:Pt.a.object,height:Pt.a.number,width:Pt.a.number},Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-contextual-toolbar {\n  display: flex;\n  height: 40px;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 0 6px;\n}\n.lake-diagram-board-contextual-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 100%;\n  border-radius: 5px;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background-clip: none;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-command .ant-btn:hover,\n.lake-diagram-contextual-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-contextual-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 18px;\n}\n.lake-diagram-contextual-command .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-button-popover {\n  padding-top: 0;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner {\n  background-color: inherit;\n  box-shadow: none;\n  border-radius: 0;\n  background-clip: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n  stroke: '@yuque-grey-4';\n  box-shadow: rgba(0, 0, 0, 0.08) 0 0 4px;\n}\n.lake-diagram-board-contextual-vertical-separator {\n  width: 1px;\n  height: 60%;\n  margin: 0 6px;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-contextual-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n");var Hk=["diagram","custom","boardWebProxy"];function Vk(e,t,n){var r=n;if(e.length>0)if((r=e.map((function(e){return t.split(".").reduce((function(e,t){return e?e.isCell&&e.get(t)||e[t]:e}),e)}))).every((function(e){return e===r[0]})))r=r[0];else{if(!r.every((function(e){return"number"==typeof e})))return"multiValue";r.sort(),r=r[r.length-1]}return r}var Uk=function(e){var t=e.diagram,n=e.custom;e.boardWebProxy;var r=Lt()(e,Hk),o=Object(Ot.useCallback)((function(e,n,r){t.command.execute("Update",{id:r,model:bn(e,n),autoSelect:!1})}),[t]);switch(e.type){case"separator":default:return Ct.a.createElement("div",{className:"lake-diagram-board-contextual-vertical-separator"});case"custom":return Ct.a.createElement(n,Et()({diagram:t,get:Vk,execCommand:o},r))}};function Wk(e){var t=e.diagram,n=e.onProperties,r=e.mini,o=e.boardWebProxy,a=Object(Ot.useState)(null),i=b()(a,2),c=i[0],l=i[1],u=Object(Ot.useState)(null),s=b()(u,2),d=s[0],f=s[1],h=Object(Ot.useState)(null),p=b()(h,2),m=p[0],y=p[1],v=Object(Ot.useState)(0),g=b()(v,2),x=g[0],w=g[1],k=Object(Ot.useState)(0),E=b()(k,2),O=E[0],C=E[1],A=Object(Ot.useState)(!0),P=b()(A,2),S=P[0];P[1];var j=t.contentEditor;function R(){return function(e,t,n){var r=e.length,o=[];if(0===r)return[];if(function(e){return e.every((function(t){return t.type===e[0].type}))}(e))switch(e[0].type){case"line":o=[{name:"contextual-line-style",type:"custom",title:jr("线条样式"),custom:sk},qk(),{name:"contextual-line-source",type:"custom",title:jr("起点"),custom:function(e){return Ct.a.createElement(ik,Et()({},e,{type:"source"}))}},{name:"contextual-line-swap-endpoint",type:"custom",title:jr("转换"),custom:dk},{name:"contextual-line-target",type:"custom",title:jr("终点"),custom:function(e){return Ct.a.createElement(ik,Et()({},e,{type:"target"}))}},qk(),{name:"font-style",type:"custom",title:jr("文字样式"),custom:hk},qk(!0),Fk];break;case"mindmap":o=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[{name:"contextual-mindmap-layout",type:"custom",title:jr("结构"),custom:yk,disabled:function(e){return e.selector.selections.some((function(e){return e.isAbstract}))}},{name:"contextual-mindmap-tree-edge",type:"custom",title:jr("分支"),custom:Sk,disabled:!1},qk(),{name:"contextual-mindmap-shape",type:"custom",title:jr("节点形状"),custom:gk,disabled:!1},{name:"contextual-mindmap-fill",type:"custom",title:jr("节点填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-mindmap-stroke",type:"custom",title:jr("节点描边"),custom:kk,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canStroke()})).length}},qk(),{name:"font-style",type:"custom",title:jr("文字样式"),custom:Ok,disabled:!1},{name:"add-icon",type:"custom",title:jr("添加标记"),custom:Ik,disabled:!1},{name:"add-link",type:"custom",custom:Fw,title:jr("插入链接"),disabled:!1}];return e&&t.push(qk(),{name:"add-abstract",type:"custom",title:jr("添加概要"),custom:pk,disabled:!1}),t.concat([qk(!0),Fk])}(sy(e,!0));break;case"text":o=zk(e);break;case"geometry":o=[{name:"contextual-geometry-shape",type:"custom",custom:$w,title:jr("图形"),disabled:!1},qk(),{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:jr("描边"),disabled:!1,custom:nk},qk(),{name:"font-style",type:"custom",title:jr("文字样式"),custom:ok,disabled:!1},{name:"add-link",type:"custom",custom:Fw,title:jr("插入链接"),hotkey:pe.ua.macos?"⌘+K":"Ctrl+K"},qk(!0),Fk];break;case"group":o=1===e.length?[{name:"ungroup",type:"custom",custom:Mk,title:jr("取消成组")},qk(!0),Fk]:[];break;case"stack":case"pen":o=[{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:jr("描边"),disabled:!1,custom:nk},qk(!0),Fk];break;case"swimlane":o=vr(e[0])?[{name:"contextual-swimlane-lane-number",type:"custom",title:jr("泳道数"),custom:Tk,disabled:function(e){var t=e.selector.selections;return!(1===t.length&&vr(t[0]))}},qk(!0),{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:jr("描边"),disabled:!1,custom:nk},qk(!0),{name:"font-style",type:"custom",title:jr("文字样式"),custom:ok,disabled:!1},qk(!0),Fk]:[{name:"contextual-swimlane-lane-number",type:"custom",title:jr("泳道数"),custom:Tk,disabled:function(e){var t=e.selector.selections;return t.some((function(e){return e.swimlane!==t[0].swimlane}))}},qk(!0),{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},qk(!0),{name:"font-style",type:"custom",title:jr("文字样式"),custom:ok,disabled:!1},{name:"add-link",type:"custom",custom:Fw,title:jr("插入链接"),disabled:!1},qk(!0),{name:"delete-lane",type:"custom",custom:Lk,title:jr("删除泳道"),disabled:!1},qk(!0),Fk];break;case"freehand":o=[{name:"contextual-geometry-stroke-color",type:"custom",title:jr("描边"),disabled:!1,custom:nk},qk(!0),Fk];break;case"dsl":o=dr(e[0])?[{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:jr("描边"),disabled:!1,custom:nk},qk(!0),{name:"font-style",type:"custom",title:jr("文字样式"),custom:ok,disabled:!1},qk(!0),{name:"enter-dsl-edit",type:"custom",title:jr("编辑"),disabled:!1,custom:qw},qk(!0),Fk]:[{name:"contextual-geometry-fill-color",type:"custom",title:jr("填充"),custom:Zw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},qk(!0),{name:"font-style",type:"custom",title:jr("文字样式"),custom:ok,disabled:!1},qk(!0),{name:"enter-dsl-edit",type:"custom",title:jr("编辑"),disabled:!1,custom:qw},qk(!0),Fk];break;default:o=[]}if(e.filter((function(e){return e.isStem})).length>1){var a,i=0===o.length?[].concat(T()(Gk()),[Fk]):Gk();(a=o).splice.apply(a,[o.length-1,0].concat(T()(i)))}return e.some((function(e){return"UML"===e.category}))&&0===o.findIndex((function(e){return"contextual-geometry-shape"===e.name}))&&o.splice(0,2),1===e.length&&xr(e[0])&&(o=zk()),r>1&&(o=o.filter((function(e){return"add-link"!==e.name}))),(o=o.filter((function(t){return!(n&&t.noMini||("function"==typeof t.disabled?t.disabled(e[0].diagram):t.disabled))}))).forEach((function(e){"properties"===e.name&&(e.onProperties=t)})),o}(t.selector.selections,n,r)}Object(Ot.useEffect)((function(){var e=function(){if(t.signal.addVertexPanelVisibility)return l(null),void f(null);var e=t.selector.selections,n=R();e&&l(n),1===n.length||n.length>1&&!t.signal.mouseMultiSelecting?function(e){f(null);var n=function(e,t){var n=Ar(e,(function(e){if(mr(e)){var t=e.getKeyShapeBox();if(e.isAbstract){var n=Ar(e.abstractCoveredCellsWithAllChildren,(function(e){return e.getKeyShapeBox()}));t.minY=Math.min(n.minY,t.minY),t.maxY=Math.max(n.maxY,t.maxY)}return function(e){var t=e.minX,n=e.minY;return{x:t,y:n,width:e.maxX-t,height:e.maxY-n}}(t)}return ur(e)?e.getPointBox():e.getBBox()})),r=n.minX,o=n.minY,a=n.maxX,i=n.maxY,c=t.viewport.convertViewport([r,o]),l=t.viewport.convertViewport([a,i]),u=l[0]-c[0],s=l[1]-c[1];return{x:c[0],y:c[1],width:u,height:s}}(e,t),r=n.x,o=n.y,a=n.width,i=n.height;w(i),C(a),f([r,o])}(e):f(null)},n=function(){l(null),f(null)},r=De()(n,24),o=De()((function(){e()}),20),a=De()((function(){if(!(t.signal.buttonDragCanvas||t.signal.dragging||t.signal.vertexResizing)){var n=t.selector.selections;1!==n.length||n[0].isPen||n[0].isFreehand||n[0].isGroup||c||e()}}),28),i=De()((function(){var e=R();l(e)}),16),u=function(){var e=t.viewport.invertViewport([0,0]);m&&oi(m[0],e[0],1)&&oi(m[1],e[1],1)||(l(null),f(null),y(e),o())},s=function(e){e.isModelChange&&i()},d=function(){y(t.viewport.invertViewport([0,0]))};return t.on("afterselect",o),t.on("keydown",r),t.on("mousemove",a),t.on("cell:dragstart",n),t.on("vertexresizestart",n),t.on("groupresizestart",n),t.on("abstadjuststart",n),t.on("endpointcontrolpointmousedown",n),t.on("addlinebuttonmousedown",n),t.on("aftercommandexecute",s),t.on("afterviewportchange",u),t.on("afterimport",d),j.on("textareaKeydown",r),function(){t.off("afterselect",o),t.off("keydown",r),t.off("mousemove",a),t.off("cell:dragstart",n),t.off("vertexresizestart",n),t.off("groupresizestart",n),t.off("abstadjuststart",n),t.off("endpointcontrolpointmousedown",n),t.off("addlinebuttonmousedown",n),t.off("aftercommandexecute",s),t.off("afterviewportchange",u),t.off("afterimport",d),j.off("textareaKeydown",r)}}),[t,c,m,S]);var _=Ct.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar"},c&&c.map((function(e,n){return Ct.a.createElement(Uk,Et()({key:n,diagram:t,boardWebProxy:o,selections:t.selector.selections},e))})));return Ct.a.createElement("div",{"data-testid":"board-contextual-toolbar"},Ct.a.createElement(Yk,{height:x,width:O,content:_,visible:!0,overlayClassName:"lake-diagram-board-contextual-toolbar-popover",diagram:t,coord:d}))}function Xk(e,t){var n={},r=[],o=[];return e.forEach((function(e){var t=e.category;e.cover||(e.cover="https://gw.alipayobjects.com/zos/bmw-prod/8681f102-cc41-4685-b75a-faadb0af0a61.svg"),"personal"===t?r.push(e):"official"===t&&o.push(e),t&&!n[t]&&(n[t]=!0)})),{personalData:r.splice(0,t),officialData:o.splice(0,t)}}Uk.propTypes={type:Pt.a.string,curr:Pt.a.string,custom:Pt.a.func,diagram:Pt.a.object},Wk.propTypes={className:Pt.a.string,position:Pt.a.string,items:Pt.a.array,domContainer:Pt.a.object,title:Pt.a.node,extra:Pt.a.node,execCommand:Pt.a.func,diagram:Pt.a.object,onProperties:Pt.a.func,mini:Pt.a.bool,boardWebProxy:Pt.a.object},Ut(".lake-diagram-scroll-tabs-container {\n  background-color: var(--yq-bg-primary);\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container {\n  overflow: scroll;\n  position: relative;\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 0 !important;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav::before {\n  display: none;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab:first-child {\n  margin-left: 0;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab {\n  padding: 0;\n  margin-left: 8px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a {\n  display: block;\n  color: var(--yq-yuque-grey-8);\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.57;\n  height: 32px;\n  border-radius: 6px;\n  padding: 5px 16px 27px 16px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a:hover {\n  background-color: var(--yq-bg-primary-hover);\n  color: var(--yq-text-primary);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab-active a {\n  color: var(--yq-text-primary);\n  font-weight: 500;\n  background-color: var(--yq-bg-primary-hover);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-ink-bar {\n  display: none;\n}\n");var Kk=Bt.a.TabPane;function Zk(e){var t=e.tabs,n=void 0===t?[]:t,r=e.InnerRCNode,o=e.className,a=e.scrollToName;if(0===n.length||!r)return Ct.a.createElement("div",null);var i=Object(Ot.useRef)(null),c=Object(Ot.useRef)(null),l=Object(Ot.useState)(n[0].name),u=b()(l,2),s=u[0],d=u[1];return Object(Ot.useEffect)((function(){var e,t=i.current;if(t){var r,o=n.map((function(e){var n=t.querySelector("[data-lake-tab-scroll=".concat(e.name,"]"));return n?n.offsetTop:0}));e=Le()((function(e){for(var t=e.target.scrollTop,r=o.length-1;r>0&&!(t>o[r]-48);r--);d((function(e){var t=n[r].name;return e!==t?t:e}))}),16),null===(r=i.current)||void 0===r||r.addEventListener("scroll",e)}return function(){var t;return e&&(null===(t=i.current)||void 0===t?void 0:t.removeEventListener("scroll",e))}}),[n]),Object(Ot.useEffect)((function(){if(a&&i&&i.current){var e,t=i.current.querySelector('[data-lake-tab-scroll="'.concat(a,'"]'));t&&1===t.nodeType&&(null===(e=i.current)||void 0===e||e.scrollTo(0,t.offsetTop))}}),[a]),Object(Ot.useEffect)((function(){c.current&&Array.from(c.current.querySelectorAll(".ant-tabs-tab")).forEach((function(e,t){0!==t&&1===e.nodeType&&(e.style.marginLeft="16px")}))}),[]),Ct.a.createElement("div",{className:"lake-diagram-scroll-tabs-container ".concat(o)},Ct.a.createElement(Bt.a,{animated:!1,onChange:function(e){var t=i.current;if(t){var n,r=t.querySelector('[data-lake-tab-scroll="'.concat(e,'"]'));r&&1===r.nodeType&&(null===(n=i.current)||void 0===n||n.scrollTo(0,r.offsetTop))}},activeKey:s,onTabClick:function(e){d(e)}},n.map((function(e){return Ct.a.createElement(Kk,{tab:Ct.a.createElement("a",null,e.title),key:e.name})}))),Ct.a.createElement("div",{ref:i,className:"lake-diagram-scroll-tabs-inner-container"},r))}Ut(".lake-board-material-lib-container {\n  text-align: left;\n  position: relative;\n  display: inline-block;\n  height: 560px;\n  width: 762px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-material-lib-container .lake-board-material-lib-close {\n  border-radius: 2px;\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3ee0285f-a1ad-4051-82a6-89e802514ef4.svg);\n  background-position: center;\n  background-repeat: no-repeat;\n  top: 8px;\n  right: 14px;\n}\n.lake-board-material-lib-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container {\n  padding-left: 24px;\n  height: 498px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-diagram-scroll-tabs-inner-container {\n  height: 450px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-board-material-lib-scroll-inner-container {\n  width: 762px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container .lake-board-material-lib-item-pane-container {\n  height: 498px;\n  overflow-y: scroll;\n}\n.lake-board-material-lib-container .lake-board-material-lib-close:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty {\n  width: 400px;\n  color: var(--yq-text-body);\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: auto;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty .lake-board-material-lib-personal-empty-tips-h1 {\n  font-size: 18px;\n  margin: 24px 0;\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty p {\n  font-size: 14px;\n  margin-bottom: 8px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty img {\n  margin-top: 16px;\n  opacity: 0.5;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item {\n  position: relative;\n  margin-right: 24px;\n  margin-bottom: 24px;\n  font-size: 14px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-title {\n  height: 54px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-left: 16px;\n  border-top: 1px solid var(--yq-border-primary);\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-cover {\n  width: 220px;\n  height: 142px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  padding: 16px;\n  display: none;\n  background-color: rgba(250, 250, 250, 0.9);\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-radius: 4px;\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  background-color: rgba(20, 20, 20, 0.9);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-button {\n  position: absolute;\n  width: calc(100% - 32px);\n  bottom: 16px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-title {\n  height: 14px;\n  font-weight: bold;\n  margin-bottom: 12px;\n  display: flex;\n  align-items: center;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-description {\n  height: 90px;\n  margin-bottom: 24px;\n  overflow: hidden;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  position: absolute;\n  width: 16px;\n  height: 16px;\n  top: 16px;\n  right: 16px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/0b88a90e-d1fd-4e14-b74d-dc5355e9de8d.svg);\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  filter: invert(100%);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete:hover {\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-href {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 4px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/712ccc64-9efb-4889-89d0-3531ff478a22.svg);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item:hover .lake-board-material-lib-item-control {\n  display: block;\n}\n");var Qk=Bt.a.TabPane,$k=[{name:"official",title:jr("推荐素材")},{name:"personal",title:jr("自定义素材")}],Jk=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ct.a.createElement("div",null),o=arguments.length>4?arguments[4]:void 0;return Ct.a.createElement("div",{className:"lake-board-material-lib-item-pane-container","data-lake-tab-scroll":e},(null==n?void 0:n.length)>0?Ct.a.createElement("div",{className:"lake-board-material-lib-item-container"},n.map((function(e,t){return function(e,t,n){var r=e.id,o=e.cover,a=e.doclet_id,i=e.title;return Ct.a.createElement("div",{className:"lake-board-material-lib-item",key:r,"data-testid":"material-lib-item-doclet-id-".concat(a),"data-lake-tab-scroll":r},Ct.a.createElement("div",{className:"lake-board-material-lib-item-cover",style:{backgroundImage:"url(".concat(o,")")}}),i&&Ct.a.createElement("div",{className:"lake-board-material-lib-item-title"},Ct.a.createElement("span",null,i)),Ct.a.createElement("div",{className:"lake-board-material-lib-item-control"},function(e,t){var n=e.title,r=e.href,o=e.description,a=e.category,i=e.id;return Ct.a.createElement("div",null,Ct.a.createElement("div",{className:"lake-board-material-lib-item-use-control-title"},n,r&&Ct.a.createElement("a",{target:"_blank",className:"lake-board-material-lib-item-use-control-href",href:r})),o&&Ct.a.createElement("div",{className:"lake-board-material-lib-item-use-control-description"},o),"personal"===a&&Ct.a.createElement("div",{onClick:function(e){e.target.closest(".lake-board-material-lib-item").style.display="none",null==t||t.onDelete(i)},className:"lake-board-material-lib-item-use-control-delete"}),Ct.a.createElement(_t.a,{onClick:function(){t.onUse(e)},className:"lake-board-material-lib-item-use-control-button",block:!0},jr("使用")))}(e,n)))}(e,0,o)}))):r)},eE=function(e,t){var n=e.map((function(e){return Jk(e.group_id,e.group,e.data,Ct.a.createElement("div",null),t)}));return Ct.a.createElement("div",{className:"lake-board-material-lib-scroll-inner-container"},n)},tE=Object.freeze({__proto__:null,ZoomTool:fb,Toolbar:ex,ContextMenu:Sx,Properties:Bw,ContextualMenu:Wk,MaterialLibMaxi:function(e){var t=e.scrollToName,n=function(e,t){var n=e.boardWebProxy,r=e.diagram,o=e.forceUpdate,a=Object(Ot.useState)(null),i=b()(a,2),c=i[0],l=i[1],u=function(){var e=de()(he.a.mark((function e(){var o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.destroyed&&n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.material["find".concat(t)]();case 4:o=e.sent,l(Xk(o,100));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var t=de()(he.a.mark((function t(o){var a,i,c,l,u,s,d,f,h,p,m,y,v;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.destroyed&&n){t.next=2;break}return t.abrupt("return");case 2:return a=n.spm,i=o.id,c=o.category,t.next=6,n.material.use(i);case 6:if(l=t.sent){t.next=9;break}return t.abrupt("return");case 9:u=l.diagramData,s=l.graphicsBBox,u&&(d=u.body,f=u.head,ba(d),h=s||(null==f?void 0:f.bbox)||r.modelManager.bbox(d),p=r.viewport.getCenter(),"number"==typeof(g=h).x&&"number"!=typeof g.minX&&(g.minX=g.x,g.maxX=g.x+g.width),"number"==typeof g.y&&"number"!=typeof g.minY&&(g.minY=g.y,g.maxY=g.y+g.height),m=p[0]-h.minX-h.width/2,y=p[1]-h.minY-h.height/2,r.modelManager.translate(d,m,y),r.hooks.forceDecorateImportModels.call(d),r.command.execute("Add",{model:d}),a&&(v={material_id:o.id},"personal"===c?a.click("b4693.c107432.d223038",v):a.click("b4693.c107432.d223037",v)),e.onUse&&e.onUse());case 11:case"end":return t.stop()}var g}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(Ot.useEffect)((function(){u()}),[r,o]),{state:{data:c,maxCount:100},onUse:s,onMore:function(t){e.onMore&&e.onMore(t)},onDelete:function(t){n.material.destroy(t),e.onDelete&&e.onDelete(t)},onClose:function(){e.onClose&&e.onClose()}}}(e,"Maxi"),r=n.state.data,o=$k[0].name,a=Object(Ot.useState)(o),i=b()(a,2),c=i[0],l=i[1];if(Object(Ot.useEffect)((function(){t&&l(t)}),[t]),!r)return Ct.a.createElement("div",null);var u=r.personalData,s=r.officialData.reduce((function(e,t){var n=t.group,r=t.group_id;return e[r]||(e[r]={group_id:r,group:n,data:[]}),e[r].data.push(t),e}),{}),d=["Hot","team","Design","Technology","Mind"];Object.keys(s).length>d.length&&Object.keys(s).filter((function(e){return!d.includes(e)})).forEach((function(e){d.push(e)}));var f=Object.keys(s).length?d.map((function(e){return s[e]})):[],h=f.map((function(e){return{name:e.group_id,title:jr(e.group)}}));return Ct.a.createElement("div",{className:"lake-board-material-lib-container"},Ct.a.createElement(Bt.a,{animated:!1,defaultActiveKey:c,onTabClick:function(e){l(e)}},Ct.a.createElement(Qk,{tab:$k[0].title,key:$k[0].name},Ct.a.createElement(Zk,{tabs:h,className:"lake-board-material-lib-scroll-container",InnerRCNode:eE(f,n)})),Ct.a.createElement(Qk,{tab:$k[1].title,key:$k[1].name},Ct.a.createElement("div",{className:"lake-board-personal-material-tab-pane-container"},Jk($k[1].name,$k[1].title,u,Ct.a.createElement("div",{className:"lake-board-material-lib-personal-empty","data-testid":"material-lib-personal-empty"},Ct.a.createElement("h1",{className:"lake-board-material-lib-personal-empty-tips-h1"},jr("添加自定义素材")),Ct.a.createElement("p",null," ",jr("步骤一：框选需要添加的内容")),Ct.a.createElement("p",null," ",jr("步骤二：右键打开面板，选择“添加到素材库”")),Ct.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/bmw-prod/5f652093-571b-4c7c-bd3f-fd81ff7fe2e1.svg"})),n)))),Ct.a.createElement("div",{className:"lake-board-material-lib-close","data-testid":"material-lib-close",onClick:function(){n.onClose()}}))}}),nE=Object.freeze({__proto__:null});function rE(e){var t,n=e.diagram,r=e.readonly,o=Object(Ot.useState)(null),a=b()(o,2),i=a[0],c=a[1],l=Object(Ot.useState)(""),u=b()(l,2),s=u[0],d=u[1],f=Object(Ot.useState)(null),h=b()(f,2),p=h[0],m=h[1],y=Object(Ot.useRef)();return Object(Ot.useEffect)((function(){function e(e){var t=e.cell,n=t.getKeyShape().getBoundingClientRect();c(null),c([n.x+n.width,n.y+n.height/2]),m(t),d(t.note.content)}return n.on("opennote",e),function(){n.off("opennote",e)}}),[n,i,c,m,s]),Object(Ot.useEffect)((function(){setTimeout((function(){var e=document.querySelector("textarea.lake-diagram-note-area");if(e){var t=e.value.length;e.focus(),e.setSelectionRange(t,t)}}),16)}),[i,y.current,p]),t=r?Ct.a.createElement("div",{className:"lake-diagram-note-area"},s):Ct.a.createElement("textarea",{className:"lake-diagram-note-area",value:s,onChange:function(e){var t=e.target.value;d(t)},ref:y}),Ct.a.createElement(ox,{placement:"right",content:t,visible:!0,overlayClassName:"lake-diagram-note-popover",diagram:n,coord:i,onClose:function(){i&&p&&(m(null),c(null),p.note.content!==s&&n.command.execute("Update",{id:p,model:{note:s?{content:s}:null}}))}})}function oE(e){return Ct.a.createElement(rE,e)}function aE(e){return Ct.a.createElement(rE,Et()({},e,{readonly:!0}))}Ut("/* stylelint-disable */\n.lake-diagram-note-popover {\n  z-index: 1033;\n}\n.lake-diagram-note-popover .lake-diagram-note-area {\n  font-size: 12px;\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  width: 294px;\n  height: 128px;\n  padding: 16px 18px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n}\n"),rE.defaultProps={diagram:null,readonly:!1},rE.propTypes={diagram:Pt.a.object,readonly:Pt.a.bool},oE.defaultProps={diagram:null},oE.propTypes={diagram:Pt.a.object},aE.defaultProps={diagram:null},aE.propTypes={diagram:Pt.a.object};var iE=Object.freeze({__proto__:null,Editor:oE,Reader:aE});function cE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cE(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ut("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-change-overlay .ant-popover-inner {\n  border: 0;\n  background: none;\n  box-shadow: none;\n}\n.lake-diagram-mindmap-icons-change {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 13px;\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-mindmap-icons-change .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px 2px;\n  height: 26px;\n  width: 26px;\n  margin: 3px 8px 3px 0;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: block;\n}\n.lake-diagram-mindmap-icons-change .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-change .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n  padding: 2px 2px;\n  margin: 3px 0;\n  display: inline-block;\n  cursor: pointer;\n  border-radius: 6px;\n}\n.lake-diagram-mindmap-icons-change .lake-icon:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-mindmap-icons-change .lake-diagram-icon-change-vertical-separator {\n  width: 1px;\n  height: 28px;\n  margin: 0 14px 0 6px;\n  background: var(--yq-border-primary);\n  display: inline-block;\n}\n"),Ut(".lake-diagram-dsl-editor-container {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 8px;\n  background-color: white;\n  min-width: 300px;\n  min-height: 120px;\n  display: flex;\n  flex-direction: column;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container {\n  padding-top: 12px;\n  padding-left: 10px;\n  padding-right: 10px;\n  flex: 1 0 40px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea {\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea > div {\n  display: flex;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper {\n  display: flex;\n  font-size: 12px;\n  justify-content: space-between;\n  height: 40px;\n  min-height: 40px;\n  background: transparent;\n  border-top: 1px solid var(--yq-border-primary);\n  line-height: 24px;\n  padding: 8px 8px;\n  text-align: left;\n  text-indent: 0;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper .larkui-icon {\n  margin-right: 6px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper button {\n  width: 40px;\n  height: 24px;\n  text-align: center;\n  line-height: 24px;\n  background-color: var(--yq-theme);\n  color: white;\n  font-size: 12px;\n  border: none;\n  padding: 0;\n  border-radius: 4px;\n  cursor: pointer;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a:hover {\n  color: var(--yq-text-body);\n}\n");var uE=!1,sE=Object.freeze({__proto__:null,Properties:cb,Note:iE,Toolbar:Gg,LinkEditor:Ug,ShapeOverlay:Xg,Dropdown:Ig,ZoomTool:eb,ContextMenu:nE,Board:tE,ToolbarShapeOverlay:$g,IconChange:function(e){var t=e.diagram;e.readonly;var n=e.className,r=Object(Ot.useState)(),o=b()(r,2),a=o[0],i=o[1],l=Object(Ot.useState)(),u=b()(l,2),s=u[0],d=u[1],f=Object(Ot.useState)(),h=b()(f,2),p=h[0],m=h[1];Object(Ot.useEffect)((function(){function e(e){var t=e.cell,n=e.key,r=e.nativeEvent;if(t&&n){var o=r.target,a=o.getBoundingClientRect();i(void 0),i([a.x+a.width,a.y+a.height]),d(t),m(o)}}return t.on("changemindmapicon",e),function(){t.off("changemindmapicon",e)}}),[t,a,i,d]);var y=Object(Ot.useMemo)((function(){var e=null==p?void 0:p.getAttribute("lake-mindmap-icon-key"),r=Mr.findIndex((function(t){return t===e}));if(e&&r>-1){var o=Tr[r];return Ct.a.createElement("div",{className:jt()("lake-diagram-mindmap-icons-change",n),"data-lake_prevent_click_unselect":"true"},Pe()(o).map((function(n){return Ct.a.createElement("img",{className:"icon-btn",key:e+n,src:Nr(e,n),id:"change-icon-".concat(e,"-").concat(n),onClick:function(){var r=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:r.map((function(t){return{icons:lE(lE({},t.model.icons||{}),{},c()({},e,n))}}))})}})})),Ct.a.createElement("div",{className:"lake-diagram-icon-change-vertical-separator"}),Ct.a.createElement("span",{className:"lake-icon lake-icon-table-new-delete",onClick:function(){var n=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:n.map((function(e){return e.model.id})),model:n.map((function(t){return{icons:lE(lE({},t.model.icons||{}),{},c()({},e,null))}}))})}}))}return[]}),[null==p?void 0:p.getAttribute("lake-mindmap-icon-key")]);return Ct.a.createElement(ox,{placement:"bottom",content:y,style:{borderRadius:"8px"},visible:!0,overlayClassName:"lake-diagram-mindmap-icons-change-overlay",diagram:t,coord:a,onClose:function(){a&&s&&(d(void 0),i(void 0),p&&(p.dataset.lakeMindmapIconSelected="false"))}})},DslEditor:function(e){var t=e.diagram,n=Object(Ot.useState)(""),o=b()(n,2),a=o[0],i=o[1],c=Object(Ot.useState)(null),l=b()(c,2),u=l[0],s=l[1],d=Object(Ot.useState)([0,0]),f=b()(d,2),h=f[0],p=f[1],m=Object(Ot.useState)([0,0]),y=b()(m,2),v=y[0],g=y[1],x=Object(Ot.useRef)(null);Object(Ot.useEffect)((function(){var e=function(e){var n=e.cell;uE=!0,s(n),i(n.stencil.toText(n.htmls));var r=t.viewport.convertViewport([n.x,n.y]),o=b()(r,2),a=o[0],c=o[1];p([a,c]),g([n.width*t.viewport.zoom,n.height*t.viewport.zoom]),t.destroyed};return t.on("opendsleditor",e),function(){t.off("opendsleditor",e)}}),[t]);var w=function(){if(u){var e=u;uE=!1,s(null),[e].concat(T()(e.getChildren())).forEach((function(e){return e.show()})),a!==e.stencil.toText(e.htmls)&&t.command.execute("UpdateDslHtml",{dsl:e,htmls:e.stencil.toHtmls(a,e.htmls)}),t.selector.select(e)}};return Object(Ot.useEffect)((function(){if(x.current&&u){var e=function(e){"Enter"===e.key&&("stage"===u.shape||(r.ua.macos?e.metaKey:e.ctrlKey))&&(e.preventDefault(),uE&&w())};return x.current.addEventListener("keydown",e),window.addEventListener("mousedown",n),t.on("afterviewportchange",o),function(){var r;null===(r=x.current)||void 0===r||r.removeEventListener("keydown",e),window.removeEventListener("mousedown",n),t.off("afterviewportchange",o)}}function n(e){var t;null!==(t=e.target)&&void 0!==t&&t.closest(".lake-diagram-dsl-editor-container")||!uE||w()}function o(e){if(u){var n=t.viewport.convertViewport([u.x,u.y]),r=b()(n,2),o=r[0],a=r[1];p([o,a]),g([u.width*t.viewport.zoom,u.height*t.viewport.zoom])}}}),[u,a]),Ct.a.createElement("div",{className:"lake-diagram-dsl-editor-container",style:{position:"absolute",left:"".concat(h[0],"px"),top:"".concat(h[1],"px"),width:v[0]+5,height:v[1]+5,visibility:u?"initial":"hidden"},ref:x},Ct.a.createElement("div",{className:"lake-diagram-dsl-editor-textarea-container"},Ct.a.createElement("textarea",{className:"lake-diagram-dsl-editor-textarea",value:a,onChange:function(e){i(e.target.value)}})),Ct.a.createElement("div",{className:"lake-diagram-dsl-editor-helper"},Ct.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/af4k4xq4ma35qvv2",target:"_blank"},Ct.a.createElement("span",{className:"lake-icon lake-icon-board-question"})),Ct.a.createElement("button",{onClick:w},Ct.a.createElement(Rt.a,{title:Ct.a.createElement("p",{style:{textAlign:"center"}},r.ua.macos?"Cmd":"Ctrl","+Enter"),placement:"bottom"},jr("确定")))))}}),dE=new r.MessageManager;function fE(e){return hE.apply(this,arguments)}function hE(){return(hE=de()(he.a.mark((function e(t){var n,o,a,i,c,l,u,s,d,f,h,p,m,y;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.file,a=t.uploader,i=t.enable,c=t.onTemporaryOnLoad,l=t.onCompleted,o){e.next=3;break}return e.abrupt("return");case 3:if(r.FileUtils.isImage(o)){e.next=5;break}return e.abrupt("return");case 5:if(!i||i()){e.next=7;break}return e.abrupt("return");case 7:if(!o.size){e.next=12;break}if(null===(u=r.FileSizeChecker.check("image",o.size))){e.next=12;break}return u.callback(dE.show(u.level,u.msg,!u.alwaysOpen)),e.abrupt("return");case 12:return e.next=14,sx(o);case 14:if(s=e.sent,d=(null===(n=ux(s))||void 0===n?void 0:n.cdn)||URL.createObjectURL(o),f=new Image,h={src:d,naturalWidth:void 0,naturalHeight:void 0,uploadInfo:{hash:s,fileName:o.name,fileType:o.type,fileSize:o.size,localTempSrc:d,state:0}},f.onload=function(){Object.assign(h,{naturalWidth:f.naturalWidth,naturalHeight:f.naturalHeight}),c&&c(h)},f.src=d,"string"!=typeof d||!d.startsWith("blob:")){e.next=32;break}return p=a.image(o),lx(s,m={imageCdnPromise:p}),e.next=26,p;case 26:if(y=e.sent){e.next=30;break}return h.uploadInfo.state=-1,e.abrupt("return",h);case 30:m.cdn=y,l&&l({hash:s,cdn:y});case 32:return e.abrupt("return",h);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pE(e){if(e.image&&e.image.uploadInfo&&e.image.uploadInfo.hash){var t,n=null===(t=ux(e.image.uploadInfo.hash))||void 0===t?void 0:t.cdn;n?(e.image.src=n,e.image.uploadInfo.state=2):e.image.uploadInfo.state=-2}}function mE(e){e.body.forEach((function(e){Wt(e,(function(e){pE(e)}))}))}function yE(e){return vE.apply(this,arguments)}function vE(){return(vE=de()(he.a.mark((function e(t){var n,r,o,a,i,c,l,u,s,d,f;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.model,r=t.diagram,o=t.uploader,n){e.next=3;break}return e.abrupt("return");case 3:if((a=n.image||n.sourceImage)&&a.src){e.next=6;break}return e.abrupt("return");case 6:if(i=n.id,c=a.src,l=a.uploadInfo,!c.startsWith("blob:")){e.next=24;break}return e.prev=10,e.next=13,fetch(c).then((function(e){return e.blob()}));case 13:return u=e.sent,s=new File([u],l&&"".concat(a.uploadInfo.fileName)),e.next=17,fE({file:s,uploader:o});case 17:d=e.sent,r&&!r.destroyed&&(f=r.find(i))&&f.updateModel({image:d}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),console.warn("Failed to save image when importing, src: ".concat(c));case 24:case"end":return e.stop()}}),e,null,[[10,21]])})))).apply(this,arguments)}function gE(e){return e.command.enable("Collapse")?e.command.execute("Collapse"):e.command.enable("Expand")?e.command.execute("Expand"):void 0}function bE(e){return e.command.enable("Collapse")||e.command.enable("Expand")}function xE(e){return e.command.enable("Expand")}function wE(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"curve-arrow").split("-"),n=b()(t,2),r=n[0],o=n[1],a=e.selector.selections;if(2===a.length&&a.every((function(e){return e.isMindmap}))){var i=e.add([{type:"line",source:{id:a[0].model.id},target:{id:a[1].model.id}}]),c=i[0].getPointAtPercent(.5);return e.remove(i),e.command.execute("Add",{model:{type:"line",shape:r,source:{id:a[0].model.id},target:{id:a[1].model.id,marker:o},controlPoints:[[c.x,c.y]]}})}e.command.execute("BeginInsertLine",{shape:r,marker:o})}var kE=[{name:"save",title:jr("保存"),hotkey:pe.ua.macos?"⌘+S":"Ctrl+S",icon:"save",disabled:!1,execCommand:function(){}},{name:"undo",title:jr("撤销"),hotkey:pe.ua.macos?"⌘+Z":"Ctrl+Z",icon:"undo",disabled:function(e){return!e.command.enable("Undo")},execCommand:function(e){return e.command.execute("Undo")}},{name:"redo",title:jr("重做"),hotkey:pe.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"redo",disabled:function(e){return!e.command.enable("Redo")},execCommand:function(e){return e.command.execute("Redo")}},{type:"separator"},{name:"beginInsertRoot",title:jr("插入主节点"),hotkey:(pe.ua.macos,"Shift+Enter"),icon:"insert-root",disabled:function(e){return!e.command.enable("MindmapBeginInsertStem")},execCommand:function(e){return e.command.execute("MindmapBeginInsertStem")}},{name:"append",title:jr("插入同级"),hotkey:"Enter",icon:"insert-sibling",disabled:function(e){return!e.command.enable("MindmapAppendSibling")},execCommand:function(e){return e.command.execute("MindmapAppendSibling")}},{name:"appendChild",title:jr("插入子级"),hotkey:"Tab",icon:"insert-child",disabled:function(e){return!e.command.enable("MindmapAppendChild")},execCommand:function(e){return e.command.execute("MindmapAppendChild")}},{name:"insertLine",title:jr("线条"),hotkey:pe.ua.macos?"⌘+L":"Ctrl+L",type:"dropdown",mode:"button",defaultKey:"curve-arrow",data:[{key:"curve",icon:"line-curve"},{key:"curve-arrow",icon:"line-curve-arrow"}],execCommand:function(e,t){return wE(e,t)}},{name:"insertNote",title:jr("备注"),icon:"diagram-toolbar-note",disabled:function(e){return!e.command.enable("MindmapOpenNote")},execCommand:function(e){return e.command.execute("MindmapOpenNote")}},{name:"createLink",title:jr("插入链接"),hotkey:pe.ua.macos?"⌘+K":"Ctrl+K",icon:"link",disabled:function(e){return!e.command.enable("CreateLink")},execCommand:function(e){return e.command.execute("CreateLink")}},{name:"insertImage",title:jr("插入图片"),type:"upload",icon:"image",accept:pe.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(","),disabled:function(e){return!e.command.enable("MindmapAttachImage")&&!e.command.enable("MindmapInsertImage")},onChange:function(){}},{type:"separator"},{name:"collapseExpand",title:jr("折叠"),hotkey:pe.ua.macos?"⌘+/":"Ctrl+/",icon:"collapse-node",disabled:function(e){return!bE(e)},active:function(e){return xE(e)},execCommand:function(e){return gE(e)}}],EE=function(){function e(){m()(this,e),Object.assign(this,{format:"lakeboard",type:"Board",version:"1.0",diagramData:{head:{},body:[]},mode:"edit",viewportSetting:null,viewportOption:"adapt",text:"",graphicsBBox:null})}return v()(e,[{key:"get",value:function(e){return this[e]}},{key:"set",value:function(e,t){this[e]=t}},{key:"export",value:function(){var e=this;return Object.keys(this).reduce((function(t,n){return t[n]=e[n],t}),{})}}]),e}();function OE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function CE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OE(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var AE=Sr.locale,PE=new EE,SE=Object.freeze({__proto__:null,uploadImage:fE,onBeforeSave:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){if(e.destroyed)r();else if(t.isCompleted())r();else{var o,a=Date.now();!n&&we.a.warning(jr("图片上传中，请稍候")),Promise.resolve().then((function e(){t.isCompleted()||Date.now()-a>=72e4?(o&&clearTimeout(o),r()):o=setTimeout(e,6e3)}))}}))},processImageModel:pE,processExportData:mE,exportData:function(e){var t=e.export();return mE(t),t},tryTransferBlobUrl:yE,importData:function(e){var t=e.diagram,n=e.data,r=e.uploader;if(n&&(n.body||n.head)&&t){if(t.import(n),r&&"edit"===t.interaction.currentMode){var o=[];return n.body.forEach((function(e){Wt(e,(function(e){o.push(yE({model:e,diagram:t,uploader:r}))}))})),o}return[]}},get map(){return cx},cleanHashCache:function(){cx={}},addHashCache:lx,getHashCache:ux,generateHash:sx,executeCollapseExpand:gE,enableCollapseExpand:bE,collapseActive:xE,mindmapInsertLine:wE,mindToolbarConfigs:kE,uploadMindmapImage:function(e){var t=e.file,n=e.uploader,r=e.diagram,o=e.from;return new Promise((function(e){fE({file:t,uploader:n,enable:function(){return r.command.enable("MindmapAttachImage")||r.command.enable("MindmapInsertImage")},onTemporaryOnLoad:function(t){"clipboard"===o&&(t.firstInsertRatio=1/window.devicePixelRatio),0===r.selector.selections.length||"drop"===o?r.command.execute("MindmapInsertImage",{image:t}):1===r.selector.selections.length&&r.command.execute("MindmapAttachImage",{image:t}),e(t)}})}))},generateBoardWebProxy:function(e,t,n,o){var a,i;if(null==e||null===(a=e.templates)||void 0===a||!a.v2||!t)return null;var c,l,u,s,d,f=new r.Uploader({docId:t,docDomain:"User"});function h(){return p.apply(this,arguments)}function p(){return(p=de()(he.a.mark((function t(){var n,r,o,a=arguments;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.templates.v2.find(CE({include_types:"official",official_channel:"material_lib_board_config",format:"lakeboard"},n));case 3:return r=t.sent,t.next=6,e.templates.v2.find(CE({include_types:"personal",scene:"material",format:"lakeboard"},n));case 6:return o=t.sent,t.abrupt("return",[].concat(T()(null==r?void 0:r.data.map((function(e){var t,n,o,a,i=null==r?void 0:r.meta,c=null==i?void 0:i.official,l={id:e.id,title:e.name,doclet_id:e.doclet_id,cover:e.cover,category:"official"};return null!=e&&null!==(t=e.meta)&&void 0!==t&&t.description&&(l.description=null==e||null===(o=e.meta)||void 0===o?void 0:o.description),null!=e&&null!==(n=e.meta)&&void 0!==n&&n.descriptionUrl&&(l.href=null==e||null===(a=e.meta)||void 0===a?void 0:a.descriptionUrl),c&&c.forEach((function(t){var n=t.id,r=t.name_en,o=t.name_zh;t.template_ids.includes(e.id)&&(l.group="zh-cn"!==AE?r:o,l.group_id=n)})),l}))),T()(null==o?void 0:o.data.map((function(e){return{id:e.id,doclet_id:e.doclet_id,cover:e.cover,category:"personal"}})))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{iconfont:{disable:!(null==o||null===(i=o.settings)||void 0===i||!i.disable_iconfont),search:(d=de()(he.a.mark((function t(n){var r,o,a,i;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.keyword,o=n.page_size,a=n.page,t.prev=1,t.next=4,e.editor.iconfont({query:r,page_size:o,page:a});case 4:if(!(i=t.sent)){t.next=7;break}return t.abrupt("return",{data:i.icons.map((function(e){return{name:e.name,svg:e.show_svg.replace("currentColor","#666")}})),count:i.count});case 7:return t.abrupt("return",null);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),function(e){return d.apply(this,arguments)})},uploader:{image:(s=de()(he.a.mark((function e(){var t=arguments;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.image.apply(f,t));case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},material:{use:(u=de()(he.a.mark((function t(n){var r,o,a,i;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.templates.v2.useMaterial({template_id:n});case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:if(o=r.data){t.next=8;break}return t.abrupt("return",null);case 8:if(!(a=o.doclet.body)){t.next=12;break}return i=JSON.parse(a),t.abrupt("return",i);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)}))),function(e){return u.apply(this,arguments)}),destroy:(l=de()(he.a.mark((function t(n){return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.templates.v2.destroy({id:n});case 1:case"end":return t.stop()}}),t)}))),function(e){return l.apply(this,arguments)}),create:(c=de()(he.a.mark((function t(n){var r,o,a,i,c,l;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.cover,o=n.diagramData,a=n.graphicsBBox,t.prev=1,!r||!o){t.next=13;break}return PE.set("graphicsBBox",a),PE.set("diagramData",o),i=Date.now(),c=new Date(i),t.next=9,e.templates.v2.create({scene:"material",in_edit:!1,name:"用户自定义素材".concat(c.toLocaleDateString()),target_type:"User",format:"lakeboard",cover:r,template_type:3,type:"Board",body:JSON.stringify(PE.export())});case 9:if(l=t.sent){t.next=12;break}return t.abrupt("return");case 12:return t.abrupt("return",l);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])}))),function(e){return c.apply(this,arguments)}),findMaxi:function(){return de()(he.a.mark((function e(){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({limit:100}));case 1:case"end":return e.stop()}}),e)})))()},findMini:function(){return de()(he.a.mark((function e(){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({limit:16}));case 1:case"end":return e.stop()}}),e)})))()}},spm:n}},Model:EE,MAXI_MAX_MATERIAL_COUNT:100,MINI_MAX_MATERIAL_COUNT:16,getMaterialCells:px,createMaterial:mx})},3696:function(e,t,n){"use strict";n(3470);var r=n(3469);n(3463);t.a=r.a},3699:function(e,t,n){e.exports=n(3706)},3706:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=c(o),i=c(n(8));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollListener=n.scrollListener.bind(n),n.eventListenerOptions=n.eventListenerOptions.bind(n),n.mousewheelListener=n.mousewheelListener.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}},{key:"componentDidUpdate",value:function(){if(this.props.isReverse&&this.loadMore){var e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}},{key:"componentWillUnmount",value:function(){this.detachScrollListener(),this.detachMousewheelListener()}},{key:"isPassiveSupported",value:function(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}},{key:"eventListenerOptions",value:function(){this.props.useCapture;return this.isPassiveSupported()?{useCapture:this.props.useCapture,passive:!0}:{passive:!1}}},{key:"setDefaultLoader",value:function(e){this.defaultLoader=e}},{key:"detachMousewheelListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}},{key:"detachScrollListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}},{key:"getParentElement",value:function(e){var t=this.props.getScrollParent&&this.props.getScrollParent();return null!=t?t:e&&e.parentNode}},{key:"filterProps",value:function(e){return e}},{key:"attachScrollListener",value:function(){var e=this.getParentElement(this.scrollComponent);if(this.props.hasMore&&e){var t=window;!1===this.props.useWindow&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}}},{key:"mousewheelListener",value:function(e){1!==e.deltaY||this.isPassiveSupported()||e.preventDefault()}},{key:"scrollListener",value:function(){var e=this.scrollComponent,t=window,n=this.getParentElement(e),r=void 0;if(this.props.useWindow){var o=document.documentElement||document.body.parentNode||document.body,a=void 0!==t.pageYOffset?t.pageYOffset:o.scrollTop;r=this.props.isReverse?a:this.calculateOffset(e,a)}else r=this.props.isReverse?n.scrollTop:e.scrollHeight-n.scrollTop-n.clientHeight;r<Number(this.props.threshold)&&e&&null!==e.offsetParent&&(this.detachScrollListener(),this.beforeScrollHeight=n.scrollHeight,this.beforeScrollTop=n.scrollTop,"function"==typeof this.props.loadMore&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}},{key:"calculateOffset",value:function(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}},{key:"calculateTopPosition",value:function(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}},{key:"render",value:function(){var e=this,t=this.filterProps(this.props),n=t.children,r=t.element,o=t.hasMore,i=(t.initialLoad,t.isReverse),c=t.loader,l=(t.loadMore,t.pageStart,t.ref),u=(t.threshold,t.useCapture,t.useWindow,t.getScrollParent,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["children","element","hasMore","initialLoad","isReverse","loader","loadMore","pageStart","ref","threshold","useCapture","useWindow","getScrollParent"]));u.ref=function(t){e.scrollComponent=t,l&&l(t)};var s=[n];return o&&(c?i?s.unshift(c):s.push(c):this.defaultLoader&&(i?s.unshift(this.defaultLoader):s.push(this.defaultLoader))),a.default.createElement(r,u,s)}}]),t}(o.Component);l.propTypes={children:i.default.node.isRequired,element:i.default.node,hasMore:i.default.bool,initialLoad:i.default.bool,isReverse:i.default.bool,loader:i.default.node,loadMore:i.default.func.isRequired,pageStart:i.default.number,ref:i.default.func,getScrollParent:i.default.func,threshold:i.default.number,useCapture:i.default.bool,useWindow:i.default.bool},l.defaultProps={element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null},t.default=l,e.exports=t.default},3708:function(e,t,n){"use strict";t.a={list:"TemplateList-module_list_7Gkfr",item:"TemplateList-module_item_SpAc7",tip:"TemplateList-module_tip_UaJ8v",name:"TemplateList-module_name_ywSQW",desc:"TemplateList-module_desc_hb3sC",docIconWrapper:"TemplateList-module_docIconWrapper_Gvaw8",moreImg:"TemplateList-module_moreImg_12JlL"}},3709:function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3244)),a=r(n(3471)),i=r(n(3)),c=r(n(34)),l=r(n(0)),u=r(n(39)),s=void 0,d=void 0,f=[],h=function(e){return"undefined"!=typeof window&&window.requestAnimationFrame(e)},p=function(e){return"undefined"!=typeof window&&window.cancelAnimationFrame(e)},m=void 0,y=function(){return Date.now()},v=void 0,g=void 0,b=function(e,t){return d={fn:e,transform:t}},x=function(e){return f=e},w=function(e){return s=e},k=function(e){return m=e},E=function(e){return v=e},O=function(e){return g=e},C=Object.freeze({get bugfixes(){return s},get applyAnimatedValues(){return d},get colorNames(){return f},get requestFrame(){return h},get cancelFrame(){return p},get interpolation(){return m},get now(){return y},get defaultElement(){return v},get createAnimatedStyle(){return g},injectApplyAnimatedValues:b,injectColorNames:x,injectBugfixes:w,injectInterpolation:k,injectFrame:function(e,t){var n;return h=(n=[e,t])[0],p=n[1],n},injectNow:function(e){return y=e},injectDefaultElement:E,injectCreateAnimatedStyle:O}),A=function(){function e(){}var t=e.prototype;return t.attach=function(){},t.detach=function(){},t.getValue=function(){},t.getAnimatedValue=function(){return this.getValue()},t.addChild=function(e){},t.removeChild=function(e){},t.getChildren=function(){return[]},e}(),P=function(e){return Object.keys(e).map((function(t){return e[t]}))},S=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).children=[],t.getChildren=function(){return t.children},t.getPayload=function(e){return void 0===e&&(e=void 0),void 0!==e&&t.payload?t.payload[e]:t.payload||i(t)},t}a(t,e);var n=t.prototype;return n.addChild=function(e){0===this.children.length&&this.attach(),this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1),0===this.children.length&&this.detach()},t}(A),j=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).payload=[],t.getAnimatedValue=function(){return t.getValue()},t.attach=function(){return t.payload.forEach((function(e){return e instanceof A&&e.addChild(i(t))}))},t.detach=function(){return t.payload.forEach((function(e){return e instanceof A&&e.removeChild(i(t))}))},t}return a(t,e),t}(S),R=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).payload={},t.getAnimatedValue=function(){return t.getValue(!0)},t.attach=function(){return P(t.payload).forEach((function(e){return e instanceof A&&e.addChild(i(t))}))},t.detach=function(){return P(t.payload).forEach((function(e){return e instanceof A&&e.removeChild(i(t))}))},t}return a(t,e),t.prototype.getValue=function(e){void 0===e&&(e=!1);var t={};for(var n in this.payload){var r=this.payload[n];(!e||r instanceof A)&&(t[n]=r instanceof A?r[e?"getAnimatedValue":"getValue"]():r)}return t},t}(S),_=function(e){function t(t){var n;return n=e.call(this)||this,!(t=t||{}).transform||t.transform instanceof A||(t=d.transform(t)),n.payload=t,n}return a(t,e),t}(R),M={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},L=function(){function e(){}return e.create=function(t,n,r){if("function"==typeof t)return t;if(m&&t.output&&"string"==typeof t.output[0])return m(t);if(Array.isArray(t))return e.create({range:t,output:n,extrapolate:r||"extend"});var o=t.output,a=t.range||[0,1],i=t.easing||function(e){return e},c="extend",l=t.map;void 0!==t.extrapolateLeft?c=t.extrapolateLeft:void 0!==t.extrapolate&&(c=t.extrapolate);var u="extend";return void 0!==t.extrapolateRight?u=t.extrapolateRight:void 0!==t.extrapolate&&(u=t.extrapolate),function(e){var t=function(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}(e,a);return function(e,t,n,r,o,a,i,c,l){var u=l?l(e):e;if(u<t){if("identity"===i)return u;"clamp"===i&&(u=t)}if(u>n){if("identity"===c)return u;"clamp"===c&&(u=n)}if(r===o)return r;if(t===n)return e<=t?r:o;t===-1/0?u=-u:n===1/0?u-=t:u=(u-t)/(n-t);u=a(u),r===-1/0?u=-u:o===1/0?u+=r:u=u*(o-r)+r;return u}(e,a[t],a[t+1],o[t],o[t+1],i,c,u,l)}},e}();var T="[-+]?\\d*\\.?\\d+",D=T+"%";function N(){return"\\(\\s*("+Array.prototype.slice.call(arguments).join(")\\s*,\\s*(")+")\\s*\\)"}var B=new RegExp("rgb"+N(T,T,T)),I=new RegExp("rgba"+N(T,T,T,T)),F=new RegExp("hsl"+N(T,D,D)),q=new RegExp("hsla"+N(T,D,D,T)),z=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,G=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Y=/^#([0-9a-fA-F]{6})$/,H=/^#([0-9a-fA-F]{8})$/;function V(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function U(e,t,n){var r=n<.5?n*(1+t):n+t-n*t,o=2*n-r,a=V(o,r,e+1/3),i=V(o,r,e),c=V(o,r,e-1/3);return Math.round(255*a)<<24|Math.round(255*i)<<16|Math.round(255*c)<<8}function W(e){var t=parseInt(e,10);return t<0?0:t>255?255:t}function X(e){return(parseFloat(e)%360+360)%360/360}function K(e){var t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function Z(e){var t=parseFloat(e);return t<0?0:t>100?1:t/100}function Q(e){var t,n,r="number"==typeof(t=e)?t>>>0===t&&t>=0&&t<=4294967295?t:null:(n=Y.exec(t))?parseInt(n[1]+"ff",16)>>>0:M.hasOwnProperty(t)?M[t]:(n=B.exec(t))?(W(n[1])<<24|W(n[2])<<16|W(n[3])<<8|255)>>>0:(n=I.exec(t))?(W(n[1])<<24|W(n[2])<<16|W(n[3])<<8|K(n[4]))>>>0:(n=z.exec(t))?parseInt(n[1]+n[1]+n[2]+n[2]+n[3]+n[3]+"ff",16)>>>0:(n=H.exec(t))?parseInt(n[1],16)>>>0:(n=G.exec(t))?parseInt(n[1]+n[1]+n[2]+n[2]+n[3]+n[3]+n[4]+n[4],16)>>>0:(n=F.exec(t))?(255|U(X(n[1]),Z(n[2]),Z(n[3])))>>>0:(n=q.exec(t))?(U(X(n[1]),Z(n[2]),Z(n[3]))|K(n[4]))>>>0:null;return null===r?e:"rgba("+((4278190080&(r=r||0))>>>24)+", "+((16711680&r)>>>16)+", "+((65280&r)>>>8)+", "+(255&r)/255+")"}var $=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,J=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,ee=new RegExp("("+Object.keys(M).join("|")+")","g");var te=function(e){function t(n,r,o){var a;return(a=e.call(this)||this).getValue=function(){var e;return(e=a).calc.apply(e,a.payload.map((function(e){return e.getValue()})))},a.updateConfig=function(e,t){return a.calc=L.create(e,t)},a.interpolate=function(e,n){return new t(i(a),e,n)},a.payload=n instanceof j&&!n.updateConfig?n.payload:Array.isArray(n)?n:[n],a.calc=L.create(r,o),a}return a(t,e),t}(j);function ne(e,t){"function"==typeof e.update?t.add(e):e.getChildren().forEach((function(e){return ne(e,t)}))}var re=function(e){function t(t){var n;return(n=e.call(this)||this).setValue=function(e,t){void 0===t&&(t=!0),n.value=e,t&&n.flush()},n.getValue=function(){return n.value},n.updateStyles=function(){return ne(i(n),n.animatedStyles)},n.updateValue=function(e){return n.flush(n.value=e)},n.interpolate=function(e,t){return new te(i(n),e,t)},n.value=t,n.animatedStyles=new Set,n.done=!1,n.startPosition=t,n.lastPosition=t,n.lastVelocity=void 0,n.lastTime=void 0,n.controller=void 0,n}a(t,e);var n=t.prototype;return n.flush=function(){0===this.animatedStyles.size&&this.updateStyles(),this.animatedStyles.forEach((function(e){return e.update()}))},n.prepare=function(e){void 0===this.controller&&(this.controller=e),this.controller===e&&(this.startPosition=this.value,this.lastPosition=this.value,this.lastVelocity=e.isActive?this.lastVelocity:void 0,this.lastTime=e.isActive?this.lastTime:void 0,this.done=!1,this.animatedStyles.clear())},t}(S),oe=function(e){function t(t){var n;return(n=e.call(this)||this).setValue=function(e,t){void 0===t&&(t=!0),Array.isArray(e)?e.length===n.payload.length&&e.forEach((function(e,r){return n.payload[r].setValue(e,t)})):n.payload.forEach((function(r,o){return n.payload[o].setValue(e,t)}))},n.getValue=function(){return n.payload.map((function(e){return e.getValue()}))},n.interpolate=function(e,t){return new te(i(n),e,t)},n.payload=t.map((function(e){return new re(e)})),n}return a(t,e),t}(j);function ae(e,t){return null==e?t:e}function ie(e){return void 0!==e?Array.isArray(e)?e:[e]:[]}function ce(e,t){if(typeof e!=typeof t)return!1;if("string"==typeof e||"number"==typeof e)return e===t;var n;for(n in e)if(!(n in t))return!1;for(n in t)if(e[n]!==t[n])return!1;return void 0!==n||e===t}function le(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"==typeof e?e.apply(void 0,n):e}function ue(e){return Object.keys(e).map((function(t){return e[t]}))}function se(e){var t=function(e){return e.to,e.from,e.config,e.native,e.onStart,e.onRest,e.onFrame,e.children,e.reset,e.reverse,e.force,e.immediate,e.impl,e.inject,e.delay,e.attach,e.destroyed,e.interpolateTo,e.autoStart,e.ref,o(e,["to","from","config","native","onStart","onRest","onFrame","children","reset","reverse","force","immediate","impl","inject","delay","attach","destroyed","interpolateTo","autoStart","ref"])}(e),n=Object.keys(e).reduce((function(n,r){var o;return void 0!==t[r]?n:c({},n,((o={})[r]=e[r],o))}),{});return c({to:t},n)}function de(e,t){var n,r=t[0],o=t[1];return c({},e,((n={})[r]=new(Array.isArray(o)?oe:re)(o),n))}function fe(e){var t=e.from,n=e.to,r=e.native,o=Object.entries(c({},t,n));return r?o.reduce(de,{}):c({},t,n)}function he(e,t){return t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e}var pe=function(e){return"auto"===e};var me={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ye=["Webkit","Ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}me=Object.keys(me).reduce((function(e,t){return ye.forEach((function(n){return e[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(n,t)]=e[t]})),e}),me);var ge={};O((function(e){return new _(e)})),E("div"),k((function(e){var t=e.output.map((function(e){return e.replace(J,Q)})).map((function(e){return e.replace(ee,Q)})),n=t[0].match($).map((function(){return[]}));t.forEach((function(e){e.match($).forEach((function(e,t){return n[t].push(+e)}))}));var r=t[0].match($).map((function(t,r){return L.create(c({},e,{output:n[r]}))}));return function(e){var n=0;return t[0].replace($,(function(){return r[n++](e)})).replace(/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,(function(e,t,n,r,o){return"rgba("+Math.round(t)+", "+Math.round(n)+", "+Math.round(r)+", "+o+")"}))}})),x(M),w((function(e,t){var n=e.from,r=e.to,o=e.children;if(ue(r).some(pe)||ue(n).some(pe)){var a=o(fe(e));if(a){Array.isArray(a)&&(a={type:"div",props:{children:a}});var i=a.props.style;return l.createElement(a.type,c({key:a.key?a.key:void 0},a.props,{style:c({},i,{position:"absolute",visibility:"hidden"}),ref:function(o){if(o){var a,i,l=u.findDOMNode(o),s=getComputedStyle(l);if("border-box"===s.boxSizing)a=l.offsetWidth,i=l.offsetHeight;else{var d=parseFloat(s.paddingLeft||0)+parseFloat(s.paddingRight||0),f=parseFloat(s.paddingTop||0)+parseFloat(s.paddingBottom||0),h=parseFloat(s.borderLeftWidth||0)+parseFloat(s.borderRightWidth||0),p=parseFloat(s.borderTopWidth||0)+parseFloat(s.borderBottomWidth||0);a=l.offsetWidth-d-h,i=l.offsetHeight-f-p}var m=function(e,t){return function(n,r){var o,a=r[0],i=r[1];return c({},n,((o={})[a]="auto"===i?~a.indexOf("height")?t:e:i,o))}}(a,i);t(c({},e,{from:Object.entries(n).reduce(m,n),to:Object.entries(r).reduce(m,r)}))}}}))}}})),b((function(e,t){if(!e.nodeType||void 0===e.setAttribute)return!1;var n=t.style,r=t.children,a=t.scrollTop,i=t.scrollLeft,c=o(t,["style","children","scrollTop","scrollLeft"]);for(var l in void 0!==a&&(e.scrollTop=a),void 0!==i&&(e.scrollLeft=i),void 0!==r&&(e.textContent=r),n)if(n.hasOwnProperty(l)){var u=0===l.indexOf("--"),s=ve(l,n[l],u);"float"===l&&(l="cssFloat"),u?e.style.setProperty(l,s):e.style[l]=s}for(var d in c){var f=ge[d]||(ge[d]=d.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()})));void 0!==e.getAttribute(f)&&e.setAttribute(f,c[d])}}),(function(e){return e}));var be=!1,xe=new Set,we=function e(){var t=y(),n=xe,r=Array.isArray(n),o=0;for(n=r?n:n[Symbol.iterator]();;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if((o=n.next()).done)break;a=o.value}for(var i=a,c=!0,l=!0,u=0;u<i.configs.length;u++){for(var s=i.configs[u],d=void 0,f=void 0,p=0;p<s.animatedValues.length;p++){var m=s.animatedValues[p];if(!m.done){var v=s.fromValues[p],g=s.toValues[p],b=m.lastPosition,x=g instanceof A,w=Array.isArray(s.initialVelocity)?s.initialVelocity[p]:s.initialVelocity;if(x&&(g=g.getValue()),s.immediate||!x&&!s.decay&&v===g)m.updateValue(g),m.done=!0;else if(s.delay&&t-i.startTime<s.delay)c=!1;else if(l=!1,"string"!=typeof v&&"string"!=typeof g){if(void 0!==s.duration)b=v+s.easing((t-i.startTime-s.delay)/s.duration)*(g-v),d=t>=i.startTime+s.delay+s.duration;else if(s.decay)b=v+w/(1-.998)*(1-Math.exp(-(1-.998)*(t-i.startTime))),(d=Math.abs(m.lastPosition-b)<.1)&&(g=b);else{f=void 0!==m.lastTime?m.lastTime:t,w=void 0!==m.lastVelocity?m.lastVelocity:s.initialVelocity,t>f+64&&(f=t);for(var k=Math.floor(t-f),E=0;E<k;++E){b+=1*(w+=1*((-s.tension*(b-g)+-s.friction*w)/s.mass)/1e3)/1e3}var O=!(!s.clamp||0===s.tension)&&(v<g?b>g:b<g),C=Math.abs(w)<=s.precision,P=0===s.tension||Math.abs(g-b)<=s.precision;d=O||C&&P,m.lastVelocity=w,m.lastTime=t}x&&!s.toValues[p].done&&(d=!1),d?(m.value!==g&&(b=g),m.done=!0):c=!1,m.updateValue(b),m.lastPosition=b}else m.updateValue(g),m.done=!0}}!i.props.onFrame&&i.props.native||(i.animatedProps[s.name]=s.interpolation.getValue())}!i.props.onFrame&&i.props.native||(!i.props.native&&i.onUpdate&&i.onUpdate(),i.props.onFrame&&i.props.onFrame(i.animatedProps)),c&&(xe.delete(i),i.debouncedOnEnd({finished:!0,noChange:l}))}xe.size?h(e):be=!1},ke=function(e){xe.has(e)&&xe.delete(e)},Ee=function(){function e(e,t){var n=this;void 0===t&&(t={native:!0,interpolateTo:!0,autoStart:!0}),this.getValues=function(){return n.props.native?n.interpolations:n.animatedProps},this.dependents=new Set,this.isActive=!1,this.hasChanged=!1,this.props={},this.merged={},this.animations={},this.interpolations={},this.animatedProps={},this.configs=[],this.frame=void 0,this.startTime=void 0,this.lastTime=void 0,this.update(c({},e,t))}var t=e.prototype;return t.update=function(e){var t=this;this.props=c({},this.props,e);var n=this.props.interpolateTo?se(this.props):this.props,r=n.from,o=void 0===r?{}:r,a=n.to,i=void 0===a?{}:a,l=n.config,u=void 0===l?{}:l,s=n.delay,d=void 0===s?0:s,h=n.reverse,p=n.attach,m=n.reset,y=n.immediate,v=n.autoStart,g=n.ref;if(h){var b=[i,o];o=b[0],i=b[1]}this.hasChanged=!1;var x=p&&p(this),w=m?{}:this.merged;if(this.merged=c({},o,w,i),this.animations=Object.entries(this.merged).reduce((function(e,n,r){var a,i,l,s=n[0],h=n[1],p=!m&&e[s]||{},v="number"==typeof h,g="string"==typeof h&&!h.startsWith("#")&&!/\d/.test(h)&&!f[h],b=!v&&!g&&Array.isArray(h),w=void 0!==o[s]?o[s]:h,k=v||b||g?h:1,E=le(u,s);if(x&&(k=x.animations[s].parent),void 0===E.decay&&ce(p.changes,h))return e;if(t.hasChanged=!0,v||g)i=l=p.parent||new re(w);else if(b)i=l=p.parent||new oe(w);else{var O=p.interpolation&&p.interpolation.calc(p.parent.value);p.parent?(i=p.parent).setValue(0,!1):i=new re(0);var C={output:[void 0!==O?O:w,h]};p.interpolation?(l=p.interpolation,p.interpolation.updateConfig(C)):l=i.interpolate(C)}le(y,s)&&i.setValue(h,!1);var A=ie(i.getPayload());return A.forEach((function(e){return e.prepare(t)})),c({},e,((a={})[s]=c({},p,{name:s,parent:i,interpolation:l,animatedValues:A,changes:h,fromValues:ie(i.getValue()),toValues:ie(x?k.getPayload():k),immediate:le(y,s),delay:ae(E.delay,d||0),initialVelocity:ae(E.velocity,0),clamp:ae(E.clamp,!1),precision:ae(E.precision,.01),tension:ae(E.tension,170),friction:ae(E.friction,26),mass:ae(E.mass,1),duration:E.duration,easing:ae(E.easing,(function(e){return e})),decay:E.decay}),a))}),this.animations),this.hasChanged)for(var k in this.configs=ue(this.animations),this.animatedProps={},this.interpolations={},this.animations)this.interpolations[k]=this.animations[k].interpolation,this.animatedProps[k]=this.animations[k].interpolation.getValue();for(var E=arguments.length,O=new Array(E>1?E-1:0),C=1;C<E;C++)O[C-1]=arguments[C];g||!v&&!O.length||this.start.apply(this,O);var A=O[0],P=O[1];return this.onEnd="function"==typeof A&&A,this.onUpdate=P,this.getValues()},t.start=function(e,t){var n,r=this;return this.startTime=y(),this.isActive&&this.stop(),this.isActive=!0,this.onEnd="function"==typeof e&&e,this.onUpdate=t,this.props.onStart&&this.props.onStart(),n=this,xe.has(n)||(xe.add(n),be||h(we),be=!0),new Promise((function(e){return r.resolve=e}))},t.stop=function(e){void 0===e&&(e=!1),e&&ue(this.animations).forEach((function(e){return e.changes=void 0})),this.debouncedOnEnd({finished:e})},t.destroy=function(){ke(this),this.props={},this.merged={},this.animations={},this.interpolations={},this.animatedProps={},this.configs=[]},t.debouncedOnEnd=function(e){ke(this),this.isActive=!1;var t=this.onEnd;this.onEnd=null,t&&t(e),this.resolve&&this.resolve(),this.resolve=null},e}(),Oe=function(e){function t(t,n){var r;return r=e.call(this)||this,t.style&&(t=c({},t,{style:g(t.style)})),r.payload=t,r.update=n,r.attach(),r}return a(t,e),t}(R);function Ce(e){var t=function(t){function n(e){var n;return(n=t.call(this)||this).callback=function(){n.node&&(!1===d.fn(n.node,n.propsAnimated.getAnimatedValue(),i(n))&&n.forceUpdate())},n.attachProps(e),n}a(n,t);var r=n.prototype;return r.componentWillUnmount=function(){this.propsAnimated&&this.propsAnimated.detach()},r.setNativeProps=function(e){!1===d.fn(this.node,e,this)&&this.forceUpdate()},r.attachProps=function(e){e.forwardRef;var t=o(e,["forwardRef"]),n=this.propsAnimated;this.propsAnimated=new Oe(t,this.callback),n&&n.detach()},r.shouldComponentUpdate=function(e){var t=e.style,n=o(e,["style"]),r=this.props,a=r.style;return(!ce(o(r,["style"]),n)||!ce(a,t))&&(this.attachProps(e),!0)},r.render=function(){var t=this,n=this.propsAnimated.getValue(),r=(n.scrollTop,n.scrollLeft,o(n,["scrollTop","scrollLeft"]));return l.createElement(e,c({},r,{ref:function(e){return t.node=he(e,t.props.forwardRef)}}))},n}(l.Component);return l.forwardRef((function(e,n){return l.createElement(t,c({},e,{forwardRef:n}))}))}var Ae={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Pe=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).state={lastProps:{from:{},to:{}},propsChanged:!1,internal:!1},t.controller=new Ee(null,null),t.didUpdate=!1,t.didInject=!1,t.finished=!0,t.start=function(){t.finished=!1;var e=t.mounted;t.controller.start((function(n){return t.finish(c({},n,{wasMounted:e}))}),t.update)},t.stop=function(){return t.controller.stop(!0)},t.update=function(){return t.mounted&&t.setState({internal:!0})},t.finish=function(e){var n=e.finished,r=e.noChange,o=e.wasMounted;t.finished=!0,t.mounted&&n&&(!t.props.onRest||!o&&r||t.props.onRest(t.controller.merged),t.mounted&&t.didInject&&(t.afterInject=fe(t.props),t.setState({internal:!0})),t.mounted&&(t.didInject||t.props.after)&&t.setState({internal:!0}),t.didInject=!1)},t}a(t,e);var n=t.prototype;return n.componentDidMount=function(){this.componentDidUpdate(),this.mounted=!0},n.componentWillUnmount=function(){this.mounted=!1,this.stop()},t.getDerivedStateFromProps=function(e,t){var n=t.internal,r=t.lastProps,o=e.from,a=e.to,i=e.reset,c=e.force;return{propsChanged:!ce(a,r.to)||!ce(o,r.from)||i&&!n||c&&!n,lastProps:e,internal:!1}},n.render=function(){var e=this,t=this.props.children,n=this.state.propsChanged;if(this.props.inject&&n&&!this.injectProps){var r=this.props.inject(this.props,(function(t){e.injectProps=t,e.setState({internal:!0})}));if(r)return r}(this.injectProps||n)&&(this.didInject=!1,this.injectProps?(this.controller.update(this.injectProps),this.didInject=!0):n&&this.controller.update(this.props),this.didUpdate=!0,this.afterInject=void 0,this.injectProps=void 0);var o=c({},this.controller.getValues(),this.afterInject);return this.finished&&(o=c({},o,this.props.after)),Object.keys(o).length?t(o):null},n.componentDidUpdate=function(){this.didUpdate&&this.start(),this.didUpdate=!1},t}(l.Component);Pe.defaultProps={from:{},to:{},config:Ae.default,native:!1,immediate:!1,reset:!1,force:!1,inject:s};var Se=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).first=!0,t.instances=new Set,t.hook=function(e,n,r,o){return t.instances.add(e),(o?n===r-1:0===n)?void 0:Array.from(t.instances)[o?n+1:n-1]},t}a(t,e);var n=t.prototype;return n.render=function(){var e=this,t=this.props,n=t.items,r=t.children,a=t.from,i=void 0===a?{}:a,u=t.initial,s=t.reverse,d=t.keys,f=t.delay,h=t.onRest,p=o(t,["items","children","from","initial","reverse","keys","delay","onRest"]),m=ie(n);return ie(m).map((function(t,n){return l.createElement(Pe,c({onRest:0===n?h:null,key:"function"==typeof d?d(t):ie(d)[n],from:e.first&&void 0!==u?u||{}:i},p,{delay:0===n&&f||void 0,attach:function(t){return e.hook(t,n,m.length,s)},children:function(e){var o=r(t,n);return o?o(e):null}}))}))},n.componentDidUpdate=function(e){this.first=!1,e.items!==this.props.items&&this.instances.clear()},t}(l.PureComponent);Se.defaultProps={keys:function(e){return e}};var je="__default",Re=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).guid=0,t.state={props:{},resolve:function(){return null},last:!0,index:0},t.next=function(e,n,r){return void 0===n&&(n=!0),void 0===r&&(r=0),t.running=!0,new Promise((function(o){t.mounted&&t.setState((function(t){return{props:e,resolve:o,last:n,index:r}}),(function(){return t.running=!1}))}))},t}a(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.componentDidUpdate({})},n.componentWillUnmount=function(){this.mounted=!1},n.componentDidUpdate=function(e){var t=this,n=this.props,r=n.states,o=n.filter,a=n.state;(e.state!==this.props.state||this.props.reset&&!this.running||!ce(r[a],e.states[e.state]))&&r&&a&&r[a]&&function(){var e=++t.guid,n=r[a];if(n)if(Array.isArray(n))for(var i=Promise.resolve(),c=function(r){var a=r,c=n[a],l=a===n.length-1;i=i.then((function(){return e===t.guid&&t.next(o(c),l,a)}))},l=0;l<n.length;l++)c(l);else if("function"==typeof n){var u=0;n((function(n,r){return void 0===r&&(r=!1),e===t.guid&&t.next(o(n),r,u++)}),(function(){return h((function(){return t.instance&&t.instance.stop()}))}),t.props)}else t.next(o(r[a]))}()},n.render=function(){var e=this,t=this.state,n=t.props,r=t.resolve,a=t.last,i=t.index;if(!n||0===Object.keys(n).length)return null;var u=this.props,s=(u.state,u.filter,u.states,u.config),d=u.primitive,f=u.onRest,h=u.forwardRef,p=o(u,["state","filter","states","config","primitive","onRest","forwardRef"]);return Array.isArray(s)&&(s=s[i]),l.createElement(d,c({ref:function(t){return e.instance=he(t,h)},config:s},p,n,{onRest:function(e){r(e),f&&a&&f(e)}}))},t}(l.PureComponent);Re.defaultProps={state:je};var _e=l.forwardRef((function(e,t){return l.createElement(Re,c({},e,{forwardRef:t}))}));_e.create=function(e){return function(t,n){var r;return void 0===n&&(n=function(e){return e}),("function"==typeof t||Array.isArray(t))&&((r={})[je]=t,t=r),function(r){return l.createElement(Re,c({primitive:e,states:t,filter:n},r))}}},_e.Spring=function(e){return _e.create(Pe)(e,se)},_e.Trail=function(e){return _e.create(Se)(e,se)};var Me=0,Le=function(e){var t=e.items,n=e.keys,r=o(e,["items","keys"]);return t=ie(void 0!==t?t:null),n="function"==typeof n?t.map(n):ie(n),c({items:t,keys:n.map((function(e){return String(e)}))},r)},Te=function(e){a(n,e);var t=n.prototype;function n(t){var n;return(n=e.call(this,t)||this).destroyItem=function(e,t,r){return function(o){var a=n.props,i=a.onRest,c=a.onDestroyed;n.mounted&&(c&&c(e),n.setState((function(e){return{deleted:e.deleted.filter((function(e){return e.key!==t}))}})),i&&i(e,r,o))}},n.state={first:!0,transitions:[],current:{},deleted:[],prevProps:t},n}return t.componentDidMount=function(){this.mounted=!0},t.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(e,t){var n=t.first,r=t.prevProps,a=o(t,["first","prevProps"]),i=Le(e),l=i.items,u=i.keys,s=i.initial,d=i.from,f=i.enter,h=i.leave,p=i.update,m=i.trail,y=void 0===m?0:m,v=i.unique,g=i.config,b=Le(r),x=b.keys,w=b.items,k=c({},a.current),E=[].concat(a.deleted),O=Object.keys(k),C=new Set(O),A=new Set(u),P=u.filter((function(e){return!C.has(e)})),S=a.transitions.filter((function(e){return!e.destroyed&&!A.has(e.originalKey)})).map((function(e){return e.originalKey})),j=u.filter((function(e){return C.has(e)})),R=0;P.forEach((function(e){v&&E.find((function(t){return t.originalKey===e}))&&(E=E.filter((function(t){return t.originalKey!==e})));var t=u.indexOf(e),r=l[t],o="enter";k[e]={state:o,originalKey:e,key:v?String(e):Me++,item:r,trail:R+=y,config:le(g,r,o),from:le(n&&void 0!==s?s||{}:d,r),to:le(f,r)}})),S.forEach((function(e){var t=x.indexOf(e),n=w[t],r="leave";E.push(c({},k[e],{state:r,destroyed:!0,left:x[Math.max(0,t-1)],right:x[Math.min(x.length,t+1)],trail:R+=y,config:le(g,n,r),to:le(h,n)})),delete k[e]})),j.forEach((function(e){var t=u.indexOf(e),n=l[t],r="update";k[e]=c({},k[e],{item:n,state:r,trail:R+=y,config:le(g,n,r),to:le(p,n)})}));var _=u.map((function(e){return k[e]}));return E.forEach((function(e){var t,n=e.left,r=e.right,a=o(e,["left","right"]);-1!==(t=_.findIndex((function(e){return e.originalKey===n})))&&(t+=1),-1===t&&(t=_.findIndex((function(e){return e.originalKey===r}))),-1===t&&(t=E.findIndex((function(e){return e.originalKey===n}))),-1===t&&(t=E.findIndex((function(e){return e.originalKey===r}))),t=Math.max(0,t),_=[].concat(_.slice(0,t),[a],_.slice(t))})),{first:n&&0===P.length,transitions:_,current:k,deleted:E,prevProps:e}},t.render=function(){var e=this,t=this.props,n=(t.initial,t.from,t.enter,t.leave,t.update,t.onDestroyed,t.keys,t.items,t.onFrame),r=t.onRest,a=t.onStart,i=(t.trail,t.config,t.children),u=(t.unique,t.reset),s=o(t,["initial","from","enter","leave","update","onDestroyed","keys","items","onFrame","onRest","onStart","trail","config","children","unique","reset"]);return this.state.transitions.map((function(t,o){var d,f=t.state,h=t.key,p=t.item,m=t.from,y=t.to,v=t.trail,g=t.config,b=t.destroyed;return l.createElement(_e,c({reset:u&&"enter"===f,primitive:Pe,state:f,filter:se,states:(d={},d[f]=y,d),key:h,onRest:b?e.destroyItem(p,h,f):r&&function(e){return r(p,f,e)},onStart:a&&function(){return a(p,f)},onFrame:n&&function(e){return n(p,f,e)},delay:v,config:g},s,{from:m,children:function(e){var t=i(p,f,o);return t?t(e):null}}))}))},n}(l.PureComponent);Te.defaultProps={keys:function(e){return e},unique:!1,reset:!1};var De=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].reduce((function(e,t){return e[t]=Ce(t),e}),Ce);t.Spring=Pe,t.Keyframes=_e,t.Transition=Te,t.Trail=Se,t.Controller=Ee,t.config=Ae,t.animated=De,t.interpolate=function(e,t,n){return e&&new te(e,t,n)},t.Globals=C},3712:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return g}));n(183);var r=n(104),o=(n(145),n(42)),a=n(0),i=n(185),c=n(31),l=n(3628),u=n(3623),s="TemplateTreeItem-module_item_rGFbi",d="TemplateTreeItem-module_title_15bPv",f="TemplateTreeItem-module_docIcon_494bD",h="TemplateTreeItem-module_name_kpLbs",p="TemplateTreeItem-module_menuItem_FWIgC",m="TemplateTreeItem-module_more_ikuvF",y="TemplateTreeItem-module_actionIcon_haD5C",v=a.memo((function(e){var t=e.node,n=e.className,r=e.size,o=void 0===r?"small":r;if(!Object(u.a)(t))return null;var c,s=Object(u.a)(t)&&i.FORMAT_TYPE_MAP[t.format],d=t.cover;return t.type===i.TYPE.OFFICIAL?d?a.createElement("span",{className:n},a.createElement("img",{src:d,style:{width:"100%"}})):a.createElement("span",{className:n,style:{fontSize:"large"===o?26:18}},((null===(c=t.meta)||void 0===c?void 0:c.character)||"📃").trim()):a.createElement(l.a,{width:"large"===o?26:22,className:n,type:s})})),g=a.memo((function(e){var t=e.data,n=e.hasActions,i=e.onAction,l=t;return a.createElement("div",{className:s},a.createElement("div",{className:d},Object(u.a)(l)&&a.createElement(v,{className:f,node:l}),a.createElement("span",{className:h,title:l.name},l.name),n&&a.createElement("span",{onClick:function(e){return e.stopPropagation()}},a.createElement(r.a,{type:"menu",hideWhenInactive:!0,placement:"bottomRight",arrowPointAtCenter:!0,trigger:["click"],content:a.createElement(o.a,{selectable:!1},a.createElement(o.a.Item,{key:"edit",className:p,onClick:function(){return null==i?void 0:i("edit",l)}},a.createElement(c.b,{name:"pencil-underscore",width:16,className:y}),__("编辑")),a.createElement(o.a.Item,{key:"delete",className:p,onClick:function(){return null==i?void 0:i("delete",l)}},a.createElement(c.b,{name:"icon-delete",width:16,className:y}),__("删除")))},a.createElement("span",{className:m,onClick:function(e){return e.stopPropagation()}},a.createElement(c.b,{name:"more",width:16}))))))}))},3716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n(26))&&"object"==typeof r&&"default"in r?r.default:r;function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return function(){var t,n=i(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=i(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)}}var s={PUBLISH:"yuque_sdk_publish",PUBLISH_CALLBACK:"yuque_sdk_publish_callback",RESIZE_CALLBACK:"yuque_sdk_resize_callback",CONNECT:"yuque_sdk_connect",DISCONNECT:"yuque_sdk_disconnect",FULLSCREEN_CALLBACK:"yuque_sdk_fullscreen_callback",SAVE_CALLBACK:"yuque_sdk_save_callback",SET_VALUE:"yuque_sdk_set_value",GET_VALUE:"yuque_sdk_get_value",GET_VALUE_CALLBACK:"yuque_sdk_get_value_callback",INSERT_VALUE:"yuque_sdk_insert_value",CHANGE_CALLBACK:"yuque_sdk_change_callback",SET_TITLE_VALUE:"yuque_sdk_set_title_value",GET_TITLE_VALUE:"yuque_sdk_get_title_value",GET_TITLE_VALUE_CALLBACK:"yuque_sdk_get_title_value_callback",SAVE_TITLE_CALLBACK:"yuque_sdk_save_title_callback",TITLE_CHANGE_CALLBACK:"yuque_sdk_title_change_callback",SCROLL_TO:"yuque_sdk_scroll_to",DOC_LOADED_CALLBACK:"yuque_sdk_doc_loaded_callback",UNLOCK:"yuque_sdk_unlock",UNLOCK_CALLBACK:"yuque_sdk_unlock_callback",RESET:"yuque_sdk_reset",RESET_CALLBACK:"yuque_sdk_reset_callback",LOAD_CALLBACK:"yuque_sdk_load_callback"},d=0,f=function(e){a(n,o);var t=u(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).init=function(t){e.url=location.href,e.target=t,e._postMessageToParent({type:s.CONNECT,url:e.url}),window.addEventListener("message",(function t(n){("string"==typeof n.data?JSON.parse(n.data):n.data).type===s.CONNECT&&(e._postMessageToParent({type:s.CONNECT,url:e.url}),window.removeEventListener("message",t,!1))}),!1),window.addEventListener("unload",(function(){e._postMessageToParent({type:s.DISCONNECT,url:e.url})}))},e._postMessageToParent=function(t){e.target&&e.target.postMessage(JSON.stringify(t),"*")},e.postMessage=function(t,n){var r={type:t,message:n,messageId:++d,url:e.url};e._postMessageToParent(r)},e.handleMessage=function(t){return e.emit("message",t)},e.ready=!1,e}return n}(),h=new f,p=function(e){try{var t="string"==typeof e.data?JSON.parse(e.data):e.data;h.handleMessage(t)}catch(e){console&&console.error(e)}};window&&window.parent&&window.self!==window.top&&(h.init(window.parent),window.addEventListener("message",p));t.MESSAGE_TYPES=s,t.eventHandler=p,t.handler=h,t.onMessage=function(e){return h.on("message",e)},t.postMessage=function(e,t){return h.postMessage(e,t)}},3717:function(e,t,n){},3718:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n.n(r),a=n(8),i=n.n(a);function c(e){var t=e.disableLink,n=e.url,r=e.children,a=e.className,i=e.target,c=e.rel,l=e.dataAspmClick,u=e.title;return o.a.createElement("a",{href:t?"#":n,className:a,target:i,rel:c,title:u,"data-aspm-click":l},r)}c.propTypes={disableLink:i.a.bool,url:i.a.string,children:i.a.arrayOf(i.a.element),className:i.a.string,rel:i.a.string,target:i.a.string,dataAspmClick:i.a.string,title:i.a.string}},3813:function(e,t,n){"use strict";n(84);var r=n(45),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(126),u=n.n(l),s=n(429),d=n(3814);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var h=["children"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){v=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function p(){}function m(){}var y={};l(y,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(y=b);var x=m.prototype=h.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==f(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return p.prototype=m,r(x,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:p,configurable:!0}),p.displayName=l(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function x(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=w(Object(o.useState)(!1),2),n=t[0],i=t[1];function c(){i(!1)}function l(){var t;return t=v().mark((function t(){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dispatch({type:"proxy.web/contentReport.check",payload:{data:{target_id:e.targetId,target_type:e.targetType,token:window.appData.sharePage&&window.appData.share.token}}});case 2:i(!0);case 3:case"end":return t.stop()}}),t)})),l=function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){x(a,r,o,i,c,"next",e)}function c(e){x(a,r,o,i,c,"throw",e)}i(void 0)}))},l.apply(this,arguments)}var u=e.children,s=b(e,h);return a.a.createElement(a.a.Fragment,null,u({onShowPanel:function(){return l.apply(this,arguments)}}),a.a.createElement(r.a,{destroyOnClose:!0,title:null,footer:null,visible:n,onCancel:c},a.a.createElement(d.default,g({},s,{onClose:c}))))};E.propTypes=m(m({},u()(d.default.propTypes,["targetId","targetType"])),{},{token:c.a.string,children:c.a.func.isRequired}),t.a=Object(s.d)()(E)},3814:function(e,t,n){"use strict";n.r(t);n(55);var r=n(22),o=(n(61),n(23)),a=(n(247),n(66)),i=(n(98),n(37)),c=n(0),l=n.n(c),u=n(8),s=n.n(u),d=n(429),f=n(396),h=n.n(f),p=n(307),m="ReportForm-module_container_CFFvb",y="ReportForm-module_title_NFreI",v="ReportForm-module_subtitle_iS17z",g="ReportForm-module_reportType_F9Aq+",b="ReportForm-module_reportTypeItem_fcNpj",x="ReportForm-module_btns_P3Kpd",w="ReportForm-module_reportReason_Ll05f",k="ReportForm-module_backBtn_Epa1y";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(){O=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(S([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==E(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function C(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var o=M(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}(this,n)}}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function L(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}var D=[{name:__("含有广告等引导性内容"),type:"normal",code:p.REPORT_TYPE.ad},{name:__("含有辱骂等不友善内容"),type:"normal",code:p.REPORT_TYPE.abuse},{name:__("含有色情、淫秽内容"),type:"normal",code:p.REPORT_TYPE.vulgar},{name:__("含有反社会、血腥暴力等内容"),type:"normal",code:p.REPORT_TYPE.political},{name:__("“清朗”系列专项举报"),type:"normal",code:p.REPORT_TYPE.clearnet},{name:__("传播不实信息（政治类、财经类、疫情类等）"),type:"normal",code:p.REPORT_TYPE.infact},{name:__("国家企业敏感信息泄露"),type:"normal",code:p.REPORT_TYPE.sensitive},{name:__("其他违法犯罪（如毒品、枪支、违规借贷等）"),type:"normal",code:p.REPORT_TYPE.illegal},{name:__("侵犯知识产权"),type:"tort"}],N=[{name:__("个人侵权"),type:"tort",code:p.REPORT_TYPE.personal_tort},{name:__("企业侵权"),type:"tort",code:p.REPORT_TYPE.enterprise_tort}],B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(u,e);var t,n,r,c=R(u);function u(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return L(_(e=c.call.apply(c,[this].concat(n))),"handleSubmit",(function(t){t.preventDefault();var n=e.props,r=n.onOk;(0,n.form.validateFields)((function(e,t){e||r(t)}))})),e}return t=u,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return l.a.createElement(a.a,null,l.a.createElement("div",{className:v},__("具体说明")),l.a.createElement(a.a.Item,{required:!1},e("reason",{validateFirst:!0,rules:[{required:!0,max:500,message:__("请输入举报原因（字数不多于500）")}]})(l.a.createElement(i.a.TextArea,{className:w,rows:5,maxLength:500,placeholder:__("举报原因（字数不多于 500）")}))),l.a.createElement("div",{className:x},l.a.createElement(o.a,{block:!0,onClick:this.props.onCancel},__("返回")),l.a.createElement(o.a,{block:!0,type:"primary",htmlType:"submit",onClick:this.handleSubmit},__("提交"))))}}])&&S(t.prototype,n),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(l.a.PureComponent);L(B,"propTypes",{onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired,form:s.a.object.isRequired});var I=a.a.create()(B),F=function(e){var t=e.onCancel,n=e.onOk;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:v},window.h5?__("侵权类举报请到 PC 端完成"):__("请选择类型")),!window.h5&&l.a.createElement("ul",{className:g},N.map((function(e,t){return l.a.createElement("li",{key:e.code||t,className:b,onClick:function(){return function(e){n(e)}(e)}},e.name)}))),l.a.createElement(o.a,{block:!0,className:k,onClick:function(){t()}},__("返回")))};F.propTypes={onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired};var q=function(e){var t=A(Object(c.useState)(),2),n=t[0],o=t[1];function a(e,t){t.preventDefault(),o(e)}var i=function(t){return function(){var n,o=(n=O().mark((function n(o){var a,i;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=window.appData.sharePage&&window.appData.share.token,"tort"!==t.type){n.next=6;break}return e.onClose(),i=h.a.stringify({report_type:o.code,target_id:e.targetId,target_type:e.targetType,token:a}),window.open("/r/content_reports?".concat(i)),n.abrupt("return");case 6:return n.next=8,e.dispatch({type:"proxy.web/contentReport.create",payload:{data:{report_type:t.code,target_id:e.targetId,target_type:e.targetType,token:a,meta:{reason:o.reason,referer_url:window.location.href}}}});case 8:e.onClose(),r.a.success(__("已收到你的举报，感谢反馈"));case 10:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){C(a,r,o,i,c,"next",e)}function c(e){C(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(e){return o.apply(this,arguments)}}()};function u(){o(null)}return n?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:y},n.name),"tort"===n.type?l.a.createElement(F,{onOk:i(n),onCancel:u}):l.a.createElement(I,{onOk:i(n),onCancel:u})):l.a.createElement("div",{className:m},l.a.createElement("div",{className:y},__("举报")),l.a.createElement("div",{className:v},__("请选举报原因")),l.a.createElement("ul",{className:g},D.map((function(e,t){return l.a.createElement("li",{key:e.code||t,onClick:a.bind(null,e)},l.a.createElement("div",{className:b},e.name))}))))};q.propTypes={targetId:s.a.number.isRequired,targetType:s.a.oneOf(["Doc"]).isRequired,onClose:s.a.func.isRequired};t.default=Object(d.d)()(q)},3818:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),o=Object(r.createContext)(null)},3828:function(e,t,n){"use strict";n(61);var r=n(23),o=(n(95),n(38)),a=n(0),i=n.n(a),c=n(8),l=n.n(c),u=n(11),s=n.n(u),d=n(90),f=n.n(d),h=n(101),p=n.n(h),m=n(3839),y=n(3581),v=n(246),g=n(3600),b=n(3609);n(3717);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}(this,n)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function A(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===x(t)?t:String(t)}var S=f()("comment:editor.ui"),j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(l,e);var t,n,a,c=E(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),A(O(t=c.call(this,e)),"focusEditor",(function(){t.editor.focus(!0)})),A(O(t),"onLoad",(function(){t.onChange()})),A(O(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),A(O(t),"handleSubmit",(function(){t.editor.contentReady().then((function(){if(!t.editor.isEmpty()){var e={format:p.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};S("submit: ",e),t.props.onSubmit(e,(function(){t.reset()}))}}))})),A(O(t),"renderEditor",(function(){return i.a.createElement(b.default,{key:"".concat(t.state.editorInstanceId),editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit})})),A(O(t),"renderReplyTo",(function(){var e=t.props,n=e.replyId,r=e.showReply;if(!n||!r)return null;var a,c=(t.props.comments||[]).find((function(e){return e.id===n}));return c?(a=c.user?c.user.name:__("用户已注销"),i.a.createElement("div",{className:"reply-tip"},__("回复")," ",i.a.createElement("a",{href:"#comment-".concat(c.id)},"@",a),i.a.createElement(o.a,{title:__("取消回复")},i.a.createElement("span",{className:"remove-reply",onClick:t.props.cancelReplyTo},i.a.createElement("span",{className:"larkicon larkicon-close"}))))):(S("comment ".concat(n," not exists")),null)})),t.editor=new g.c({disableYuqueCardEmbedView:e.disableYuqueCardEmbedView,belong:e.target,targetType:e.type,attachType:e.type,getDefaultSuggestions:e.getDefaultSuggestions,useMiniGuide:e.useMiniGuide,isMiniSize:e.isMiniSize,placeholder:e.placeholder||" ",replyId:e.replyId||""}),t.initialDocument=t.editor.getInitialDocument(),S("init use: ",t.initialDocument),t.state={hasValue:!1,editorInstanceId:"reply_main_".concat(e.replyId||"")},t}return t=l,(n=[{key:"componentDidUpdate",value:function(e){var t=this.props.replyId;t&&e.replyId!==t&&this.focusEditor(),e.replyId!==t&&this.editor._engine.engine.renderer.updatePlaceholder(this.props.placeholder)}},{key:"reset",value:function(){var e="reply_main_".concat(this.props.replyId||"","_").concat((new Date).getTime());this.editor.reset(),this.initialDocument=g.c.getEmptyDocument(),this.editor.initialDocument=this.initialDocument,this.setState({hasValue:!1,editorInstanceId:e}),S("reset editor, new instance: ".concat(e,", document: "),this.initialDocument)}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.submitting,o=e.showAvatar,a=e.useMiniGuide,c=e.isMiniSize,l=e.group,u=e.reverseReplyButton,d=this.editor.isEditMode,f=s()({"comments-form-wrapper":!0,"edit-mode":d,"no-avatar":!o,"mini-size":c}),h=Object(m.b)(this.props.target,{me:t,group:l}),p=c?24:32;return i.a.createElement("div",{className:"comments-form-editor"},o&&i.a.createElement("div",{className:"avatar"},i.a.createElement(v.a,{src:t.avatar_url,size:p,name:t.name})),i.a.createElement("div",{className:f},i.a.createElement("div",{className:"editor-wrapper"},i.a.createElement("div",{className:"editor"},this.renderReplyTo(),this.renderEditor())),u?i.a.createElement("div",{className:"action clearfix",style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},(a||this.props.cancelable)&&i.a.createElement(r.a,{style:{marginRight:6},onClick:this.props.onCancelCreate},__("取消")),n?i.a.createElement(r.a,{disabled:"disabled"},i.a.createElement("span",null,__("提交中..."))):i.a.createElement(r.a,{disabled:this.state.hasValue&&!h?"":"disabled",onClick:this.handleSubmit},d?__("确定"):__("评论")),h&&i.a.createElement(m.a,null)):i.a.createElement("div",{className:"action clearfix"},n?i.a.createElement(r.a,{disabled:"disabled",style:{marginRight:12}},i.a.createElement("span",null,__("提交中..."))):i.a.createElement(r.a,{type:"primary",disabled:this.state.hasValue&&!h?"":"disabled",onClick:this.handleSubmit,style:{marginRight:12}},d?__("确定"):__("回复")),(a||this.props.cancelable)&&i.a.createElement("a",{className:"btn-cancel",onClick:this.props.onCancelCreate},__("取消")),h&&i.a.createElement(m.a,null))))}}])&&w(t.prototype,n),a&&w(t,a),Object.defineProperty(t,"prototype",{writable:!1}),l}(a.Component);j.defaultProps={showAvatar:!0,useMiniGuide:!1,cancelable:!1,showReply:!0,reverseReplyButton:!1},j.propTypes={me:l.a.object.isRequired,type:l.a.oneOf(y.a.TARGET_TYPES),group:l.a.object,target:l.a.object.isRequired,targetType:l.a.object,replyId:l.a.number,comments:l.a.array,cancelReplyTo:l.a.func,onSubmit:l.a.func,getDefaultSuggestions:l.a.func,submitting:l.a.bool,showAvatar:l.a.bool,useMiniGuide:l.a.bool,onCancelCreate:l.a.func,isMiniSize:l.a.bool,cancelable:l.a.bool,disableYuqueCardEmbedView:l.a.bool,placeholder:l.a.string,showReply:l.a.bool,reverseReplyButton:l.a.bool},t.a=j},3839:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(0),o=n.n(r),a=n(8),i=n(132),c={bookTips:"index-module_bookTips_cZ25F",groupTips:"index-module_groupTips_znta0",commentTips:"index-module_commentTips_eS4uK"};function l(e){var t=e.targetType,n=o.a.createElement("a",{href:"https://www.yuque.com/yuque/cdgcvd/zsw0w0",className:"wording-comment-link",target:"_blank",style:{marginLeft:"8px"}},__("了解更多"));switch(t){case"Book":return o.a.createElement("span",{className:c.bookTips,"data-testid":"forbid-tip"},__("注册 7 天后可设置为互联网可见 {learnMoreLink}",{learnMoreLink:n}));case"Group":return o.a.createElement("div",{className:c.groupTips,"data-testid":"forbid-tip"},__("注册 7 天后，即可创建知识小组 {learnMoreLink}",{learnMoreLink:n}));default:return o.a.createElement("span",{className:c.commentTips,"data-testid":"forbid-tip"},__("注册 7 天后即可参与评论 {learnMoreLink}",{learnMoreLink:n}))}}function u(e,t){var n,r=window.appData,o=r.settings,a=void 0===o?{}:o,c=r.organization,l=r.isPublicCloud,u=t||{},s=u.me,d=void 0===s?window.appData.me||{}:s,f=u.group,h=void 0===f?window.appData.group:f,p=c&&c.id;h&&i.a.isGroupOrPublication(h)&&(n=h.abilities&&h.abilities.read_private);var m=e&&e.abilities&&e.abilities.update;return!!(l&&!p&&a.enable_new_user_public_ability_forbid&&d.isNewbie&&!n&&!m)}l.propTypes={targetType:a.PropTypes.string}},3840:function(e,t,n){"use strict";n(95);var r=n(38),o=(n(183),n(104)),a=n(0),i=n.n(a),c=n(8),l=n.n(c),u=n(1604),s=n.n(u),d=n(11),f=n.n(d),h=n(31),p="CornerBubble-module_cornerBubble_2kGnu",m="CornerBubble-module_cornerCount_O3YTX",y="CornerBubble-module_cornerCountLarge_3x8Br",v="CornerBubble-module_cornerCountHover_x2J7h",g="CornerBubble-module_cornerIcon_N8Ibc",b="CornerBubble-module_btnWord_-QoZm",x="CornerBubble-module_badge_SQuZN";function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===w(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){var t,n,a,c=e.count,l=e.style,u=e.onClick,d=e.iconName,w=e.iconSize,E=e.countPopoverContent,O=e.countPopoverClassName,C=e.renderBadge,A=e.tooltipText,P=e.btnWord;return i.a.createElement(r.a,{title:A},i.a.createElement("div",{className:p,onClick:u,style:l},s()(c)&&c>0&&(n=!!E,a=i.a.createElement("div",{className:f()((t={},k(t,m,!0),k(t,v,n),k(t,y,c>99),t))},c>99?"99+":c),n?i.a.createElement(o.a,{placement:"topRight",trigger:"hover",overlayClassName:O,content:E},a):a),C&&i.a.createElement("div",{className:x},C()),!!d&&i.a.createElement(h.b,{className:g,name:d,width:w||20}),!!P&&i.a.createElement("p",{className:b},P)))};E.propTypes={iconName:l.a.string.isRequired,iconSize:l.a.number,count:l.a.number,style:l.a.object,onClick:l.a.func,countPopoverContent:l.a.element,countPopoverClassName:l.a.string,renderBadge:l.a.func,tooltipText:l.a.string,btnWord:l.a.string};t.a=E},3845:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(125),l=n(630),u=n(53),s="EmbedHeader-module_docEmbedHeader_lYs+e",d="EmbedHeader-module_embedHeaderReference_SWdkM",f="EmbedHeader-module_embedHeaderTitle_SPNfw",h="EmbedHeader-module_embedHeaderLink_Q9Vhk";function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){var t=e.title,n=e.link,r=e.height,a=e.style,i=void 0===a?{}:a,p=e.doc,m=e.book,v=e.group,g=window.appData.isYuqueMobileApp;return o.a.createElement("div",{className:s,style:y({height:"".concat(r,"px")},i)},o.a.createElement("span",{className:d},__("引用自"),"："),o.a.createElement("span",{className:f},t,o.a.createElement(l.b,{group:v,book:m,doc:p})),o.a.createElement("a",{className:h,href:n,target:"_blank",onClick:function(){!function(e){if(g){var t,n,r=(null===(t=window.nebulaMobileApp)||void 0===t||null===(n=t.envInfo)||void 0===n?void 0:n.origin)||window.location.origin;return c.a.pushWebWindow({url:"".concat(r).concat(e)}),!1}if(u.d)window.parent.postMessage({name:"openExternalLink",args:["".concat(window.location.origin).concat(e)]},"*")}(n)}},__("查看原文")))};g.propTypes={title:i.a.string,link:i.a.string,height:i.a.number,style:i.a.object,doc:i.a.object,book:i.a.object,group:i.a.object};t.a=g},3853:function(e,t,n){"use strict";n(183);var r=n(104),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(11),u=n.n(l);n(3679);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=e.reaction,n=e.users,i=e.myReaction,c=s(Object(o.useState)(!1),2),l=c[0],d=c[1];return a.a.createElement(r.a,{className:"post-reaction-detail",overlayClassName:"post-reaction-detail-popover",getPopupContainer:function(e){return e.parentNode},mouseEnterDelay:.618,trigger:["hover"],placement:"bottomLeft",onVisibleChange:function(n){d(n),!1===n?e.reset(t.id):e.loadUsers(t.id)},visible:l,content:a.a.createElement("ul",{className:"post-reaction-users"},n.map((function(e){return a.a.createElement("li",{key:e.id},a.a.createElement("a",{href:"/".concat(e.login),target:"_blank"},e.name))})))},a.a.createElement("div",{onClick:e.onReactionClick,className:u()({"post-reaction-detail-type":!0,"post-reaction-detail-active":i&&i.reaction_types&&i.reaction_types.includes(t.id)})},a.a.createElement("img",{className:"post-interaction-icon",src:t.icon,height:20}),a.a.createElement("span",{className:"post-interaction-num"},e.total)))}f.defaultProps={onReactionClick:function(){}},f.propTypes={myReaction:c.a.object,users:c.a.array.isRequired,total:c.a.number.isRequired,reaction:c.a.object.isRequired,loadUsers:c.a.func.isRequired,reset:c.a.func.isRequired,onReactionClick:c.a.func},t.a=f},3854:function(e,t,n){"use strict";n(183);var r=n(104),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(3630),u=n(31);n(3679);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=l.a.REACTIONS;function h(e){var t=e.active,n=e.totalReaction,i=e.reactionIcon,c=s(Object(o.useState)(!1),2),l=c[0],d=c[1];return a.a.createElement("div",{className:"post-reaction"},a.a.createElement(r.a,{getPopupContainer:function(e){return e.parentNode},trigger:window.h5?["click"]:["hover"],placement:e.placement,autoAdjustOverflow:!1,visible:l,arrowPointAtCenter:!0,onVisibleChange:function(e){d(e)},content:a.a.createElement("div",null,a.a.createElement("ul",{className:"post-reaction-items"},f.map((function(n){return a.a.createElement("li",{className:t.includes(n.id)?"post-reaction-active":"",key:n.id},a.a.createElement("img",{src:n.icon,onClick:function(){var r;r=n,t.includes(r.id)?e.onCancelReaction(r.id):e.onReaction(r.id),e.onReactionUpdate(r),d(!1)}}))}))))},a.a.createElement("div",null,a.a.createElement("span",{className:"post-reaction-entry"},i||a.a.createElement(u.b,{name:"comment-reaction",width:20,height:20})),n>0&&a.a.createElement("span",{className:"post-interaction-action-total"},n))))}h.defaultProps={onReactionUpdate:function(){}},h.propTypes={active:c.a.array,onReaction:c.a.func.isRequired,onCancelReaction:c.a.func.isRequired,onReactionUpdate:c.a.func,totalReaction:c.a.number,reactionIcon:c.a.element,placement:c.a.string},t.a=h},3855:function(e,t,n){"use strict";var r=n(0),o=n(90),a=n.n(o),i=n(196);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=new a.a("thread:post.port");t.a=function(e){var t=e.me,n=e.comment,o=e.onReactionUpdate,a=d(Object(r.useState)(n.reactions||[]),2),c=a[0],f=a[1],h=d(Object(r.useState)({}),2),m=h[0],y=h[1],v=d(Object(r.useState)(!1),2),g=v[0],b=v[1],x="Comment";Object(r.useEffect)((function(){f(n.reactions||[])}),[n]);var w=function(){var e=null;return t&&t.id&&(e=c.find((function(e){return e.user_id===t.id})))&&(e.reaction_types=e.action_option.split(",")),e},k=function(e){return i.webProxy.actions.create({target_id:n.id,target_type:x,action_type:"reaction",action_option:e}).then((function(n){p("success",n);var r=c.filter((function(e){return e.user_id!==t.id}));r.push({user_id:t.id,action_type:"reaction",action_option:e}),f(r),o&&o(r,{actionType:"create",userId:t.id,actionOption:e})}))};return{state:{reactions:c,reactionUserMap:m},reaction:function(e){p("reaction",e);var t=e,n=w();if(n){var r=s(n.reaction_types);if(r.includes(e))return Promise.resolve({});r.push(e),t=r.join(",")}return k(t)},cancelReaction:function(e){p("cancel reaction:",e);var r=w();if(!r)return Promise.resolve({});var a=r.reaction_types.filter((function(t){return t!==e}));if(a.length>0){var l=a.join(",");return p("update action_option",a.join(",")),k(l)}return i.webProxy.actions.destroy({target_id:n.id,target_type:x,action_type:"reaction"}).then((function(){var n=c.filter((function(e){return e.user_id!==t.id}));f(n),o&&o(n,{actionType:"delete",userId:t.id,reactionType:e})}))},loadReactionUser:function(e){p("load users for reaction",e),g||(b(!0),i.webProxy.actions.users({target_id:n.id,target_type:x,action_type:"reaction",action_option:"".concat(e),limit:30}).then((function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},m);n[e]=t,b(!1),y(n)})))},resetReactionUser:function(e){y({})},getMyReaction:w}}},3859:function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;this.queue=[],this.cache=null}r.prototype.matrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&0===e[4]&&0===e[5]||(this.cache=null,this.queue.push(e)),this},r.prototype.translate=function(e,t){return 0===e&&0===t||(this.cache=null,this.queue.push([1,0,0,1,e,t])),this},r.prototype.scale=function(e,t){return 1===e&&1===t||(this.cache=null,this.queue.push([e,0,0,t,0,0])),this},r.prototype.rotate=function(e,t,n){var r,o,a;return 0!==e&&(this.translate(t,n),r=e*Math.PI/180,o=Math.cos(r),a=Math.sin(r),this.queue.push([o,a,-a,o,0,0]),this.cache=null,this.translate(-t,-n)),this},r.prototype.skewX=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,0,Math.tan(e*Math.PI/180),1,0,0])),this},r.prototype.skewY=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,Math.tan(e*Math.PI/180),0,1,0,0])),this},r.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var e=1;e<this.queue.length;e++)this.cache=(t=this.cache,n=this.queue[e],[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1],t[0]*n[2]+t[2]*n[3],t[1]*n[2]+t[3]*n[3],t[0]*n[4]+t[2]*n[5]+t[4],t[1]*n[4]+t[3]*n[5]+t[5]]);var t,n;return this.cache},r.prototype.calc=function(e,t,n){var r;return this.queue.length?(this.cache||(this.cache=this.toArray()),[e*(r=this.cache)[0]+t*r[2]+(n?0:r[4]),e*r[1]+t*r[3]+(n?0:r[5])]):[e,t]},e.exports=r},3861:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return C}));n(55);var r=n(22),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(43),u=n.n(l),s=n(3666),d=n.n(s),f=n(3716),h=n(207),p=n(3577);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(){y=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var v={};l(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(v=b);var x=p.prototype=f.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==m(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=p,r(x,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function v(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function k(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}var E=new(n(3608).a),O=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.doc=n.doc,this.getContent=n.getContent,this.workflow=n.workflow,this.engine=n.workflow?n.workflow.engine:n.engine,this._title=this.doc&&this.doc.title,this.getTitle=function(){return t._title},E.saveToServer||(this.getTitle=n.getTitle||function(){return this.doc?this.doc.title:null}),this.change=u()(this.change,300),this.onMessage=f.onMessage,this.MESSAGE_TYPES=f.MESSAGE_TYPES,"off"===E.extraConfig.message&&r.a.config({top:-9999})}var t,n,o,a,i;return t=e,n=[{key:"_postContentMessage",value:function(e,t){if(t||(t={status:"success",message:"ok"}),t.id=this.doc.slug,"success"===t.status)return this._getEmbedData().then((function(n){t.data=b(b({},n),t.data||{}),Object(f.postMessage)(e,t)}));Object(f.postMessage)(e,t)}},{key:"_getEmbedData",value:(a=y().mark((function e(){var t,n,r,o,a,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.engine){e.next=3;break}return e.next=3,this.engine.onBeforeSave();case 3:return t=this.getContent({fullHTML:E.fullHTML}),n=t.content,r=t.html,o=t.thumbnail,a=this.getTitle(),i={id:this.doc.slug,slug:this.doc.slug,title:a},"Sheet"===this.doc.type||"Table"===this.doc.type?(i.thumbnail=o,i.lakesheet=n):(i.lake=n,i.html=r),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=a.apply(e,t);function i(e){v(o,n,r,i,c,"next",e)}function c(e){v(o,n,r,i,c,"throw",e)}i(void 0)}))},function(){return i.apply(this,arguments)})},{key:"publish",value:function(e){this._postContentMessage(f.MESSAGE_TYPES.PUBLISH_CALLBACK,e)}},{key:"save",value:function(e){this._postContentMessage(f.MESSAGE_TYPES.SAVE_CALLBACK,e)}},{key:"saveTitle",value:function(e){this._title=e,this._postContentMessage(f.MESSAGE_TYPES.SAVE_TITLE_CALLBACK,{data:{data:e},status:"success"})}},{key:"changeTitle",value:function(e,t){this._title=e,t&&this._postContentMessage(f.MESSAGE_TYPES.TITLE_CHANGE_CALLBACK,{data:{data:e},status:"success"})}},{key:"loadCallback",value:function(){Object(f.postMessage)(f.MESSAGE_TYPES.LOAD_CALLBACK)}},{key:"getValueCallback",value:function(){this._postContentMessage(f.MESSAGE_TYPES.GET_VALUE_CALLBACK)}},{key:"unlockCallback",value:function(){this._postContentMessage(f.MESSAGE_TYPES.UNLOCK_CALLBACK)}},{key:"resetCallback",value:function(){this._postContentMessage(f.MESSAGE_TYPES.RESET_CALLBACK)}},{key:"change",value:function(){this._postContentMessage(f.MESSAGE_TYPES.CHANGE_CALLBACK)}},{key:"fullScreen",value:function(e){Object(f.postMessage)(f.MESSAGE_TYPES.FULLSCREEN_CALLBACK,e)}},{key:"resize",value:function(e){Object(f.postMessage)(f.MESSAGE_TYPES.RESIZE_CALLBACK,e)}},{key:"onDocLoaded",value:function(e){Object(f.postMessage)(f.MESSAGE_TYPES.DOC_LOADED_CALLBACK,e)}},{key:"onHashChange",value:function(e){Object(f.postMessage)("hashchange",{newURL:e.newURL,oldURL:e.oldURL,href:location.href})}},{key:"connect",value:function(e){var t=this;e.on(p.i.error,(function(e){t.onError(e)})),e.on(p.i.docStatusChange,(function(e){t.onDocStatusChanged(e)})),e.on(p.i.saveTitle,(function(e){t.saveTitle({data:e,state:"success",message:"ok"})})),e.on(p.i.change,(function(){E.onchange&&t.change()})),e.on(p.i.miniExpand,(function(e){t.fullScreen(e)}))}},{key:"onDocStatusChanged",value:function(e){e===p.a.saved?this.save({status:"success",message:"ok",data:{save_type:"user"}}):e===p.a.published?this.publish():e===p.a.loaded&&this.onDocLoaded()}},{key:"onError",value:function(e){e&&e.code===p.d.PUBLISH_FAILED&&this.publish({status:"error",message:e.message})}}],n&&w(t.prototype,n),o&&w(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function C(e){var t=e.backgroundColor,n=e.autoHeight,r=e.bodyBackgroundColor,a=e.toolbarBackgroundColor;Object(o.useEffect)((function(){var e="";if(r&&(e+="\n        .lake-max-editor-wrapper-content .lake-max-editor-content {\n          background-color: ".concat(d()(r),";\n        }\n        .lake-max-editor-wrapper-content .lake-content-editor {\n          border: 0 none;\n          box-shadow: none;\n        }\n      ")),a&&(e+="\n        .lake-toolbar {\n          background-color: ".concat(d()(a),";\n        }\n      ")),t&&(e+="\n        #content,\n        .lake-content-editor,\n        .lake-title-editor .ant-input {\n          background-color: ".concat(d()(t),"\n        }\n      ")),n||(e+="\n        .lake-mini-editor .lake-content-editor-core {\n          height: calc(100vh - 40px);\n          min-height: calc(100vh - 40px);\n          overflow-y: auto;\n        }\n      "),e){var o=document.createElement("style");document.head.appendChild(o),o.type="text/css",o.appendChild(document.createTextNode(e))}}),[])}function A(e){var t=e.doc,n=e.publish,i=e.setContent,c=e.getContent,l=e.insertContent,u=e.getTitle,s=e.getContainer,d=e.autoHeight,p=(e.fullScreen,e.onLoad),m=e.workflow,y=e.engine,v=e.backgroundColor,g=e.bodyBackgroundColor,b=e.toolbarBackgroundColor,x=Object(o.useRef)(null),w=s(),k=Object(o.useRef)(null),E=Object(o.useMemo)((function(){return new O({doc:t,getContent:c,getTitle:u})}),[t,c,u]);return C({autoHeight:d,backgroundColor:v,bodyBackgroundColor:g,toolbarBackgroundColor:b}),Object(o.useEffect)((function(){Object(f.onMessage)((function(e){var t=e.type,o=e.message,a=e.options,c=void 0===a?{}:a;if(t===f.MESSAGE_TYPES.PUBLISH)n();else if(t===f.MESSAGE_TYPES.GET_VALUE)E.getValueCallback();else if(t===f.MESSAGE_TYPES.SET_VALUE)if("markdown"===c.format)try{h.a.convertMarkdownToLake(o).then((function(e){return i(e)}))}catch(e){r.a.error(__("初始化 Markdown 格式失败"))}else i(o);else if(t===f.MESSAGE_TYPES.SCROLL_TO){var u=document.querySelector(".lake-editor-scroll-container")||document.querySelector(".lake-content-editor-core");u?u.scrollTop=o:window.scrollTo(0,o)}else if(t===f.MESSAGE_TYPES.INSERT_VALUE)l(o);else if(t===f.MESSAGE_TYPES.UNLOCK)m&&m.exit({unlock:!0}).then((function(){E.unlockCallback()}));else if(t===f.MESSAGE_TYPES.RESET&&(y||m)){var s=(y||m).reset,d=function(e){s(e),E.resetCallback()};if("markdown"===c.format)try{h.a.convertMarkdownToLake(o).then((function(e){d(e)}))}catch(e){r.a.error(__("重置 Markdown 格式失败"))}else d(o)}})),E.loadCallback(),p(E),m&&E.connect(m)}),[]),Object(o.useEffect)((function(){if(w&&d){!function e(){x.current||(x.current=setTimeout((function(){x.current=null;var t=w.querySelector?w:w.current,n=t.querySelector(".lake-max-editor-content");if(n||(n=t.querySelector(".lake-content-editor")),n){var r=n.scrollHeight,o=document.querySelector(".lake-toolbar"),a=o?o.offsetHeight:0,i=document.querySelector(".lark-editor-header"),c=i?i.offsetHeight:0;k.current!==r&&(E.resize({height:a+c+r+60}),k.current=r)}e()}),300))}()}return function(){clearTimeout(x.current),x.current=null}}),[w,d]),a.a.createElement("span",null)}A.defaultProps={onLoad:function(){}},A.propTypes={doc:c.a.object,getContainer:c.a.func.isRequired,getContent:c.a.func.isRequired,getTitle:c.a.func,publish:c.a.func.isRequired,setContent:c.a.func.isRequired,autoHeight:c.a.bool,onLoad:c.a.func,insertContent:c.a.func.isRequired,engine:c.a.func.object},t.b=A},3869:function(e,t,n){"use strict";var r=n(90),o=n.n(r),a=n(26),i=n.n(a),c=n(1511);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,n)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===l(t)?t:String(t)}var y=o()("biz.comment_collab"),v={inactive:"inactive",error:"error",usersChange:"usersChange",broadcast:"broadcast",statusChange:"statusChange"},g={COMMENT_CREATE:"create",COMMENT_UPDATE:"update",COMMENT_DELETE:"destroy",BELONG_UPDATE:"belong_update",REACTION_UPDATE:"reaction_update"},b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(a,e);var t,n,r,o=d(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),p(f(t=o.call(this)),"conn",void 0),p(f(t),"collab",void 0),p(f(t),"options",void 0),p(f(t),"currentMember",void 0),p(f(t),"socket",void 0),t.options=e,t.collab=e.collab,t.conn=t.createConnect(),t}return t=a,(n=[{key:"createConnect",value:function(){var e=this,t=this.collab,n="".concat(t.host,"/?id=").concat(t.id,"&token=").concat(t.token);y("connect",n);var r=new c.a(n);return r.on("ready",(function(t){e.socket=t,t.addEventListener("message",(function(t){var n;try{n=JSON.parse(t.data)}catch(e){console.error(e)}if(n&&("ready"===n.action&&(e.currentMember=n.data),"broadcast"===n.action)){var r=n.data,o=r.body,a=r.type;o.user.uuid!==e.currentMember.uuid&&e.emit(v.broadcast,{type:a,body:o})}}))})),r}},{key:"reset",value:function(){this.currentMember=null,this.conn.disconnect()}},{key:"updateReaction",value:function(e,t,n){y("reaction update"),this.conn.broadcast(g.REACTION_UPDATE,{user:this.currentMember,reaction:e,comment:t,reactionAction:n})}},{key:"updateBelong",value:function(e){y("comment create"),this.conn.broadcast(g.BELONG_UPDATE,{user:this.currentMember,belong:e})}},{key:"createComment",value:function(e){y("comment create"),this.conn.broadcast(g.COMMENT_CREATE,{user:this.currentMember,comment:e})}},{key:"updateComment",value:function(e){y("comment update"),this.conn.broadcast(g.COMMENT_UPDATE,{user:this.currentMember,comment:e})}},{key:"destroyComment",value:function(e){y("comment destroy"),this.conn.broadcast(g.COMMENT_DELETE,{user:this.currentMember,comment:e})}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a);p(b,"EVENT",v),p(b,"MESSAGE",g),t.a=b},3870:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return u}));var r=n(26);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,i=void 0,i=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===o(i)?i:String(i)),r)}var a,i}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var u={SCROLL:"SCROLL"},s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,o=c(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return t=l,n&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.n(r).a),d=new s;function f(){return d}},3874:function(e,t,n){"use strict";function r(e){return e*e*e}function o(e){return--e*e*e+1}function a(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}))},3884:function(e,t,n){"use strict";n(61);var r=n(23),o=n(0),a=n.n(o),i=n(8),c=n.n(i),l=n(11),u=n.n(l),s=n(90),d=n.n(s),f=n(101),h=n.n(f),p=n(3600),m=n(3609);n(3717);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}(this,n)}}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function k(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===y(t)?t:String(t)}var O=d()("comment:update.editor.ui"),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(c,e);var t,n,o,i=b(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),k(x(t=i.call(this,e)),"onLoad",(function(){t.onChange()})),k(x(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),k(x(t),"handleCancel",(function(){t.reset(),t.props.onCancel()})),k(x(t),"handleSubmit",(function(){var e=t.props,n=e.comment,r=e.commentMoodChanged;t.editor.contentReady().then((function(){var e={format:h.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};O("on save: ".concat(n.id,", document: "),e),r||t.editor.isContentChanged()?t.props.onSave(n.id,e,(function(){t.handleCancel()})):t.handleCancel()}))})),k(x(t),"renderEditor",(function(){return a.a.createElement(m.default,{editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit,key:"".concat(t.state.editorInstanceId)})}));var n=e.comment;return t.editor=new p.c({target:n,belong:e.target,attachType:e.type,useBelongAttach:!0,from:"reply",useMiniGuide:e.useMiniGuide,getDefaultSuggestions:e.getDefaultSuggestions,autoFocus:!0}),t.initialDocument=t.editor.getInitialDocument(),O("init use: ",t.initialDocument),t.state={hasValue:!0,editorInstanceId:"reply_update_".concat(n.id)},t}return t=c,(n=[{key:"reset",value:function(){this.editor.reset()}},{key:"render",value:function(){var e=u()({"comments-form-wrapper":!0,"edit-mode":!0});return a.a.createElement("div",{className:"comments-form-editor"},a.a.createElement("div",{className:e},a.a.createElement("div",{className:"editor-wrapper"},a.a.createElement("div",{className:"editor"},this.renderEditor())),a.a.createElement("div",{className:"action clearfix"},this.state.submitting?a.a.createElement(r.a,{disabled:"disabled",style:{marginRight:12}},a.a.createElement("span",null,__("提交中..."))):a.a.createElement(r.a,{type:"primary",disabled:this.state.hasValue?"":"disabled",onClick:this.handleSubmit,style:{marginRight:12}},a.a.createElement("span",null,__("提交"))),a.a.createElement("a",{className:"btn-cancel",onClick:this.handleCancel},a.a.createElement("span",null,__("取消"))))))}}])&&v(t.prototype,n),o&&v(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Component);C.propTypes={type:c.a.oneOf(["Doc","Resource"]),target:c.a.object.isRequired,comment:c.a.object.isRequired,onSave:c.a.func,onCancel:c.a.func,getDefaultSuggestions:c.a.func,commentMoodChanged:c.a.bool,useMiniGuide:c.a.bool},t.a=C},3889:function(e,t,n){"use strict";n(206);var r=n(111),o=n(358),a=n.n(o),i=n(0),c=n.n(i),l=n(8),u=n.n(l),s=n(90),d=n.n(s),f=n(11),h=n.n(f),p=n(429),m=n(3699),y=n.n(m),v=n(35),g=n(3581),b=(n(61),n(23)),x=n(730),w=n.n(x),k=n(31),E=n(139),O=n(3828),C=n(3560),A={miniGuide:"Editor-module_miniGuide_71Yr9",areaBtn:"Editor-module_areaBtn_aMxhW",active:"Editor-module_active_Nin9i",icon:"Editor-module_icon_tywji",miniGuideLeft:"Editor-module_miniGuideLeft_6qlDi",replyIcon:"Editor-module_replyIcon_YVDPO",text:"Editor-module_text_ayCNj",miniWrapper:"Editor-module_miniWrapper_bgh3f",editorInput:"Editor-module_editorInput_pjxNG"};function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function S(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===P(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(){j=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==P(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return S()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function R(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=d()("comment:editor"),T=function(e){var t,n,r=e.targetType,o=e.target,a=e.useMiniGuide,l=e.dispatch,u=e.onCancelCreate,s=e.showReply,d="autosave/".concat(r,"_comments/").concat(o.id,"/replyId"),f=c.a.createRef(),h=Object(i.useState)(function(){if(!s)return null;var e=E.a.get(d);return L("cached reply id: ","".concat(d," -> ").concat(e)),e?Number(e):null}()),p=_(h,2),m=p[0],y=p[1],g=_(Object(i.useState)(!!a),2),b=g[0],x=g[1],k=function(){u&&"function"==typeof u?u():x(!b)},O=function(){y(null),E.a.remove(d),e.onCloseReply()},C=_(Object(i.useState)(!1),2),A=C[0],P=C[1];return{state:{submitting:A,replyId:m,showMiniGuide:b},editorRef:f,handleReplyTo:function(e){y(e),a&&b&&k(),E.a.set(d,e)},cancelReply:O,toggleEditor:k,toggleAreaCommenting:function(e){e.stopPropagation(),l&&l({type:"litecomment/toggleAreaCommenting"})},createReply:(t=j().mark((function t(n,i){var c,l,u,s,d,f,h,p;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),c=e.litecomment,u=(l=void 0===c?{}:c).page,s=l.rect,d=e.comments,f={commentable_type:r,commentable_id:o.id,parent_id:m,body_asl:n.value,body:n.html,format:n.format,page:u,rect:s},(u||s)&&(f.type=w.a.TYPE.AREA_COMMENT),m&&((null==(h=d.find((function(e){return e.id===m})))?void 0:h.type)===w.a.TYPE.WORDING_COMMENT&&(f.type=w.a.TYPE.WORDING_COMMENT,f.selection=h.selection),h&&(f.root_id=h.parent_id?h.root_id:h.id,f.to_user_id=h.user_id)),"lake"!==f.format&&(f.body=n.html),t.prev=6,t.next=9,v.a.comments.create(f);case 9:p=t.sent,P(!1),L("reply success: ",p),i&&i(),e.onCreate&&e.onCreate(p),O(),a&&x(!0),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),P(!1);case 21:case"end":return t.stop()}}),t,null,[[6,18]])})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){R(a,r,o,i,c,"next",e)}function c(e){R(a,r,o,i,c,"throw",e)}i(void 0)}))},function(e,t){return n.apply(this,arguments)})}},D=c.a.forwardRef((function(e,t){var n=T(e),r=n.state,o=r.replyId,a=r.showMiniGuide,l=r.submitting,u=c.a.createRef();Object(i.useImperativeHandle)(t,(function(){return{handleReplyTo:function(e){n.handleReplyTo(e),u&&u.current&&u.current.focusEditor()},cancelReply:n.cancelReply,focusEditor:function(){u&&u.current&&u.current.focusEditor()}}}));var s=e.className,d=e.group,f=e.targetType,p=e.target,m=e.comments,y=e.canComment,v=e.useMiniGuide,g=e.isMiniSize,x=e.areaCommenting,w=e.withAreaSelection,E=e.disableYuqueCardEmbedView,P=e.cancelable,j=e.me,R=e.showReply,_=e.placeholder,M=e.commentTipText;if(!y)return null;var L=h()(A.areaBtn,S({},A.active,x));return c.a.createElement("div",{className:h()(s,A.wrapper,S({},A.miniWrapper,g))},c.a.createElement(C.a,{me:j,place:"comment"},a?c.a.createElement("div",{className:A.miniGuide,onClick:n.toggleEditor,"data-testid":"comment-mini-guide"},c.a.createElement("div",{className:A.miniGuideLeft},c.a.createElement(k.b,{name:"comment-reply",className:A.replyIcon}),c.a.createElement("span",{className:A.text},M||__("点击添加评论"))),w&&c.a.createElement(b.a,{onClick:n.toggleAreaCommenting,className:L,"data-testid":"area-selection-button"},c.a.createElement(k.b,{name:"area-comment",size:14,className:A.icon}),__("框选评论"))):c.a.createElement("div",{className:A.editorInput,"data-testid":"comment-editor"},c.a.createElement(O.a,{me:j,group:d,type:f,submitting:l,target:p,replyId:o,cancelReplyTo:n.cancelReply,comments:m,onSubmit:n.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!v,useMiniGuide:v,onCancelCreate:n.toggleEditor,isMiniSize:g,ref:u,cancelable:P,disableYuqueCardEmbedView:E,showReply:R,placeholder:_}))))}));D.defaultProps={me:window.appData.me,onCloseReply:function(){}},D.propTypes={className:u.a.string,group:u.a.object.isRequired,target:u.a.object.isRequired,targetType:u.a.oneOf(g.a.TARGET_TYPES),comments:u.a.array,useMiniGuide:u.a.bool,canComment:u.a.bool,onCreate:u.a.func,cancelable:u.a.bool,onCancelCreate:u.a.func,getDefaultSuggestions:u.a.func,type:u.a.oneOf(["default","timeline"]),isMiniSize:u.a.bool,editorAffixed:u.a.bool,litecomment:u.a.object,withAreaSelection:u.a.bool,dispatch:u.a.func,areaCommenting:u.a.bool,disableYuqueCardEmbedView:u.a.bool,me:u.a.object,showReply:u.a.bool,placeholder:u.a.string,onCloseReply:u.a.func,commentTipText:u.a.string},D.displayName="LiteCommentEditor";var N=D,B=n(71),I=n(207),F=n(3818),q=n(3869),z=n(3552),G=n(194),Y=n(316),H=n(246),V=n(540),U=n(3897),W=n(3718),X=n(3870),K="wordCommentSelection-module_container_LBNIq",Z="wordCommentSelection-module_prefixIcon_nL7Bk",Q="wordCommentSelection-module_quotation_qfH3Q",$="wordCommentSelection-module_quotationTip_S-QRh",J="wordCommentSelection-module_quotationContent_atDX4",ee="wordCommentSelection-module_quotationContentMini_5dM90";function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==te(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===te(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e){var t,n=e.comment,r=e.getViewEngine,o=e.isMiniSize,a=Object(i.useCallback)((function(){var e,t=Object(X.b)(),o=null==n||null===(e=n.selection)||void 0===e?void 0:e.paragraph_id,a=r();a&&o&&a.execCommand("tryUnfold",o),t.emit(X.a.SCROLL,re(re({},n.selection),{},{comment_id:n.id}))}),[n,r,X.b]);return n.selection_type===w.a.SELECTION_TYPE.Review?null:c.a.createElement("div",{className:K},c.a.createElement("span",{className:Z}),c.a.createElement("div",{className:Q,onClick:a},c.a.createElement("span",{className:h()((t={},oe(t,J,!o),oe(t,ee,o),t))},c.a.createElement("span",{className:$},__("引用原文：")),n.selection.text)))}ae.defaultProps={isMiniSize:!1},ae.propTypes={comment:u.a.object.isRequired,getViewEngine:u.a.func.isRequired,isMiniSize:u.a.bool};var ie=ae,ce=n(3629),le=n(3884),ue=n(1490),se=n(3657),de=["children"],fe=["children"];function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pe.apply(this,arguments)}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ge(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function ge(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,we(r.key),r)}}function we(e){var t=function(e,t){if("object"!==he(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===he(t)?t:String(t)}function ke(){return window.WeakMap?new WeakMap:new(function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r={},(n=we(n="_map"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,(n=[{key:"has",value:function(e){return!!this._map[e]}},{key:"delete",value:function(e){this._map[e]=void 0,delete this._map[e]}},{key:"get",value:function(e){return this._map[e]}}])&&xe(t.prototype,n),r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}())}var Ee=ke(),Oe=ke(),Ce=window.IntersectionObserver?new IntersectionObserver((function(e){var t,n=ve(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value;if(Ee.has(o.target))null===(r=Ee.get(o.target))||void 0===r||r(o.intersectionRatio,o.intersectionRect.height)}}catch(e){n.e(e)}finally{n.f()}}),{rootMargin:"100%",threshold:[0,.1,1]}):null,Ae=window.ResizeObserver?new window.ResizeObserver((function(e){var t,n=ve(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value;if(Oe.has(o.target))null===(r=Oe.get(o.target))||void 0===r||r(o.contentRect)}}catch(e){n.e(e)}finally{n.f()}})):null;function Pe(e){var t=e.children,n=ye(e,de);return c.a.createElement("div",n,t)}Pe.propTypes={children:u.a.oneOfType([u.a.arrayOf(u.a.node),u.a.node]).isRequired};var Se=window.DELAY_COMMENTS_DEFAULT_HEIGHT||400;function je(){var e=me(Object(i.useState)(null),2),t=e[0],n=e[1],r=Object(i.useCallback)((function(e){e!==t&&n(e)}),[t]);return{current:t,setRef:r}}function Re(e){var t=e.children,n=ye(e,fe),r=je(),o=je(),a=me(Object(i.useState)(!0),2),l=a[0],u=a[1],s=me(Object(i.useState)(0),2),d=s[0],f=s[1],h=me(Object(i.useState)(Se),2),p=h[0],m=h[1];return Object(i.useEffect)((function(){if(r.current){var e=r.current;return Ee.set(e,(function(e){e>0&&l&&u(!1),f(e)})),Ce.observe(e),function(){Ee.delete(e),Ce.unobserve(e)}}}),[r,l,f]),Object(i.useEffect)((function(){if(o.current){var e=o.current;return Oe.set(e,(function(e){0!==e.height&&m(e.height)})),Ae.observe(e),function(){Oe.delete(e),Ae.unobserve(e)}}}),[o,m]),c.a.createElement("div",pe({ref:r.setRef},n,{style:{minHeight:p}}),l?null:c.a.createElement("div",{style:{display:d>0?"block":"none"},ref:o.setRef},t))}Re.propTypes={children:u.a.oneOfType([u.a.arrayOf(u.a.node),u.a.node]).isRequired};var _e=function(e){return Ce&&e.enableDelay?c.a.createElement(Re,e):c.a.createElement(Pe,e)};_e.propTypes={children:u.a.oneOfType([u.a.arrayOf(u.a.node),u.a.node]).isRequired};var Me=_e;function Le(e){var t=e.comment,n=e.group,r=e.target,o=e.commentableType,a=e.onClick,i=e.mode,l=e.onCancelEdit,u=e.onSave,s=e.getDefaultSuggestions,d=e.useMiniGuide,f=e.disableYuqueCardEmbedView,h=e.enableDelay,p={read_status:-1===t.status?99:0,id:t.id};if("edit"===i)return c.a.createElement("div",{style:{marginBottom:16}},c.a.createElement(le.a,{type:o,group:n,comment:t,target:r,onCancel:l,onSave:u,getDefaultSuggestions:s,useMiniGuide:d}));var m=Object(ce.a)()||Object(ce.b)();return c.a.createElement(c.a.Fragment,null,c.a.createElement(Me,{className:"content-detail",onClick:function(){return a(t)},enableDelay:h},m&&c.a.createElement("div",{style:{marginBottom:6}},c.a.createElement(se.default,{key:"audits",doc:p,type:"Comment"})),c.a.createElement(ue.default,{id:t.id,key:"reply-".concat(t.id),genOutline:!1,genAnchor:!1,content:t.body_asl,disableYuqueCardEmbedView:f,simpleUI:!0,imageLazyLoad:!0})))}function Te(){}Le.defaultProps={onCancelEdit:Te,onSave:Te,onClick:Te},Le.propTypes={comment:u.a.object.isRequired,group:u.a.object.isRequired,target:u.a.object.isRequired,getDefaultSuggestions:u.a.func.isRequired,commentableType:u.a.oneOf(g.a.TARGET_TYPES),mode:u.a.oneOf(["edit","view"]),useMiniGuide:u.a.bool,disableYuqueCardEmbedView:u.a.bool,onCancelEdit:u.a.func,onSave:u.a.func,onClick:u.a.func};var De=Le,Ne=n(3630),Be=n(3853),Ie=Ne.a.REACTIONS;function Fe(e){var t=e.comment,n=e.onReactionUpdate,r=e.reactionMap,o=e.reactions,a=e.myReaction,i=e.reactionViewModel,l=e.reactionUserMap;return o.length>0?c.a.createElement("div",{className:"post-interaction",style:{marginTop:12}},c.a.createElement("div",{className:"post-interaction-reaction-summary"},c.a.createElement("ul",null,Ie.map((function(e){var o=r[e.id].count;return 0===o?null:c.a.createElement("li",{key:e.id},c.a.createElement(Be.a,{myReaction:a,reaction:e,users:l[e.id]||[],total:o,loadUsers:function(){i.loadReactionUser(e.id)},reset:function(){i.resetReactionUser(e.id)},onReactionClick:function(){var r;(null!=a&&null!==(r=a.action_option)&&void 0!==r&&r.includes(e.id)?i.cancelReaction(e.id):i.reaction(e.id)).then((function(){i.loadReactionUser(e.id),n(e,t)}))}}))}))))):null}Fe.defaultProps={onReactionUpdate:function(){}},Fe.propTypes={comment:u.a.object.isRequired,onReactionUpdate:u.a.func,reactionMap:u.a.object.isRequired,reactions:u.a.array.isRequired,myReaction:u.a.object,reactionViewModel:u.a.object.isRequired,reactionUserMap:u.a.object.isRequired};var qe=Fe,ze=(n(183),n(104)),Ge=(n(145),n(42)),Ye=(n(227),n(115)),He=n(3813),Ve=n(3854),Ue={container:"commentActions-module_container_Pd8UE",actionsHiddenArea:"commentActions-module_actionsHiddenArea_rwxN3",actionItem:"commentActions-module_actionItem_IYkZw",actionItemWithoutMargin:"commentActions-module_actionItemWithoutMargin_UTjq4"},We="commentFloorListItem-module_commentFloorListItem_hEa7c",Xe="commentFloorListItem-module_listItemWrapper_WP5Au",Ke="commentFloorListItem-module_hashActive_QOVC4",Ze="commentFloorListItem-module_isSelected_KRAD2",Qe="commentFloorListItem-module_isMiniSize_LwzVw",$e="commentFloorListItem-module_avatar_MHjSF",Je="commentFloorListItem-module_commentOrder_Iuwe4",et="commentFloorListItem-module_main_gfOyp",tt="commentFloorListItem-module_commentMain_sXNkM",nt="commentFloorListItem-module_actionsHiddenArea_sIy27",rt="commentFloorListItem-module_head_HFLrS",ot="commentFloorListItem-module_name_pqKOI",at="commentFloorListItem-module_miniName_SV4Rr",it="commentFloorListItem-module_toUserName_ODbN0",ct="commentFloorListItem-module_miniToUserName_tSChh",lt="commentFloorListItem-module_arrowRight_KtPw0",ut="commentFloorListItem-module_time_juhkg",st="commentFloorListItem-module_commentIpRegion_jl233",dt="commentFloorListItem-module_wordCommentSelectionWrapper_7T0sG",ft="commentFloorListItem-module_content_Zn013",ht="commentFloorListItem-module_replyEditor_PeaGC",pt="commentFloorListItem-module_deleted_2GyFb",mt="commentFloorListItem-module_rootCommentFloorListItem_KZW6g";function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function vt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==yt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===yt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gt(e){var t=e.comment,n=e.me,r=e.isMobile,o=e.canComment,a=e.canEdit,i=e.canReport,l=e.canDelete,u=e.onRemove,s=e.onEdit,d=e.onReplyTo,f=e.onCopyCommentLink,p=e.reactionViewModel,m=e.myReaction,y=e.onReactionUpdate;return n&&n.id?c.a.createElement("div",{className:Ue.container},o&&c.a.createElement("span",{className:Ue.actionItem},c.a.createElement(k.b,{name:"comment-bubble",color:"#8C8C8C",width:16,height:16,onClick:d})),o&&c.a.createElement(Ve.a,{placement:r?"topLeft":void 0,reactionIcon:c.a.createElement("span",{className:Ue.actionItemWithoutMargin},c.a.createElement(k.b,{className:Ue.action,name:"comment-reaction",color:"#8C8C8C",width:16,height:16})),active:(null==m?void 0:m.reaction_types)||[],onReaction:p.reaction,onCancelReaction:p.cancelReaction,onReactionUpdate:function(e){return y(e,t)}}),c.a.createElement("div",{className:h()(Ue.actionsHiddenArea,vt({},nt,!r))},a&&c.a.createElement("span",{className:Ue.actionItem},c.a.createElement(k.b,{className:Ue.action,name:"edit-border",width:16,height:16,color:"#8C8C8C",onClick:s})),l&&c.a.createElement(Ye.a,{title:__("确认删除该评论么？"),onConfirm:u},c.a.createElement("span",{className:Ue.actionItem},c.a.createElement(k.b,{className:Ue.action,name:"icon-delete",color:"#8C8C8C",width:16,height:16}))),c.a.createElement(ze.a,{type:"menu",getPopupContainer:function(e){return e.parentNode},placement:"bottomRight",arrowPointAtCenter:!0,trigger:r?"click":"hover",content:c.a.createElement(Ge.a,null,c.a.createElement(Ge.a.Item,{key:"copy"},c.a.createElement("span",{onClick:f},__("复制评论链接"))),i&&c.a.createElement(Ge.a.Item,{key:"report"},c.a.createElement(He.a,{targetId:t.id,targetType:"Comment"},(function(e){return c.a.createElement("span",{className:"action-link",onClick:e.onShowPanel},__("举报"))})))),hideWhenInactive:!0},c.a.createElement("span",{className:Ue.actionItem},c.a.createElement(k.b,{className:Ue.action,name:"comment-more",color:"#8C8C8C",width:16,height:16}))))):null}gt.defaultProps={isMobile:!1},gt.propTypes={comment:u.a.object.isRequired,me:u.a.object,canComment:u.a.bool,canEdit:u.a.bool,canReport:u.a.bool,canDelete:u.a.bool,onRemove:u.a.func.isRequired,onEdit:u.a.func.isRequired,onReplyTo:u.a.func.isRequired,onCopyCommentLink:u.a.func,onReactionUpdate:u.a.func,reactionViewModel:u.a.object,myReaction:u.a.object,isMobile:u.a.bool};var bt=gt;function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function wt(){wt=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==xt(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function kt(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function Et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ct=d()("comment:editor"),At=function(e){var t,n=e.commentableType,r=e.target,o=e.dispatch,a=e.rootId,l=e.replyToComment,u=e.litecomment,s=void 0===u?{}:u,d=e.onCancelReply,f=e.onCreate,h=c.a.createRef(),p=Et(Object(i.useState)(!1),2),m=p[0],y=p[1];t=l.user?l.user.name:__("用户已注销");var g,b;return{state:{submitting:m,replyId:l.id,placeholder:__("回复 {user}",{user:t})},editorRef:h,handleCancelReply:function(){d()},toggleAreaCommenting:function(e){e.stopPropagation(),o&&o({type:"litecomment/toggleAreaCommenting"})},createReply:(g=wt().mark((function e(t,o){var i,c,u,h;return wt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),i=s.page,c=s.rect,u={commentable_type:n,commentable_id:r.id,parent_id:l.id,to_user_id:l.user_id,body_asl:t.value,body:t.html,format:t.format,page:i,rect:c},(i||c)&&(u.type=w.a.TYPE.AREA_COMMENT),l&&(l.type===w.a.TYPE.WORDING_COMMENT&&(u.type=w.a.TYPE.WORDING_COMMENT,u.selection=l.selection),u.root_id=a),"lake"!==u.format&&(u.body=t.html),e.prev=6,e.next=9,v.a.comments.create(u);case 9:(h=e.sent).to_user=l.user,y(!1),Ct("reply success: ",h),o&&o(),f&&f(h),d(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),y(!1);case 21:case"end":return e.stop()}}),e,null,[[6,18]])})),b=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=g.apply(e,t);function a(e){kt(o,n,r,a,i,"next",e)}function i(e){kt(o,n,r,a,i,"throw",e)}a(void 0)}))},function(e,t){return b.apply(this,arguments)})}},Pt=c.a.forwardRef((function(e,t){var n=At(e),r=n.state,o=r.replyId,a=r.submitting,l=r.placeholder,u=c.a.createRef();Object(i.useImperativeHandle)(t,(function(){return{focusEditor:function(){u&&u.current&&u.current.focusEditor()}}}));var s=e.group,d=e.canComment,f=e.isMiniSize,h=e.disableYuqueCardEmbedView,p=e.cancelable,m=e.me,y=e.comments,v=e.useMiniGuide,g=e.replyToComment,b=e.commentableType,x=e.target,w=e.reverseReplyButton;return d?c.a.createElement(C.a,{me:m,place:"comment"},c.a.createElement(O.a,{ref:u,placeholder:l,me:m,group:s,type:b,submitting:a,target:x,replyId:o,replyToComment:g,showReply:!1,cancelReplyTo:n.cancelReply,comments:y,onSubmit:n.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!1,useMiniGuide:v,onCancelCreate:n.handleCancelReply,isMiniSize:f,cancelable:p,disableYuqueCardEmbedView:h,reverseReplyButton:w})):null}));Pt.defaultProps={me:window.appData.me,onCancelReply:function(){}},Pt.propTypes={group:u.a.object.isRequired,target:u.a.object.isRequired,commentableType:u.a.oneOf(g.a.TARGET_TYPES),comments:u.a.array,canComment:u.a.bool,cancelable:u.a.bool,getDefaultSuggestions:u.a.func,isMiniSize:u.a.bool,useMiniGuide:u.a.bool,litecomment:u.a.object,dispatch:u.a.func,disableYuqueCardEmbedView:u.a.bool,me:u.a.object,rootId:u.a.number,replyToComment:u.a.object,onCancelReply:u.a.func,onCreate:u.a.func,reverseReplyButton:u.a.bool},Pt.displayName="CommentReplyEditor";var St=Pt,jt=(n(55),n(22)),Rt=n(179),_t=n.n(Rt),Mt=n(3855);function Lt(e){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(e)}function Tt(){Tt=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==Lt(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function Dt(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function Nt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Dt(a,r,o,i,c,"next",e)}function c(e){Dt(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){Ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Lt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Lt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gt=function(e){var t,n,r,o,a,c=e.isRootComment,l=e.comment,u=e.commentableType,s=e.me,d=e.target,f=e.dispatch,h=e.onRemoveComment,p=e.onUpdateComment,m=e.canComment,y=e.onCreateComment,b=e.isMobile,k=e.onReplyToComment,E=Object(i.useContext)(F.a),O=qt(Object(i.useState)("view"),2),C=O[0],A=O[1],P=Object(i.useRef)(null),S=qt(Object(i.useState)(!1),2),j=S[0],R=S[1],_=!window.h5&&l.meta&&l.meta.ip,M=!c&&l.parent_id&&l.parent_id!==l.root_id,L=g.a.getAnchorId(l.id),T=c&&l.type===w.a.TYPE.WORDING_COMMENT,D=!!l.deleted_at,N=Object(Mt.a)({me:s,comment:l,onReactionUpdate:function(e,t){var n=It(It({},l),{},{reactions:e});f({type:"litecomment/updateOne",payload:n}),null==E||E.updateReaction(null,n,t)}}),B=N.state,I=B.reactions,q=B.reactionUserMap,z=Object(i.useMemo)((function(){var e={reactionMap:Ne.a.classifyReactions(I),myReaction:N.getMyReaction(),totalReaction:0};return Object.keys(e.reactionMap).forEach((function(t){e.totalReaction+=e.reactionMap[t].count})),e}),[I]),G=z.reactionMap,Y=z.myReaction;return{state:{showReplyToUser:M,anchor:L,wordingCommentVisible:T,contentEditorMode:C,isDeleted:D,reactionMap:G,myReaction:Y,reactions:I,reactionUserMap:q,replyEditorVisible:j,metaInfoVisible:_},reactionViewModel:N,editorRef:P,handleEdit:function(){A("edit")},handleCancelEdit:function(){A("view")},handleEditorSave:(a=Nt(Tt().mark((function e(t,n,r){var o,a;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={id:t,format:n.format,body_asl:n.value,body:n.html},e.next=3,v.a.comments.update(o);case 3:(a=e.sent).to_user=l.to_user,a.reactions=l.reactions,a.sub_comments=l.sub_comments,r&&r(),p(a),f({type:"litecomment/updateOne",payload:a}),null==E||E.updateComment(a);case 11:case"end":return e.stop()}}),e)}))),function(e,t,n){return a.apply(this,arguments)}),handleCommentContentClick:function(){"Resource"===u&&f({type:"litecomment/updateCurrentCommentId",payload:l.id})},canComment:function(){return!D&&m},canEdit:function(){return!D&&(s&&s.id===l.user_id)},canReport:function(){if(D)return!1;if(!window.appData.isPublicCloud)return!1;var e=Object(ce.a)()||Object(ce.b)();return l.status===x.STATUS.normal&&e&&s&&s.id!==l.user_id},canDelete:function(){var e;return!D&&(!!s&&(s.id===l.user_id||!("Doc"!==u||null===(e=d.abilities)||void 0===e||!e.destroy_comment)))},handleReplyToComment:(o=Nt(Tt().mark((function e(){return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b?k(l):(R(!0),setTimeout((function(){var e;null===(e=P.current)||void 0===e||e.focusEditor()}),200));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),handleCreateComment:(r=Nt(Tt().mark((function e(t){return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.to_user=l.user,f({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==E||E.createComment(t),y(t);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),handleCancelReply:(n=Nt(Tt().mark((function e(){return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R(!1);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)}),handleRemoveComment:(t=Nt(Tt().mark((function e(){var t;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={id:l.id},v.a.comments.destroy(t).then((function(){f({type:"litecomment/remove",payload:t}),jt.a.success(__("操作成功"),3),h(t),null==E||E.destroyComment(l)}));case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),handleReactionUpdate:function(){},handleCopyCommentLink:function(){var e=Ne.a.getPostUrl(l.id);_t()(e),jt.a.success(__("评论链接复制成功"))}}};function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function Ht(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Yt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Yt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e){var t,n=e.comment,r=e.flattenFloorComments,o=e.isRootComment,a=e.commentableType,i=e.getViewEngine,l=e.target,u=e.useMiniGuide,s=e.getDefaultSuggestions,d=e.disableYuqueCardEmbedView,f=e.group,p=e.me,m=e.canComment,y=e.dispatch,v=e.onUpdateComment,g=(e.editorAffixed,e.isMobile),b=e.isMiniSize,x=(e.areaCommenting,e.cancelable,e.onCancelCreate,e.litecomment),w=e.urlHash,E=e.currentCommentId,O=e.onCreateComment,C=e.onEditComment,A=e.onRemoveComment,P=e.onReplyToComment,S=e.reverseReplyButton,j=e.enableDelay,R=n.user,_=n.to_user,M=Gt({isRootComment:o,comment:n,commentableType:a,me:p,target:l,onRemoveComment:A,onEditComment:C,dispatch:y,onUpdateComment:v,canComment:m,onCreateComment:O,onReplyToComment:P,isMobile:g}),L=M.state,T=L.showReplyToUser,D=L.anchor,N=L.wordingCommentVisible,I=L.contentEditorMode,F=L.replyEditorVisible,q=L.isDeleted,z=L.reactionMap,X=L.myReaction,K=L.reactions,Z=L.reactionUserMap,Q=M.reactionViewModel,$=M.editorRef,J=o?n.id:n.root_id,ee=w==="#".concat(D),te=E===n.id,ne=b?24:32,re={paddingLeft:ne+12};return c.a.createElement("div",{id:D,className:h()(We,Ht({},mt,o)),style:o?null:re},c.a.createElement("div",{className:h()(Xe,(t={},Ht(t,Ke,ee),Ht(t,Ze,te),Ht(t,Qe,b),t))},R?c.a.createElement("div",{className:$e},c.a.createElement(W.a,{url:"/".concat(R.login)},c.a.createElement(c.a.Fragment,null,c.a.createElement(V.a,{user:R},c.a.createElement(H.a,{src:R.avatar_url,size:ne,name:R.name})),n.order&&c.a.createElement("span",{className:Je},n.order)))):c.a.createElement("div",{className:$e},c.a.createElement(H.a,{src:G.avatar.user,size:ne,name:__("用户已注销")}),n.order&&c.a.createElement("span",{className:Je},n.order)),c.a.createElement("div",{className:et},c.a.createElement("div",{className:tt},c.a.createElement("div",{className:rt},R?c.a.createElement(W.a,{url:"/".concat(R.login),className:h()(ot,Ht({},at,b))},c.a.createElement(c.a.Fragment,null,R.name,(null==p?void 0:p.isAdmin)&&[B.STATUS.banned,B.STATUS.blocked].includes(R.status)&&c.a.createElement("span",{className:"book-name-scope"},c.a.createElement(k.b,{name:"doc-has-content-risk",width:13,style:{opacity:.375,marginLeft:4}})))):c.a.createElement("a",{className:ot},__("用户已注销")),T&&(_?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:lt}),b?c.a.createElement(W.a,{url:"/".concat(_.login),className:h()(it,ct)},_.name):c.a.createElement(V.a,{user:_},c.a.createElement(W.a,{url:"/".concat(_.login),className:it},_.name))):c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:lt}),c.a.createElement("a",{className:it},__("用户已注销")))),!b&&c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{href:"#".concat(D),className:ut},c.a.createElement(Y.a,{time:n.created_at})),c.a.createElement("span",{className:st},c.a.createElement(U.a,{target:n,type:"Comment"})))),b&&c.a.createElement("div",null,c.a.createElement("a",{href:"#".concat(D),className:ut},c.a.createElement(Y.a,{time:n.created_at})),c.a.createElement("span",{className:st},c.a.createElement(U.a,{target:n,type:"Comment"}))),N&&c.a.createElement("div",{className:dt},c.a.createElement(ie,{isMiniSize:b,comment:n,getViewEngine:i})),q?c.a.createElement("div",{className:ft},c.a.createElement("div",{className:pt},__("该评论已删除"))):c.a.createElement("div",{className:ft},c.a.createElement(De,{comment:n,group:f,target:l,getDefaultSuggestions:s,commentableType:a,mode:I,useMiniGuide:u,disableYuqueCardEmbedView:d,onCancelEdit:M.handleCancelEdit,onSave:M.handleEditorSave,onClick:M.handleCommentContentClick,enableDelay:j})),!q&&c.a.createElement(qe,{comment:n,onReactionUpdate:M.handleReactionUpdate,reactionViewModel:Q,myReaction:X,reactionMap:z,reactions:K,reactionUserMap:Z}),!q&&c.a.createElement(bt,{isMobile:g,comment:n,me:p,canComment:M.canComment(),canEdit:M.canEdit(),canReport:M.canReport(),canDelete:M.canDelete(),onReplyTo:M.handleReplyToComment,onEdit:M.handleEdit,onRemove:M.handleRemoveComment,onCopyCommentLink:M.handleCopyCommentLink,reactionViewModel:Q,reactionMap:z,myReaction:X,reactions:K,reactionUserMap:Z,onReactionUpdate:M.handleReactionUpdate}),F&&c.a.createElement("div",{className:ht},c.a.createElement(St,{ref:$,rootId:J,replyToComment:n,group:f,me:p,target:l,commentableType:a,litecomment:x,comments:r,cancelable:!0,isMiniSize:b,disableYuqueCardEmbedView:d,getDefaultSuggestions:s,dispatch:y,canComment:m,onCancelReply:M.handleCancelReply,onCreate:M.handleCreateComment,reverseReplyButton:S}))))))}Vt.defaultProps={canComment:!0,onEditComment:function(){},onRemoveComment:function(){},onCreateComment:function(){},getViewEngine:function(){}},Vt.propTypes={comment:u.a.object.isRequired,flattenFloorComments:u.a.arrayOf(u.a.object),getViewEngine:u.a.func,isRootComment:u.a.bool,commentableType:u.a.oneOf(g.a.TARGET_TYPES),target:u.a.object.isRequired,useMiniGuide:u.a.bool,getDefaultSuggestions:u.a.func,disableYuqueCardEmbedView:u.a.bool,group:u.a.object.isRequired,me:u.a.object.isRequired,canComment:u.a.bool,onEditComment:u.a.func,onCreateComment:u.a.func,onRemoveComment:u.a.func,onUpdateComment:u.a.func,dispatch:u.a.func,editorAffixed:u.a.bool,isMobile:u.a.bool,isMiniSize:u.a.bool,areaCommenting:u.a.bool,cancelable:u.a.bool,onCancelCreate:u.a.func,litecomment:u.a.object,urlHash:u.a.string,currentCommentId:u.a.number,onReplyToComment:u.a.func.isRequired};var Ut=Vt,Wt="index-module_default_FTDOK",Xt="index-module_commentEditor_yI7Ow",Kt="index-module_mini_6PdDj",Zt="index-module_emptyView_t1FqB",Qt="index-module_miniEditor_CRXwG",$t="index-module_editorMobile_0VdOM",Jt="index-module_miniFloorList_+ysrM";function en(e){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en(e)}function tn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==en(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===en(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function on(e){var t=e.flattenFloorComments,n=e.commentableType,r=e.getViewEngine,o=e.target,a=e.useMiniGuide,l=e.getDefaultSuggestions,u=e.disableYuqueCardEmbedView,s=e.group,d=e.me,f=e.canComment,p=e.onReplyToComment,m=e.onEditComment,y=e.onCreateComment,v=e.onRemoveComment,g=e.onUpdateComment,b=e.dispatch,x=e.litecomment,w=e.isMiniSize,k=e.currentCommentId,E=e.isMobile,O=e.reverseReplyButton,C="";try{C=decodeURIComponent(window.location.hash)}catch(e){}var A=nn(Object(i.useState)(C),2),P=A[0],S=A[1];Object(i.useEffect)((function(){var e=function(){try{S(decodeURIComponent(window.location.hash)),z.a.scrollToHash({top:60})}catch(e){}};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}}),[]);var j=t.length;return c.a.createElement("div",{className:h()(tn({},Jt,w))},t.map((function(e){return c.a.createElement(Ut,{key:e.id,enableDelay:j>100,flattenFloorComments:t,isRootComment:!e.parent_id,comment:e,commentableType:n,getViewEngine:r,target:o,useMiniGuide:a,getDefaultSuggestions:l,disableYuqueCardEmbedView:u,group:s,me:d,canComment:f,dispatch:b,onReplyToComment:p,onCreateComment:y,onEditComment:m,onRemoveComment:v,onUpdateComment:g,litecomment:x,isMiniSize:w,urlHash:P,currentCommentId:k,isMobile:E,reverseReplyButton:O})})))}on.defaultProps={onReplyToComment:function(){},onEditComment:function(){},onCreateComment:function(){},onRemoveComment:function(){},onUpdateComment:function(){},getViewEngine:function(){}},on.propTypes={flattenFloorComments:u.a.arrayOf(u.a.object),getViewEngine:u.a.func,commentableType:u.a.oneOf(g.a.TARGET_TYPES),target:u.a.object.isRequired,useMiniGuide:u.a.bool,getDefaultSuggestions:u.a.func,disableYuqueCardEmbedView:u.a.bool,group:u.a.object.isRequired,me:u.a.object,canComment:u.a.bool,dispatch:u.a.func,onReplyToComment:u.a.func,onEditComment:u.a.func,onRemoveComment:u.a.func,onCreateComment:u.a.func,onUpdateComment:u.a.func,litecomment:u.a.object,isMiniSize:u.a.bool,currentCommentId:u.a.number,isMobile:u.a.bool,reverseReplyButton:u.a.bool};var an=on;function cn(e){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cn(e)}function ln(){return ln=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ln.apply(this,arguments)}function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==cn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===cn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fn(){fn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),c=new C(o||[]);return r(i,"_invoke",{value:w(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};l(m,a,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&n.call(v,a)&&(m=v);var g=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==cn(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,r(g,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new x(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,c,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function hn(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function pn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){hn(a,r,o,i,c,"next",e)}function c(e){hn(a,r,o,i,c,"throw",e)}i(void 0)}))}}function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vn=d()("commnent_floor");function gn(e){var t=e.commentableType,n=e.target,r=e.group,o=e.me,c=e.litecomment.comments,l=e.canMentionMembers,u=e.dispatch,s=e.isMobile,d=mn(Object(i.useState)(!0),2),f=d[0],h=d[1],p=mn(Object(i.useState)(!1),2),m=p[0],y=p[1],b=mn(Object(i.useState)(0),2),w=b[0],k=b[1],E=mn(Object(i.useState)(""),2),O=E[0],C=E[1],A=mn(Object(i.useState)(null),2),P=A[0],S=A[1],j=Object(i.useRef)([]),R=Object(i.useContext)(F.a),_=function(){var e=document.querySelector("#scroll-to-comment");if(e){e.scrollIntoView();var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,t-40)}},M=function(){var e=pn(fn().mark((function e(){var a,i,c,s,d;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){var t;return"Review"===e.selection_type?!(![x.TYPE.REVIEW_APPROVAL,x.TYPE.REVIEW_REJECTION,x.TYPE.REVIEW_OPINION].includes(e.type)||!e.body)&&(e.body_asl=e.body,!0):!!((null==o?void 0:o.id)===e.user_id||null!=o&&o.isAdmin)||![B.STATUS.banned,B.STATUS.blocked].includes(null==e||null===(t=e.user)||void 0===t?void 0:t.status)},a={commentable_type:t,commentable_id:n.id,include_section:!0,include_to_user:!0,include_reactions:!0},m||h(!0),e.next=5,v.a.comments.floorComments(a,{useOriginResp:!0});case 5:i=e.sent,c=(c=i.data.comments).filter((function(e){return e.sub_comments=(e.sub_comments||[]).filter(s),s(e)})),d=c.reduce((function(e,t){var n;return e++,null===(n=t.sub_comments)||void 0===n||n.forEach((function(t){e++})),e}),0),u({type:"litecomment/updateModel",payload:{comments:c,commentCount:d}}),h(!1),y(!0),l&&(r.members.length>0||(vn("load members"),u({type:"group/getMembers",payload:{data:{group_id:r.id,with_invited:!1}}})));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=Object(i.useMemo)((function(){var e=null==c?void 0:c.filter((function(e){var t;return e.comment_area&&(null===(t=e.comment_area)||void 0===t?void 0:t.rect)}));return e?(e.forEach((function(e,t){e.order=t+1})),c.sort((function(e,t){return new Date(e.created_at)-new Date(t.created_at)}))):c}),[c]),T=Object(i.useMemo)((function(){var e=L.reduce((function(e,t){var n;return e.push(t),null===(n=t.sub_comments)||void 0===n||n.forEach((function(t){e.push(t)})),e}),[]);return j.current=e,e}),[L]),D=function(){var t=a()(T,e.pageSize).length;k(t)};return Object(i.useEffect)((function(){function e(){return(e=pn(fn().mark((function e(){return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),h(!1);case 8:null==R||R.on("broadcast",(function(e){var t=e.type,n=e.body;if(t===q.a.MESSAGE.REACTION_UPDATE){var r=n.reactionAction,o=r.actionType,a=r.userId,i=r.actionOption,c=n.comment,l=T.find((function(e){return e.id===c.id}));if(l){var s=l.reactions||[],d=s;"create"===o?(d=s.filter((function(e){return e.user_id!==a}))).push({user_id:a,action_type:"reaction",action_option:i}):"delete"===o&&(d=s.filter((function(e){return e.user_id!==a}))),u({type:"litecomment/updateOne",payload:sn(sn({},l),{},{reactions:d})})}}else if(t===q.a.MESSAGE.COMMENT_CREATE){if(j.current.find((function(e){return e.id===n.comment.id})))return;u({type:"litecomment/create",payload:{data:n.comment,commentListStyle:"floor",insertToBottom:!0}})}else t===q.a.MESSAGE.COMMENT_UPDATE?u({type:"litecomment/updateOne",payload:n.comment}):t===q.a.MESSAGE.COMMENT_DELETE&&u({type:"litecomment/remove",payload:n.comment})}));case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){null==R||R.reset()}}),[]),{state:{loading:f,loaded:m,pageNo:w,flattenFloorComments:T,bottomEditorPlaceholder:O,replyToComment:P,commentCollab:R},setBottomEditorPlaceHolder:C,setReplyToComment:S,setPageNo:k,getDefaultSuggestions:function(){return g.a.getParticipants(n,T,{groupMembers:r.members,targetType:t})},handleCreateRootComment:function(t){u({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==R||R.createComment(t),D(),"mini"===e.size&&_(),e.onCreate&&e.onCreate(t)},handleCreateReplyToComment:function(t){t.to_user=null==P?void 0:P.user,u({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==R||R.createComment(t),D(),e.onCreate&&e.onCreate(t),s&&setTimeout((function(){var e=document.querySelector("#comment-".concat(t.id));null==e||e.scrollIntoView({behavior:"smooth",block:"center"})}),100)},renderAllComments:D,scrollToEditor:_}}function bn(e){var t,n,o=e.group,l=e.book,u=e.doc,s=e.target,d=e.commentableType,f=e.canComment,p=e.useMiniGuide,m=e.size,v=e.withAreaSelection,g=e.cancelable,b=e.onCancelCreate,x=e.dispatch,w=e.litecomment,k=void 0===w?{}:w,E=k.areaCommenting,O=void 0!==E&&E,C=k.currentCommentId,A=e.me,P=e.isMobile,S=e.getViewEngine,j=e.openInfiniteScroll,R=e.pageSize,_=e.onCommentLoaded,M=e.commentTipText,L=e.reverseReplyButton,T=mn(Object(i.useState)(!1),2),D=T[0],B=T[1],F=mn(Object(i.useState)(!1),2),q=F[0],z=F[1],G=Object(i.useRef)(null),Y=Object(i.useRef)(!1),H=gn(e),V=H.state,U=V.loading,W=V.pageNo,X=V.flattenFloorComments,K=V.bottomEditorPlaceholder;Object(i.useEffect)((function(){U||Y.current||(Y.current=!0,null==_||_())}),[U,_]);var Z=I.a.isPrivate(u,l,o),Q=c.a.createRef(),$=function(e){Q&&Q.current&&(H.setReplyToComment(e),j&&(H.renderAllComments(),z(!0)),H.setBottomEditorPlaceHolder(__("回复 {user}",{user:e.user.name})),Q.current.handleReplyTo(e.id),H.scrollToEditor())},J=function(){var e=document.querySelector("#lark-mini-editor");e&&e.scrollIntoView({block:"center"})};if(Object(i.useEffect)((function(){e.focusToEditor&&Q&&Q.current&&Q.current.focusEditor()}),[e.focusToEditor]),Object(i.useEffect)((function(){D||e.onEditorReady&&Q&&Q.current&&(B(!0),e.onEditorReady(Q.current))}),[Q]),Object(i.useEffect)((function(){var e;q&&(J(),null==Q||null===(e=Q.current)||void 0===e||e.focusEditor())}),[q]),Object(i.useImperativeHandle)(e.forwardedRef,(function(){return{renderAllComments:H.renderAllComments}})),U)return c.a.createElement(r.a,{justify:"block"});var ee="mini"===m||P,te=ee&&p,ne=a()(X,R).length,re=X.slice(0,R*(W+1));return c.a.createElement("div",{className:h()((t={},dn(t,Wt,!ee),dn(t,Kt,ee),t),"comment-floor-mini"),ref:G},j?c.a.createElement(y.a,{loadMore:function(){H.setPageNo(W+1)},hasMore:W<ne,useWindow:"mini"!==m,getScrollParent:function(){return G.current}},c.a.createElement(an,{comments:re,flattenFloorComments:X,me:A,group:o,target:s,commentableType:d,currentCommentId:C,isMiniSize:ee,useMiniGuide:p,disableYuqueCardEmbedView:!Z,canComment:f,getViewEngine:S,getDefaultSuggestions:H.getDefaultSuggestions,onReplyToComment:$,onEditComment:J,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:x,editorAffixed:te,isMobile:P,areaCommenting:O,cancelable:g,onCancelCreate:b,litecomment:e.litecomment,reverseReplyButton:L})):c.a.createElement(an,{comments:X,flattenFloorComments:X,me:A,group:o,target:s,commentableType:d,currentCommentId:C,isMiniSize:ee,useMiniGuide:p,disableYuqueCardEmbedView:!Z,canComment:f,getViewEngine:S,getDefaultSuggestions:H.getDefaultSuggestions,onReplyToComment:$,onEditComment:J,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:x,editorAffixed:te,isMobile:P,areaCommenting:O,cancelable:g,onCancelCreate:b,litecomment:e.litecomment,reverseReplyButton:L}),te&&!X.length&&c.a.createElement("div",{className:Zt},__("暂无回复")),c.a.createElement("div",{id:"scroll-to-comment"}),c.a.createElement("div",{className:h()(Xt,(n={},dn(n,Qt,te),dn(n,$t,P),n))},c.a.createElement(N,{ref:Q,disableYuqueCardEmbedView:!Z,group:o,target:s,targetType:d,comments:X,litecomment:e.litecomment,useMiniGuide:p,canComment:f,onCreate:P?H.handleCreateReplyToComment:H.handleCreateRootComment,getDefaultSuggestions:H.getDefaultSuggestions,isMiniSize:ee,editorAffixed:te,withAreaSelection:v,dispatch:x,areaCommenting:O,cancelable:g,onCancelCreate:b,me:A,showReply:P,placeholder:K,onCloseReply:function(){H.setBottomEditorPlaceHolder("")},commentTipText:M})))}bn.defaultProps={canComment:!0,canMentionMembers:!1,useMiniGuide:!1,size:"default",me:window.appData.me,isMobile:window.h5,openInfiniteScroll:!1,pageSize:15},bn.propTypes={commentableType:u.a.oneOf(g.a.TARGET_TYPES),group:u.a.object.isRequired,book:u.a.object,doc:u.a.object,target:u.a.object.isRequired,canMentionMembers:u.a.bool,cancelable:u.a.bool,onCancelCreate:u.a.func,useMiniGuide:u.a.bool,onCreate:u.a.func,onRemove:u.a.func,focusToEditor:u.a.bool,canComment:u.a.bool,size:u.a.oneOf(["default","mini"]),withAreaSelection:u.a.bool,litecomment:u.a.object,onEditorReady:u.a.func,me:u.a.object,isMobile:u.a.bool,dispatch:u.a.func,getViewEngine:u.a.func,openInfiniteScroll:u.a.bool,pageSize:u.a.number,onCommentLoaded:u.a.func,commentTipText:u.a.string,reverseReplyButton:u.a.bool};Object(p.d)((function(e){return{litecomment:e.litecomment}}))(bn);var xn=Object(p.d)((function(e){return{litecomment:e.litecomment,group:e.group}}))(bn);t.a=Object(i.forwardRef)((function(e,t){return c.a.createElement(xn,ln({},e,{forwardedRef:t}))}))},3895:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(841),l=n(229),u=n(3656),s=n(255);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(){f=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof p?t:p,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h={};function p(){}function m(){}function y(){}var v={};l(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(v=b);var x=y.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==d(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(f).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function h(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}var p,m,y=Object(c.a)({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(7),n.e(12),n.e(59)]).then(n.bind(null,4101))},loading:u.a}),v=Object(c.a)({loader:(p=f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.loadModule)("larksheet");case 2:return e.abrupt("return",Promise.all([n.e(0),n.e(24),n.e(57)]).then(n.bind(null,4120)));case 3:case"end":return e.stop()}}),e)})),m=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=p.apply(e,t);function a(e){h(o,n,r,a,i,"next",e)}function i(e){h(o,n,r,a,i,"throw",e)}a(void 0)}))},function(){return m.apply(this,arguments)}),loading:u.a});function g(e){var t=e.format,n=e.content;return"spreadjs"===t?"export"===new URLSearchParams(window.location.search).get("mode")?o.a.createElement(y,{content:n,onLoad:e.onLoad}):o.a.createElement(v,{body:n,className:e.className||"",showToolbar:e.showToolbar,sheetStyle:e.geSheetStyle}):"lakesheet"===t?o.a.createElement(y,{versionMode:!!e.versionMode,abilities:e.abilities,docId:e.docId,docType:e.docType,type:e.type,content:n,onLoad:e.onLoad}):null}g.propTypes={className:i.a.string,format:i.a.string.isRequired,abilities:i.a.object,docId:i.a.number.isRequired,content:i.a.string.isRequired,versionMode:i.a.bool,showToolbar:i.a.bool,geSheetStyle:i.a.object,onLoad:i.a.func},t.a=Object(l.b)(g,!0,__("数据出错，请通过历史恢复到最近的正确版本，重新编辑"))},3896:function(e,t,n){"use strict";var r=n(951),o=n.n(r),a=n(33);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(){c=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var a=t&&t.prototype instanceof p?t:p,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var h={};function p(){}function m(){}function y(){}var v={};s(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,a)&&(v=b);var x=y.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function o(r,a,c,l){var u=f(e[r],e,a);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==i(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,c,l)}),(function(e){o("throw",e,c,l)})):t.resolve(d).then((function(e){s.value=e,c(s)}),(function(e){return o("throw",e,c,l)}))}l(u.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return j()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=f(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=f(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},w(k.prototype),s(k.prototype,l,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(d(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(x),s(x,u,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function l(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===i(a)?a:String(a)),r)}var o,a}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(h,e);var t,n,r,o,i,l=f(h);function h(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),l.apply(this,arguments)}return t=h,n=[{key:"init",value:function(e){var t=e.content;e.onFocus,this.setContent(t)}},{key:"getDefaultDiagram",value:function(){var e,t,n;return{diagramData:{head:{theme:{name:"dark"===(null===(e=window)||void 0===e||null===(t=e.appData)||void 0===t||null===(n=t.themeManager)||void 0===n?void 0:n._current)?"dark":"default"}},body:[]}}}},{key:"setContent",value:function(e){var t=h.contentToMind(e);t?this.isUseDefaultContent=!1:(t=this.getDefaultDiagram(),this.isUseDefaultContent=!0),this.engine.setValue(t)}},{key:"getValue",value:function(){return JSON.stringify(this.engine.getValue())}},{key:"getPureContent",value:function(){return JSON.stringify(this.engine.getValue())}},{key:"getEditorContent",value:function(e){return{content:this.getValue(),html:null}}},{key:"export",value:function(e,t){"png"!==e&&"jpg"!==e||this.engine.download(e,t)}},{key:"getThumbnail",value:(i=u(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.engine.canvas({backgroundColor:"#fff"});case 2:return t=e.sent,e.abrupt("return",t.toDataURL("image/jpeg",.5));case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"isEmpty",value:function(){return 0===this.engine.getValue().diagramData.body.length}},{key:"getDocMeta",value:function(){return this.engine.getMeta()}},{key:"isContentReady",value:function(){var e;return null===(e=this.engine.uploader)||void 0===e?void 0:e.isCompleted()}},{key:"onBeforeSave",value:(o=u(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.engine.onBeforeSave();case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"onCommandEnd",value:function(e){this.engine.on("commandEnd",(function(t,n){e(a.EDITOR_NAME.BOARD,t,n)}))}},{key:"destroy",value:function(){this.engine.destroy()}}],n&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(n(1518).a);p.contentToMind=function(e){return e&&(o.a.isLakeMind(e)||o.a.isLakeBoard(e))?JSON.parse(e):null},t.a=p},3897:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(3629),i=n(8),c=n.n(i),l=function(e){var t,n=e.type,r=void 0===n?"Doc":n,i=e.target,c=e.style;return r&&i&&window.appData.isYuque?((null===(t=window.appData)||void 0===t?void 0:t.settings)||{}).disable_ip_region_model?null:(Object(a.a)()||Object(a.b)())&&("Doc"!==r||i.first_published_at)&&i.region?o.a.createElement("span",{style:c},__("IP 属地"),i.region||__("未知")):null:null};l.propTypes={target:c.a.object.isRequired,type:c.a.string},t.a=l},3917:function(e,t,n){"use strict";var r=/,?([a-z]),?/gi,o=parseFloat,a=Math,i=a.PI,c=a.min,l=a.max,u=a.pow,s=a.abs,d=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,f=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi,h=Array.isArray||function(e){return e instanceof Array};function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)p(e,n)&&(t[n]=m(e[n]));return t}function y(e){var t=y.ps=y.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout((function(){for(var n in t)p(t,n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])})),t[e]}function v(e,t,n,r){return 1===arguments.length&&(t=e.y,n=e.width,r=e.height,e=e.x),{x:e,y:t,width:n,height:r,x2:e+n,y2:t+r}}function g(){return this.join(",").replace(r,"$1")}function b(e){var t=m(e);return t.toString=g,t}function x(e,t,n,r,o,a,i,c,l){var s=1-l,d=u(s,3),f=u(s,2),h=l*l*l,p=d*t+3*f*l*r+3*s*l*l*a+h*c;return{x:A(d*e+3*f*l*n+3*s*l*l*o+h*i),y:A(p)}}function w(e){var t=L.apply(null,e);return v(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function k(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function E(e,t,n,r,o){return e*(e*(-3*t+9*n-9*r+3*o)+6*t-12*n+6*r)-3*t+3*n}function O(e,t,n,r,o,i,c,l,u){null==u&&(u=1);for(var s=(u=u>1?1:u<0?0:u)/2,d=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],h=0,p=0;p<12;p++){var m=s*d[p]+s,y=E(m,e,n,o,c),v=E(m,t,r,i,l),g=y*y+v*v;h+=f[p]*a.sqrt(g)}return s*h}function C(e,t,n,r,o,a,i,u){if(!(l(e,n)<c(o,i)||c(e,n)>l(o,i)||l(t,r)<c(a,u)||c(t,r)>l(a,u))){var s=(e*r-t*n)*(a-u)-(t-r)*(o*u-a*i),d=(e-n)*(a-u)-(t-r)*(o-i);if(d){var f=A(((e*r-t*n)*(o-i)-(e-n)*(o*u-a*i))/d),h=A(s/d),p=+f.toFixed(2),m=+h.toFixed(2);if(!(p<+c(e,n).toFixed(2)||p>+l(e,n).toFixed(2)||p<+c(o,i).toFixed(2)||p>+l(o,i).toFixed(2)||m<+c(t,r).toFixed(2)||m>+l(t,r).toFixed(2)||m<+c(a,u).toFixed(2)||m>+l(a,u).toFixed(2)))return{x:f,y:h}}}}function A(e){return Math.round(1e11*e)/1e11}function P(e,t,n){if(!function(e,t){return e=v(e),k(t=v(t),e.x,e.y)||k(t,e.x2,e.y)||k(t,e.x,e.y2)||k(t,e.x2,e.y2)||k(e,t.x,t.y)||k(e,t.x2,t.y)||k(e,t.x,t.y2)||k(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(w(e),w(t)))return n?0:[];for(var r=O.apply(0,e),o=O.apply(0,t),a=j(e)?1:~~(r/5)||1,i=j(t)?1:~~(o/5)||1,c=[],l=[],u={},d=n?0:[],f=0;f<a+1;f++){var h=x.apply(0,e.concat(f/a));c.push({x:h.x,y:h.y,t:f/a})}for(f=0;f<i+1;f++)h=x.apply(0,t.concat(f/i)),l.push({x:h.x,y:h.y,t:f/i});for(f=0;f<a;f++)for(var p=0;p<i;p++){var m,y=c[f],g=c[f+1],b=l[p],E=l[p+1],A=s(g.x-y.x)<.01?"y":"x",P=s(E.x-b.x)<.01?"y":"x",S=C(y.x,y.y,g.x,g.y,b.x,b.y,E.x,E.y);if(S){if(u[m=S.x.toFixed(9)+"#"+S.y.toFixed(9)])continue;u[m]=!0;var R=y.t+s((S[A]-y[A])/(g[A]-y[A]))*(g.t-y.t),_=b.t+s((S[P]-b[P])/(E[P]-b[P]))*(E.t-b.t);R>=0&&R<=1&&_>=0&&_<=1&&(n?d++:d.push({x:S.x,y:S.y,t1:R,t2:_}))}}return d}function S(e){var t=y(e);if(t.abs)return b(t.abs);if(h(e)&&h(e&&e[0])||(e=function(e){if(!e)return null;var t=y(e);if(t.arr)return m(t.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return h(e)&&h(e[0])&&(r=m(e)),r.length||String(e).replace(d,(function(e,t,o){var a=[],i=t.toLowerCase();for(o.replace(f,(function(e,t){t&&a.push(+t)})),"m"==i&&a.length>2&&(r.push([t].concat(a.splice(0,2))),i="l",t="m"==t?"l":"L");a.length>=n[i]&&(r.push([t].concat(a.splice(0,n[i]))),n[i]););})),r.toString=y.toString,t.arr=m(r),r}(e)),!e||!e.length)return[["M",0,0]];var n,r=[],o=0,a=0,i=0,c=0,l=0;"M"==e[0][0]&&(i=o=+e[0][1],c=a=+e[0][2],l++,r[0]=["M",o,a]);for(var u,s,p=l,v=e.length;p<v;p++){if(r.push(u=[]),(n=(s=e[p])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u[6]=+s[6]+o,u[7]=+s[7]+a;break;case"V":u[1]=+s[1]+a;break;case"H":u[1]=+s[1]+o;break;case"M":i=+s[1]+o,c=+s[2]+a;default:for(var x=1,w=s.length;x<w;x++)u[x]=+s[x]+(x%2?o:a)}else for(var k=0,E=s.length;k<E;k++)u[k]=s[k];switch(n=n.toUpperCase(),u[0]){case"Z":o=+i,a=+c;break;case"H":o=u[1];break;case"V":a=u[1];break;case"M":i=u[u.length-2],c=u[u.length-1];default:o=u[u.length-2],a=u[u.length-1]}}return r.toString=g,t.abs=b(r),r}function j(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function R(e,t,n,r){return[e,t,n,r,n,r]}function _(e,t,n,r,o,a){var i=1/3,c=2/3;return[i*e+c*n,i*t+c*r,i*o+c*n,i*a+c*r,o,a]}function M(e,t,n,r,o,c,l,u,d,f){var h,m,y=120*i/180,v=i/180*(+o||0),g=[],b=(m=function(e,t,n){return{x:e*a.cos(n)-t*a.sin(n),y:e*a.sin(n)+t*a.cos(n)}},function e(){var t=Array.prototype.slice.call(arguments,0),n=t.join("␀"),r=e.cache=e.cache||{},o=e.count=e.count||[];return p(r,n)?(function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(o,n),r[n]):(o.length>=1e3&&delete r[o.shift()],o.push(n),r[n]=m.apply(0,t),r[n])});if(f)S=f[0],j=f[1],A=f[2],P=f[3];else{e=(h=b(e,t,-v)).x,t=h.y;var x=(e-(u=(h=b(u,d,-v)).x))/2,w=(t-(d=h.y))/2,k=x*x/(n*n)+w*w/(r*r);k>1&&(n*=k=a.sqrt(k),r*=k);var E=n*n,O=r*r,C=(c==l?-1:1)*a.sqrt(s((E*O-E*w*w-O*x*x)/(E*w*w+O*x*x))),A=C*n*w/r+(e+u)/2,P=C*-r*x/n+(t+d)/2,S=a.asin(((t-P)/r).toFixed(9)),j=a.asin(((d-P)/r).toFixed(9));(S=e<A?i-S:S)<0&&(S=2*i+S),(j=u<A?i-j:j)<0&&(j=2*i+j),l&&S>j&&(S-=2*i),!l&&j>S&&(j-=2*i)}var R=j-S;if(s(R)>y){var _=j,L=u,T=d;j=S+y*(l&&j>S?1:-1),g=M(u=A+n*a.cos(j),d=P+r*a.sin(j),n,r,o,0,l,L,T,[j,_,A,P])}R=j-S;var D=a.cos(S),N=a.sin(S),B=a.cos(j),I=a.sin(j),F=a.tan(R/4),q=4/3*n*F,z=4/3*r*F,G=[e,t],Y=[e+q*N,t-z*D],H=[u+q*I,d-z*B],V=[u,d];if(Y[0]=2*G[0]-Y[0],Y[1]=2*G[1]-Y[1],f)return[Y,H,V].concat(g);for(var U=[],W=0,X=(g=[Y,H,V].concat(g).join().split(",")).length;W<X;W++)U[W]=W%2?b(g[W-1],g[W],v).y:b(g[W],g[W+1],v).x;return U}function L(e,t,n,r,o,i,u,d){for(var f,h,p,m,y,v,g,b,x=[],w=[[],[]],k=0;k<2;++k)if(0==k?(h=6*e-12*n+6*o,f=-3*e+9*n-9*o+3*u,p=3*n-3*e):(h=6*t-12*r+6*i,f=-3*t+9*r-9*i+3*d,p=3*r-3*t),s(f)<1e-12){if(s(h)<1e-12)continue;0<(m=-p/h)&&m<1&&x.push(m)}else g=h*h-4*p*f,b=a.sqrt(g),g<0||(0<(y=(-h+b)/(2*f))&&y<1&&x.push(y),0<(v=(-h-b)/(2*f))&&v<1&&x.push(v));for(var E,O=x.length,C=O;O--;)E=1-(m=x[O]),w[0][O]=E*E*E*e+3*E*E*m*n+3*E*m*m*o+m*m*m*u,w[1][O]=E*E*E*t+3*E*E*m*r+3*E*m*m*i+m*m*m*d;return w[0][C]=e,w[1][C]=t,w[0][C+1]=u,w[1][C+1]=d,w[0].length=w[1].length=C+2,{x0:c.apply(0,w[0]),y0:c.apply(0,w[1]),x1:l.apply(0,w[0]),y1:l.apply(0,w[1])}}function T(e){var t=y(e);if(t.curve)return b(t.curve);for(var n=S(e),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=function(e,t,n){var r,o;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(M.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*t.x-t.bx,o=2*t.y-t.by):(r=t.x,o=t.y),e=["C",r,o].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(_(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(_(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(R(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(R(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(R(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(R(t.x,t.y,t.X,t.Y))}return e},i=function(e,t){if(e[t].length>7){e[t].shift();for(var r=e[t];r.length;)c[t]="A",e.splice(t++,0,["C"].concat(r.splice(0,6)));e.splice(t,1),d=n.length}},c=[],l="",u="",s=0,d=n.length;s<d;s++){n[s]&&(l=n[s][0]),"C"!=l&&(c[s]=l,s&&(u=c[s-1])),n[s]=a(n[s],r,u),"A"!=c[s]&&"C"==l&&(c[s]="C"),i(n,s);var f=n[s],h=f.length;r.x=f[h-2],r.y=f[h-1],r.bx=o(f[h-4])||r.x,r.by=o(f[h-3])||r.y}return t.curve=b(n),n}e.exports=function(e,t,n){e=T(e),t=T(t);for(var r,o,a,i,c,l,u,s,d,f,h=n?0:[],p=0,m=e.length;p<m;p++){var y=e[p];if("M"==y[0])r=c=y[1],o=l=y[2];else{"C"==y[0]?(d=[r,o].concat(y.slice(1)),r=d[6],o=d[7]):(d=[r,o,r,o,c,l,c,l],r=c,o=l);for(var v=0,g=t.length;v<g;v++){var b=t[v];if("M"==b[0])a=u=b[1],i=s=b[2];else{"C"==b[0]?(f=[a,i].concat(b.slice(1)),a=f[6],i=f[7]):(f=[a,i,a,i,u,s,u,s],a=u,i=s);var x=P(d,f,n);if(n)h+=x;else{for(var w=0,k=x.length;w<k;w++)x[w].segment1=p,x[w].segment2=v,x[w].bez1=d,x[w].bez2=f;h=h.concat(x)}}}}}return h}},3935:function(e,t,n){"use strict";n.r(t);var r=n(3936);t.default=r.default},3936:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(2866),l=n(30),u=n(3896);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=(null==c?void 0:c.Reader)||window["lake-board"].Reader;function h(e){var t=e.content,n=e.width,a=e.height,i=Object(r.useMemo)((function(){return u.a.contentToMind(t)}),[t]),c=s(Object(r.useState)(null),2),d=c[0],h=c[1],p=Object(r.useMemo)((function(){return o.a.createElement(f,{onLoad:function(n){var r=new u.a(t,n);e.onLoad(r),h(n)}})}),[]),m={};return a&&(m.height=a),n&&(m.width=n),Object(r.useEffect)((function(){if(d&&i){var t=d.diagram,n=i.viewportOption,r=i.viewportSetting;if(d.setValue(i),l.ua.mobile||e.autoFit)t.viewport.autoFit();else if(n&&"WYSIWYG"===n&&r)t.viewport.set(r);else{var o=t.getCells().filter((function(e){return e.isRoot&&e.isMindmap&&!e.isLine}));t.viewport.autoFit({zoom:1}),o.length>0&&t.viewport.scrollIntoView(o[0])}}}),[d,i]),o.a.createElement("div",{className:e.className,style:m},p)}h.defaultProps={className:"",onLoad:function(){}},h.propTypes={className:i.a.string,content:i.a.string,onLoad:i.a.func,height:i.a.oneOfType([i.a.string,i.a.number]),width:i.a.oneOfType([i.a.string,i.a.number]),autoFit:i.a.bool},t.default=h},3942:function(e,t,n){var r=n(710);e.exports=function(e,t){return r(e,5,t="function"==typeof t?t:void 0)}},3943:function(e,t,n){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function c(e,t,n){if(e&&e.length){var r=t[0],o=t[1],a=Math.PI/180*n,i=Math.cos(a),c=Math.sin(a);e.forEach((function(e){var t=e[0],n=e[1];e[0]=(t-r)*i-(n-o)*c+r,e[1]=(t-r)*c+(n-o)*i+o}))}}function l(e){var t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}function u(e,t){var n=t.hachureAngle+90,r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);var o=[0,0];if(n)for(var a=0,l=e;a<l.length;a++)c(l[a],o,n);var u=function(e,t){for(var n=[],r=0,o=e;r<o.length;r++)(s=i([],o[r],!0))[0].join(",")!==s[s.length-1].join(",")&&s.push([s[0][0],s[0][1]]),s.length>2&&n.push(s);var a=[];t=Math.max(t,.1);for(var c=[],l=0,u=n;l<u.length;l++)for(var s=u[l],d=0;d<s.length-1;d++){var f=s[d],h=s[d+1];if(f[1]!==h[1]){var p=Math.min(f[1],h[1]);c.push({ymin:p,ymax:Math.max(f[1],h[1]),x:p===f[1]?f[0]:h[0],islope:(h[0]-f[0])/(h[1]-f[1])})}}if(c.sort((function(e,t){return e.ymin<t.ymin?-1:e.ymin>t.ymin?1:e.x<t.x?-1:e.x>t.x?1:e.ymax===t.ymax?0:(e.ymax-t.ymax)/Math.abs(e.ymax-t.ymax)})),!c.length)return a;for(var m=[],y=c[0].ymin;m.length||c.length;){if(c.length){var v=-1;for(d=0;d<c.length&&!(c[d].ymin>y);d++)v=d;c.splice(0,v+1).forEach((function(e){m.push({s:y,edge:e})}))}if((m=m.filter((function(e){return!(e.edge.ymax<=y)}))).sort((function(e,t){return e.edge.x===t.edge.x?0:(e.edge.x-t.edge.x)/Math.abs(e.edge.x-t.edge.x)})),m.length>1)for(d=0;d<m.length;d+=2){var g=d+1;if(g>=m.length)break;var b=m[d].edge,x=m[g].edge;a.push([[Math.round(b.x),y],[Math.round(x.x),y]])}y+=t,m.forEach((function(e){e.edge.x=e.edge.x+t*e.edge.islope}))}return a}(e,r);if(n){for(var s=0,d=e;s<d.length;s++)c(d[s],o,-n);!function(e,t,n){var r=[];e.forEach((function(e){return r.push.apply(r,e)})),c(r,t,n)}(u,o,-n)}return u}var s=function(){function e(e){this.helper=e}return e.prototype.fillPolygons=function(e,t){return this._fillPolygons(e,t)},e.prototype._fillPolygons=function(e,t){var n=u(e,t);return{type:"fillSketch",ops:this.renderLines(n,t)}},e.prototype.renderLines=function(e,t){for(var n=[],r=0,o=e;r<o.length;r++){var a=o[r];n.push.apply(n,this.helper.doubleLineOps(a[0][0],a[0][1],a[1][0],a[1][1],t))}return n},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.fillPolygons=function(e,t){var n=t.hachureGap;n<0&&(n=4*t.strokeWidth),n=Math.max(n,.1);for(var r=u(e,Object.assign({},t,{hachureGap:n})),o=Math.PI/180*t.hachureAngle,a=[],c=.5*n*Math.cos(o),s=.5*n*Math.sin(o),d=0,f=r;d<f.length;d++){var h=f[d],p=h[0],m=h[1];l([p,m])&&a.push([[p[0]-c,p[1]+s],i([],m,!0)],[[p[0]+c,p[1]-s],i([],m,!0)])}return{type:"fillSketch",ops:this.renderLines(a,t)}},t}(s),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.fillPolygons=function(e,t){var n=this._fillPolygons(e,t),r=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),o=this._fillPolygons(e,r);return n.ops=n.ops.concat(o.ops),n},t}(s),h=function(){function e(e){this.helper=e}return e.prototype.fillPolygons=function(e,t){var n=u(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(n,t)},e.prototype.dotsOnLines=function(e,t){var n=[],r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);var o=t.fillWeight;o<0&&(o=t.strokeWidth/2);for(var a=r/4,i=0,c=e;i<c.length;i++)for(var u=c[i],s=l(u),d=s/r,f=Math.ceil(d)-1,h=s-f*r,p=(u[0][0]+u[1][0])/2-r/4,m=Math.min(u[0][1],u[1][1]),y=0;y<f;y++){var v=m+h+y*r,g=p-a+2*Math.random()*a,b=v-a+2*Math.random()*a,x=this.helper.ellipse(g,b,o,o,t);n.push.apply(n,x.ops)}return{type:"fillSketch",ops:n}},e}(),p=function(){function e(e){this.helper=e}return e.prototype.fillPolygons=function(e,t){var n=u(e,t);return{type:"fillSketch",ops:this.dashedLine(n,t)}},e.prototype.dashedLine=function(e,t){var n=this,r=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,o=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,a=[];return e.forEach((function(e){var i=l(e),c=Math.floor(i/(r+o)),u=(i+o-c*(r+o))/2,s=e[0],d=e[1];s[0]>d[0]&&(s=e[1],d=e[0]);for(var f=Math.atan((d[1]-s[1])/(d[0]-s[0])),h=0;h<c;h++){var p=h*(r+o),m=p+r,y=[s[0]+p*Math.cos(f)+u*Math.cos(f),s[1]+p*Math.sin(f)+u*Math.sin(f)],v=[s[0]+m*Math.cos(f)+u*Math.cos(f),s[1]+m*Math.sin(f)+u*Math.sin(f)];a.push.apply(a,n.helper.doubleLineOps(y[0],y[1],v[0],v[1],t))}})),a},e}(),m=function(){function e(e){this.helper=e}return e.prototype.fillPolygons=function(e,t){var n=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,r=t.zigzagOffset<0?n:t.zigzagOffset,o=u(e,t=Object.assign({},t,{hachureGap:n+r}));return{type:"fillSketch",ops:this.zigzagLines(o,r,t)}},e.prototype.zigzagLines=function(e,t,n){var r=this,o=[];return e.forEach((function(e){var a=l(e),c=Math.round(a/(2*t)),u=e[0],s=e[1];u[0]>s[0]&&(u=e[1],s=e[0]);for(var d=Math.atan((s[1]-u[1])/(s[0]-u[0])),f=0;f<c;f++){var h=2*f*t,p=2*(f+1)*t,m=Math.sqrt(2*Math.pow(t,2)),y=[u[0]+h*Math.cos(d),u[1]+h*Math.sin(d)],v=[u[0]+p*Math.cos(d),u[1]+p*Math.sin(d)],g=[y[0]+m*Math.cos(d+Math.PI/4),y[1]+m*Math.sin(d+Math.PI/4)];o.push.apply(o,i(i([],r.helper.doubleLineOps(y[0],y[1],g[0],g[1],n),!1),r.helper.doubleLineOps(g[0],g[1],v[0],v[1],n),!1))}})),o},e}(),y={},v=function(){function e(e){this.seed=e}return e.prototype.next=function(){return this.seed?(Math.pow(2,31)-1&(this.seed=Math.imul(48271,this.seed)))/Math.pow(2,31):Math.random()},e}();const g={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function b(e,t){return e.type===t}function x(e){const t=[],n=function(e){const t=new Array;for(;""!==e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:0,text:RegExp.$1},e=e.substr(RegExp.$1.length);else{if(!e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];t[t.length]={type:1,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length)}return t[t.length]={type:2,text:""},t}(e);let r="BOD",o=0,a=n[o];for(;!b(a,2);){let i=0;const c=[];if("BOD"===r){if("M"!==a.text&&"m"!==a.text)return x("M0,0"+e);o++,i=g[a.text],r=a.text}else b(a,1)?i=g[r]:(o++,i=g[a.text],r=a.text);if(!(o+i<n.length))throw new Error("Path data ended short");for(let e=o;e<o+i;e++){const t=n[e];if(!b(t,1))throw new Error("Param not a number: "+r+","+t.text);c[c.length]=+t.text}if("number"!=typeof g[r])throw new Error("Bad segment: "+r);{const e={key:r,data:c};t.push(e),o+=i,a=n[o],"M"===r&&(r="L"),"m"===r&&(r="l")}}return t}function w(e){let t=0,n=0,r=0,o=0;const a=[];for(const{key:i,data:c}of e)switch(i){case"M":a.push({key:"M",data:[...c]}),[t,n]=c,[r,o]=c;break;case"m":t+=c[0],n+=c[1],a.push({key:"M",data:[t,n]}),r=t,o=n;break;case"L":a.push({key:"L",data:[...c]}),[t,n]=c;break;case"l":t+=c[0],n+=c[1],a.push({key:"L",data:[t,n]});break;case"C":a.push({key:"C",data:[...c]}),t=c[4],n=c[5];break;case"c":{const e=c.map(((e,r)=>r%2?e+n:e+t));a.push({key:"C",data:e}),t=e[4],n=e[5];break}case"Q":a.push({key:"Q",data:[...c]}),t=c[2],n=c[3];break;case"q":{const e=c.map(((e,r)=>r%2?e+n:e+t));a.push({key:"Q",data:e}),t=e[2],n=e[3];break}case"A":a.push({key:"A",data:[...c]}),t=c[5],n=c[6];break;case"a":t+=c[5],n+=c[6],a.push({key:"A",data:[c[0],c[1],c[2],c[3],c[4],t,n]});break;case"H":a.push({key:"H",data:[...c]}),t=c[0];break;case"h":t+=c[0],a.push({key:"H",data:[t]});break;case"V":a.push({key:"V",data:[...c]}),n=c[0];break;case"v":n+=c[0],a.push({key:"V",data:[n]});break;case"S":a.push({key:"S",data:[...c]}),t=c[2],n=c[3];break;case"s":{const e=c.map(((e,r)=>r%2?e+n:e+t));a.push({key:"S",data:e}),t=e[2],n=e[3];break}case"T":a.push({key:"T",data:[...c]}),t=c[0],n=c[1];break;case"t":t+=c[0],n+=c[1],a.push({key:"T",data:[t,n]});break;case"Z":case"z":a.push({key:"Z",data:[]}),t=r,n=o}return a}function k(e){const t=[];let n="",r=0,o=0,a=0,i=0,c=0,l=0;for(const{key:u,data:s}of e){switch(u){case"M":t.push({key:"M",data:[...s]}),[r,o]=s,[a,i]=s;break;case"C":t.push({key:"C",data:[...s]}),r=s[4],o=s[5],c=s[2],l=s[3];break;case"L":t.push({key:"L",data:[...s]}),[r,o]=s;break;case"H":r=s[0],t.push({key:"L",data:[r,o]});break;case"V":o=s[0],t.push({key:"L",data:[r,o]});break;case"S":{let e=0,a=0;"C"===n||"S"===n?(e=r+(r-c),a=o+(o-l)):(e=r,a=o),t.push({key:"C",data:[e,a,...s]}),c=s[0],l=s[1],r=s[2],o=s[3];break}case"T":{const[e,a]=s;let i=0,u=0;"Q"===n||"T"===n?(i=r+(r-c),u=o+(o-l)):(i=r,u=o);const d=r+2*(i-r)/3,f=o+2*(u-o)/3,h=e+2*(i-e)/3,p=a+2*(u-a)/3;t.push({key:"C",data:[d,f,h,p,e,a]}),c=i,l=u,r=e,o=a;break}case"Q":{const[e,n,a,i]=s,u=r+2*(e-r)/3,d=o+2*(n-o)/3,f=a+2*(e-a)/3,h=i+2*(n-i)/3;t.push({key:"C",data:[u,d,f,h,a,i]}),c=e,l=n,r=a,o=i;break}case"A":{const e=Math.abs(s[0]),n=Math.abs(s[1]),a=s[2],i=s[3],c=s[4],l=s[5],u=s[6];0===e||0===n?(t.push({key:"C",data:[r,o,l,u,l,u]}),r=l,o=u):r===l&&o===u||(O(r,o,l,u,e,n,a,i,c).forEach((function(e){t.push({key:"C",data:e})})),r=l,o=u);break}case"Z":t.push({key:"Z",data:[]}),r=a,o=i}n=u}return t}function E(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function O(e,t,n,r,o,a,i,c,l,u){const s=(d=i,Math.PI*d/180);var d;let f=[],h=0,p=0,m=0,y=0;if(u)[h,p,m,y]=u;else{[e,t]=E(e,t,-s),[n,r]=E(n,r,-s);const i=(e-n)/2,u=(t-r)/2;let d=i*i/(o*o)+u*u/(a*a);d>1&&(d=Math.sqrt(d),o*=d,a*=d);const f=o*o,v=a*a,g=f*v-f*u*u-v*i*i,b=f*u*u+v*i*i,x=(c===l?-1:1)*Math.sqrt(Math.abs(g/b));m=x*o*u/a+(e+n)/2,y=x*-a*i/o+(t+r)/2,h=Math.asin(parseFloat(((t-y)/a).toFixed(9))),p=Math.asin(parseFloat(((r-y)/a).toFixed(9))),e<m&&(h=Math.PI-h),n<m&&(p=Math.PI-p),h<0&&(h=2*Math.PI+h),p<0&&(p=2*Math.PI+p),l&&h>p&&(h-=2*Math.PI),!l&&p>h&&(p-=2*Math.PI)}let v=p-h;if(Math.abs(v)>120*Math.PI/180){const e=p,t=n,c=r;p=l&&p>h?h+120*Math.PI/180*1:h+120*Math.PI/180*-1,f=O(n=m+o*Math.cos(p),r=y+a*Math.sin(p),t,c,o,a,i,0,l,[p,e,m,y])}v=p-h;const g=Math.cos(h),b=Math.sin(h),x=Math.cos(p),w=Math.sin(p),k=Math.tan(v/4),C=4/3*o*k,A=4/3*a*k,P=[e,t],S=[e+C*b,t-A*g],j=[n+C*w,r-A*x],R=[n,r];if(S[0]=2*P[0]-S[0],S[1]=2*P[1]-S[1],u)return[S,j,R].concat(f);{f=[S,j,R].concat(f);const e=[];for(let t=0;t<f.length;t+=3){const n=E(f[t][0],f[t][1],s),r=E(f[t+1][0],f[t+1][1],s),o=E(f[t+2][0],f[t+2][1],s);e.push([n[0],n[1],r[0],r[1],o[0],o[1]])}return e}}var C={randOffset:function(e,t){return N(e,t)},randOffsetWithRange:function(e,t,n){return D(e,t,n)},ellipse:function(e,t,n,r,o){return R(e,t,o,j(n,r,o)).opset},doubleLineOps:function(e,t,n,r,o){return B(e,t,n,r,o,!0)}};function A(e,t,n,r,o){return{type:"path",ops:B(e,t,n,r,o)}}function P(e,t,n){var r=(e||[]).length;if(r>2){for(var o=[],a=0;a<r-1;a++)o.push.apply(o,B(e[a][0],e[a][1],e[a+1][0],e[a+1][1],n));return t&&o.push.apply(o,B(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:o}}return 2===r?A(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function S(e,t){var n=F(e,1*(1+.2*t.roughness),t);if(!t.disableMultiStroke){var r=F(e,1.5*(1+.22*t.roughness),function(e){var t=a({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}(t));n=n.concat(r)}return{type:"path",ops:n}}function j(e,t,n){var r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),o=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),a=2*Math.PI/o,i=Math.abs(e/2),c=Math.abs(t/2),l=1-n.curveFitting;return{increment:a,rx:i+=N(i*l,n),ry:c+=N(c*l,n)}}function R(e,t,n,r){var o=z(r.increment,e,t,r.rx,r.ry,1,r.increment*D(.1,D(.4,1,n),n),n),a=o[0],i=o[1],c=q(a,null,n);if(!n.disableMultiStroke&&0!==n.roughness){var l=q(z(r.increment,e,t,r.rx,r.ry,1.5,0,n)[0],null,n);c=c.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:c}}}function _(e,t,n,r,o,a,c,l,u){var s=e,d=t,f=Math.abs(n/2),h=Math.abs(r/2);f+=N(.01*f,u),h+=N(.01*h,u);for(var p=o,m=a;p<0;)p+=2*Math.PI,m+=2*Math.PI;m-p>2*Math.PI&&(p=0,m=2*Math.PI);var y=2*Math.PI/u.curveStepCount,v=Math.min(y/2,(m-p)/2),g=G(v,s,d,f,h,p,m,1,u);if(!u.disableMultiStroke){var b=G(v,s,d,f,h,p,m,1.5,u);g.push.apply(g,b)}return c&&(l?g.push.apply(g,i(i([],B(s,d,s+f*Math.cos(p),d+h*Math.sin(p),u),!1),B(s,d,s+f*Math.cos(m),d+h*Math.sin(m),u),!1)):g.push({op:"lineTo",data:[s,d]},{op:"lineTo",data:[s+f*Math.cos(p),d+h*Math.sin(p)]})),{type:"path",ops:g}}function M(e,t){for(var n=[],r=0,o=e;r<o.length;r++){var a=o[r];if(a.length){var i=t.maxRandomnessOffset||0,c=a.length;if(c>2){n.push({op:"move",data:[a[0][0]+N(i,t),a[0][1]+N(i,t)]});for(var l=1;l<c;l++)n.push({op:"lineTo",data:[a[l][0]+N(i,t),a[l][1]+N(i,t)]})}}}return{type:"fillPath",ops:n}}function L(e,t){return function(e,t){var n=e.fillStyle||"hachure";if(!y[n])switch(n){case"zigzag":y[n]||(y[n]=new d(t));break;case"cross-hatch":y[n]||(y[n]=new f(t));break;case"dots":y[n]||(y[n]=new h(t));break;case"dashed":y[n]||(y[n]=new p(t));break;case"zigzag-line":y[n]||(y[n]=new m(t));break;default:y[n="hachure"]||(y[n]=new s(t))}return y[n]}(t,C).fillPolygons(e,t)}function T(e){return e.randomizer||(e.randomizer=new v(e.seed||0)),e.randomizer.next()}function D(e,t,n,r){return void 0===r&&(r=1),n.roughness*r*(T(n)*(t-e)+e)}function N(e,t,n){return void 0===n&&(n=1),D(-e,e,t,n)}function B(e,t,n,r,o,a){void 0===a&&(a=!1);var i=a?o.disableMultiStrokeFill:o.disableMultiStroke,c=I(e,t,n,r,o,!0,!1);if(i)return c;var l=I(e,t,n,r,o,!0,!0);return c.concat(l)}function I(e,t,n,r,o,a,i){var c,l=Math.pow(e-n,2)+Math.pow(t-r,2),u=Math.sqrt(l);c=u<200?1:u>500?.4:-.0016668*u+1.233334;var s=o.maxRandomnessOffset||0;s*s*100>l&&(s=u/10);var d=s/2,f=.2+.2*T(o),h=o.bowing*o.maxRandomnessOffset*(r-t)/200,p=o.bowing*o.maxRandomnessOffset*(e-n)/200;h=N(h,o,c),p=N(p,o,c);var m=[],y=function(){return N(d,o,c)},v=function(){return N(s,o,c)},g=o.preserveVertices;return a&&(i?m.push({op:"move",data:[e+(g?0:y()),t+(g?0:y())]}):m.push({op:"move",data:[e+(g?0:N(s,o,c)),t+(g?0:N(s,o,c))]})),i?m.push({op:"bcurveTo",data:[h+e+(n-e)*f+y(),p+t+(r-t)*f+y(),h+e+2*(n-e)*f+y(),p+t+2*(r-t)*f+y(),n+(g?0:y()),r+(g?0:y())]}):m.push({op:"bcurveTo",data:[h+e+(n-e)*f+v(),p+t+(r-t)*f+v(),h+e+2*(n-e)*f+v(),p+t+2*(r-t)*f+v(),n+(g?0:v()),r+(g?0:v())]}),m}function F(e,t,n){var r=[];r.push([e[0][0]+N(t,n),e[0][1]+N(t,n)]),r.push([e[0][0]+N(t,n),e[0][1]+N(t,n)]);for(var o=1;o<e.length;o++)r.push([e[o][0]+N(t,n),e[o][1]+N(t,n)]),o===e.length-1&&r.push([e[o][0]+N(t,n),e[o][1]+N(t,n)]);return q(r,null,n)}function q(e,t,n){var r=e.length,o=[];if(r>3){var a=[],i=1-n.curveTightness;o.push({op:"move",data:[e[1][0],e[1][1]]});for(var c=1;c+2<r;c++){var l=e[c];a[0]=[l[0],l[1]],a[1]=[l[0]+(i*e[c+1][0]-i*e[c-1][0])/6,l[1]+(i*e[c+1][1]-i*e[c-1][1])/6],a[2]=[e[c+1][0]+(i*e[c][0]-i*e[c+2][0])/6,e[c+1][1]+(i*e[c][1]-i*e[c+2][1])/6],a[3]=[e[c+1][0],e[c+1][1]],o.push({op:"bcurveTo",data:[a[1][0],a[1][1],a[2][0],a[2][1],a[3][0],a[3][1]]})}if(t&&2===t.length){var u=n.maxRandomnessOffset;o.push({op:"lineTo",data:[t[0]+N(u,n),t[1]+N(u,n)]})}}else 3===r?(o.push({op:"move",data:[e[1][0],e[1][1]]}),o.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===r&&o.push.apply(o,B(e[0][0],e[0][1],e[1][0],e[1][1],n));return o}function z(e,t,n,r,o,a,i,c){var l=[],u=[];if(0===c.roughness){e/=4,u.push([t+r*Math.cos(-e),n+o*Math.sin(-e)]);for(var s=0;s<=2*Math.PI;s+=e){var d=[t+r*Math.cos(s),n+o*Math.sin(s)];l.push(d),u.push(d)}u.push([t+r*Math.cos(0),n+o*Math.sin(0)]),u.push([t+r*Math.cos(e),n+o*Math.sin(e)])}else{var f=N(.5,c)-Math.PI/2;u.push([N(a,c)+t+.9*r*Math.cos(f-e),N(a,c)+n+.9*o*Math.sin(f-e)]);var h=2*Math.PI+f-.01;for(s=f;s<h;s+=e)d=[N(a,c)+t+r*Math.cos(s),N(a,c)+n+o*Math.sin(s)],l.push(d),u.push(d);u.push([N(a,c)+t+r*Math.cos(f+2*Math.PI+.5*i),N(a,c)+n+o*Math.sin(f+2*Math.PI+.5*i)]),u.push([N(a,c)+t+.98*r*Math.cos(f+i),N(a,c)+n+.98*o*Math.sin(f+i)]),u.push([N(a,c)+t+.9*r*Math.cos(f+.5*i),N(a,c)+n+.9*o*Math.sin(f+.5*i)])}return[u,l]}function G(e,t,n,r,o,a,i,c,l){var u=a+N(.1,l),s=[];s.push([N(c,l)+t+.9*r*Math.cos(u-e),N(c,l)+n+.9*o*Math.sin(u-e)]);for(var d=u;d<=i;d+=e)s.push([N(c,l)+t+r*Math.cos(d),N(c,l)+n+o*Math.sin(d)]);return s.push([t+r*Math.cos(i),n+o*Math.sin(i)]),s.push([t+r*Math.cos(i),n+o*Math.sin(i)]),q(s,null,l)}function Y(e){return[...e]}function H(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function V(e,t,n){const r=H(t,n);if(0===r)return H(e,t);let o=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return o=Math.max(0,Math.min(1,o)),H(e,U(t,n,o))}function U(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function W(e,t,n,r){const o=r||[];if(function(e,t){const n=e[t+0],r=e[t+1],o=e[t+2],a=e[t+3];let i=3*r[0]-2*n[0]-a[0];i*=i;let c=3*r[1]-2*n[1]-a[1];c*=c;let l=3*o[0]-2*a[0]-n[0];l*=l;let u=3*o[1]-2*a[1]-n[1];return u*=u,i<l&&(i=l),c<u&&(c=u),i+c}(e,t)<n){const n=e[t+0];o.length?(a=o[o.length-1],i=n,Math.sqrt(H(a,i))>1&&o.push(n)):o.push(n),o.push(e[t+3])}else{const r=.5,a=e[t+0],i=e[t+1],c=e[t+2],l=e[t+3],u=U(a,i,r),s=U(i,c,r),d=U(c,l,r),f=U(u,s,r),h=U(s,d,r),p=U(f,h,r);W([a,u,f,p],0,n,o),W([p,h,d,l],0,n,o)}var a,i;return o}function X(e,t){return K(e,0,e.length,t)}function K(e,t,n,r,o){const a=o||[],i=e[t],c=e[n-1];let l=0,u=1;for(let r=t+1;r<n-1;++r){const t=V(e[r],i,c);t>l&&(l=t,u=r)}return Math.sqrt(l)>r?(K(e,t,u+1,r,a),K(e,u,n,r,a)):(a.length||a.push(i),a.push(c)),a}function Z(e,t=.15,n){const r=[],o=(e.length-1)/3;for(let n=0;n<o;n++)W(e,3*n,t,r);return n&&n>0?K(r,0,r.length,n):r}var Q="none",$=function(){function e(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}return e.newSeed=function(){return Math.floor(Math.random()*Math.pow(2,31))},e.prototype._o=function(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions},e.prototype._d=function(e,t,n){return{shape:e,sets:t||[],options:n||this.defaultOptions}},e.prototype.line=function(e,t,n,r,o){var a=this._o(o);return this._d("line",[A(e,t,n,r,a)],a)},e.prototype.rectangle=function(e,t,n,r,o){var a=this._o(o),i=[],c=function(e,t,n,r,o){return function(e,t){return P(e,!0,t)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],o)}(e,t,n,r,a);if(a.fill){var l=[[e,t],[e+n,t],[e+n,t+r],[e,t+r]];"solid"===a.fillStyle?i.push(M([l],a)):i.push(L([l],a))}return a.stroke!==Q&&i.push(c),this._d("rectangle",i,a)},e.prototype.ellipse=function(e,t,n,r,o){var a=this._o(o),i=[],c=j(n,r,a),l=R(e,t,a,c);if(a.fill)if("solid"===a.fillStyle){var u=R(e,t,a,c).opset;u.type="fillPath",i.push(u)}else i.push(L([l.estimatedPoints],a));return a.stroke!==Q&&i.push(l.opset),this._d("ellipse",i,a)},e.prototype.circle=function(e,t,n,r){var o=this.ellipse(e,t,n,n,r);return o.shape="circle",o},e.prototype.linearPath=function(e,t){var n=this._o(t);return this._d("linearPath",[P(e,!1,n)],n)},e.prototype.arc=function(e,t,n,r,o,i,c,l){void 0===c&&(c=!1);var u=this._o(l),s=[],d=_(e,t,n,r,o,i,c,!0,u);if(c&&u.fill)if("solid"===u.fillStyle){var f=a({},u);f.disableMultiStroke=!0;var h=_(e,t,n,r,o,i,!0,!1,f);h.type="fillPath",s.push(h)}else s.push(function(e,t,n,r,o,a,i){var c=e,l=t,u=Math.abs(n/2),s=Math.abs(r/2);u+=N(.01*u,i),s+=N(.01*s,i);for(var d=o,f=a;d<0;)d+=2*Math.PI,f+=2*Math.PI;f-d>2*Math.PI&&(d=0,f=2*Math.PI);for(var h=(f-d)/i.curveStepCount,p=[],m=d;m<=f;m+=h)p.push([c+u*Math.cos(m),l+s*Math.sin(m)]);return p.push([c+u*Math.cos(f),l+s*Math.sin(f)]),p.push([c,l]),L([p],i)}(e,t,n,r,o,i,u));return u.stroke!==Q&&s.push(d),this._d("arc",s,u)},e.prototype.curve=function(e,t){var n=this._o(t),r=[],o=S(e,n);if(n.fill&&n.fill!==Q&&e.length>=3){var a=Z(function(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(3===n)r.push(Y(e[0]),Y(e[1]),Y(e[2]),Y(e[2]));else{const n=[];n.push(e[0],e[0]);for(let t=1;t<e.length;t++)n.push(e[t]),t===e.length-1&&n.push(e[t]);const o=[],a=1-t;r.push(Y(n[0]));for(let e=1;e+2<n.length;e++){const t=n[e];o[0]=[t[0],t[1]],o[1]=[t[0]+(a*n[e+1][0]-a*n[e-1][0])/6,t[1]+(a*n[e+1][1]-a*n[e-1][1])/6],o[2]=[n[e+1][0]+(a*n[e][0]-a*n[e+2][0])/6,n[e+1][1]+(a*n[e][1]-a*n[e+2][1])/6],o[3]=[n[e+1][0],n[e+1][1]],r.push(o[1],o[2],o[3])}}return r}(e),10,(1+n.roughness)/2);"solid"===n.fillStyle?r.push(M([a],n)):r.push(L([a],n))}return n.stroke!==Q&&r.push(o),this._d("curve",r,n)},e.prototype.polygon=function(e,t){var n=this._o(t),r=[],o=P(e,!0,n);return n.fill&&("solid"===n.fillStyle?r.push(M([e],n)):r.push(L([e],n))),n.stroke!==Q&&r.push(o),this._d("polygon",r,n)},e.prototype.path=function(e,t){var n=this._o(t),r=[];if(!e)return this._d("path",r,n);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var o=n.fill&&"transparent"!==n.fill&&n.fill!==Q,a=n.stroke!==Q,i=!!(n.simplification&&n.simplification<1),c=function(e,t,n){const r=k(w(x(e))),o=[];let a=[],i=[0,0],c=[];const l=()=>{c.length>=4&&a.push(...Z(c,1)),c=[]},u=()=>{l(),a.length&&(o.push(a),a=[])};for(const{key:e,data:t}of r)switch(e){case"M":u(),i=[t[0],t[1]],a.push(i);break;case"L":l(),a.push([t[0],t[1]]);break;case"C":if(!c.length){const e=a.length?a[a.length-1]:i;c.push([e[0],e[1]])}c.push([t[0],t[1]]),c.push([t[2],t[3]]),c.push([t[4],t[5]]);break;case"Z":l(),a.push([i[0],i[1]])}if(u(),!n)return o;const s=[];for(const e of o){const t=X(e,n);t.length&&s.push(t)}return s}(e,0,i?4-4*n.simplification:(1+n.roughness)/2);return o&&("solid"===n.fillStyle?r.push(M(c,n)):r.push(L(c,n))),a&&(i?c.forEach((function(e){r.push(P(e,!1,n))})):r.push(function(e,t){for(var n=k(w(x(e))),r=[],o=[0,0],a=[0,0],i=function(e,n){switch(e){case"M":var i=1*(t.maxRandomnessOffset||0),c=t.preserveVertices;r.push({op:"move",data:n.map((function(e){return e+(c?0:N(i,t))}))}),a=[n[0],n[1]],o=[n[0],n[1]];break;case"L":r.push.apply(r,B(a[0],a[1],n[0],n[1],t)),a=[n[0],n[1]];break;case"C":var l=n[0],u=n[1],s=n[2],d=n[3],f=n[4],h=n[5];r.push.apply(r,function(e,t,n,r,o,a,i,c){for(var l=[],u=[c.maxRandomnessOffset||1,(c.maxRandomnessOffset||1)+.3],s=[0,0],d=c.disableMultiStroke?1:2,f=c.preserveVertices,h=0;h<d;h++)0===h?l.push({op:"move",data:[i[0],i[1]]}):l.push({op:"move",data:[i[0]+(f?0:N(u[0],c)),i[1]+(f?0:N(u[0],c))]}),s=f?[o,a]:[o+N(u[h],c),a+N(u[h],c)],l.push({op:"bcurveTo",data:[e+N(u[h],c),t+N(u[h],c),n+N(u[h],c),r+N(u[h],c),s[0],s[1]]});return l}(l,u,s,d,f,h,a,t)),a=[f,h];break;case"Z":r.push.apply(r,B(a[0],a[1],o[0],o[1],t)),a=[o[0],o[1]]}},c=0,l=n;c<l.length;c++){var u=l[c];i(u.key,u.data)}return{type:"path",ops:r}}(e,n))),this._d("path",r,n)},e.prototype.opsToPath=function(e,t){for(var n="",r=0,o=e.ops;r<o.length;r++){var a=o[r],i="number"==typeof t&&t>=0?a.data.map((function(e){return+e.toFixed(t)})):a.data;switch(a.op){case"move":n+="M".concat(i[0]," ").concat(i[1]," ");break;case"bcurveTo":n+="C".concat(i[0]," ").concat(i[1],", ").concat(i[2]," ").concat(i[3],", ").concat(i[4]," ").concat(i[5]," ");break;case"lineTo":n+="L".concat(i[0]," ").concat(i[1]," ")}}return n.trim()},e.prototype.toPaths=function(e){for(var t=e.sets||[],n=e.options||this.defaultOptions,r=[],o=0,a=t;o<a.length;o++){var i=a[o],c=null;switch(i.type){case"path":c={d:this.opsToPath(i),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:Q};break;case"fillPath":c={d:this.opsToPath(i),stroke:Q,strokeWidth:0,fill:n.fill||Q};break;case"fillSketch":c=this.fillSketch(i,n)}c&&r.push(c)}return r},e.prototype.fillSketch=function(e,t){var n=t.fillWeight;return n<0&&(n=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||Q,strokeWidth:n,fill:Q}},e}(),J=function(){function e(e,t){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new $(t)}return e.prototype.draw=function(e){for(var t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.ctx,o=e.options.fixedDecimalPlaceDigits,a=0,i=t;a<i.length;a++){var c=i[a];switch(c.type){case"path":r.save(),r.strokeStyle="none"===n.stroke?"transparent":n.stroke,r.lineWidth=n.strokeWidth,n.strokeLineDash&&r.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(r.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(r,c,o),r.restore();break;case"fillPath":r.save(),r.fillStyle=n.fill||"";var l="curve"===e.shape||"polygon"===e.shape||"path"===e.shape?"evenodd":"nonzero";this._drawToContext(r,c,o,l),r.restore();break;case"fillSketch":this.fillSketch(r,c,n)}}},e.prototype.fillSketch=function(e,t,n){var r=n.fillWeight;r<0&&(r=n.strokeWidth/2),e.save(),n.fillLineDash&&e.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(e.lineDashOffset=n.fillLineDashOffset),e.strokeStyle=n.fill||"",e.lineWidth=r,this._drawToContext(e,t,n.fixedDecimalPlaceDigits),e.restore()},e.prototype._drawToContext=function(e,t,n,r){void 0===r&&(r="nonzero"),e.beginPath();for(var o=0,a=t.ops;o<a.length;o++){var i=a[o],c="number"==typeof n&&n>=0?i.data.map((function(e){return+e.toFixed(n)})):i.data;switch(i.op){case"move":e.moveTo(c[0],c[1]);break;case"bcurveTo":e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"lineTo":e.lineTo(c[0],c[1])}}"fillPath"===t.type?e.fill(r):e.stroke()},Object.defineProperty(e.prototype,"generator",{get:function(){return this.gen},enumerable:!1,configurable:!0}),e.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},e.prototype.line=function(e,t,n,r,o){var a=this.gen.line(e,t,n,r,o);return this.draw(a),a},e.prototype.rectangle=function(e,t,n,r,o){var a=this.gen.rectangle(e,t,n,r,o);return this.draw(a),a},e.prototype.ellipse=function(e,t,n,r,o){var a=this.gen.ellipse(e,t,n,r,o);return this.draw(a),a},e.prototype.circle=function(e,t,n,r){var o=this.gen.circle(e,t,n,r);return this.draw(o),o},e.prototype.linearPath=function(e,t){var n=this.gen.linearPath(e,t);return this.draw(n),n},e.prototype.polygon=function(e,t){var n=this.gen.polygon(e,t);return this.draw(n),n},e.prototype.arc=function(e,t,n,r,o,a,i,c){void 0===i&&(i=!1);var l=this.gen.arc(e,t,n,r,o,a,i,c);return this.draw(l),l},e.prototype.curve=function(e,t){var n=this.gen.curve(e,t);return this.draw(n),n},e.prototype.path=function(e,t){var n=this.gen.path(e,t);return this.draw(n),n},e}(),ee="http://www.w3.org/2000/svg",te=function(){function e(e,t){this.svg=e,this.gen=new $(t)}return e.prototype.draw=function(e){for(var t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,o=r.createElementNS(ee,"g"),a=e.options.fixedDecimalPlaceDigits,i=0,c=t;i<c.length;i++){var l=c[i],u=null;switch(l.type){case"path":(u=r.createElementNS(ee,"path")).setAttribute("d",this.opsToPath(l,a)),u.setAttribute("stroke",n.stroke),u.setAttribute("stroke-width",n.strokeWidth+""),u.setAttribute("fill","none"),n.strokeLineDash&&u.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&u.setAttribute("stroke-dashoffset","".concat(n.strokeLineDashOffset));break;case"fillPath":(u=r.createElementNS(ee,"path")).setAttribute("d",this.opsToPath(l,a)),u.setAttribute("stroke","none"),u.setAttribute("stroke-width","0"),u.setAttribute("fill",n.fill||""),"curve"!==e.shape&&"polygon"!==e.shape||u.setAttribute("fill-rule","evenodd");break;case"fillSketch":u=this.fillSketch(r,l,n)}u&&o.appendChild(u)}return o},e.prototype.fillSketch=function(e,t,n){var r=n.fillWeight;r<0&&(r=n.strokeWidth/2);var o=e.createElementNS(ee,"path");return o.setAttribute("d",this.opsToPath(t,n.fixedDecimalPlaceDigits)),o.setAttribute("stroke",n.fill||""),o.setAttribute("stroke-width",r+""),o.setAttribute("fill","none"),n.fillLineDash&&o.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&o.setAttribute("stroke-dashoffset","".concat(n.fillLineDashOffset)),o},Object.defineProperty(e.prototype,"generator",{get:function(){return this.gen},enumerable:!1,configurable:!0}),e.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},e.prototype.opsToPath=function(e,t){return this.gen.opsToPath(e,t)},e.prototype.line=function(e,t,n,r,o){var a=this.gen.line(e,t,n,r,o);return this.draw(a)},e.prototype.rectangle=function(e,t,n,r,o){var a=this.gen.rectangle(e,t,n,r,o);return this.draw(a)},e.prototype.ellipse=function(e,t,n,r,o){var a=this.gen.ellipse(e,t,n,r,o);return this.draw(a)},e.prototype.circle=function(e,t,n,r){var o=this.gen.circle(e,t,n,r);return this.draw(o)},e.prototype.linearPath=function(e,t){var n=this.gen.linearPath(e,t);return this.draw(n)},e.prototype.polygon=function(e,t){var n=this.gen.polygon(e,t);return this.draw(n)},e.prototype.arc=function(e,t,n,r,o,a,i,c){void 0===i&&(i=!1);var l=this.gen.arc(e,t,n,r,o,a,i,c);return this.draw(l)},e.prototype.curve=function(e,t){var n=this.gen.curve(e,t);return this.draw(n)},e.prototype.path=function(e,t){var n=this.gen.path(e,t);return this.draw(n)},e}(),ne={canvas:function(e,t){return new J(e,t)},svg:function(e,t){return new te(e,t)},generator:function(e){return new $(e)},newSeed:function(){return $.newSeed()}};e.exports=ne},3944:function(e,t,n){var r=n(3945)();e.exports=r},3945:function(e,t,n){var r=n(3946),o=n(460),a=n(931);e.exports=function(e){return function(t,n,i){return i&&"number"!=typeof i&&o(t,n,i)&&(n=i=void 0),t=a(t),void 0===n?(n=t,t=0):n=a(n),i=void 0===i?t<n?1:-1:a(i),r(t,n,i,e)}}},3946:function(e,t){var n=Math.ceil,r=Math.max;e.exports=function(e,t,o,a){for(var i=-1,c=r(n((t-e)/(o||1)),0),l=Array(c);c--;)l[a?c:++i]=e,e+=o;return l}},3947:function(e,t,n){"use strict";e.exports=n(3948)},3948:function(e,t,n){"use strict";var r=n(3949),o=n(3950),a=n(3859),i=n(3951),c=n(3952);function l(e){if(!(this instanceof l))return new l(e);var t=r(e);this.segments=t.segments,this.err=t.err,this.__stack=[]}l.from=function(e){if("string"==typeof e)return new l(e);if(e instanceof l){var t=new l("");return t.err=e.err,t.segments=e.segments.map((function(e){return e.slice()})),t.__stack=e.__stack.map((function(e){return a().matrix(e.toArray())})),t}throw new Error("SvgPath.from: invalid param type "+e)},l.prototype.__matrix=function(e){var t,n=this;e.queue.length&&this.iterate((function(r,o,a,i){var l,u,s,d;switch(r[0]){case"v":u=0===(l=e.calc(0,r[1],!0))[0]?["v",l[1]]:["l",l[0],l[1]];break;case"V":u=(l=e.calc(a,r[1],!1))[0]===e.calc(a,i,!1)[0]?["V",l[1]]:["L",l[0],l[1]];break;case"h":u=0===(l=e.calc(r[1],0,!0))[1]?["h",l[0]]:["l",l[0],l[1]];break;case"H":u=(l=e.calc(r[1],i,!1))[1]===e.calc(a,i,!1)[1]?["H",l[0]]:["L",l[0],l[1]];break;case"a":case"A":var f=e.toArray(),h=c(r[1],r[2],r[3]).transform(f);if(f[0]*f[3]-f[1]*f[2]<0&&(r[5]=r[5]?"0":"1"),l=e.calc(r[6],r[7],"a"===r[0]),"A"===r[0]&&r[6]===a&&r[7]===i||"a"===r[0]&&0===r[6]&&0===r[7]){u=["a"===r[0]?"l":"L",l[0],l[1]];break}u=h.isDegenerate()?["a"===r[0]?"l":"L",l[0],l[1]]:[r[0],h.rx,h.ry,h.ax,r[4],r[5],l[0],l[1]];break;case"m":d=o>0,u=["m",(l=e.calc(r[1],r[2],d))[0],l[1]];break;default:for(u=[s=r[0]],d=s.toLowerCase()===s,t=1;t<r.length;t+=2)l=e.calc(r[t],r[t+1],d),u.push(l[0],l[1])}n.segments[o]=u}),!0)},l.prototype.__evaluateStack=function(){var e,t;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(e=a(),t=this.__stack.length;--t>=0;)e.matrix(this.__stack[t].toArray());this.__matrix(e),this.__stack=[]}},l.prototype.toString=function(){var e="",t="",n=!1;this.__evaluateStack();for(var r=0,o=this.segments.length;r<o;r++){var a=this.segments[r],i=a[0];i!==t||"m"===i||"M"===i?("m"===i&&"z"===t&&(e+=" "),e+=i,n=!1):n=!0;for(var c=1;c<a.length;c++){var l=a[c];1===c?n&&l>=0&&(e+=" "):l>=0&&(e+=" "),e+=l}t=i}return e},l.prototype.translate=function(e,t){return this.__stack.push(a().translate(e,t||0)),this},l.prototype.scale=function(e,t){return this.__stack.push(a().scale(e,t||0===t?t:e)),this},l.prototype.rotate=function(e,t,n){return this.__stack.push(a().rotate(e,t||0,n||0)),this},l.prototype.skewX=function(e){return this.__stack.push(a().skewX(e)),this},l.prototype.skewY=function(e){return this.__stack.push(a().skewY(e)),this},l.prototype.matrix=function(e){return this.__stack.push(a().matrix(e)),this},l.prototype.transform=function(e){return e.trim()?(this.__stack.push(o(e)),this):this},l.prototype.round=function(e){var t,n=0,r=0,o=0,a=0;return e=e||0,this.__evaluateStack(),this.segments.forEach((function(i){var c=i[0].toLowerCase()===i[0];switch(i[0]){case"H":case"h":return c&&(i[1]+=o),o=i[1]-i[1].toFixed(e),void(i[1]=+i[1].toFixed(e));case"V":case"v":return c&&(i[1]+=a),a=i[1]-i[1].toFixed(e),void(i[1]=+i[1].toFixed(e));case"Z":case"z":return o=n,void(a=r);case"M":case"m":return c&&(i[1]+=o,i[2]+=a),o=i[1]-i[1].toFixed(e),a=i[2]-i[2].toFixed(e),n=o,r=a,i[1]=+i[1].toFixed(e),void(i[2]=+i[2].toFixed(e));case"A":case"a":return c&&(i[6]+=o,i[7]+=a),o=i[6]-i[6].toFixed(e),a=i[7]-i[7].toFixed(e),i[1]=+i[1].toFixed(e),i[2]=+i[2].toFixed(e),i[3]=+i[3].toFixed(e+2),i[6]=+i[6].toFixed(e),void(i[7]=+i[7].toFixed(e));default:return t=i.length,c&&(i[t-2]+=o,i[t-1]+=a),o=i[t-2]-i[t-2].toFixed(e),a=i[t-1]-i[t-1].toFixed(e),void i.forEach((function(t,n){n&&(i[n]=+i[n].toFixed(e))}))}})),this},l.prototype.iterate=function(e,t){var n,r,o,a=this.segments,i={},c=!1,l=0,u=0,s=0,d=0;if(t||this.__evaluateStack(),a.forEach((function(t,n){var r=e(t,n,l,u);Array.isArray(r)&&(i[n]=r,c=!0);var o=t[0]===t[0].toLowerCase();switch(t[0]){case"m":case"M":return l=t[1]+(o?l:0),u=t[2]+(o?u:0),s=l,void(d=u);case"h":case"H":return void(l=t[1]+(o?l:0));case"v":case"V":return void(u=t[1]+(o?u:0));case"z":case"Z":return l=s,void(u=d);default:l=t[t.length-2]+(o?l:0),u=t[t.length-1]+(o?u:0)}})),!c)return this;for(o=[],n=0;n<a.length;n++)if(void 0!==i[n])for(r=0;r<i[n].length;r++)o.push(i[n][r]);else o.push(a[n]);return this.segments=o,this},l.prototype.abs=function(){return this.iterate((function(e,t,n,r){var o,a=e[0],i=a.toUpperCase();if(a!==i)switch(e[0]=i,a){case"v":return void(e[1]+=r);case"a":return e[6]+=n,void(e[7]+=r);default:for(o=1;o<e.length;o++)e[o]+=o%2?n:r}}),!0),this},l.prototype.rel=function(){return this.iterate((function(e,t,n,r){var o,a=e[0],i=a.toLowerCase();if(a!==i&&(0!==t||"M"!==a))switch(e[0]=i,a){case"V":return void(e[1]-=r);case"A":return e[6]-=n,void(e[7]-=r);default:for(o=1;o<e.length;o++)e[o]-=o%2?n:r}}),!0),this},l.prototype.unarc=function(){return this.iterate((function(e,t,n,r){var o,a,c,l=[],u=e[0];return"A"!==u&&"a"!==u?null:("a"===u?(a=n+e[6],c=r+e[7]):(a=e[6],c=e[7]),0===(o=i(n,r,a,c,e[4],e[5],e[1],e[2],e[3])).length?[["a"===e[0]?"l":"L",e[6],e[7]]]:(o.forEach((function(e){l.push(["C",e[2],e[3],e[4],e[5],e[6],e[7]])})),l))})),this},l.prototype.unshort=function(){var e,t,n,r,o,a=this.segments;return this.iterate((function(i,c,l,u){var s,d=i[0],f=d.toUpperCase();c&&("T"===f?(s="t"===d,"Q"===(n=a[c-1])[0]?(e=n[1]-l,t=n[2]-u):"q"===n[0]?(e=n[1]-n[3],t=n[2]-n[4]):(e=0,t=0),r=-e,o=-t,s||(r+=l,o+=u),a[c]=[s?"q":"Q",r,o,i[1],i[2]]):"S"===f&&(s="s"===d,"C"===(n=a[c-1])[0]?(e=n[3]-l,t=n[4]-u):"c"===n[0]?(e=n[3]-n[5],t=n[4]-n[6]):(e=0,t=0),r=-e,o=-t,s||(r+=l,o+=u),a[c]=[s?"c":"C",r,o,i[1],i[2],i[3],i[4]]))})),this},e.exports=l},3949:function(e,t,n){"use strict";var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},o=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function a(e){return e>=48&&e<=57}function i(e){return e>=48&&e<=57||43===e||45===e||46===e}function c(e){this.index=0,this.path=e,this.max=e.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function l(e){for(;e.index<e.max&&(10===(t=e.path.charCodeAt(e.index))||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&o.indexOf(t)>=0);)e.index++;var t}function u(e){var t=e.path.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="SvgPath: arc flag can be 0 or 1 only (at pos "+e.index+")")}function s(e){var t,n=e.index,r=n,o=e.max,i=!1,c=!1,l=!1,u=!1;if(r>=o)e.err="SvgPath: missed param (at pos "+r+")";else if(43!==(t=e.path.charCodeAt(r))&&45!==t||(t=++r<o?e.path.charCodeAt(r):0),a(t)||46===t){if(46!==t){if(i=48===t,t=++r<o?e.path.charCodeAt(r):0,i&&r<o&&t&&a(t))return void(e.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+n+")");for(;r<o&&a(e.path.charCodeAt(r));)r++,c=!0;t=r<o?e.path.charCodeAt(r):0}if(46===t){for(u=!0,r++;a(e.path.charCodeAt(r));)r++,l=!0;t=r<o?e.path.charCodeAt(r):0}if(101===t||69===t){if(u&&!c&&!l)return void(e.err="SvgPath: invalid float exponent (at pos "+r+")");if(43!==(t=++r<o?e.path.charCodeAt(r):0)&&45!==t||r++,!(r<o&&a(e.path.charCodeAt(r))))return void(e.err="SvgPath: invalid float exponent (at pos "+r+")");for(;r<o&&a(e.path.charCodeAt(r));)r++}e.index=r,e.param=parseFloat(e.path.slice(n,r))+0}else e.err="SvgPath: param should start with 0..9 or `.` (at pos "+r+")"}function d(e){var t,n;n=(t=e.path[e.segmentStart]).toLowerCase();var o=e.data;if("m"===n&&o.length>2&&(e.result.push([t,o[0],o[1]]),o=o.slice(2),n="l",t="m"===t?"l":"L"),"r"===n)e.result.push([t].concat(o));else for(;o.length>=r[n]&&(e.result.push([t].concat(o.splice(0,r[n]))),r[n]););}function f(e){var t,n,o,a,c,f=e.max;if(e.segmentStart=e.index,t=e.path.charCodeAt(e.index),n=97==(32|t),function(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(t))if(a=r[e.path[e.index].toLowerCase()],e.index++,l(e),e.data=[],a){for(o=!1;;){for(c=a;c>0;c--){if(!n||3!==c&&4!==c?s(e):u(e),e.err.length)return void d(e);e.data.push(e.param),l(e),o=!1,e.index<f&&44===e.path.charCodeAt(e.index)&&(e.index++,l(e),o=!0)}if(!o){if(e.index>=e.max)break;if(!i(e.path.charCodeAt(e.index)))break}}d(e)}else d(e);else e.err="SvgPath: bad command "+e.path[e.index]+" (at pos "+e.index+")"}e.exports=function(e){var t=new c(e),n=t.max;for(l(t);t.index<n&&!t.err.length;)f(t);return t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}}},3950:function(e,t,n){"use strict";var r=n(3859),o={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},a=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;e.exports=function(e){var t,n,c=new r;return e.split(a).forEach((function(e){if(e.length)if(void 0===o[e])switch(n=e.split(i).map((function(e){return+e||0})),t){case"matrix":return void(6===n.length&&c.matrix(n));case"scale":return void(1===n.length?c.scale(n[0],n[0]):2===n.length&&c.scale(n[0],n[1]));case"rotate":return void(1===n.length?c.rotate(n[0],0,0):3===n.length&&c.rotate(n[0],n[1],n[2]));case"translate":return void(1===n.length?c.translate(n[0],0):2===n.length&&c.translate(n[0],n[1]));case"skewX":return void(1===n.length&&c.skewX(n[0]));case"skewY":return void(1===n.length&&c.skewY(n[0]))}else t=e})),c}},3951:function(e,t,n){"use strict";var r=2*Math.PI;function o(e,t,n,r){var o=e*n+t*r;return o>1&&(o=1),o<-1&&(o=-1),(e*r-t*n<0?-1:1)*Math.acos(o)}function a(e,t){var n=4/3*Math.tan(t/4),r=Math.cos(e),o=Math.sin(e),a=Math.cos(e+t),i=Math.sin(e+t);return[r,o,r-o*n,o+r*n,a+i*n,i-a*n,a,i]}e.exports=function(e,t,n,i,c,l,u,s,d){var f=Math.sin(d*r/360),h=Math.cos(d*r/360),p=h*(e-n)/2+f*(t-i)/2,m=-f*(e-n)/2+h*(t-i)/2;if(0===p&&0===m)return[];if(0===u||0===s)return[];u=Math.abs(u),s=Math.abs(s);var y=p*p/(u*u)+m*m/(s*s);y>1&&(u*=Math.sqrt(y),s*=Math.sqrt(y));var v=function(e,t,n,a,i,c,l,u,s,d){var f=d*(e-n)/2+s*(t-a)/2,h=-s*(e-n)/2+d*(t-a)/2,p=l*l,m=u*u,y=f*f,v=h*h,g=p*m-p*v-m*y;g<0&&(g=0),g/=p*v+m*y;var b=(g=Math.sqrt(g)*(i===c?-1:1))*l/u*h,x=g*-u/l*f,w=d*b-s*x+(e+n)/2,k=s*b+d*x+(t+a)/2,E=(f-b)/l,O=(h-x)/u,C=(-f-b)/l,A=(-h-x)/u,P=o(1,0,E,O),S=o(E,O,C,A);return 0===c&&S>0&&(S-=r),1===c&&S<0&&(S+=r),[w,k,P,S]}(e,t,n,i,c,l,u,s,f,h),g=[],b=v[2],x=v[3],w=Math.max(Math.ceil(Math.abs(x)/(r/4)),1);x/=w;for(var k=0;k<w;k++)g.push(a(b,x)),b+=x;return g.map((function(e){for(var t=0;t<e.length;t+=2){var n=e[t+0],r=e[t+1],o=h*(n*=u)-f*(r*=s),a=f*n+h*r;e[t+0]=o+v[0],e[t+1]=a+v[1]}return e}))}},3952:function(e,t,n){"use strict";var r=1e-10,o=Math.PI/180;function a(e,t,n){if(!(this instanceof a))return new a(e,t,n);this.rx=e,this.ry=t,this.ax=n}a.prototype.transform=function(e){var t=Math.cos(this.ax*o),n=Math.sin(this.ax*o),a=[this.rx*(e[0]*t+e[2]*n),this.rx*(e[1]*t+e[3]*n),this.ry*(-e[0]*n+e[2]*t),this.ry*(-e[1]*n+e[3]*t)],i=a[0]*a[0]+a[2]*a[2],c=a[1]*a[1]+a[3]*a[3],l=((a[0]-a[3])*(a[0]-a[3])+(a[2]+a[1])*(a[2]+a[1]))*((a[0]+a[3])*(a[0]+a[3])+(a[2]-a[1])*(a[2]-a[1])),u=(i+c)/2;if(l<r*u)return this.rx=this.ry=Math.sqrt(u),this.ax=0,this;var s=a[0]*a[1]+a[2]*a[3],d=u+(l=Math.sqrt(l))/2,f=u-l/2;return this.ax=Math.abs(s)<r&&Math.abs(d-c)<r?90:180*Math.atan(Math.abs(s)>Math.abs(d-c)?(d-i)/s:s/(d-c))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(d),this.ry=Math.sqrt(f)):(this.ax+=90,this.rx=Math.sqrt(f),this.ry=Math.sqrt(d)),this},a.prototype.isDegenerate=function(){return this.rx<r*this.ry||this.ry<r*this.rx},e.exports=a},3953:function(e,t,n){var r=n(710);e.exports=function(e){return r(e,4)}},3964:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(43),l=n.n(c),u=n(3170),s=n.n(u),d=n(3845);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var h=["doc","book","group","match","children","className","fragmentId"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function m(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===f(a)?a:String(a)),r)}var o,a}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t,n,r,a=g(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).headerHeight=e.showHeader?32:0,t.state={contentHeight:"auto"},t}return t=i,n=[{key:"_calcFrameElement",value:function(){var e=window.parent,t=this.props.minResizeHeight;if(e&&this.containerRef){var n=this.containerRef.scrollHeight;if(n>32){n<t&&(n=t);var r=n+this.headerHeight+1;this.cacheOuterFrameHeight!==r&&(e.postMessage({isYuqueEmbed:!0,href:window.location.href,contentHeight:r},"*"),this.cacheOuterFrameHeight=r)}}}},{key:"getContentHeightFromViewer",value:function(){return window.innerHeight-this.headerHeight}},{key:"setContentHeight",value:function(){this.setState({contentHeight:this.getContentHeightFromViewer()})}},{key:"reCalcFrameElement",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=this.props.autoResizeTimeout;if(!(t>10)){this.reCalcTimeout&&(window.clearTimeout(this.reCalcTimeout),this.reCalcTimeout=void 0);var r=window.setTimeout((function(){e._calcFrameElement(),e.reCalcFrameElement(t+1)}),n);this.reCalcTimeout=r}}},{key:"unsafe_componentWillReceiveProps",value:function(){this.reCalcFrameElement(),this.setContentHeight()}},{key:"componentDidMount",value:function(){var e=this;this.reCalcFrameElement(),this.setContentHeight(),window.addEventListener("resize",l()((function(){e.setContentHeight()}),16))}},{key:"render",value:function(){var e=this,t=this.props,n=t.doc,r=t.book,a=t.group,i=t.match,c=t.children,l=t.className,u=t.fragmentId,f=m(t,h),y=s()(f,"autoResizeTimeout","docLoaded","showHeader","minResizeHeight"),v=u?"".concat(i.url,"#").concat(u):i.url,g=this.state.contentHeight;document.body.style["overflow-y"]="hidden";try{return o.a.createElement("div",p({className:"doc-embed-container ".concat(l||"")},y),this.props.showHeader&&o.a.createElement(d.a,{title:n.title,doc:n,book:r,group:a,link:v,height:this.headerHeight}),o.a.createElement("div",{"data-scroll-container":"true",className:"doc-embed-content-container",style:{height:"number"==typeof g?"".concat(g,"px"):"auto"},ref:function(t){e.containerRef=t},onScroll:this.props.onScroll},c))}catch(e){return console.error(e),window.location.href="/404?view=doc_embed",o.a.createElement("span",null)}}}],n&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.Component);x.defaultProps={showHeader:!0,className:"",onScroll:function(){},minResizeHeight:200,autoResizeTimeout:100},x.propTypes={doc:i.a.object.isRequired,book:i.a.object,group:i.a.object,match:i.a.object,minResizeHeight:i.a.number,autoResizeTimeout:i.a.number,showHeader:i.a.bool,className:i.a.string,fragmentId:i.a.string,onScroll:i.a.func,children:i.a.oneOfType([i.a.arrayOf(i.a.node),i.a.node]).isRequired};t.a=x},3992:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(90),l=n.n(c),u=n(67),s=n(905);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}var f=new l.a("doc:error"),h=Object(s.b)((function(){return Promise.all([n.e(0),n.e(1),n.e(21),n.e(1405)]).then(n.bind(null,3251))}),{suspense:!0}),p=Object(s.b)((function(){return Promise.all([n.e(0),n.e(1),n.e(21),n.e(1406)]).then(n.bind(null,3250))}),{suspense:!0}),m=Object(s.b)((function(){return Promise.all([n.e(0),n.e(1),n.e(21),n.e(1404)]).then(n.bind(null,3252))}),{suspense:!0}),y=Object(s.b)((function(){return n.e(1401).then(n.bind(null,4167))}),{suspense:!0});function v(e){var t=e.error;f("doc load error",t);var n=Object(u.useHistory)();return o.a.createElement("div",{"data-testid":"empty-view"},function(){if(403===t.status){if(null!=t&&t.needVerifyTargetId&&"need_verify_password"===(null==t?void 0:t.code))return o.a.createElement(h,{targetType:"Doc",needVerifyTargetId:t.needVerifyTargetId,onlyContent:!0});var e=t.data,r=e.organization,a=e.canReadOrg,i=e.groupLogin;return(r&&a||!window.appData.isYuque)&&i?o.a.createElement(m,d({},t.data,{history:n,onlyContent:!0})):o.a.createElement(p,d({},t.data,{history:n,onlyContent:!0}))}return[404,500].includes(t.status)?o.a.createElement(y,{status:t.status}):o.a.createElement("div",{style:{height:"640px"}})}())}v.propTypes={error:i.a.object.isRequired},t.a=v},4002:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(841),l=n(229),u=n(3656),s=Object(c.a)({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(6),n.e(12),n.e(62)]).then(n.bind(null,4161))},loading:u.a}),d=Object(c.a)({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(6),n.e(12),n.e(62)]).then(n.bind(null,4398))},loading:u.a});function f(e){var t=e.format,n=e.content;if("laketable"===t){var r=function(){return o.a.createElement(s,{versionMode:!!e.versionMode,abilities:e.abilities,docId:e.docId,docType:e.docType,type:e.type,content:n,onLoad:e.onLoad})},a=function(){return o.a.createElement(d,{versionMode:!!e.versionMode,abilities:e.abilities,docId:e.docId,docType:e.docType,type:e.type,content:n,onLoad:e.onLoad})};if(window.h5){var i=new URLSearchParams(window.location.search).get("next");return i?"true"===i?a():r():e.enableNext?a():r()}return a()}return null}f.propTypes={format:i.a.string.isRequired,abilities:i.a.object,docId:i.a.number.isRequired,docType:i.a.string.isRequired,type:i.a.string.isRequired,content:i.a.string.isRequired,enableNext:i.a.bool.isRequired,versionMode:i.a.bool,onLoad:i.a.func},t.a=Object(l.b)(f,!0,__("数据出错，请通过历史恢复到最近的正确版本，重新编辑"))},4026:function(e,t,n){"use strict";t.a={wrapper:"Reader-module_wrapper_8LhoV",adapt:"Reader-module_adapt_jPfiq",content:"Reader-module_content_iqKeO",draft:"Reader-module_draft_zoYcP"}},4119:function(e,t,n){"use strict";n(55);var r=n(22),o=n(0),a=n(90),i=n.n(a),c=n(67),l=n(3608);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=new i.a("hook:useLoadDoc");t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.requestData,a=e.dispatch,i=n.book_id,u=n.slug,s=n.query,f=Object(c.useRouteMatch)().params,p={};p=i&&u?{book_id:i,slug:u}:{user_login:f.group,book_slug:f.book,slug:f.doc},Object(o.useEffect)((function(){h("load doc: ",n);var e=(new l.a).isExtremeMode();if(window.appData.isYuqueMobileApp&&window.__skeletonData&&window.__skeletonData.book_id===i&&window.__skeletonData.slug===u&&(window.__skeletonData=void 0,e=!0),!e){var t="doc_embed"!==s.view;return a({type:"doc/getDetail",payload:d(d({},p),{},{withData:{contributors:t,like:t,hits:t,pager:t,suggests:t}})}).then((function(e){h("doc init done, res: ",e)})).catch((function(e){h("doc init error",e),r.a.error(e.message||__("系统异常"))})),function(){window.scrollTo(0,0)}}a({type:"doc/update",payload:{loaded:!0,loadedAt:+new Date}})}),t)}},4124:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(11),l=n.n(c),u=n(429),s=n(31),d=n(3889),f=n(229),h=n(3840),p=n(207),m={commmentHeader:"ReaderComment-module_commmentHeader_U8YZ5",mobileCommmentHeaderWrapper:"ReaderComment-module_mobileCommmentHeaderWrapper_MxoIa",mobileCommmentHeader:"ReaderComment-module_mobileCommmentHeader_O2gLE",count:"ReaderComment-module_count_6syjv",replayBtn:"ReaderComment-module_replayBtn_YG364",text:"ReaderComment-module_text_E5A0E",commentFloorContainer:"ReaderComment-module_commentFloorContainer_hYRys",mobileCommentFloorContainer:"ReaderComment-module_mobileCommentFloorContainer_6CVJy",header:"ReaderComment-module_header_9Ej69",headerTitle:"ReaderComment-module_headerTitle_MaqXh",headerBtn:"ReaderComment-module_headerBtn_YdQfC",mobile:"ReaderComment-module_mobile_f+LqA"};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===y(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t,n,a=e.target,i=e.isShare,c=e.group,u=e.book,f=e.withCornerBubble,y=e.getViewEngine,b=e.onRemoveComment,x=e.onCreateComment,w=e.litecomment,k=e.autoScrollToComment,E=i?"share":"read",O=null===(t=window.location.hash)||void 0===t?void 0:t.match(/#comment-(\d+)/),C=O?O[1]:void 0,A=!!C,P=!A,S=g(Object(r.useState)(!1),2),j=S[0],R=S[1],_=Object(r.useRef)(),M=function(){var e=document.querySelector("#lark-mini-editor");e?(P&&_.current&&_.current.renderAllComments(),e.scrollIntoView(),R(!0)):document.querySelector("#scroll-to-comment").scrollIntoView()},L=w.commentCount>0?o.a.createElement("div",{className:m.commmentHeader},__("所有评论（{count}）",{count:w.commentCount})):null,T=w.commentCount>0?o.a.createElement("div",{className:m.mobileCommmentHeaderWrapper},o.a.createElement("div",{className:m.mobileCommmentHeader},o.a.createElement("span",{className:m.count},__("所有评论（{count}）",{count:w.commentCount})),o.a.createElement("a",{className:m.replayBtn,onClick:M},o.a.createElement(s.b,{name:"edit-border",width:20}),o.a.createElement("span",{className:m.text},__("回复"))))):null,D=window.h5,N=o.a.createElement("div",{className:m.wrapper},D?T:L,o.a.createElement("div",{className:l()((n={},v(n,m.mobileCommentFloorContainer,D),v(n,m.commentFloorContainer,!D),n))},o.a.createElement(d.a,{ref:_,key:a.id,commentableType:e.targetType,target:e.target,group:c,book:u,doc:a,canMentionMembers:p.a.canMentionMembers(E,{group:c}),onCreate:x,onRemove:b,canComment:!0,focusToEditor:j,getViewEngine:y,openInfiniteScroll:P,onCommentLoaded:function(){k&&C&&setTimeout((function(){var e=document.querySelector("#comment-".concat(C));null==e||e.scrollIntoView(!0)}),1e3)}})),f&&o.a.createElement(h.a,{iconName:"comment-bubble",style:{bottom:"86px"},onClick:M,count:w.commentCount>0?w.commentCount:0})),B=g(Object(r.useState)(A?N:null),2),I=B[0],F=B[1];return Object(r.useEffect)((function(){F(N)}),[j]),Object(r.useEffect)((function(){F(N)}),[w.commentCount]),o.a.createElement(o.a.Fragment,null,I)};x.defaultProps={isShare:!1,onCreateComment:function(){},onRemoveComment:function(){}},x.propTypes={target:i.a.object.isRequired,litecomment:i.a.object.isRequired,targetType:i.a.oneOf(["Doc","DocVersion"]).isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,autoScrollToComment:i.a.bool,isShare:i.a.bool,onCreateComment:i.a.func,onRemoveComment:i.a.func,withCornerBubble:i.a.bool,getViewEngine:i.a.func};t.default=Object(f.b)(Object(u.d)((function(e){return{litecomment:e.litecomment}}))(x),!0)},4144:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(3170),l=n.n(c),u=n(1490),s=n(3982),d=n(3964);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===f(a)?a:String(a)),r)}var o,a}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(i,e);var t,n,r,a=y(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a.apply(this,arguments)}return t=i,(n=[{key:"render",value:function(){var e=this.props,t=e.location,n=e.fragment,r=e.doc,a=e.book,i=e.group,c=e.isPresentMode,f=e.className;return"doc_embed"===(this.props.view||t.query.view)?o.a.createElement(d.a,h({className:f},l()(this.props,"isPresentMode"),{"data-presentation":c}),c?o.a.createElement(s.a,{doc:r,view:"doc_embed",getContainer:function(){return document.body}}):o.a.createElement(u.default,{doc:r,book:a,group:i,content:n,scene:"doc",preventCopySelfContainer:!0,fallbackLake:!0})):o.a.createElement("div",null,o.a.createElement(u.default,{doc:r,book:a,group:i,content:n,preventCopySelfContainer:!0,fallbackLake:!0}))}}])&&p(t.prototype,n),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.PureComponent);g.propTypes={fragment:i.a.string,view:i.a.string,doc:i.a.object,book:i.a.object,group:i.a.object,location:i.a.object,showHeader:i.a.bool,isPresentMode:i.a.bool,className:i.a.string},t.a=g},4397:function(e,t,n){"use strict";var r=n(90),o=n.n(r),a=n(4119),i=n(207),c=new o.a("doc:share.page.vm");t.a=function(e){var t=e.book,n=e.doc,r=e.query,o=e.slug,l=e.appData,u=e.dispatch;return r=i.a.normalizeReadPageQuery(r),c("process doc: ",o,r),Object(a.a)({requestData:{query:r,book_id:t.id,slug:o},dispatch:u,doc:n},[o]),{getQuery:function(){return r},isDocEmbed:function(){return"doc_embed"===r.view},isDocInner:function(){return"Doc"===n.type&&r.inner},isRenderSingleDoc:function(){return t.abilities&&!t.abilities.read},needRenderComments:function(){return n.loaded&&t.enable_comment&&!n.error},needRenderPager:function(){return n.loaded&&!l.isDocCollaborator}}}},4412:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(3895),l=n(630),u=n(3845),s=n(3657),d={draft:"SheetEmbed-module_draft_hySRt",sheetViewer:"SheetEmbed-module_sheetViewer_LnVL7",content:"SheetEmbed-module_content_XRryY"};function f(e){var t=e.doc,n=e.book,r=e.group,a=e.match,i=e.sheetHeight,f=e.hasReadAuditTip,h=e.showHeader?i-32:i;return t.loaded?o.a.createElement("div",{className:d.wrapper},e.showHeader&&o.a.createElement(u.a,{title:t.title,doc:t,book:n,group:r,height:32,link:a&&a.url}),o.a.createElement("div",{className:d.content},e.showHeader&&o.a.createElement(l.g,{doc:t,className:d.draft}),f&&o.a.createElement(s.default,{key:"audits",doc:t,type:"Doc"}),o.a.createElement("div",{className:d.sheetViewer,style:{width:"100%",height:h,overflow:"hidden"}},o.a.createElement(c.a,{content:t.content,format:t.format,geSheetStyle:{width:"100%",height:i-40}})))):null}f.defaultProps={showHeader:!0},f.propTypes={doc:i.a.object.isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,sheetHeight:i.a.number.isRequired,match:i.a.object.isRequired,showHeader:i.a.bool,hasReadAuditTip:i.a.bool.isRequired};t.a=f},4413:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(4002),l=n(630),u=n(3845),s=n(3657),d={draft:"TableEmbed-module_draft_MzbtP",tableViewer:"TableEmbed-module_tableViewer_zFcBH",content:"TableEmbed-module_content_jQFtq"};function f(e){var t=e.doc,n=e.book,r=e.group,a=e.match,i=e.tableHeight,f=e.hasReadAuditTip,h=e.showHeader?i-32:i;return t.loaded?o.a.createElement("div",{className:d.wrapper},e.showHeader&&o.a.createElement(u.a,{title:t.title,doc:t,book:n,group:r,height:32,link:a&&a.url}),o.a.createElement("div",{className:d.content},e.showHeader&&o.a.createElement(l.g,{doc:t,className:d.draft}),f&&o.a.createElement(s.default,{key:"audits",doc:t,type:"Doc"}),o.a.createElement("div",{className:d.tableViewer,style:{width:"100%",height:h,overflow:"hidden"}},o.a.createElement(c.a,{docId:t.id,type:t.type,abilities:t.abilities,content:t.content||t.body,enableNext:t.isEnableTableNext,format:t.format,geSheetStyle:{width:"100%",height:i}})))):null}f.defaultProps={showHeader:!0},f.propTypes={doc:i.a.object.isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,tableHeight:i.a.number.isRequired,match:i.a.object.isRequired,showHeader:i.a.bool,hasReadAuditTip:i.a.bool.isRequired};t.a=f},4448:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(90),l=n.n(c),u=n(1501),s=n(3935),d=n(420),f=n(905),h=n(4026);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=new l.a("doc:mind.reader"),v=Object(f.c)((function(){return n.e(1188).then(n.bind(null,3933))}),{suspense:!0}),g=Object(f.c)((function(){return n.e(26).then(n.bind(null,4017))}),{suspense:!0}),b=Object(f.b)((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(5),n.e(65)]).then(n.bind(null,3253))}),{suspense:!0});function x(e){var t=e.doc,n=e.isDocEmbed,a=e.shouldRenderComments,i=e.editMode,c=e.history,l=x.useViewModel({doc:t,isDocEmbed:n,dispatch:e.dispatch}),u=l.getStage();return Object(r.useEffect)((function(){y("mind reader react node created")}),[]),o.a.createElement("div",{className:h.a.wrapper},o.a.createElement("div",{className:h.a.adapt},i?o.a.createElement(b,{history:c,editMode:i}):o.a.createElement(s.default,{className:h.a.content,content:t.content,width:"100%",height:u.height,onLoad:l.onLoad})),!n&&!i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(v,{type:"Doc",targetId:t.id,likeStatus:t.like.actioned,likeCount:t.like.count,size:"bubble",bubblePopover:!0}),o.a.createElement(g,{style:a?{bottom:"32px"}:{bottom:"86px"}})))}x.useViewModel=function(e){var t=e.doc,n=e.isDocEmbed,o=e.dispatch,a=p(Object(r.useState)(document.body.clientHeight),2),i=a[0],c=a[1],l=Object(f.e)(),s=function(){c(document.body.clientHeight)},h=function(e){u.a.getSheetStoredPosition(t.id)&&console.log("TODO")};return Object(r.useEffect)((function(){return window.addEventListener("resize",s,!1),function(){window.removeEventListener("resize",s,!1)}}),[]),Object(r.useEffect)((function(){b.preload()}),[]),{state:{viewHeight:i},getStage:function(){return{height:i-(n?32:60)}},restorePosition:h,addCommentCount:function(){o({type:"doc/addCommentCount"})},onLoad:function(e){h(),Object(d.b)(t.id,t.type),v.start(),g.start(),l.priorityTaskManager.execMedium()},reduceCommentCount:function(){o({type:"doc/reduceCommentCount"})}}},x.propTypes={group:i.a.object.isRequired,book:i.a.object.isRequired,doc:i.a.object.isRequired,isShare:i.a.bool,isDocEmbed:i.a.bool,dispatch:i.a.func,shouldRenderComments:i.a.bool},t.default=x},4449:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(90),l=n.n(c),u=n(1501),s=n(2868),d=n(905),f=n(4026);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=new l.a("doc:mind.reader"),y=Object(d.c)((function(){return n.e(1188).then(n.bind(null,3933))}),{suspense:!0}),v=Object(d.c)((function(){return n.e(26).then(n.bind(null,4017))}),{suspense:!0});function g(e){var t=e.doc,n=e.isDocEmbed,a=e.shouldRenderComments,i=g.useViewModel({doc:t,isDocEmbed:n,dispatch:e.dispatch}),c=i.getStage();return Object(r.useEffect)((function(){m("mind reader react node created")}),[]),o.a.createElement("div",{className:f.a.wrapper},o.a.createElement("div",{className:f.a.adapt},o.a.createElement(s.default,{className:f.a.content,content:t.content,width:"100%",height:c.height,onLoad:i.onLoad})),!n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(y,{type:"Doc",targetId:t.id,likeStatus:t.like.actioned,likeCount:t.like.count,size:"bubble",bubblePopover:!0}),o.a.createElement(v,{style:a?{bottom:"32px"}:{bottom:"86px"}})))}g.useViewModel=function(e){var t=e.doc,n=e.isDocEmbed,o=e.dispatch,a=h(Object(r.useState)(document.body.clientHeight),2),i=a[0],c=a[1],l=Object(d.e)(),s=function(){c(document.body.clientHeight)},f=function(e){u.a.getSheetStoredPosition(t.id)&&console.log("TODO"),y.start(),v.start(),l.priorityTaskManager.execMedium()};return Object(r.useEffect)((function(){return window.addEventListener("resize",s,!1),setTimeout((function(){f()})),function(){window.removeEventListener("resize",s,!1)}}),[]),{state:{viewHeight:i},getStage:function(){return{height:i-(n?32:60)}},onLoad:f,addCommentCount:function(){o({type:"doc/addCommentCount"})},reduceCommentCount:function(){o({type:"doc/reduceCommentCount"})}}},g.propTypes={group:i.a.object.isRequired,book:i.a.object.isRequired,doc:i.a.object.isRequired,isShare:i.a.bool,dispatch:i.a.func,shouldRenderComments:i.a.bool},t.default=g},4511:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=n(207),l=n(3845),u=n(4412),s=n(4413),d=n(3992),f=n(4448),h=n(4449),p=n(90),m=n.n(p),y=n(2867),v=n(1490),g=n(3552),b=n(3861),x=n(3608),w=n(4124),k="ReaderDocEmbed-module_wrap_iirZe",E="ReaderDocEmbed-module_title_X6A9I",O="ReaderDocEmbed-module_article_+VRXp",C="ReaderDocEmbed-module_comment_hpWBZ",A="ReaderDocEmbed-module_withOutline_oWpnx";function P(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=new m.a("doc:embed"),M=new URLSearchParams(window.location.search);function L(e){var t=e.doc,n=e.scene,a=e.theme,i=Object(r.useMemo)((function(){return new x.a}),[]),l=!window.h5&&("1"===M.get("outline")||i.isEmbedMode&&"toc"===i.sidebar),u="1"===M.get("comment"),s="1"===M.get("title"),d=S(Object(r.useState)([]),2),f=d[0],h=d[1],p=S(Object(r.useState)(null),2),m=p[0],j=p[1],R=S(Object(r.useState)(null),2),L=R[0],T=R[1],D=o.a.useRef(null),N=o.a.useRef(null);o.a.useRef(null).current=o.a.useMemo((function(){return _("useMemo start calculate."),D.current?f.map((function(e){return document.getElementById(e.id)})):[]}),[f]);var B=Object(r.useMemo)((function(){return new b.a}),[]);Object(b.c)({backgroundColor:i.backgroundColor}),Object(r.useEffect)((function(){B.onMessage((function(e){e.id;var t=e.type,n=e.message;e.options;t===B.MESSAGE_TYPES.SCROLL_TO?window.scrollTo(0,n):t===B.MESSAGE_TYPES.SET_VALUE&&(j(n),T(+new Date))})),B.loadCallback()}),[B]),Object(r.useEffect)((function(){j(t.content)}),[t.content]),Object(r.useEffect)((function(){t.loaded&&B.onDocLoaded()}),[t.loaded,B]),_("render doc as embed mode, show outline:",l);var I=function(e){_("onresize update outline position"),function(){var e=D.current;if(e){var t={type:"doc_height_change",payload:{height:e.offsetHeight}};i.autoHeight&&(clearTimeout(N.current),N.current=setTimeout((function(){B.resize({height:document.body.scrollHeight})}),300)),_("send message:",t),window.parent.postMessage(t,"*")}}()},F=function(e){var t=e.data;if(_("receive message:",t),"jump_to_anchor"===t.code){var n=t.payload.id;if("string"==typeof n)if(f.find((function(e){return e.id===n})))document.getElementById(n).scrollIntoView()}},q=function(e){B.onHashChange(e)};if(Object(r.useEffect)((function(){return window.addEventListener("resize",I),window.addEventListener("message",F),window.addEventListener("hashchange",q),function(){window.removeEventListener("resize",I),window.removeEventListener("message",F),window.removeEventListener("hashchange",q)}}),[]),Object(r.useEffect)((function(){"en"===M.get("translate")&&c.a.translateDoc({srcLanguage:"zh",tgtLanguage:"en",withComment:!1}),i.watermark&&Object(y.b)({el:document.querySelector("#content"),text:i.watermark})}),[]),!t.loaded)return o.a.createElement("span",null);var z=o.a.createElement(v.default,{key:L,content:m,scene:n,genOutline:l,genAnchor:!1,typography:a.typography,onLoaded:function(e,t){var n,r;_("doc loaded"),g.a.initScrollbarPosition(),h(t.outline),n={rootNode:e.domRootNode,outline:P(t.outline)},r={url:document.location.href,type:"doc_ready",payload:{height:n.rootNode.offsetHeight,outline:n.outline}},_("send message:",r),window.parent.postMessage(r,"*")}});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"content",className:"".concat(k," ").concat(l?A:"")},s&&o.a.createElement("h1",{id:"article-title",className:E},t.title),o.a.createElement("div",{className:O,ref:D},m?z:null)),u&&o.a.createElement("div",{className:C,"data-testid":"doc-embed-comment"},o.a.createElement(w.default,{key:t.id,target:t,targetType:"Doc",book:e.book,group:e.group})))}L.defaultProps={scene:"other",theme:{}},L.propTypes={doc:i.a.object.isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,scene:i.a.oneOf(["doc","other"]),theme:i.a.object};var T=L,D=n(4144),N="EmbedReader-module_content_e5Mfz",B="EmbedReader-module_assistantWrapper_tchwH";function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=new URLSearchParams(window.location.search);function z(e){var t=e.doc,n=e.group,a=e.book,i=e.isShare,p="yuque"===e.from,m=I(Object(r.useState)(document.body.clientHeight),2),y=m[0],v=m[1],g="0"!==q.get("title"),b="true"===q.get("assistant"),x=function(){v(document.body.clientHeight)};if(Object(r.useEffect)((function(){return window.addEventListener("resize",x,!1),function(){window.removeEventListener("resize",x,!1)}}),[]),!t.loaded)return o.a.createElement("span",null);if(t.error)return o.a.createElement(d.a,{error:t.error});if("Doc"===t.type)return p?o.a.createElement(D.a,{match:e.match,doc:t,book:a,group:n,view:"doc_embed",scene:"doc",isPresentMode:!!q.get("_present"),showHeader:g,docLoaded:t.loaded,fragment:t.content,className:b?B:""}):o.a.createElement(T,{doc:t,book:a,group:n,scene:"doc",theme:c.a.getTheme(t,a)});if("Sheet"===t.type)return o.a.createElement(u.a,{doc:t,book:a,group:n,sheetHeight:y,match:e.match,hasReadAuditTip:c.a.needShowAuditTip(t),showHeader:g&&p});if("Table"===t.type)return o.a.createElement(s.a,{doc:t,book:a,group:n,tableHeight:y,match:e.match,hasReadAuditTip:c.a.needShowAuditTip(t),showHeader:g&&p});var w=function(){return"Mind"===t.type||"Board"===t.type?o.a.createElement(f.default,{key:"doc-content-".concat(t.id),group:n,book:a,doc:t,isShare:i,isDocEmbed:!0}):"Show"===t.type?o.a.createElement(h.default,{key:"doc-content-".concat(t.id),group:n,book:a,doc:t,isShare:i,isDocEmbed:!0}):o.a.createElement(o.a.Fragment,null,t.content)};return p?o.a.createElement("div",{id:"lake-document-embed"},g&&o.a.createElement(l.a,{title:t.title,height:32,link:e.match&&e.match.url,doc:t,book:a,group:n}),o.a.createElement("div",{className:N},w())):w()}z.propTypes={group:i.a.object.isRequired,book:i.a.object.isRequired,doc:i.a.object.isRequired,isShare:i.a.bool,from:i.a.string,match:i.a.object.isRequired};t.default=z},510:function(e,t,n){"use strict";n(3248);var r=n(3188);n(1414);t.a=r.a},5163:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(429),i=n(67),c=n(4397),l=n(4511);t.default=Object(a.d)((function(e){return{group:e.group,book:e.book,doc:e.doc}}))(Object(i.withRouter)((function(e){var t=e.doc,n=e.book,r=e.group,a=e.match,i=e.from,u=e.location,s=window.appData.sharePage,d=s?"doc_slug":"doc";return Object(c.a)({book:n,doc:t,query:u.query,slug:a.params[d],appData:window.appData,dispatch:e.dispatch}),o.a.createElement(l.default,{doc:t,book:n,group:r,isShare:s,match:a,from:i})})))}}]);