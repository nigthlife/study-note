文件上传绕过方式

1.   前端绕过（验证在前端）

     -   使用本地文件替换

2.   content-type绕过

     -   修改类型为png、jpe

3.   黑名单绕过

     -   尝试使用不在黑名单中的后缀类型上传

4.   .hatccess文件绕过

     -   将这个文件上传成功后，当前文件夹中所有文件都会视为php文件，然后进行解析

5.   文件后缀大小写绕过

     -   在后缀处多添加空格

6.   后缀添加空格绕过

     -   

7.   利用windows特性，会自动去除末尾的点号

8.   利用windows特性，可在后缀名中加” ::$DATA”绕过：

9.   黑名单过滤，注意第15行和之前不太一样，

     -   路径拼接的是处理后的文件名，于是构造info.php. . （点+空格+点）
     -   经过处理后，文件名变成info.php.，即可绕过。
     -   

10.   依旧是黑名单过滤，注意到，这里是将问题后缀名替换为空，于是可以利用双写绕过：

      -   使用后缀方式为：.pphphp
      -   此方法只能用在去除一次php

11.   看到是白名单判断，但是$img_path直接拼接，因此可以利用%00截断绕过

      -   使用%00对php的版本号有要求，必须小5.3.4

12.   和十一关不同的是这次的save_path是通过post传进来的，还是利用00截断，但这次需要在二进制中进行修改，因为post不会像get对%00进行自动解码。

13.   %00 截断，需要低版本php

14.   图片马+文件包含

15.   图片马+文件包含漏洞

16.   图片马+文件包含漏洞

17.   图片马+二次渲染+文件包含

      本关综合判断了后缀名、content-type，以及利用imagecreatefromgif判断是否为gif图片，最后再做了一次二次渲染，绕过方法：不过二次渲染会保留一些文件内容不会改变，所以在制作图片马之前，我们先观察二次渲染前后图片不会改变的地方，将其代码写入其中即可绕过二次渲染

18.   这里先将文件上传到服务器，然后通过rename修改名称，再通过unlink删除文件，因此可以通过条件竞争的方式在unlink之前，访问webshell。
      首先在burp中不断发送上传webshell的数据包：

19.   本关对文件后缀名做了白名单判断，然后会一步一步检查文件大小、文件是否存在等等，将文件上传后，对文件重新命名，同样存在条件竞争的漏洞。可以不断利用burp发送上传图片马的数据包，由于条件竞争，程序会出现来不及rename的问题，从而上传成功：

20.   空格绕过或者%00截断

21.   ![image-20220810223608011](文件上传绕过方式.assets/image-20220810223608011.png)

      

      

      

      

      

      

      







